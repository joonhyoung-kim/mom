!function(Z,p,j){"use strict";var g="ht",L=Z[g],h=L.Default,G=L.graph,T=h.getInternal(),N=T.ui(),X=N.NodeUI.prototype,o=N.ShapeUI.prototype,m=G.GraphView,$=m.prototype,J=N.EdgeUI.prototype,H=L.Node,E=L.Shape,u=L.Edge,D=L.Group,O=h.isTouchable,s=h.preventDefault,k=Z.setTimeout,x=h.grow,v=h.isDragging,r=h.getDistance,t=null,R=L.List,C="undefined"!=typeof Float32Array?Float32Array:Array,S=Math,F=S.PI,d="Crossing",Q="No Crossing",K=F/2,U=2*F,f=S.atan2,a=S.sqrt,z=S.pow,e=S.sin,i=S.cos,V=S.min,n=S.max,M=S.abs,q=S.ceil,w=S.round,W=h.unionPoint,I=h.unionRect,c=h.containsPoint,B=h.clone,b="rgb(52, 152, 219)",P="red",l={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var N=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],t=0;t<N.length;t++){var o=N[t];o=0===t%2?o/400*Y.width:o/100*Y.height,N[t]=o}return Y.width>120&&(N[4]=Y.width-26,N[6]=Y.width-40,N[10]=Y.width-40,N[12]=Y.width-26,N[18]=33),N}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},y={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:b,rotation:.61},{type:"circle",rect:[200,120,70,70],background:b,rotation:.61},{type:"circle",rect:[200,220,70,70],background:b,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:b},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:b}]},A={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:P,rotation:.61}]},_={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:b},{type:"circle",rect:[0,210,90,90],background:b},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:b}]},ak={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:P},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:P}]},Ob={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:b}]},Fc={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:P}]},rs={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},pb={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Sh=function(t){var A=t.touches[0];return A?A:t.changedTouches[0]},ho=function(b,M,E,F){return f(F-M,E-b)},ai=function(X,H){return{x:X.x*H,y:X.y*H}},Lh=function(H,$){var X,D,l,q,_=H._layers,x=H.sm().getSelection()._as,W=x.length;if(_)for(X=0;X<_.length;X++){q=_[X];for(var z=0;W>z;z++)if(D=x[z],D._layer===q&&(l=$(D),l===!1))return}else for(X=0;W>X;X++)if(D=x[X],l=$(D),l===!1)return},vh=function(K,f,N){var F,s,d,x,Q,W=this,a=f,l=W.gv;if(K instanceof E){d=K.getSegments();var n=l.getDataUI(K);Q=n._55O.$15l,d&&d.size()||(d=Gg(Q)),K.isClosePath()&&d.indexOf(5)<0&&(d=new R(d._as),d.add(5)),F=Ig(K,n,a),s=Q[F]}else{var Z=l.getDataUI(K);Q=ko(Z,K.s("edge.points")),d=K.s("edge.segments"),d&&d.size()||(d=Gg(Q)),Q=Q._as,F=Ig(K,Z,a),s=Q[F]}if(d&&(x=d.get(a)),2===x||1===x||5===x){var t=Q[F+1];5===x&&(t=Q[0]);var H=Dr(s,N,t);return H}return N},ul=function(i,r){var l,q,R,J,Z=i._layers,c=i.sm().getSelection()._as,E=c.length;if(Z)for(l=Z.length-1;l>=0;l--){J=Z[l];for(var k=E-1;k>=0;k--)if(q=c[k],q._layer===J&&(R=r(q),R===!1))return}else for(l=E-1;l>=0;l--)if(q=c[l],R=r(q),R===!1)return},lk=function(N,J,W,l){var s=J/2,h=W/2,i=ig(N,-s,-h,l),E=ig(N,s,-h,l),R=ig(N,-s,h,l),A=ig(N,s,h,l),T=ig(N,0,-h,l),d=ig(N,s,0,l),V=ig(N,0,h,l),z=ig(N,-s,0,l);return[i,E,R,A,T,d,V,z]},Dr=function(s,y,V){var C={x:y.x-s.x,y:y.y-s.y},f={x:V.x-s.x,y:V.y-s.y},g=a(z(V.x-s.x,2)+z(V.y-s.y,2)),Y={x:f.x/g,y:f.y/g},$=C.x*Y.x+C.y*Y.y,o={x:Y.x*$,y:Y.y*$};return{x:s.x+o.x,y:s.y+o.y}},ig=function(V,C,A,$){var x=i($)*C-e($)*A,n=e($)*C+i($)*A;return V?{x:V.x+x,y:V.y+n}:{x:x,y:n}},eh=function(y,w){return w>2*y?y:w/2},Rp=function(H,i,P,Z){var x=r(H,i);return P=Z?V(P,x):eh(P,x),x?P/=x:P=0,{x:H.x+(i.x-H.x)*P,y:H.y+(i.y-H.y)*P}},dg=function(g,v){var q,E,L=g.gv,c=g._data,e=c._40I,N=c._41I,s=c.s("edge.offset"),u=c.s("edge.source.position"),H=c.s("edge.target.position"),$=c.s("edge.source.offset.x"),U=c.s("edge.source.offset.y"),_=c.s("edge.target.offset.x"),O=c.s("edge.target.offset.y"),K=c.s("edge.source.anchor.x"),w=c.s("edge.source.anchor.y"),z=c.s("edge.target.anchor.x"),j=c.s("edge.target.anchor.y");if(v?(q=T.getEdgeAgentPosition(L,e,u,$,U,K,w),E=T.getEdgeAgentPosition(L,N,H,_,O,z,j)):(q=T.getEdgeAgentPosition(L,e,u,0,0,K,w),E=T.getEdgeAgentPosition(L,N,H,0,0,z,j)),"points"===c.s("edge.type")&&s&&!c.s("edge.center")&&q){var F=c.s("edge.points")||new R,J=F.size(),d=Rp(q,J?F.get(0):E,s,J),X=Rp(E,J?F.get(J-1):q,s,J);q=d,E=X}return[q,E]},ko=function(h,c,M){var J=h._78o,i=h._data,Q=i.s("edge.type"),g=[J.sourcePoint,J.targetPoint];return"points"===Q?M&&(g=dg(h)):g=J.center?Q?M?dg(h):dg(h,!0):M?dg(h):[J.c1,J.c2]:M?dg(h):dg(h,!0),c=new R(c?c._as:t),c.add(g[0],0),c.add(g[1]),c},ui=function(U){return U=new R(U._as),U.removeAt(0),U.removeAt(U.size()-1),U},Gg=function(W){W._as||(W=new R(W));var v=new R;v.add(1);for(var S=1;S<W.size();S++)v.add(2);return v},ad=function(j,Z){return{x:(j.x+Z.x)/2,y:(j.y+Z.y)/2}},Ik=function(k,P){return{x:k.x+1*(P.x-k.x)/4,y:k.y+1*(P.y-k.y)/4}},_f=function(o,t){return{x:o.x+3*(t.x-o.x)/4,y:o.y+3*(t.y-o.y)/4}},qq=function(K,E,l,z){var h=E.x+E.width/2,P=E.y+E.height/2,I=a(h*h+P*P),b=f(P,h)+l;return{x:z.x+I*i(b),y:z.y+I*e(b)}},Nf=$.validateImpl,Vn=$.isRectEditable,ij=$.isPointEditable,bi=$._42,lq=o._79o,co=J._79o,Lp=o._48O,Pn=o._47O,Wc=X._48O,Qp=X._80o,em=o._80o,lo=X.getSelectWidth,wn=X._47O,Lf=J._47O,xl=$.isEditable,Vi=["northwest","north","northeast","east","southeast","south","southwest","west"],dm=function(A,B,h,O,L,C,J,v,H,w){var b=A.x,j=A.y,U=A.width,k=A.height,x={x:b+U/2,y:j+k/2};O=O||0,B=ig(x,B.x-x.x,B.y-x.y,-O),J&&!v&&(B.x+=H,B.y+=w);var $=.01;if("northwest"===h?(B.x+L>b+U-$&&(B.x=b+U-L-$),B.y+L>j+k-$&&(B.y=j+k-L-$),A=W(B,{x:b+U,y:j+k})):"north"===h?(B.y+L>j+k-$&&(B.y=j+k-L-$),A=W({x:b,y:B.y},{x:b+U,y:j+k})):"northeast"===h?(B.x<b+L+$&&(B.x=b+L+$),B.y+L>j+k-$&&(B.y=j+k-L-$),A=W({x:b,y:B.y},{x:B.x,y:j+k})):"west"===h?(B.x+L>b+U-$&&(B.x=b+U-L-$),A=W({x:B.x,y:j},{x:b+U,y:j+k})):"east"===h?(B.x<b+L+$&&(B.x=b+L+$),A=W({x:b,y:j},{x:B.x,y:j+k})):"southwest"===h?(B.x+L>b+U-$&&(B.x=b+U-L-$),B.y<j+L+$&&(B.y=j+L+$),A=W({x:B.x,y:j},{x:b+U,y:B.y})):"south"===h?(B.y<j+L+$&&(B.y=j+L+$),A=W({x:b,y:j},{x:b+U,y:B.y})):"southeast"===h&&(B.x<b+L+$&&(B.x=b+L+$),B.y<j+L+$&&(B.y=j+L+$),A=W({x:b,y:j},B)),"keepRatio"===C&&(!J&&v||J&&!v)&&("northeast"===h||"southeast"===h||"northwest"===h||"southwest"===h)){var n=A.width,D=A.height,p=n/U,Z=D/k,I=V(p,Z);A.width=U*I,A.height=k*I,"northeast"===h?A.y=j+(k-A.height):"northwest"===h?(A.y=j+(k-A.height),A.x=b+(U-A.width)):"southwest"===h&&(A.x=b+(U-A.width))}A.x-=x.x,A.y-=x.y;var y=qq(t,A,O,x);return A.x=y.x-A.width/2,A.y=y.y-A.height/2,A},ml=function(M,R,_,f){var i=M.getRotation(),N=R,X=N.x,I=N.y,V=N.width,L=N.height,o={x:X+N.width/2,y:I+N.height/2};f=ig(o,f.x-o.x,f.y-o.y,-i),"northwest"===_?N=W(f,{x:X+V,y:I+L}):"north"===_?N=W({x:X,y:f.y},{x:X+V,y:I+L}):"northeast"===_?N=W({x:X,y:f.y},{x:f.x,y:I+L}):"west"===_?N=W({x:f.x,y:I},{x:X+V,y:I+L}):"east"===_?N=W({x:X,y:I},{x:f.x,y:I+L}):"southwest"===_?N=W({x:f.x,y:I},{x:X+V,y:f.y}):"south"===_?N=W({x:X,y:I},{x:X+V,y:f.y}):"southeast"===_&&(N=W({x:X,y:I},f)),M.setRect(N),N.x-=o.x,N.y-=o.y;var a=qq(M,N,i,o);M.p(a.x,a.y)},bd=function(G,Y,y,O,J,T,d,e){var H=t;T?(H=ig(t,J.x-Y.x,J.y-Y.y,-y),H.x-=d.x,H.y-=d.y):H=ig(t,J.x-Y.x,J.y-Y.y,0);var u={x:Y.x+H.x,y:Y.y+H.y};e&&(u=e(u.x,u.y)),u.e=G.getPoints().get(O).e,G.setPoint(O,u);var C=G.getWidth(),F=G.getHeight(),I=G.p().x-C/2,h=G.p().y-F/2;I-=Y.x,h-=Y.y;var i=qq(G,{x:I,y:h,width:C,height:F},y,Y);G.p(i.x,i.y)},Ig=function(j,n,C){var k,J;if(j instanceof E?(k=j.getPoints(),J=j.getSegments()):j instanceof u&&"points"===j.s("edge.type")&&(k=j.s("edge.points"),J=j.s("edge.segments"),k=ko(n,k)),J&&J.size()||(J=Gg(k)),j instanceof E&&j.isClosePath()&&J.indexOf(5)<0&&(J=new R(J._as),J.add(5)),J)for(var U=-1,P=0;P<J.size();P++){if(P===C)return U;var o=J.get(P);1===o?U+=1:2===o?U+=1:3===o?U+=2:4===o&&(U+=3)}},Cm=function(x,Z,$){var a,d;if(x instanceof E?(a=x.getPoints(),d=x.getSegments()):x instanceof u&&"points"===x.s("edge.type")&&(a=x.s("edge.points"),d=x.s("edge.segments"),a=ko(Z,a)),d&&d.size()||(d=Gg(a)),d)for(var n=-1,t=0;t<d.size();t++){var O=d.get(t);if(1===O?n+=1:2===O?n+=1:3===O?n+=2:4===O&&(n+=3),n===$)return t}},io=function(A,$){var v=[A[0]-$[0],A[1]-$[1],A[2]-$[2]];return v},hr=function(){var t=new C(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Tp=function(X,m){var O=X[0],U=X[1],K=X[2];return X[0]=m[0]*O+m[4]*U+m[8]*K+m[12],X[1]=m[1]*O+m[5]*U+m[9]*K+m[13],X[2]=m[2]*O+m[6]*U+m[10]*K+m[14],X},Cq=function(D,y){if(y){var O=e(y),I=i(y),r=D[0],H=D[1],T=D[2],n=D[3],_=D[8],q=D[9],Y=D[10],x=D[11];D[0]=r*I-_*O,D[1]=H*I-q*O,D[2]=T*I-Y*O,D[3]=n*I-x*O,D[8]=r*O+_*I,D[9]=H*O+q*I,D[10]=T*O+Y*I,D[11]=n*O+x*I}},an=function(A,x){for(var F=A.s("grid.row.count"),o=A.s("grid.column.count"),e=0;F>e;e++)for(var K=0;o>K;K++){var H=A.getCellRect(e,K);if(c(H,x))return{rowIndex:e,columnIndex:K,rect:H,grid:A}}return null},pm=function(H,$,y,w,K,m){var u={},g=y-H,n=w-$,C=S.sqrt(g*g+n*n),Z=g/C,c=n/C,h=(-H+K)*Z+(-$+m)*c;return 0>=h?(u.x=H,u.y=$):h>=C?(u.x=y,u.y=w):(u.x=H+h*Z,u.y=$+h*c),g=K-u.x,n=m-u.y,u.z=S.sqrt(g*g+n*n),u},dj=function(D,v){var H,p,J,F,c,i,R,X,P=D.getPoints(),Q=D.getSegments(),b=D.p(),o=D.getRotation();if(!Q||!(Q.indexOf(3)>0||Q.indexOf(4)>0)){for(X=0;X<=P.size()-1;X++)if(X===P.size()-1?(c=P.get(0),F=P.get(X)):(F=P.get(X),c=P.get(X+1)),F=ig(b,F.x-b.x,F.y-b.y,o),c=ig(b,c.x-b.x,c.y-b.y,o),i=pm(F.x,F.y,c.x,c.y,v.x,v.y),R=i.z,R<(D.s("shape.border.width")||10)){p=F,J=c,H=X;break}if(H!=t){var G=pm(p.x,p.y,J.x,J.y,v.x,v.y),A=r(p,G);return{attachIndex:H,attachOffset:A}}}},Go=function(a){for(var i=a._data,w=i.p(),n=i.getRotation(),h=i.getPoints(),s=t,M=[],X=0;X<h.size();X++)s=h.get(X),M.push(ig(w,s.x-w.x,s.y-w.y,n));a._55O.$15l=M};h.setImage("xeditinteractor_parentIcon",y),h.setImage("xeditinteractor_hostIcon",A),h.setImage("xeditinteractor_edgeIcon",_),h.setImage("xeditinteractor_removeIcon",ak),h.setImage("xeditinteractor_sourceIcon",Ob),h.setImage("xeditinteractor_targetIcon",Fc),h.setImage("xeditinteractor_elevationIcon",rs),h.setImage("xeditinteractor_tallIcon",pb),$._editPointSize=O?24:9,$._edgeHelpers=["parent","remove","source","target"],$._leftTopHelpers=["parent"],$._rightTopHelpers=["host"],$._leftBottomHelpers=["edge"],$._rightBottomHelpers=["remove"],Vi=Vi.concat(Vi).concat(Vi),J._79o=function(){var b=this,l=b.gv,B=l.getZoom(),o=l._editInteractor,A=co.call(b);if(!A)return null;var w=dg(b,!0),d=w[0],y=w[1],T={x:A.x,y:A.y,width:A.width,height:A.height},V=W(d,y);if(o instanceof G.XEditInteractor){T=I(T,V);var U=b._55O,j=l.getEditPointSize()/B+2,$=0;U&&U._43O&&($+=j/2,x(T,$))}return T},J._47O=function(u){var Z=this,k=Z.gv,j=k._editInteractor;j instanceof G.XEditInteractor||Lf.call(Z,u)},J.rectIntersects=function(w){var z=this,L=z._data,_=z.gv,C=_.getZoom(),E=z._55O,m=_._editInteractor;if(m instanceof G.XEditInteractor&&_.isEditable(L)&&E&&E._43O&&"points"===L.s("edge.type")){var u=L.s("edge.points"),F=L.s("edge.segments");u=ko(z,u),F&&F.size()||(F=Gg(u)),u=u._as;var o=!1,i=O?5:1,y=w.x+i,s=w.y+i,v={x:y,y:s};if(m._edge===L&&m._hoverSegmentIndex>=0){var D=_._editInteractor._hoverSegmentIndex,H=F.get(D),p=Ig(L,z,D),f=t;if(p!=t&&p>=0){var r=u[p],x=_.getSegmentHoverWidth()/C;if(2===H||1===H){var M=u[p+1];f=dd(new xk(r.x,r.y),new xk(M.x,M.y),new xk(v.x-x,v.y-x),new xk(v.x+2*x,v.y+2*x)),f.$62l===d&&(o=!0)}else if(3===H){var S=u[p+1],M=u[p+2];f=lp(new xk(r.x,r.y),new xk(S.x,S.y),new xk(M.x,M.y),new xk(v.x-x,v.y-x),new xk(v.x+2*x,v.y+2*x)),f.$62l===d&&(o=!0)}else if(4===H){var b=u[p+1],U=u[p+2];M=u[p+3],f=xq(new xk(r.x,r.y),new xk(b.x,b.y),new xk(U.x,U.y),new xk(M.x,M.y),new xk(v.x-x,v.y-x),new xk(v.x+2*x,v.y+2*x)),f.$62l===d&&(o=!0)}}}if(o)return!0}return t},o._47O=function(I){var h=this,p=h.gv,$=p._editInteractor;$ instanceof G.XEditInteractor||Pn.call(h,I)},o.rectIntersects=function(P){var y=this,q=y._data,R=y.gv,M=R.getZoom(),A=y._55O,f=R._editInteractor;if(f instanceof G.XEditInteractor&&R.isEditable(q)&&A&&A._43O){var Z=A.$15l,H=!1,c=O?5:1,F=P.x+c,U=P.y+c,X={x:F,y:U};if(Z&&Z.length===q.getPoints().size()||(Go(y),Z=A.$15l),f._shape===q&&f._hoverSegmentIndex>=0){var o=q.getSegments();o&&o.size()||(o=Gg(Z));var i=R._editInteractor._hoverSegmentIndex,l=o.get(i),B=Ig(q,y,i),T=t;if(B!=t&&B>=0){var W=Z[B],I=R.getSegmentHoverWidth()/M;if(2===l||1===l){var C=Z[B+1];T=dd(new xk(W.x,W.y),new xk(C.x,C.y),new xk(X.x-I,X.y-I),new xk(X.x+2*I,X.y+2*I)),T.$62l===d&&(H=!0)}else if(3===l){var s=Z[B+1],C=Z[B+2];T=lp(new xk(W.x,W.y),new xk(s.x,s.y),new xk(C.x,C.y),new xk(X.x-I,X.y-I),new xk(X.x+2*I,X.y+2*I)),T.$62l===d&&(H=!0)}else if(4===l){var m=Z[B+1],w=Z[B+2];C=Z[B+3],T=xq(new xk(W.x,W.y),new xk(m.x,m.y),new xk(w.x,w.y),new xk(C.x,C.y),new xk(X.x-I,X.y-I),new xk(X.x+2*I,X.y+2*I)),T.$62l===d&&(H=!0)}}}if(H)return!0}return t},o._48O=function(){var i=this,D=i.gv,f=D._editInteractor;f instanceof G.XEditInteractor?(X._48O.call(i),i._55O._43O&&Go(i)):Lp.call(i)},o._79o=function(){var D=this,r=D.gv,J=r.getZoom(),W=r._editInteractor,R=lq.call(D);if(R){var m={x:R.x,y:R.y,width:R.width,height:R.height};if(W instanceof G.XEditInteractor){var A=D._55O,l=r.getEditPointSize()/J+2,B=0;A&&A._43O&&(B+=l/2,x(m,B))}return m}},X._47O=function(d){var y=this,m=y.gv,N=m._editInteractor;if(N instanceof G.XEditInteractor);else{var L=y._55O;L&&L._98o&&wn.call(y,d)}},X.getSelectWidth=function(){var T=this,x=T.gv,W=x._editInteractor,R=T._data;return x.isEditable(R)&&W instanceof G.XEditInteractor?0:lo.call(T)},X._80o=function(R){var u=this,X=u.gv._editInteractor;if(Qp.call(u,R),X&&X._debug){R.save(),R.beginPath(),R.lineWidth=1,R.strokeStyle="green";var j=u._79o();j&&(R.rect(j.x,j.y,j.width,j.height),R.stroke()),R.restore()}},o._80o=function(A){var N=this,E=N.gv._editInteractor;if(em.call(N,A),E&&E._debug){A.save(),A.beginPath(),A.lineWidth=1,A.strokeStyle="green";var s=N._79o();A.rect(s.x,s.y,s.width,s.height),A.stroke(),A.restore()}},X._48O=function(){var x=this,m=x.gv,w=x._data,X=m._editInteractor,p=x._55O,U=w.p(),I=w.getRotation();if(X instanceof G.XEditInteractor){if(p._42O){var j=lk(U,w.getWidth(),w.getHeight(),I),O=j[0],H=j[1],J=j[2],Q=j[3],l=j[4],Z=j[5],b=j[6],z=j[7];p.$45l=[O,l,H,Z,Q,b,J,z]}}else Wc.call(x)},$.getResizeMode=function(){return this.$25l||"normal"},$.setResizeMode=function(T){var N=this.$25l;this.$25l=T,this.fp("resizeMode",N,T)},$.getSnapAngle=function(){return this.$26l||Math.PI/36},$.setSnapAngle=function(_){var o=this.$26l;this.$26l=_,this.fp("snapAngle",o,_)},$.getSnapSpacing=function(){return this.$27l},$.setSnapSpacing=function(N){var i=this.$27l;this.$27l=N,this.fp("snapSpacing",i,N)},$.getPointSnapSpacing=function(){return this._pointSnapSpacing},$.setPointSnapSpacing=function(v){var U=this._pointSnapSpacing;this._pointSnapSpacing=v,this.fp("pointSnapSpacing",U,v)},$.setHelperEditableFunc=function(B){var s=this._helperEditableFunc;this._helperEditableFunc=B,this.fp("helperEditableFunc",s,B)},$.getHelperEditableFunc=function(){return this._helperEditableFunc},$.setLeftTopHelpers=function(y){var d=this._leftTopHelpers;this._leftTopHelpers=y,this.fp("leftTopHelpers",d,y)},$.getLeftTopHelpers=function(){return this._leftTopHelpers},$.setLeftTopHelpersAlign=function(s){var D=this._leftTopHelpersAlign;this._leftTopHelpersAlign=s,this.fp("leftTopHelpersAlign",D,s)},$.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},$.setRightTopHelpers=function(v){var K=this._rightTopHelpers;this._rightTopHelpers=v,this.fp("rightTopHelpers",K,v)},$.getRightTopHelpers=function(){return this._rightTopHelpers},$.setRightTopHelpersAlign=function(e){var r=this._rightTopHelpersAlign;this._rightTopHelpersAlign=e,this.fp("rightTopHelpersAlign",r,e)},$.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},$.setLeftBottomHelpers=function(M){var w=this._leftBottomHelpers;this._leftBottomHelpers=M,this.fp("leftBottomHelpers",w,M)},$.getLeftBottomHelpers=function(){return this._leftBottomHelpers},$.setLeftBottomHelpersAlign=function(u){var H=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=u,this.fp("leftBottomHelpersAlign",H,u)},$.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},$.setRightBottomHelpers=function(u){var r=this._rightBottomHelpers;this._rightBottomHelpers=u,this.fp("rightBottomHelpers",r,u)},$.getRightBottomHelpers=function(){return this._rightBottomHelpers},$.setRightBottomHelpersAlign=function(I){var b=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=I,this.fp("rightBottomHelpersAlign",b,I)},$.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},$.setEdgeHelpers=function(Z){var W=this._edgeHelpers;this._edgeHelpers=Z,this.fp("edgeHelpers",W,Z)},$.getEdgeHelpers=function(){return this._edgeHelpers},$.isHelperEditable=function(G,c){return G instanceof u&&("host"===c||"edge"===c||"elevation"===c||"tall"===c)?!1:G instanceof H&&("source"===c||"target"===c)?!1:"pointElevation"===c?this._helperEditableFunc?this._helperEditableFunc(G,c):!1:this._helperEditableFunc?this._helperEditableFunc(G,c):!0},$.getEditHelperSize=function(){return this._editHelperSize||(O?28:16)},$.setEditHelperSize=function(W){var B=this._editHelperSize;this._editHelperSize=W,this.fp("editHelperSize",B,W)},$.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},$.setEditRectBorderColor=function(P){var r=this.$28l;this.$28l=P,this.fp("editRectBorderColor",r,P)},$.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},$.setNodeBorderColor=function(R){var T=this.$29l;this.$29l=R,this.fp("nodeBorderColor",T,R)},$.getEditRectBorderStyle=function(){return this.$30l||"dashed"},$.setEditRectBorderStyle=function(s){var k=this.$30l;this.$30l=s,this.fp("editRectBorderStyle",k,s)},$.getControlPointBackground=function(){return this.$31l||"#ff0"},$.setControlPointBackground=function(D){var s=this.$31l;this.$31l=D,this.fp("controlPointBackground",s,D)},$.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},$.setControlPointBorderColor=function(D){var o=this.$32l;this.$32l=D,this.fp("controlPointBorderColor",o,D)},$.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},$.setJoinPointBackground=function(L){var C=this.$33l;this.$33l=L,this.fp("joinPointBackground",C,L)},$.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},$.setJoinPointBorderColor=function(v){var T=this.$34l;this.$34l=v,this.fp("joinPointBorderColor",T,v)},$.getDirectionLineColor=function(){return this.$35l||"#888"},$.setDirectionLineColor=function(n){var I=this.$35l;this.$35l=n,this.fp("directionLineColor",I,n)},$.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},$.setSegmentHoverColor=function(G){var P=this.$36l;this.$36l=G,this.fp("segmentHoverColor",P,G)},$.getSegmentHoverWidth=function(){return this.$22l||(O?16:8)},$.setSegmentHoverWidth=function(D){var a=this.$22l;this.$22l=D,this.fp("segmentHoverWidth",a,D)},$.getSnapPointBorderColor=function(){return this.$38l||"#f00"},$.setSnapPointBorderColor=function(P){var G=this.$38l;this.$38l=P,this.fp("snapPointBorderColor",G,P)},$.getEditRectPadding=function(){return this.$39l!=t?this.$39l:6},$.setEditRectPadding=function(R){var x=this.$39l;this.$39l=R,this.fp("editRectPading",x,R)},$.isRectEditable=function(e){var b=this,X=b._editInteractor;return X instanceof G.XEditInteractor?b._rectEditableFunc?b._rectEditableFunc(e):!0:Vn.call(b,e)},$.isPointEditable=function(T){var y=this,h=y._editInteractor;return h instanceof G.XEditInteractor?y._pointEditableFunc?y._pointEditableFunc(T):!0:ij.call(y,T)},$.validateImpl=function(){var Y=this,P=Y.$14l,W=Y._editInteractor;if(P){var D=Y.getWidth(),p=Y.getHeight();(D!==P.clientWidth||p!==P.clientHeight)&&(W&&(W._68I=1),T.setCanvas(P,D,p),Y._32I=1)}Nf.call(this)},$.isEditable=function(j){var J=xl.call(this,j),k=this._editInteractor;if(k instanceof G.XEditInteractor&&j instanceof u){if(!j.s("2d.editable"))return!1;var Z=this.getEditableFunc();J=Z?Z(j):!0}return J},$._42=function(P,L){var v=this,Y=v._editInteractor;bi.call(v,P,L),Y instanceof G.XEditInteractor&&Y._68I&&Y._42()},$.isSnapPoint=function(){return!0};var rg=function(T){arguments.length>0&&this.$58l(T)},Gm=rg.prototype;Gm.$58l=function(U){this.$62l=U,this.points=new Array},Gm.$56l=function(N){this.points.push(N)},Gm.$57l=function(O){this.points=this.points.concat(O)};var xk=function(z,t){arguments.length>0&&this.$58l(z,t)},Oi=xk.prototype;Oi.$58l=function(m,p){this.x=m,this.y=p},Oi.add=function(y){return new xk(this.x+y.x,this.y+y.y)},Oi.addEquals=function(M){return this.x+=M.x,this.y+=M.y,this},Oi.$55l=function(u){return new xk(this.x*u,this.y*u)},Oi.eq=function(L){return this.x==L.x&&this.y==L.y},Oi.lt=function(Q){return this.x<Q.x&&this.y<Q.y},Oi.lte=function(E){return this.x<=E.x&&this.y<=E.y},Oi.gt=function(G){return this.x>G.x&&this.y>G.y},Oi.gte=function(D){return this.x>=D.x&&this.y>=D.y},Oi.lerp=function(g,d){return new xk(this.x+(g.x-this.x)*d,this.y+(g.y-this.y)*d)},Oi.distanceFrom=function(S){var Q=this.x-S.x,f=this.y-S.y;return a(Q*Q+f*f)},Oi.min=function($){return new xk(V(this.x,$.x),V(this.y,$.y))},Oi.max=function(g){return new xk(n(this.x,g.x),n(this.y,g.y))},Oi.toString=function(){return this.x+","+this.y};var po=function(){this.$58l(arguments)},Al=po.prototype;po.TO=1e-6,po.AC=6,Al.$58l=function(G){this.co=new Array;for(var W=G.length-1;W>=0;W--)this.co.push(G[W])},Al.$55l=function(d){for(var u=new po,X=0;X<=this.$50l()+d.$50l();X++)u.co.push(0);for(var X=0;X<=this.$50l();X++)for(var x=0;x<=d.$50l();x++)u.co[X+x]+=this.co[X]*d.co[x];return u},Al.$59l=function(){for(var O=this.$50l();O>=0&&M(this.co[O])<=po.TO;O--)this.co.pop()},Al.$50l=function(){return this.co.length-1},Al.$51l=function(){var J;switch(this.$59l(),this.$50l()){case 0:J=new Array;break;case 1:J=this.$52l();break;case 2:J=this.$53l();break;case 3:J=this.$54l();break;case 4:J=this.$63l();break;default:J=new Array}return J},Al.$52l=function(){var c=new Array,k=this.co[1];return 0!=k&&c.push(-this.co[0]/k),c},Al.$53l=function(){var d=new Array;if(2==this.$50l()){var N=this.co[2],Y=this.co[1]/N,p=this.co[0]/N,Z=Y*Y-4*p;if(Z>0){var H=a(Z);d.push(.5*(-Y+H)),d.push(.5*(-Y-H))}else 0==Z&&d.push(.5*-Y)}return d},Al.$63l=function(){var l=new Array;if(4==this.$50l()){var G=this.co[4],s=this.co[3]/G,K=this.co[2]/G,X=this.co[1]/G,e=this.co[0]/G,R=new po(1,-K,s*X-4*e,-s*s*e+4*K*e-X*X).$54l(),w=R[0],g=s*s/4-K+w;if(M(g)<=po.TO&&(g=0),g>0){var v=a(g),I=3*s*s/4-v*v-2*K,L=(4*s*K-8*X-s*s*s)/(4*v),A=I+L,C=I-L;if(M(A)<=po.TO&&(A=0),M(C)<=po.TO&&(C=0),A>=0){var b=a(A);l.push(-s/4+(v+b)/2),l.push(-s/4+(v-b)/2)}if(C>=0){var b=a(C);l.push(-s/4+(b-v)/2),l.push(-s/4-(b+v)/2)}}else if(0>g);else{var L=w*w-4*e;if(L>=-po.TO){if(0>L&&(L=0),L=2*a(L),I=3*s*s/4-2*K,I+L>=po.TO){var Q=a(I+L);l.push(-s/4+Q/2),l.push(-s/4-Q/2)}if(I-L>=po.TO){var Q=a(I-L);l.push(-s/4+Q/2),l.push(-s/4-Q/2)}}}}return l},Al.$54l=function(){var S=new Array;if(3==this.$50l()){var p=this.co[3],$=this.co[2]/p,K=this.co[1]/p,L=this.co[0]/p,m=(3*K-$*$)/3,C=(2*$*$*$-9*K*$+27*L)/27,Z=$/3,u=C*C/4+m*m*m/27,D=C/2;if(M(u)<=po.TO&&(u=0),u>0){var U,l,R=a(u);U=-D+R,l=U>=0?z(U,1/3):-z(-U,1/3),U=-D-R,U>=0?l+=z(U,1/3):l-=z(-U,1/3),S.push(l-Z)}else if(0>u){var g=a(-m/3),k=f(a(-u),-D)/3,H=i(k),X=e(k),c=a(3);S.push(2*g*H-Z),S.push(-g*(H+c*X)-Z),S.push(-g*(H-c*X)-Z)}else{var U;U=D>=0?-z(D,1/3):z(-D,1/3),S.push(2*U-Z),S.push(-U-Z)}}return S};var Ni=function(K,v){arguments.length>0&&this.$58l(K,v)},_q=Ni.prototype;_q.$58l=function(Y,P){this.x=Y,this.y=P},_q.length=function(){return a(this.x*this.x+this.y*this.y)},_q.$60l=function(R){return this.x*R.x+this.y*R.y};var Ch=function(l,E,N,S){var O,p=(S.x-N.x)*(l.y-N.y)-(S.y-N.y)*(l.x-N.x),y=(E.x-l.x)*(l.y-N.y)-(E.y-l.y)*(l.x-N.x),I=(S.y-N.y)*(E.x-l.x)-(S.x-N.x)*(E.y-l.y);if(0!=I){var H=p/I,Y=y/I;H>=0&&1>=H&&Y>=0&&1>=Y?(O=new rg(d),O.points.push(new xk(l.x+H*(E.x-l.x),l.y+H*(E.y-l.y)))):O=new rg(Q)}else O=0==p||0==y?new rg("C"):new rg("P");return O},Ur=function(X,u,G,M,C){var H,D,f,v,h,A,p,N=M.min(C),S=M.max(C),m=new rg(Q);H=u.$55l(-2),f=X.add(H.add(G)),H=X.$55l(-2),D=u.$55l(2),v=H.add(D),h=new xk(X.x,X.y),p=new Ni(M.y-C.y,C.x-M.x),A=M.x*C.y-C.x*M.y;for(var Z=new po(p.$60l(f),p.$60l(v),p.$60l(h)+A).$51l(),l=0;l<Z.length;l++){var J=Z[l];if(J>=0&&1>=J){var Y=X.lerp(u,J),g=u.lerp(G,J),I=Y.lerp(g,J);M.x==C.x?N.y<=I.y&&I.y<=S.y&&(m.$62l=d,m.$56l(I)):M.y==C.y?N.x<=I.x&&I.x<=S.x&&(m.$62l=d,m.$56l(I)):I.gte(N)&&I.lte(S)&&(m.$62l=d,m.$56l(I))}}return m},lp=function(f,n,T,$,J){var E=$.min(J),r=$.max(J),B=new xk(r.x,E.y),H=new xk(E.x,r.y),Z=Ur(f,n,T,E,B),s=Ur(f,n,T,B,r),v=Ur(f,n,T,r,H),j=Ur(f,n,T,H,E),g=new rg(Q);return g.$57l(Z.points),g.$57l(s.points),g.$57l(v.points),g.$57l(j.points),g.points.length>0&&(g.$62l=d),g},_n=function(c,e,f,I,H,T){var R,i,M,o,k,a,p,j,X,E,W=H.min(T),w=H.max(T),g=new rg(Q);R=c.$55l(-1),i=e.$55l(3),M=f.$55l(-3),o=R.add(i.add(M.add(I))),k=new Ni(o.x,o.y),R=c.$55l(3),i=e.$55l(-6),M=f.$55l(3),o=R.add(i.add(M)),a=new Ni(o.x,o.y),R=c.$55l(-3),i=e.$55l(3),M=R.add(i),p=new Ni(M.x,M.y),j=new Ni(c.x,c.y),E=new Ni(H.y-T.y,T.x-H.x),X=H.x*T.y-T.x*H.y;for(var G=new po(E.$60l(k),E.$60l(a),E.$60l(p),E.$60l(j)+X).$51l(),K=0;K<G.length;K++){var m=G[K];if(m>=0&&1>=m){var D=c.lerp(e,m),v=e.lerp(f,m),x=f.lerp(I,m),h=D.lerp(v,m),u=v.lerp(x,m),O=h.lerp(u,m);H.x==T.x?W.y<=O.y&&O.y<=w.y&&(g.$62l=d,g.$56l(O)):H.y==T.y?W.x<=O.x&&O.x<=w.x&&(g.$62l=d,g.$56l(O)):O.gte(W)&&O.lte(w)&&(g.$62l=d,g.$56l(O))}}return g},xq=function(z,O,B,k,C,L){var E=C.min(L),K=C.max(L),F=new xk(K.x,E.y),r=new xk(E.x,K.y),$=_n(z,O,B,k,E,F),m=_n(z,O,B,k,F,K),l=_n(z,O,B,k,K,r),R=_n(z,O,B,k,r,E),x=new rg(Q);return x.$57l($.points),x.$57l(m.points),x.$57l(l.points),x.$57l(R.points),x.points.length>0&&(x.$62l=d),x},dd=function(N,D,m,L){var E=m.min(L),Y=m.max(L),u=new xk(Y.x,E.y),q=new xk(E.x,Y.y),G=Ch(E,u,N,D),J=Ch(u,Y,N,D),c=Ch(Y,q,N,D),b=Ch(q,E,N,D),T=new rg(Q);return T.$57l(G.points),T.$57l(J.points),T.$57l(c.points),T.$57l(b.points),T.points.length>0&&(T.$62l=d),T},Xd=G.XEditInteractor=function(S){var w=this,f=w._view=document.createElement("canvas");f.className="editCanvas",f.style.position="absolute",Xd.superClass.constructor.call(w,S)};h.def(Xd,G.Interactor,{ms_edit:1,setUp:function(){var j=this,c=j.gv,o=c.getView(),D=j._view;Xd.superClass.setUp.call(j),c.setEditInteractor(j),c.$14l=D,c._79O?o.insertBefore(D,c._79O):o.appendChild(D);var T=j.$49l=j.$11l.bind(j);c.dm().md(T),c.sm().ms(T),c.mp(T)},tearDown:function(){var I=this,E=I.gv,h=E.getView(),r=I.$49l;Xd.superClass.tearDown.call(I),E.setEditInteractor(t),E.$14l=t,h.removeChild(I._view),E.dm().umd(r),E.sm().ums(r),E.ump(r)},clear:function(){var J=this,$=J.gv;delete J._hoverSegmentIndex,delete J._edge,delete J._shape,delete $._editing,delete J.$10l,delete J.$13l,delete J.$9l,delete J._removePointIndex,delete J._lp,J.$12l="",delete J.$40l,delete J.$67l,delete J.$72l,delete J.$73l,delete J.$75l,delete J.$1l,delete J.$3l,delete J.$2l,delete J.$92l,delete J.$93l,delete J.$94l,J.clearDragging()},handle_keydown:function(E){this.$48l!==E.shiftKey&&(this.$48l=E.shiftKey,this.handle_mousemove(E,j,!0))},handle_keyup:function(J){this.$48l!==J.shiftKey&&(this.$48l=J.shiftKey,this.handle_mousemove(J,j,!0))},handle_touchstart:function(m){this.handle_mousemove(m),this.handle_mousedown(m)},handle_mousedown:function(u){s(u);var n=this,e=n.$13l,I=n.gv,q=I.dm(),G=q.getHistoryManager(),X=I.sm(),A=I.getZoom(),$=I.lp(u),p=h.isDoubleClick(u),T=h.isLeftButton(u),U=n.$7l,t=n._shape,y=n._hoverSegmentIndex,Y=n._edge,R=n.$87l,j=n.$88l,M=function(){n._68I||R===n.$87l&&j===n.$88l||n.$43l()};if(7!==n.$67l&&(delete n.$87l,delete n.$88l),T&&(t||Y)&&y>=0&&p&&(t&&X.contains(t)||Y&&X.contains(Y))){var d=vh.call(n,t||Y,y,$);return n.addShapePoint(t||Y,y,d),k(function(){n.handle_mousemove(u)},40),void 0}if(T&&(t||Y)&&n._removePointIndex>=0&&p)return n.removeShapePoint(),n.$5l=1,k(function(){n.handle_mousemove(u)},40),void 0;if(!T||!I._editing)return M(),void 0;if(t&&e>=0){var c=t.getPoints().get(e),Q=t.p(),P=ig(Q,c.x-Q.x,c.y-Q.y,-U+t.getRotation());D=ig(Q,$.x-Q.x,$.y-Q.y,-U),n.$24l={x:D.x-P.x,y:D.y-P.y},n.startDragging(u),G&&G.beginInteraction(),n.fi({kind:"beginEditPoint",event:u,data:t,index:e}),n.$88l=e,n.$87l=t}else if(n.$10l){var o=I.sm().getSelection(),F=n.$6l,Z=n.$1l={},x=n.$3l={},W=n.$16l[l[n.$10l]],K={x:F.x,y:F.y},O={x:F.x+F.width/2,y:F.y+F.height/2};n.$24l={x:$.x-W.x/A,y:$.y-W.y/A},n.$2l=B(n.$8l),n.$4l=B(F),o.each(function(p){if(p instanceof H){var j=p.p(),A=p.getWidth(),W=p.getHeight(),S=ig(O,j.x-O.x,j.y-O.y,-U);Z[p.getId()]={x:j.x-A/2,y:j.y-W/2,width:A,height:W},x[p.getId()]={x:(S.x-K.x)/F.width,y:(S.y-K.y)/F.height}}}),n.startDragging(u),G&&G.beginInteraction(),n.fi({kind:"beginEditRect",event:u,direction:n.$10l})}else if(Y&&e>=0){var a=ko(I.getDataUI(Y),Y.s("edge.points")),c=a.get(e);n.$24l={x:$.x-c.x,y:$.y-c.y},n.startDragging(u),G&&G.beginInteraction(),n.fi({kind:"beginEditPoint",event:u,data:Y,index:e}),n.$88l=e,n.$87l=Y}else if(n.$40l){var F=n.$6l,O={x:F.x+F.width/2,y:F.y+F.height/2},J=B(n.$23l);J.x/=A,J.y/=A;var V=ig(O,J.x-O.x,J.y-O.y,-U),D=ig(O,$.x-O.x,$.y-O.y,-U);n.$24l={x:D.x-V.x,y:D.y-V.y},n.startDragging(u),G&&G.beginInteraction(),n.fi({kind:"beginEditRotation",event:u,data:n._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(n.$67l)>=0){var E=n.$67l;(7===E||8===E||9===E)&&G&&G.beginInteraction(),n.startDragging(u)}else if(n.$71l&&p&&n.$79l(n.$71l,$)){var i=X.toSelection();G&&G.beginInteraction(),i.each(function(z){q.remove(z)}),G&&G.endInteraction()}M()},$11l:function(){var x=this,S=x.gv;S._editing&&(x.$13l==t||x._shape==t&&x._edge==t)&&(x.$73l==t||1!==x.$67l&&5!==x.$67l&&6!==x.$67l)||(x.$5l=1),x._68I=1},$46l:function(y){var T=this,A=T.gv,k=A.lp(y),N=[];return ul(A,function(S){var o=A.getDataUI(S);if(o){var C=o._79o();c(C,k)&&N.push(S)}}),N},$47l:function(k){var q=this,G=q.$13l,S=q.gv.dm(),a=S.getHistoryManager();q.$10l?(q.fi({kind:"endEditRect",event:k,direction:q.$10l}),a&&a.endInteraction()):q._shape&&G>=0?(q.fi({kind:"endEditPoint",event:k,data:q._shape,index:G}),a&&a.endInteraction()):q._edge&&G>=0?(q.fi({kind:"endEditPoint",event:k,data:q._edge,index:G}),a&&a.endInteraction()):q.$23l&&q.$40l&&(q.fi({kind:"endEditRotation",event:k}),a&&a.endInteraction())},handleWindowTouchEnd:function($){this.handleWindowMouseUp($)},handleWindowMouseUp:function(p){var d=this,J=d.gv,D=J.dm(),B=D.getHistoryManager(),C=d._shape,l=d._edge,n=d.$13l,P=d.$40l,U=d.$9l,E=d.$10l,b=d.$67l;if((C||l)&&n>=0&&U>=0){var R,W;if(C){var G=C.p(),F=C.getRotation();R=C.getPoints(),W=R.get(U),bd(C,G,F,n,W,!1)}else if(R=ko(J.getDataUI(l),l.s("edge.points"),!0),W=R.get(U),0===n){var _=R.get(0);
l.s("edge.source.offset.x",W.x-_.x),l.s("edge.source.offset.y",W.y-_.y)}else if(n===R.size()-1){var X=R.get(R.size()-1);l.s("edge.target.offset.x",W.x-X.x),l.s("edge.target.offset.y",W.y-X.y)}else"points"===l.s("edge.type")&&(R.set(n,W),l.s("edge.points",ui(R)))}d.$47l(p);var i=d.$73l;1===b?(B&&B.beginInteraction(),i?J.sm().each(function(H){if(H.setHost&&J.isHelperEditable(H,"host")){H.setHost(i);var Y=d.$75l,o=d.$74l;Y&&(H.s("attach.row.index",Y.rowIndex),H.s("attach.column.index",Y.columnIndex)),o&&(H.s("attach.index",o.attachIndex),H.s("attach.offset",o.attachOffset),H.s("attach.offset.relative",!1),H.s("attach.offset.opposite",!1))}}):J.sm().each(function(a){a.setHost&&J.isHelperEditable(a,"host")&&(a.setHost(t),a.s("attach.row.index",j),a.s("attach.column.index",j),a.s("attach.index",j),a.s("attach.offset",j),a.s("attach.offset.relative",!1),a.s("attach.offset.opposite",!1))}),B&&B.endInteraction()):2===b?(B&&B.beginInteraction(),i?J.sm().each(function(S){S.setParent&&J.isHelperEditable(S,"parent")&&S.setParent(i)}):J.sm().each(function(T){T.setParent&&J.isHelperEditable(T,"parent")&&T.setParent(t)}),B&&B.endInteraction()):3===b?i&&(B&&B.beginInteraction(),J.sm().each(function(Y){if(J.isHelperEditable(Y,"edge")&&Y instanceof H&&i instanceof H){var F=new L.Edge;D.add(F),F.setSource(Y),F.setTarget(i),d.onEdgeCreated&&d.onEdgeCreated(p,F)}}),B&&B.endInteraction()):5===b||6===b?i&&(B&&B.beginInteraction(),J.sm().each(function(y){y instanceof u&&i instanceof H&&(5===b&&J.isHelperEditable(y,"source")?y.setSource(i):6===b&&J.isHelperEditable(y,"source")&&y.setTarget(i))}),B&&B.endInteraction()):(7===b||8===b||9===b)&&B&&B.endInteraction(),(E||P)&&d.$43l(!0),O?(d.clear(),delete d.$64l,d._68I||d.$43l()):(d.handle_mousemove(p,!0),b&&!d._68I&&d.$43l())},handleWindowTouchMove:function($){this.handleWindowMouseMove($)},handleWindowMouseMove:function(n){this._78I(n)},handle_mousemove:function(l,$,w){if(!this._pause){if(!w){var T=O?Sh(l):l;this.$61l={clientX:T.clientX,clientY:T.clientY}}if($===!0||!v()){var J=this,N=J.gv,z=!1,G=t;J.clear(),N.sm().size()>0&&(G=N.lp(w?J.$61l:l),z=J._79I(l,G)),z&&(N._editing=1),J.$12l!==J.$65l&&(J.$65l=J.$12l,J.setCursor(J.$12l)),J.$40l!==J.$64l&&(J.$64l=J.$40l,J._68I||J.$43l()),J._hoverSegmentIndex!==J.$66l&&(J.$66l=J._hoverSegmentIndex,J._68I||J.$43l())}}},_78I:function(q){this.autoScroll(q);var V=this,P=V.gv,s=P.lp(q),y=P.getZoom(),m=V.$13l;if((V._shape||V._edge)&&m>=0){var J,g,o,S=V._shape,Y=V._edge,j=V.$24l,A=P.getPointSnapSpacing(),C=function(s,N){return A==t||isNaN(A)?{x:s,y:N}:{x:w(s/A)*A,y:w(N/A)*A}};if(S){J=S.getPoints();var B=S.p(),x=S.getRotation(),n=0;g=ig(B,s.x-B.x,s.y-B.y,-x),bd(S,B,x,m,s,!0,j,C),V.fi({kind:"betweenEditPoint",event:q,data:S,index:m})}else if(Y){J=ko(P.getDataUI(Y),Y.s("edge.points"),!0),s.x-=j.x,s.y-=j.y,g=s;var z,l,Q=Y.s("edge.offset"),d=J.size(),W=d>2;if(0===m){var I=J.get(0);Q&&(I=Rp(I,J.get(1),-Q,W),s=Rp(s,J.get(1),-Q,W)),z=s.x-I.x,l=s.y-I.y,o=C(z,l),Y.s("edge.source.offset.x",o.x),Y.s("edge.source.offset.y",o.y)}else if(m===d-1){var T=J.get(d-1);Q&&(T=Rp(T,J.get(d-2),-Q,W),s=Rp(s,J.get(d-2),-Q,W)),z=s.x-T.x,l=s.y-T.y,o=C(z,l),Y.s("edge.target.offset.x",o.x),Y.s("edge.target.offset.y",o.y)}else"points"===Y.s("edge.type")&&(o=C(s.x,s.y),o.e=J.get(m).e,J.set(m,o),Y.s("edge.points",ui(J)));V.fi({kind:"betweenEditPoint",event:q,data:Y,index:m})}if(delete V.$9l,P.isSnapPoint(S)||P.isSnapPoint(Y))for(n=0;n<J.size();n++)if(n!==m){var N=J.get(n);if(r(N,g)<P.getEditPointSize()/y){V.$9l=n;break}}}else if(V.$10l){var j=V.$24l;s.x-=j.x,s.y-=j.y;var X=P.sm().getSelection(),L=V.$1l,Z=V.$7l,G=V.$10l,i=V.$4l,D=V.$2l,$=P.getEditRectPadding()/y,O=2*$,_=P.getSnapSpacing(),b=_!=t&&!isNaN(_),p=dm(D,s,G,Z,2*$,P.getResizeMode(),b,!0),e=V.$6l;if(b){var c=p.width-O,R=p.height-O,v=w(c/_)*_,bn=w(R/_)*_,zj=v-c,Rh=bn-R;("west"===G||"northwest"===G||"southwest"===G)&&(zj=-zj),("north"===G||"northwest"===G||"northeast"===G)&&(Rh=-Rh),p=dm(D,s,G,Z,2*$,P.getResizeMode(),b,!1,zj,Rh)}V.$8l=p,e.x=p.x+$,e.y=p.y+$,e.width=p.width-O,e.height=p.height-O;var Xp=p.x+p.width/2,dp=p.y+p.height/2,cc=e.x,Re=e.y,El=e.width/i.width,$p=e.height/i.height;X.each(function(y){if(y instanceof H&&P.isEditable(y)&&P.isRectEditable(y)){var C=L[y.getId()],x=V.$3l[y.getId()],O={x:C.x+C.width/2,y:C.y+C.height/2},v=0,R=0,n=G,l=180*M(Z-y.getRotation())/F;"northeast"===G?l>=315||45>l?(v=C.width*El+C.x,R=C.height*(1-$p)+C.y,n="northeast"):l>=45&&135>l?(v=C.width*(1-$p)+C.x,R=C.height*(1-El)+C.y,n="northwest"):l>=135&&225>l?(v=C.width*(1-El)+C.x,R=C.height*$p+C.y,n="southwest"):(v=C.width*$p+C.x,R=C.height*El+C.y,n="southeast"):"north"===G?l>=315||45>l?(R=C.height*(1-$p)+C.y,n="north"):l>=45&&135>l?(v=C.width*(1-$p)+C.x,n="west"):l>=135&&225>l?(R=C.height*$p+C.y,n="south"):(v=C.width*$p+C.x,n="east"):"northwest"===G?l>=315||45>l?(v=C.width*(1-El)+C.x,R=C.height*(1-$p)+C.y,n="northwest"):l>=45&&135>l?(v=C.width*(1-$p)+C.x,R=C.height*El+C.y,n="southwest"):l>=135&&225>l?(v=C.width*El+C.x,R=C.height*$p+C.y,n="southeast"):(v=C.width*$p+C.x,R=C.height*(1-El)+C.y,n="northeast"):"west"===G?l>=315||45>l?(v=C.width*(1-El)+C.x,n="west"):l>=45&&135>l?(R=C.height*El+C.y,n="south"):l>=135&&225>l?(v=C.width*El+C.x,n="east"):(R=C.height*(1-El)+C.y,n="north"):"southwest"===G?l>=315||45>l?(v=C.width*(1-El)+C.x,R=C.height*$p+C.y,n="southwest"):l>=45&&135>l?(v=C.width*$p+C.x,R=C.height*El+C.y,n="southeast"):l>=135&&225>l?(v=C.width*El+C.x,R=C.height*(1-$p)+C.y,n="northeast"):(v=C.width*(1-$p)+C.x,R=C.height*(1-El)+C.y,n="northwest"):"east"===G?l>=315||45>l?(v=C.width*El+C.x,n="east"):l>=45&&135>l?(R=C.height*(1-El)+C.y,n="north"):l>=135&&225>l?(v=C.width*(1-El)+C.x,n="west"):(R=C.height*El+C.y,n="south"):"south"===G?l>=315||45>l?(R=C.height*$p+C.y,n="south"):l>=45&&135>l?(v=C.width*$p+C.x,n="east"):l>=135&&225>l?(R=C.height*(1-$p)+C.y,n="north"):(v=C.width*(1-$p)+C.x,n="west"):"southeast"===G&&(l>=315||45>l?(v=C.width*El+C.x,R=C.height*$p+C.y,n="southeast"):l>=45&&135>l?(v=C.width*$p+C.x,R=C.height*(1-El)+C.y,n="northeast"):l>=135&&225>l?(v=C.width*(1-El)+C.x,R=C.height*(1-$p)+C.y,n="northwest"):(v=C.width*(1-$p)+C.x,R=C.height*El+C.y,n="southwest"));var W=ig(O,v-O.x,R-O.y,y.getRotation());ml(y,C,n,{x:W.x,y:W.y});var h=cc+e.width*x.x,U=Re+e.height*x.y,i={x:h,y:U};i=ig({x:Xp,y:dp},i.x-Xp,i.y-dp,Z),y.p(i.x,i.y)}}),V.fi({kind:"betweenEditRect",event:q,direction:G})}else if(V.$23l&&V.$40l){var ql=V.$8l,we=ql.width,qc=ql.height,B={x:ql.x+we/2,y:ql.y+qc/2},j=V.$24l,oi=V.$23l,eb=oi.x/y-B.x,Jm=oi.y/y-B.y,ld=a(eb*eb+Jm*Jm),_l=Math.asin(j.x/ld),Gm=P.sm().getSelection(),mh=K+f(s.y-B.y,s.x-B.x)-_l,kq=P.getSnapAngle(),mh=w(mh/kq)*kq;0>mh&&(mh+=U);var Do=mh-V.$7l,ck=[B.x,0,B.y];Gm.each(function(p){if(P.isEditable(p)&&P.isRotationEditable(p)&&P.isVisible(p)){var W=io(p.p3(),ck),T=hr();Cq(T,-Do),p.setRotation(p.getRotation()+Do),Tp(W,T),p.p3(ck[0]+W[0],ck[1]+W[1],ck[2]+W[2])}}),V.$7l=mh,V.fi({kind:"betweenEditRotation",event:q})}else if([1,2,3,5,6].indexOf(V.$67l)>=0)V.$72l=q,V.$78l||(V.$78l=1,k(function(){h.isDragging()&&V.$43l(),delete V.$78l},12));else if(7===V.$67l){if(V.$87l instanceof E){var S=V.$87l,Oi=V.$88l,Xm=h.clone(S.getPoints().get(Oi)),nc=s.y-Xm.y;Xm.e||(Xm.e=0),V.$92l||(V.$92l=Xm.e),Xm.e=V.$92l-nc,S.setPoint(Oi,Xm)}else if(V.$87l instanceof u){var Y=V.$87l,Oi=V.$88l,J=ko(P.getDataUI(Y),Y.s("edge.points")),Xm=J.get(Oi),nc=s.y-Xm.y;Xm.e||(Xm.e=0),V.$92l||(V.$92l=Xm.e),Xm.e=V.$92l-nc,J.set(Oi,Xm),Y.s("edge.points",ui(J))}}else if(8===V.$67l){var Gm=P.sm().getSelection(),gg=V.$93l;gg||(gg=V.$93l={}),Gm.each(function(o){if(o.p3){var B=o.p3(),h=gg[o.getId()];h==t&&(h=gg[o.getId()]=B[1]),o.p3([B[0],h-(s.y-V.$90l.y/y),B[2]])}})}else if(9===V.$67l){var Gm=P.sm().getSelection(),Cn=V.$94l;Cn||(Cn=V.$94l={}),Gm.each(function(A){if(A.s3){var E=A.s3(),j=Cn[A.getId()];j==t&&(j=Cn[A.getId()]=E[1]);var m=j-(s.y-V.$91l.y/y);0>m&&(m=.01),A.s3([E[0],m,E[2]])}})}},$79l:function(u,p){var H=this,B=H.gv,_=B.getZoom(),a=B.getEditHelperSize(),$=u.x/_,m=u.y/_,W=a/_,f=W/2;return c({x:$-f,y:m-f,width:W,height:W},p)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(_,p){for(var J=this,Y=J.gv,d=Y.getZoom(),x=Y.getEditPointSize(),Z=x/d,i=Z/2,W=J.$46l(_),O=0;O<W.length;O++){var L,R,v=W[O],r=Y.getDataUI(v);if(r&&r._55O){var z=r._55O;if(z._43O&&v instanceof u){if(L=v.s("edge.points"),L=ko(r,L),R=v.s("edge.segments"),R&&R.size()||(R=Gg(L)),J.$42l(v,p,L._as,R,"edge"))return!0;if("points"===v.s("edge.type"))return J.$41l(v,p,L._as,R,"edge"),void 0}if(z._43O&&v instanceof E&&z.$15l&&z.$15l.length===v.getPoints().size()){if(L=z.$15l,R=v.getSegments(),R&&R.size()||(R=Gg(L)),J.$42l(v,p,L,R,"shape"))return!0;if(J.$41l(v,p,L,R,"shape"))return}}}if(J.$16l){var L,o=J.$16l,M=o[3].x-o[7].x,N=o[3].y-o[7].y,y=a(M*M+N*N),q=o[1].x-o[5].x,e=o[1].y-o[5].y,j=a(q*q+e*e),S={x:p.x*d,y:p.y*d};if(J._80I(S,0,o[0],"northwest",y,j)||J._80I(S,1,o[1],"north",y,j)||J._80I(S,2,o[2],"northeast",y,j)||J._80I(S,7,o[7],"west",y,j)||J._80I(S,3,o[3],"east",y,j)||J._80I(S,6,o[6],"southwest",y,j)||J._80I(S,5,o[5],"south",y,j)||J._80I(S,4,o[4],"southeast",y,j))return!0}if(J.$23l){var X=J.$23l,m=X.x/d,k=X.y/d;if(c({x:m-i,y:k-i,width:Z,height:Z},p))return J.$40l=1,J.$12l=J.getHelperCursor("rotation")||"crosshair",!0}return J.$68l&&J.$79l(J.$68l,p)?(J.$67l=1,J.$12l=J.getHelperCursor("host")||"crosshair",!0):J.$69l&&J.$79l(J.$69l,p)?(J.$67l=2,J.$12l=J.getHelperCursor("parent")||"crosshair",!0):J.$70l&&J.$79l(J.$70l,p)?(J.$67l=3,J.$12l=J.getHelperCursor("edge")||"crosshair",!0):J.$71l&&J.$79l(J.$71l,p)?(J.$67l=4,J.$12l=J.getHelperCursor("remove")||"crosshair",!0):J.$82l&&J.$79l(J.$82l,p)?(J.$67l=5,J.$12l=J.getHelperCursor("source")||"crosshair",!0):J.$83l&&J.$79l(J.$83l,p)?(J.$67l=6,J.$12l=J.getHelperCursor("target")||"crosshair",!0):J._pointElevationHelperPoint&&J.$79l(J._pointElevationHelperPoint,p)?(J.$67l=7,J.$12l=J.getHelperCursor("pointElevation")||"crosshair",!0):J.$90l&&J.$79l(J.$90l,p)?(J.$67l=8,J.$12l=J.getHelperCursor("elevation")||"crosshair",!0):J.$91l&&J.$79l(J.$91l,p)?(J.$67l=9,J.$12l=J.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(I,T,X,j,d,C){var e=this,f=e.gv,b=f.getEditPointSize(),G=b/2,w=f.sm(),B=f.isDirectionEditable;if(B&&1===w.size()){var V=w.ld();if(B=B.bind(f),V instanceof H){if(!B(V,j))return!1;if("east"===j){if(B(V,"northeast")&&B(V,"southeast")&&2*b>=C)return!1}else if("west"===j){if(B(V,"northwest")&&B(V,"southwest")&&2*b>=C)return!1}else if("north"===j){if(B(V,"northwest")&&B(V,"northeast")&&2*b>=d)return!1}else if("south"===j&&B(V,"southwest")&&B(V,"southeast")&&2*b>=d)return!1}}else{if(2*b>=d&&("north"===j||"south"===j))return!1;if(2*b>=C&&("east"===j||"west"===j))return!1}if(c({x:X.x-G,y:X.y-G,width:b,height:b},I)){if(e.$10l!==j){var z=180*e.$7l/F,$="";z>=337.5||22.5>z?$="north":z>=22.5&&67.5>z?$="northeast":z>=67.5&&112.5>z?$="east":z>=112.5&&157.5>z?$="southeast":z>=157.5&&202.5>z?$="south":z>=202.5&&247.5>z?$="southwest":z>=247.5&&292.5>z?$="west":z>=292.5&&337.5>z&&($="northwest");var Y=Vi.indexOf($),$=Vi[T-(1-Y)+8];switch($){case"northwest":e.$12l="nwse-resize";break;case"northeast":e.$12l="nesw-resize";break;case"southwest":e.$12l="nesw-resize";break;case"southeast":e.$12l="nwse-resize";break;case"north":e.$12l="ns-resize";break;case"east":e.$12l="ew-resize";break;case"south":e.$12l="ns-resize";break;case"west":e.$12l="ew-resize"}e.$10l=j}return!0}return!1},$42l:function(z,r,L,Z,t){var w,S=this,W=S.gv,h=W.getEditPointSize(),V=h/W.getZoom(),N=-1,a={x:r.x,y:r.y,width:0,height:0},q=function(A){"shape"===t?S._shape=z:S._edge=z,S._removePointIndex=A},f=function(E){"shape"===t?S._shape=z:S._edge=z,S.$13l=E,S.$12l="crosshair"};for(x(a,V/2),N=L.length-1,w=Z.size()-1;w>=0;w--){var K=Z.get(w);if(1===K||2===K)N-=1;else if(3===K){var R=L[N-1];if(c(a,R))return f(N-1),!0;N-=2}else if(4===K){var l=L[N-1],B=L[N-2];if(c(a,l))return f(N-1),!0;if(c(a,B))return f(N-2),!0;N-=3}}for(N=L.length-1,w=Z.size()-1;w>=0;w--){var K=Z.get(w),y=L[N];if(c(a,y))return q(N),f(N),!0;1===K||2===K?N-=1:3===K?N-=2:4===K&&(N-=3)}return!1},$41l:function(b,e,n,J,Z){var t=this,G=t.gv,z=-1,D=0,i={x:e.x,y:e.y,width:0,height:0},q=function(U,S){t._hoverSegmentIndex=S,t._lp=e,"shape"===Z?t._shape=b:t._edge=b};for(x(i,G.getSegmentHoverWidth()/2/G.getZoom()),b instanceof E&&b.isClosePath()&&J.indexOf(5)<0&&(J=new R(J._as),J.add(5));D<J.size();D++){var T=J.get(D);if(1===T){var V=n[z],u=n[z+1];if(V){var Y=dd(new xk(V.x,V.y),new xk(u.x,u.y),new xk(i.x,i.y),new xk(i.x+i.width,i.y+i.height));if(Y.$62l===d&&Y.points.length>0)return q(Y,D),!0}z+=1}else if(2===T){var V=n[z],u=n[z+1],Y=dd(new xk(V.x,V.y),new xk(u.x,u.y),new xk(i.x,i.y),new xk(i.x+i.width,i.y+i.height));if(Y.$62l===d&&Y.points.length>0)return q(Y,D),!0;z+=1}else if(3===T){var V=n[z],Q=n[z+1],m=n[z+2],Y=lp(new xk(V.x,V.y),new xk(Q.x,Q.y),new xk(m.x,m.y),new xk(i.x,i.y),new xk(i.x+i.width,i.y+i.height));if(Y.$62l===d)return q(Y,D),!0;z+=2}else if(4===T){var V=n[z],K=n[z+1],w=n[z+2],m=n[z+3],Y=xq(new xk(V.x,V.y),new xk(K.x,K.y),new xk(w.x,w.y),new xk(m.x,m.y),new xk(i.x,i.y),new xk(i.x+i.width,i.y+i.height));if(Y.$62l===d)return q(Y,D),!0;z+=3}else if(5===T){var V=n[z],u=n[0];if(V){var Y=dd(new xk(V.x,V.y),new xk(u.x,u.y),new xk(i.x,i.y),new xk(i.x+i.width,i.y+i.height));if(Y.$62l===d&&Y.points.length>0)return q(Y,D),!0}}}return!1},addShapePoint:function(j,A,d){var w=this,x=w.gv,n=x.dm(),Q=n.getHistoryManager();if(Q&&Q.beginInteraction(),0===arguments.length&&(j=w._shape||w._edge,A=w._hoverSegmentIndex,d=w._lp),j instanceof E||j instanceof u){var y=Ig(j,x.getDataUI(j),A);if(!isNaN(A)&&d&&!isNaN(y)){var $=d;if(j instanceof E){var Y=j.p(),l=j.getRotation(),Z=j.toSegments();Z&&Z.size()||(Z=Gg(j.getPoints())),j.isClosePath()&&Z.indexOf(5)<0&&(Z=new R(Z._as),Z.add(5));var S=Z.get(A),C="addPoint",g="removePointAt";if(2===S||1===S){var P={x:$.x,y:$.y};Z.add(S,A),P=ig(Y,P.x-Y.x,P.y-Y.y,-l),j[C](P,y+1)}else if(3===S){var t=j.getPoints(),U=t.get(y),M=t.get(y+2),P={x:$.x,y:$.y};P=ig(Y,P.x-Y.x,P.y-Y.y,-l);var c=ad(U,P),r=ad(P,M);Z.removeAt(A),Z.add(3,A),Z.add(3,A),j.setPoint(y+1,P),j[C](r,y+2),j[C](c,y+1)}else if(4===S){var t=j.getPoints(),U=t.get(y),M=t.get(y+3),P={x:$.x,y:$.y};P=ig(Y,P.x-Y.x,P.y-Y.y,-l);var c=Ik(U,P),r=_f(U,P),T=Ik(P,M),_=_f(P,M);Z.removeAt(A),Z.add(4,A),Z.add(4,A),j[g](y+1),j[g](y+1),j[C](P,y+1),j[C](_,y+2),j[C](T,y+2),j[C](r,y+1),j[C](c,y+1)}else if(5===S){var P={x:$.x,y:$.y};Z.add(2,A),P=ig(Y,P.x-Y.x,P.y-Y.y,-l),j[C](P,y+1)}j.isClosePath()&&Z.remove(5),j.setSegments(Z);var X=j.getWidth(),W=j.getHeight(),h=j.p().x-X/2,e=j.p().y-W/2;h-=Y.x,e-=Y.y;var F=qq(j,{x:h,y:e,width:X,height:W},l,Y);j.p(F.x,F.y)}else if(j instanceof u){if("points"!==j.s("edge.type"))return Q&&Q.endInteraction(),void 0;var t=j.s("edge.points");Z=j.s("edge.segments"),t=ko(x.getDataUI(j),t),Z&&Z.size()||(Z=Gg(t)),Z=new R(Z._as.slice(0)),t=new R(t._as.slice(0));var S=Z.get(A);if(2===S||1===S){var P={x:$.x,y:$.y};Z.add(S,A),t.add(P,y+1)}else if(3===S){var U=t.get(y),M=t.get(y+2),P={x:$.x,y:$.y},c=ad(U,P),r=ad(P,M);Z.removeAt(A),Z.add(3,A),Z.add(3,A),t.set(y+1,P),t.add(r,y+2),t.add(c,y+1)}else if(4===S){var U=t.get(y),M=t.get(y+3),P={x:$.x,y:$.y},c=Ik(U,P),r=_f(U,P),T=Ik(P,M),_=_f(P,M);Z.removeAt(A),Z.add(4,A),Z.add(4,A),t.removeAt(y+1),t.removeAt(y+1),t.add(P,y+1),t.add(_,y+2),t.add(T,y+2),t.add(r,y+1),t.add(c,y+1)}j.s("edge.points",ui(t)),j.s("edge.segments",Z)}}}Q&&Q.endInteraction()},removeShapePoint:function(k,h){var j=this,g="removeAt",i=j.gv,x=i.dm(),z=x.getHistoryManager();if(z&&z.beginInteraction(),0===arguments.length&&(k=j._shape||j._edge,h=j._removePointIndex),h>=0&&(k instanceof E||k instanceof u)){var L=Cm(k,j.gv.getDataUI(k),h),o=h;if(k instanceof E){var a=k.p(),p=k.toSegments();p&&p.size()||(p=Gg(k.getPoints()));var T=p.get(L),H="removePointAt";if(1===T&&0===o)if(k.getPoints().size()>1){var A=p.get(L+1);p[g](L+1),3===A?k[H](o+1):4===A&&(k[H](o+2),k[H](o+1)),k[H](o)}else k.dm().remove(k);else 2===T||1===T?(p[g](L),k[H](o)):3===T?(p[g](L),k[H](o),k[H](o-1)):4===T&&(p[g](L),k[H](o),k[H](o-1),k[H](o-2));k.setSegments(p);var r=k.getWidth(),V=k.getHeight(),l=k.p().x-r/2,_=k.p().y-V/2;l-=a.x,_-=a.y;var d=qq(k,{x:l,y:_,width:r,height:V},k.getRotation(),a);k.p(d.x,d.y)}else if(k instanceof u){if("points"!==k.s("edge.type"))return z&&z.endInteraction(),void 0;var N=k.s("edge.points");if(p=k.s("edge.segments"),N&&(N=ko(j.gv.getDataUI(k),N),p&&p.size()||(p=Gg(N))),0===h||h===N.size()-1)return z&&z.endInteraction(),void 0;p=new R(p._as.slice(0)),N=new R(N._as.slice(0));var T=p.get(L);2===T||1===T?(p[g](L),N[g](o)):3===T?(p[g](L),N[g](o),N[g](o-1)):4===T&&(p[g](L),N[g](o),N[g](o-1),N[g](o-2)),k.s("edge.segments",p),k.s("edge.points",ui(N))}}z&&z.endInteraction()},changeShapeSegment:function(k,y,c){var w=this,J=w.gv,H=J.dm(),t=H.getHistoryManager();if(t&&t.beginInteraction(),1!==arguments.length||isNaN(k)||(c=k,k=w._shape||w._edge,y=w._hoverSegmentIndex),k instanceof E||k instanceof u){var o=Ig(k,w.gv.getDataUI(k),y);if(!isNaN(y)&&!isNaN(o))if(k instanceof E){var e=k.p(),a=k.toSegments();a&&a.size()||(a=Gg(k.getPoints()));var q=a.get(y),G=k.toPoints();if(1===c||2===c)1===q||2===q?a.set(y,c):3===q?(a.set(y,c),G.removeAt(o+1)):4===q&&(a.set(y,c),G.removeAt(o+1),G.removeAt(o+1));else if(3===c){var s=function(){var O=G.get(o),p=G.get(o+1),C=ad(O,p);a.set(y,3),G.add(C,o+1)};2===q||1===q?s():4===q&&(G.removeAt(o+1),G.removeAt(o+1),s())}else if(4===c){var A=function(){var I=G.get(o),R=G.get(o+1),n=Ik(I,R),S=_f(I,R);a.set(y,4),G.add(n,o+1),G.add(S,o+2)};2===q||1===q?A():3===q&&(G.removeAt(o+1),A())}k.setSegments(a),k.setPoints(G);var l=k.getWidth(),P=k.getHeight(),C=k.p().x-l/2,F=k.p().y-P/2;C-=e.x,F-=e.y;var I=new qq(k,{x:C,y:F,width:l,height:P},k.getRotation(),e);k.p(I.x,I.y)}else if(k instanceof u){if("points"!==k.s("edge.type"))return t&&t.endInteraction(),void 0;var G=k.s("edge.points");a=k.s("edge.segments"),G&&(G=ko(w.gv.getDataUI(k),G),a&&a.size()||(a=Gg(G))),a=new R(a._as.slice(0)),G=new R(G._as.slice(0));var q=a.get(y);if(1===c||2===c)1===q||2===q?a.set(y,c):3===q?(a.set(y,c),G.removeAt(o+1)):4===q&&(a.set(y,c),G.removeAt(o+1),G.removeAt(o+1));else if(3===c){var s=function(){var I=G.get(o),W=G.get(o+1),D=ad(I,W);a.set(y,3),G.add(D,o+1)};2===q||1===q?s():4===q&&(G.removeAt(o+1),G.removeAt(o+1),s())}else if(4===c){var A=function(){var S=G.get(o),P=G.get(o+1),w=Ik(S,P),r=_f(S,P);a.set(y,4),G.add(w,o+1),G.add(r,o+2)};2===q||1===q?A():3===q&&(G.removeAt(o+1),A())}k.s("edge.points",ui(G)),k.s("edge.segments",a)}}t&&t.endInteraction()},getDefaultSegments:function(p){var Z=this.gv,e=Z.getDataUI(p);if(p instanceof u){var $=p.s("edge.points");return $=ko(e,$),Gg($)}if(p instanceof E){var $=p.getPoints(),J=p.getSegments();return J&&J.size()>0?J:Gg($)}},$43l:function(P){var w=this;P&&(w.$5l=1),w._68I=1,w._42()},_42:function(){var e=this;if(e._68I){delete e._68I;var o=e.gv,N=e.$5l,S=o.getZoom(),z=o.getEditPointSize(),G=z/2,n=new R,l=e._view,$=e._edge,w=e._shape,p=l.getContext("2d"),f=o.tx(),V=o.ty(),C=t,M=o.getEditPointBackground(),s=o.getControlPointBackground(),Q=o.getControlPointBorderColor(),_=o.getEditPointBorderColor(),A=o.getEditRectBorderColor(),r=o.getDirectionLineColor(),d=o.getSegmentHoverColor(),i=o.getSnapPointBorderColor(),X=o.getJoinPointBackground(),F=o.getJoinPointBorderColor(),K=o.getSegmentHoverWidth(),k=[5,5],O=o.getEditRectBorderStyle();Lh(o,function(O){o.isSelected(O)&&o.isVisible(O)&&n.add(O)}),p.clearRect(0,0,q(l.width),q(l.height)),p.save(),T.translateAndScale(p,f,V,1);var c=t,g={x:0,y:0,width:0,height:0},j=0,y=0,m=0,Z=0,J=0,v=0,gs=0,uf=0,Uf=0,$k=0,fl=[];if(N?(delete e.$6l,delete e.$8l,delete e.$7l,delete e.$16l,delete e.$23l):(c=e.$6l,C=e.$7l),delete e.$68l,delete e.$69l,delete e.$71l,delete e.$70l,delete e.$82l,delete e.$83l,delete e._pointElevationHelperPoint,delete e.$90l,delete e.$91l,delete e.$75l,delete e.$74l,n.each(function(G){var a=o.getDataUI(G);if(a){var U=a._55O;if(o.isEditable(G))U._56O&&G instanceof H&&y++,fl.push(G),U._42O&&G instanceof H&&j++,o.isHelperEditable(G,"host")&&Z++,o.isHelperEditable(G,"parent")&&m++,o.isHelperEditable(G,"remove")&&J++,o.isHelperEditable(G,"edge")&&v++,o.isHelperEditable(G,"source")&&gs++,o.isHelperEditable(G,"target")&&uf++,o.isHelperEditable(G,"elevation")&&Uf++,o.isHelperEditable(G,"tall")&&$k++;else if(G instanceof D&&G.isExpanded()){var p=!0,t=o.getEditableFunc();t&&(p=t(G)),p&&(o.isHelperEditable(G,"host")&&Z++,o.isHelperEditable(G,"parent")&&m++,o.isHelperEditable(G,"remove")&&J++,o.isHelperEditable(G,"edge")&&v++,o.isHelperEditable(G,"source")&&gs++,o.isHelperEditable(G,"target")&&uf++,o.isHelperEditable(G,"elevation")&&Uf++,o.isHelperEditable(G,"tall")&&$k++,fl.push(G))}}}),p.beginPath(),p.lineWidth=1,p.strokeStyle=o.getNodeBorderColor(),fl.forEach(function(h){var Z=o.getDataUI(h),K=Z._55O;if(N)if(C==t&&(C=h instanceof u?0:h instanceof D&&h.isExpanded()?0:h.getRotation(),e.$7l=C),c==t){var n,B,z;if(h instanceof D&&h.isExpanded()||h instanceof u){var V=o.getDataUIBounds(h);B=V.width,z=V.height,n={x:V.x+B/2,y:V.y+z/2}}else n=h.p(),B=h.getWidth(),z=h.getHeight();c={x:n.x,y:n.y,width:0,height:0},g.x=n.x-B/2,g.y=n.y-z/2,g.width=B,g.height=z,c=I(c,g)}else{var n,B,z,r,l=c.x+c.width/2,w=c.y+c.height/2,R={x:l,y:w};if(h instanceof D&&h.isExpanded()||h instanceof u){r=0;var V=o.getDataUIBounds(h);B=V.width,z=V.height,n={x:V.x+B/2,y:V.y+z/2}}else n=h.p(),B=h.getWidth(),z=h.getHeight(),r=h.getRotation();var k={x:n.x-B/2,y:n.y-z/2,width:B,height:z},_={x:k.x,y:k.y},Y={x:k.x+k.width,y:k.y},d={x:k.x,y:k.y+k.height},s={x:k.x+k.width,y:k.y+k.height},_=ig(n,_.x-n.x,_.y-n.y,r),d=ig(n,d.x-n.x,d.y-n.y,r),s=ig(n,s.x-n.x,s.y-n.y,r),Y=ig(n,Y.x-n.x,Y.y-n.y,r),Q=-C,E=ig(R,_.x-R.x,_.y-R.y,Q),x=ig(R,Y.x-R.x,Y.y-R.y,Q),$=ig(R,d.x-R.x,d.y-R.y,Q),a=ig(R,s.x-R.x,s.y-R.y,Q),F=W([E,x,$,a]);c=I(c,F),c.x-=l,c.y-=w;var y=qq(t,c,C,R);c.x=y.x-c.width/2,c.y=y.y-c.height/2}if(j>1&&o.isEditable(h)&&o.isRectEditable(h)&&h instanceof H){var M=h.getRect(),v=K.$45l,m=ai(v[0],S),U=ai(v[2],S),J=ai(v[4],S),q=ai(v[6],S);h.getRotation()?(p.moveTo(m.x,m.y),p.lineTo(U.x,U.y),p.lineTo(J.x,J.y),p.lineTo(q.x,q.y),p.lineTo(m.x,m.y)):p.rect(M.x*S,M.y*S,M.width*S,M.height*S)}}),p.stroke(),c){e.$6l=B(c),x(c,o.getEditRectPadding()/S);var gb={x:c.x+c.width/2,y:c.y+c.height/2},kh=lk(gb,c.width,c.height,C),Zh=kh[0],al=kh[1],$q=kh[2],af=kh[3],Te=kh[4],Rq=kh[5],Ii=kh[6],Tl=kh[7];if(Zh=ai(kh[0],S),al=ai(kh[1],S),$q=ai(kh[2],S),af=ai(kh[3],S),Te=ai(kh[4],S),Rq=ai(kh[5],S),Ii=ai(kh[6],S),Tl=ai(kh[7],S),e.$8l=c,j>0&&(e.$16l=[Zh,Te,al,Rq,af,Ii,$q,Tl],p.beginPath(),p.lineWidth=1,p.strokeStyle=A,"dashed"===O&&p.setLineDash&&p.setLineDash(k),p.moveTo(Zh.x,Zh.y),p.lineTo(al.x,al.y),p.lineTo(af.x,af.y),p.lineTo($q.x,$q.y),p.lineTo(Zh.x,Zh.y),p.stroke(),"dashed"===O&&p.setLineDash&&p.setLineDash([])),p.beginPath(),p.lineWidth=1,p.fillStyle=M,p.strokeStyle=_,j>0){var Qc=Rq.x-Tl.x,Wo=Rq.y-Tl.y,jj=a(Qc*Qc+Wo*Wo),bh=Te.x-Ii.x,es=Te.y-Ii.y,Af=a(bh*bh+es*es),Dc=2*z;if(o.isDirectionEditable&&1===fl.length){var eb=fl[0],us=o.getDataUI(eb),Rh=us._55O,Cm=o.isDirectionEditable.bind(o);if(Rh._42O){var Ui,fi,Zo,hd;Cm(eb,"northwest")&&(Ui=!0,p.rect(Zh.x-G,Zh.y-G,z,z)),Cm(eb,"northeast")&&(fi=!0,p.rect(al.x-G,al.y-G,z,z)),Cm(eb,"southwest")&&(Zo=!0,p.rect($q.x-G,$q.y-G,z,z)),Cm(eb,"southeast")&&(hd=!0,p.rect(af.x-G,af.y-G,z,z)),Cm(eb,"north")&&(Ui&&fi?jj>Dc&&p.rect(Te.x-G,Te.y-G,z,z):p.rect(Te.x-G,Te.y-G,z,z)),Cm(eb,"south")&&(hd&&Zo?jj>Dc&&p.rect(Ii.x-G,Ii.y-G,z,z):p.rect(Ii.x-G,Ii.y-G,z,z)),Cm(eb,"west")&&(Zo&&Ui?Af>Dc&&p.rect(Tl.x-G,Tl.y-G,z,z):p.rect(Tl.x-G,Tl.y-G,z,z)),Cm(eb,"east")&&(hd&&fi?Af>Dc&&p.rect(Rq.x-G,Rq.y-G,z,z):p.rect(Rq.x-G,Rq.y-G,z,z))}}else jj>Dc&&(p.rect(Te.x-G,Te.y-G,z,z),p.rect(Ii.x-G,Ii.y-G,z,z)),Af>Dc&&(p.rect(Rq.x-G,Rq.y-G,z,z),p.rect(Tl.x-G,Tl.y-G,z,z)),p.rect(Zh.x-G,Zh.y-G,z,z),p.rect(al.x-G,al.y-G,z,z),p.rect($q.x-G,$q.y-G,z,z),p.rect(af.x-G,af.y-G,z,z)}if(y>0){var Lr=e.$23l=ig(Te,0,2*-z,C);p.moveTo(Lr.x+G,Lr.y),p.arc(Lr.x,Lr.y,G,0,U,!1)}p.fill(),p.stroke(),e.$40l&&e.$44l(p,c,C);var Mf,zi,Xp=o.getLeftTopHelpers(),Od=o.getRightTopHelpers(),qm=o.getLeftBottomHelpers(),Qn=o.getRightBottomHelpers(),Fm=o.getEdgeHelpers(),wr=o.getEditHelperSize(),Me=wr/2,Nm=function(O,h,Q,V){"leftTop"===h?(Mf=c.x*S-wr-G-("h"===V?Q*(wr+G):0)-1,zi=c.y*S-wr-G-("v"===V?Q*(wr+G):0)-1):"rightTop"===h?(Mf=(c.x+c.width)*S+G+("h"===V?Q*(wr+G):0)+1,zi=c.y*S-wr-G-("v"===V?Q*(wr+G):0)-1):"leftBottom"===h?(Mf=c.x*S-wr-G-("h"===V?Q*(wr+G):0)-1,zi=(c.y+c.height)*S+G+("v"===V?Q*(wr+G):0)+1):"rightBottom"===h&&(Mf=(c.x+c.width)*S+G+("h"===V?Q*(wr+G):0)+1,zi=(c.y+c.height)*S+G+("v"===V?Q*(wr+G):0)+1);var H=Mf+Me,r=zi+Me,q=(c.x+c.width/2)*S,t=(c.y+c.height/2)*S,D=ig({x:q,y:t},H-q,r-t,C);if("host"===O){if(Z>0)return e.$77l(p,C,D),!0}else if("edge"===O){if(v>0)return e.$80l(p,C,D),!0}else if("remove"===O){if(J>0)return fl&&1===fl.length&&fl[0]instanceof u?e.$81l(p,C,{x:q+wr/2+5,y:t}):e.$81l(p,C,D),!0}else if("parent"===O){if(m>0)return fl&&1===fl.length&&fl[0]instanceof u?e.$76l(p,C,{x:q-wr/2-5,y:t}):e.$76l(p,C,D),!0}else if("elevation"===O){if(Uf>0)return e.$85l(p,C,D),!0}else if("tall"===O){if($k>0)return e.$86l(p,C,D),!0}else if("source"===O||"target"===O){var w=fl[0],s=o.getDataUI(w),g=dg(s,!0),A=g[0],z=g[1];if(gs&&"source"===O)return e.$84l(p,c,A,!0,w.isLooped(),h,Q,V),!0;if(uf&&"target"===O)return e.$84l(p,c,z,!1,w.isLooped(),h,Q,V),!0}};if(Xp&&Xp.length>0){var vm=0;Xp.forEach(function(t){Nm(t,"leftTop",vm,o.getLeftTopHelpersAlign()||"h")&&vm++})}if(Od&&Od.length>0){var vm=0;Od.forEach(function(v){Nm(v,"rightTop",vm,o.getRightTopHelpersAlign()||"h")&&vm++})}if(qm&&qm.length>0){var vm=0;qm.forEach(function(I){Nm(I,"leftBottom",vm,o.getLeftBottomHelpersAlign()||"h")&&vm++})}if(Qn&&Qn.length>0){var vm=0;Qn.forEach(function(N){Nm(N,"rightBottom",vm,o.getRightBottomHelpersAlign()||"h")&&vm++})}if(Fm&&Fm.length>0&&((gs||uf)&&fl&&1===fl.length&&fl[0]instanceof u?!0:!1)){var vm=0;Fm.forEach(function(x){Nm(x,"edge",vm,"h")&&vm++})}if(e.$72l){var If,qc=e.$67l,wn=e.$68l,Cf=e.$69l,ph=(e.$71l,e.$70l),qs=e.$82l,kg=e.$83l;if(1===qc?If=wn:2===qc?If=Cf:3===qc?If=ph:5===qc?If=qs:6===qc&&(If=kg),If){var Nj=o.lp(e.$72l),Md=o.getDataAt(e.$72l);if(Md&&Md instanceof H){var xn,Io,Vi;if(e.$73l=Md,1===qc)if(Md instanceof L.Grid)xn=e.$75l=an(Md,Nj);else if(Md instanceof L.Shape){Vi=e.$74l=dj(Md,Nj);var Df=Md.getPoints();if(Vi){var cq=Vi.attachIndex,Zr=Ig(Md,o.getDataUI(Md),cq)+1,Yp=Zr+1>=Df.size()?0:Zr+1,Xj=Df.get(Zr),Zf=Df.get(Yp),kd=Md.p(),An=Md.getRotation();Xj=ig(kd,Xj.x-kd.x,Xj.y-kd.y,An),Zf=ig(kd,Zf.x-kd.x,Zf.y-kd.y,An),p.beginPath(),p.strokeStyle=d,p.lineWidth=K,p.moveTo(Xj.x*S,Xj.y*S),p.lineTo(Zf.x*S,Zf.y*S),p.stroke()}}xn?Io=xn.rect:(Io=h.clone(o.getDataUIBounds(Md)),h.grow(Io,2)),p.beginPath(),p.rect(Io.x*S,Io.y*S,Io.width*S,Io.height*S),p.strokeStyle=1===qc||4===qc||6===qc?P:b,p.lineWidth=2,p.setLineDash&&p.setLineDash([8,8]),p.stroke()}else delete e.$73l;Nj.x=Nj.x*S,Nj.y=Nj.y*S;var ae=ho(If.x,If.y,Nj.x,Nj.y),Ke=ig(If,Nj.x-If.x,Nj.y-If.y,-ae),Fc=Ke.x-If.x;p.translate(If.x,If.y),p.rotate(ae),Y.width=Fc,Y.height=40;var pj=b;(1===qc||4===qc||6===qc)&&(pj=P),Y.comps[0].gradientColor=pj,h.drawImage(p,Y,0,-20,Fc,40)}}}if(n.each(function(n){var P=o.getDataUI(n);if(P){var g,h,C=P._55O,j=P._78o;if(C&&C._43O&&n instanceof E?(g=C.$15l,h=n.getSegments(),h&&h.size()||(h=Gg(g)),n.isClosePath()&&h.indexOf(5)<0&&(h=new R(h._as),h.add(5))):C&&j&&C._43O&&(g=n.s("edge.points"),h=n.s("edge.segments"),g=ko(P,g),h&&h.size()||(h=Gg(g)),g&&(g=g._as)),g&&h){var B=0,L=h.size(),T=e._hoverSegmentIndex;g=g.slice(0);for(var Z=0;Z<g.length;Z++)g[Z]=ai(g[Z],S);p.beginPath(),p.strokeStyle=r,p.lineWidth=1,B=0;for(var Z=0;L>Z;Z++){var W=h.get(Z);if(1===W||2===W)B++;else if(3===W){var c=g[B-1],O=g[B],Y=g[B+1];p.moveTo(c.x,c.y),p.lineTo(O.x,O.y),p.lineTo(Y.x,Y.y),B+=2}else if(4===W){var c=g[B-1],a=g[B],m=g[B+1],Y=g[B+2];p.moveTo(c.x,c.y),p.lineTo(a.x,a.y),p.moveTo(m.x,m.y),p.lineTo(Y.x,Y.y),B+=3}}if(p.stroke(),w===n||$===n&&"points"===$.s("edge.type")){p.beginPath(),B=0,p.strokeStyle=d,p.lineWidth=K;for(var Z=0;L>Z;Z++){var W=h.get(Z);if(1===W||2===W){if(T===Z){var c=g[B-1],Y=g[B];p.moveTo(c.x,c.y),p.lineTo(Y.x,Y.y);break}B++}else if(3===W){if(T===Z){var c=g[B-1],O=g[B],Y=g[B+1];p.moveTo(c.x,c.y),p.quadraticCurveTo(O.x,O.y,Y.x,Y.y);break}B+=2}else if(4===W){if(T===Z){var c=g[B-1],a=g[B],m=g[B+1],Y=g[B+2];p.moveTo(c.x,c.y),p.bezierCurveTo(a.x,a.y,m.x,m.y,Y.x,Y.y);break}B+=3}else if(5===W&&T===Z){var c=g[B-1],Y=g[0];p.moveTo(c.x,c.y),p.lineTo(Y.x,Y.y);break}}p.stroke()}p.beginPath(),B=0,p.strokeStyle=F,p.lineWidth=1,p.fillStyle=X;for(var Z=0;L>Z;Z++){var W=h.get(Z);if(1===W||2===W){var Y=g[B];p.moveTo(Y.x+G,Y.y),p.arc(Y.x,Y.y,G,0,U,!0),B++}else if(3===W){var Y=g[B+1];p.moveTo(Y.x+G,Y.y),p.arc(Y.x,Y.y,G,0,U,!0),B+=2}else if(4===W){var Y=g[B+2];p.moveTo(Y.x+G,Y.y),p.arc(Y.x,Y.y,G,0,U,!0),B+=3}}p.fill(),p.stroke(),p.beginPath(),B=0,p.strokeStyle=Q,p.lineWidth=1,p.fillStyle=s;for(var Z=0;L>Z;Z++){var W=h.get(Z);if(1===W||2===W)B++;else if(3===W){var O=g[B];p.moveTo(O.x+G,O.y),p.arc(O.x,O.y,G,0,U,!0),B+=2}else if(4===W){var a=g[B],m=g[B+1];p.moveTo(a.x+G,a.y),p.arc(a.x,a.y,G,0,U,!0),p.moveTo(m.x+G,m.y),p.arc(m.x,m.y,G,0,U,!0),B+=3}}if(p.fill(),p.stroke(),p.beginPath(),B=0,p.strokeStyle=i,p.lineWidth=2,(w===n||$===n)&&e.$9l!=t){var Y=g[e.$9l];p.moveTo(Y.x+G,Y.y),p.arc(Y.x,Y.y,G,0,U,!0),p.stroke()}}}}),e.$87l&&o.sm().contains(e.$87l)){var Vq,Hk=e.$87l,Lo=e.$88l,wr=o.getEditHelperSize(),Me=wr/2;if(o.isHelperEditable(Hk,"pointElevation"))if(Hk instanceof E){var Tk=Hk.getPosition();Vq=h.clone(Hk.getPoints().get(Lo)),Vq=ig({x:Tk.x,y:Tk.y},Vq.x-Tk.x,Vq.y-Tk.y,Hk.getRotation()),Vq.x*=S,Vq.y*=S,p.translate(Vq.x,Vq.y),h.drawImage(p,h.getImage("xeditinteractor_elevationIcon"),Me,-Me,wr,wr),p.translate(-Vq.x,-Vq.y),e._pointElevationHelperPoint={x:Vq.x+wr,y:Vq.y}}else if(Hk instanceof u){var pd=ko(o.getDataUI(Hk),Hk.s("edge.points")),Vq=h.clone(pd.get(Lo));Vq.x*=S,Vq.y*=S,p.translate(Vq.x,Vq.y),h.drawImage(p,h.getImage("xeditinteractor_elevationIcon"),Me,-Me,wr,wr),p.translate(-Vq.x,-Vq.y),e._pointElevationHelperPoint={x:Vq.x+wr,y:Vq.y}}}p.restore(),e.$5l=0}},$89l:function(Q,H,_,x){Q.save();var W=this,Z=W.gv,k=Z.getEditHelperSize(),d=k/2;Q.beginPath(),Q.translate(_.x,_.y),Q.rotate(H),h.drawImage(Q,x,-d,-d,k,k),Q.restore()},$85l:function(X,P,g){var o=this;o.$90l=g,o.$89l(X,P,g,h.getImage("xeditinteractor_elevationIcon"))},$86l:function(Y,b,N){var T=this;T.$91l=N,T.$89l(Y,b,N,h.getImage("xeditinteractor_tallIcon"))},$77l:function(m,n,Q){var x=this;x.$68l=Q,x.$89l(m,n,Q,h.getImage("xeditinteractor_hostIcon"))},$80l:function($,v,L){var J=this;J.$70l=L,J.$89l($,v,L,h.getImage("xeditinteractor_edgeIcon"))},$81l:function(o,M,v){var d=this;d.$71l=v,d.$89l(o,M,v,h.getImage("xeditinteractor_removeIcon"))},$76l:function(S,x,N){var D=this;D.$69l=N,D.$89l(S,x,N,h.getImage("xeditinteractor_parentIcon"))},$84l:function(v,E,G,e,z){var V,u=this,i=u.gv,N=i.getZoom(),P=i.getEditHelperSize(),f=P/2;G.x*=N,G.y*=N,z&&(e?G.x-=f+5:G.x+=f+5),G.y-=P-2,e?(u.$82l=G,V=h.getImage("xeditinteractor_sourceIcon")):(u.$83l=G,V=h.getImage("xeditinteractor_targetIcon")),v.beginPath(),v.translate(G.x,G.y),h.drawImage(v,V,-f,-f,P,P),v.translate(-G.x,-G.y)},$44l:function(Q,G,q){Q.save();var j=this.gv.getZoom(),f=a(z(G.width,2)+z(G.height,2))/2*j+10,P=f,T=P+8,x=P+18,t=q,y=G.x+G.width/2,u=G.y+G.height/2;Q.translate(y*j,u*j),Q.beginPath(),Q.strokeStyle="rgb(150, 150, 150)";for(var R=0,S=0,$=0,c=0,d=0,s=0;360>s;s++)R=s*F/180,0===s%5&&(S=i(R)*P,$=e(R)*P,c=i(R)*T,d=e(R)*T,Q.moveTo(S,$),Q.lineTo(c,d)),0===s%45&&(S=i(R)*P,$=e(R)*P,c=i(R)*x,d=e(R)*x,Q.moveTo(S,$),Q.lineTo(c,d));Q.stroke(),Q.beginPath(),Q.rotate(-K),Q.beginPath(),Q.fillStyle="rgba(255, 0, 0, 0.1)",Q.strokeStyle="rgb(157, 157, 157)",Q.moveTo(0,0),Q.arc(0,0,x,0,q,!1),Q.fill(),Q.beginPath(),Q.moveTo(0+x,0),Q.arc(0,0,x,0,q,!1),Q.stroke(),Q.rotate(K),Q.font="bold 12px Verdana, Arial";var H=20*e(t),M=20*i(t),W=w(180*t/F)+"°";Q.textAlign="center",Q.textBaseline="middle",Q.beginPath();var h=Q.measureText("365.°").width;Q.fillStyle="white",Q.rect(H-h/2,-M-10,h,20),Q.fill(),Q.beginPath(),Q.fillStyle="rgb(79,79,79)",Q.fillText(W,H,-M),Q.restore()
}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);