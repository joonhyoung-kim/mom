<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mom.XUPP1030">
	<select id="get_defaultInfo1" parameterType="java.util.HashMap" resultType="com.mom.dto.LowerHashMap" fetchSize="1000">
		SELECT MCD.COMPANY_CD
		     , MCD.COMPANY_NM
		     , MCD.DIVISION_CD
		     , MCD.DIVISION_NM
		     , MD.DEMAND_ID
		     , MD.DEMAND_TYPE
		     , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MD.COMPANY_CD,MD.DIVISION_CD, 'PP0001', MD.DEMAND_TYPE, 'KR') FROM DUAL) AS DEMAND_TYPE_NM     
		     , MD.ITEM_ID
		     , MI.ITEM_NM
		     , MI.ITEM_TYPE
		     , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MD.COMPANY_CD,MD.DIVISION_CD, 'MD0002', MI.ITEM_TYPE, 'KR') FROM DUAL) AS ITEM_TYPE_NM     
		     , MI.ITEM_SPEC
		     , TO_CHAR(MD.DUE_DATE ,'YYYY-MM-DD HH24:MI:SS') AS DUE_DATE
		     , MD.QTY
		     , NVL(MWO.GOOD_QTY, 0)  AS WO_RESULT_QTY
		     , NVL(MWO.CANCEL_QTY,0) AS CANCEL_QTY
		     , MD.QTY - NVL(MWO.GOOD_QTY, 0) - NVL(MWO.CANCEL_QTY,0) AS REMAIN_QTY
		     , MD.WORK_CENTER_CD
		     , (SELECT MOM_COMMON_PKG.FN_GET_WORK_CENTER_NAME(MD.COMPANY_CD, MD.DIVISION_CD, MD.WORK_CENTER_CD) FROM DUAL) AS WORK_CENTER_NM
		     , MWO.WORK_ORDER_ID
		     , MSD.SO_NO
		     , MSD.SO_SEQ
		     , MD.UPDATE_BY
		     ,(SELECT MOM_COMMON_PKG.FN_GET_USER_NAME(MD.COMPANY_CD, MD.DIVISION_CD, MD.UPDATE_BY) FROM DUAL ) AS UPDATEBYNM
		     , TO_CHAR(MD.UPDATE_DATE ,'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
		     , CASE WHEN NVL(MWO.GOOD_QTY, 0) > 0 THEN 'N' 
		       ELSE 'Y'
		       END               AS MODIFY_YN  
		FROM   MOM_COM_DIV_V MCD
		     , MOM_DEMAND MD
		     , MOM_ITEM   MI
		     , MOM_WORK_ORDER MWO
		     , MOM_SO_DTL MSD
		WHERE  MCD.COMPANY_CD    = MD.COMPANY_CD
		AND    MCD.DIVISION_CD   = MCD.DIVISION_CD
		AND    MD.COMPANY_CD     = MI.COMPANY_CD
		AND    MD.DIVISION_CD    = MI.DIVISION_CD
		AND    MD.ITEM_ID        = MI.ITEM_ID
		AND    MD.COMPANY_CD     = MWO.COMPANY_CD(+)
		AND    MD.DIVISION_CD    = MWO.DIVISION_CD(+)
		AND    MD.DEMAND_ID      = MWO.DEMAND_ID(+)
		AND    MD.COMPANY_CD     = MSD.COMPANY_CD(+)
		AND    MD.DIVISION_CD    = MSD.DIVISION_CD(+)
		AND    MD.SALES_ORDER_ID = MSD.SALES_ORDER_ID(+)
		AND    MD.COMPANY_CD     = #{companyCd, jdbcType=VARCHAR}
		AND    MD.DIVISION_CD    = #{divisionCd, jdbcType=VARCHAR}
		ORDER BY MCD.COMPANY_NM
		       , MCD.DIVISION_NM
		       , MD.DUE_DATE
		       , MD.ITEM_ID
		       , MD.DEMAND_ID

	</select>
	<select id="get_defaultInfo2" parameterType="java.util.HashMap" resultType="com.mom.dto.LowerHashMap" fetchSize="1000">
				SELECT MB.ITEM_ID                  -- 품목
		     , MI.ITEM_NM                  -- 품명
		     , MB.WORK_CENTER_CD           -- 작업장
		     , MWC.WORK_CENTER_NM          -- 작업장명
		     , MB.PRIORITY                 -- 우선순위 
		FROM   MOM_BOR MB
		     , MOM_ITEM MI
		     , MOM_WORK_CENTER MWC
		     , MOM_ROUTING MR
		WHERE  MB.COMPANY_CD     = MI.COMPANY_CD
		AND    MB.DIVISION_CD    = MI.DIVISION_CD
		AND    MB.ITEM_ID        = MI.ITEM_ID
		AND    MB.COMPANY_CD     = MWC.COMPANY_CD
		AND    MB.DIVISION_CD    = MWC.DIVISION_CD
		AND    MB.WORK_CENTER_CD = MWC.WORK_CENTER_CD
		AND    MB.COMPANY_CD     = MR.COMPANY_CD
		AND    MB.DIVISION_CD    = MR.DIVISION_CD
		AND    MB.ROUTING_ID     = MR.ROUTING_ID
		AND    MB.USE_YN         = 'Y'
		ORDER BY MB.ITEM_ID, MB.PRIORITY
	</select>

</mapper>