!function (y, F, Z) {
    "use strict"; var K = "ht"; if (!y[K]) {
        !function () { Date.now && Date.prototype.getTime || (Date.now = function () { return (new Date).getTime() }), y.performance && y.performance.now || function () { var Z = Date.now(); y.performance || (y.performance = {}), y.performance.now = function () { return Date.now() - Z } }(); for (var C = Date.now(), R = 16, N = ["ms", "moz", "webkit", "o"], W = 0; W < N.length && !y.requestAnimationFrame; ++W)y.requestAnimationFrame = y[N[W] + "RequestAnimationFrame"], y.cancelAnimationFrame = y[N[W] + "CancelAnimationFrame"] || y[N[W] + "CancelRequestAnimationFrame"]; y.requestAnimationFrame || (y.requestAnimationFrame = function (j) { var D = Date.now(), T = R + C - D; return 0 > T && (T = 0), C = D, y.setTimeout(function () { C = Date.now(), j(performance.now()) }, T) }), y.cancelAnimationFrame || (y.cancelAnimationFrame = function (E) { return y.clearTimeout(E) }) }(); var f, N, _, W, i = y.document, l = null, R = y[K] = {}, x = y[K + "config"], m = R.Default = x && x.Default || {}, M = R.Style = x && x.Style || {}, d = R.Color = x && x.Color || {}, u = R.IsGetter = x && x.IsGetter || {}, Q = Math, L = Q.round, G = Q.floor, T = Q.ceil, o = Q.sqrt, g = Q.max, b = Q.min, A = Q.abs, S = Q.cos, E = Q.acos, t = Q.sin, C = Q.pow, H = Q.asin, s = Q.PI, B = 2 * s, c = s / 2, z = Q.tan, I = Q.atan2, J = Q.random, O = !1, j = !1, n = y.parseInt || global.parseInt, q = "9417-12-01", w = function () { try { return y.navigator.platform.indexOf("Win") > -1 } catch (e) { } }(), X = function (P) { return P * P }, U = y.setTimeout, v = y.clearTimeout, V = y.location, h = y.navigator ? y.navigator.userAgent.toLowerCase() : "", D = function (i) { return i.test(h) }, r = D(/msie/) || D(/trident/), p = D(/msie 10/), e = D(/edge/), $ = D(/firefox/), a = D(/mac/), P = m.isTouchable === Z ? w ? !1 : i ? "ontouchend" in i : !1 : m.isTouchable, Y = "default", tl = "single", rp = "multiple", Mb = "front", ak = "back", Xr = "left", kf = "right", ys = "top", yn = "bottom", vr = "center", rs = "eye", Jr = "middle", Je = "east", tp = "west", il = "north", js = "none", $k = "px", Cn = "absolute", Uo = "border", bd = "triangle", vd = "rect", Oj = "circle", mr = "cylinder", mi = "shape", Kr = "items", jl = "normal", ee = "remove", rr = "clear", fh = "width", Yj = "height", Rk = "ingroup", Sb = "check", Oc = "uncheck", Xe = "radio", gq = "radioOn", yg = "radioOff", fg = "points", Ri = "values", ll = "series", Ob = "body", Sc = "label", zp = "label2", Yf = "note", Wd = "note2", Vl = "icons", Fd = "labelFont", od = "labelColor", Ud = "labelSelectColor", Yi = "note.expanded", Dd = "note2.expanded", jg = "edge.expanded", Go = "edge.points", jj = "edge.type", sf = "rotation", tm = "getRotation", Tk = "setRotation", Yq = "hidden", ls = "visible", If = "tuv", as = "no", Gm = "draw", Tm = "select", Kg = "currentSubGraph", Zq = "selectBackground", om = "autoMakeVisible", He = "autoHideScrollBar", ki = "scrollBarColor", uj = "scrollBarSize", se = "indent", Dn = "rowHeight", dh = "columnLineColor", Wq = "rowLineColor", Wm = "columnLineVisible", dk = "rowLineVisible", qc = "visibleFunc", Gk = "expandIcon", uh = "collapseIcon", fl = "checkMode", Po = "sortFunc", Fp = "editable", Ho = "batchEditable", Rg = "tristate", ej = "asc", Pp = "desc", Ug = "position", vn = "elevation", Dm = "children", xe = "translateX", $g = "translateY", Mj = "dataModel", Wc = "maxSize", Md = "shape3d", $h = "shape3d.resolution", th = "shape3d.visible", Qc = "shape3d.from.visible", zb = "shape3d.to.visible", Hr = "shape3d.top.visible", nn = "shape3d.bottom.visible", uq = "repeat.uv.length", Bo = "serializeValue", zi = "deserializeValue", Jh = "centerUniform", Zg = "rgba(255,255,255,0)", Eg = "style", fj = "attr", Gp = "field", Mm = "string", Lr = "boolean", rh = "color", Bq = "int", bs = "number", wg = "ew-resize", zg = "ns-resize", tf = "pointer", Mo = "auto", Ir = "mousedown", bm = "mousemove", Pb = "mouseup", Ie = "mouseout", he = "touchstart", Sp = "touchmove", Dc = "touchend", Vo = "keydown", um = "keyup", _n = $ ? "DOMMouseScroll" : "mousewheel", _r = P ? [he, Sp, Dc, Vo, um, "keypress", "input", "contextmenu"] : [Vo, um, "keypress", "input", Ir, bm, Pb, Ie, _n, "contextmenu", "mouseenter", "mouseleave", "mouseover"], $p = l, _m = l, Zd = l, Am = Pb.length, Pn = function () { Zd && (v(Zd.timeout), Zd = l) }, dn = function () { Zd && Rp(Zd.e, Zd.info) }; y.addEventListener && (P || (y.addEventListener(Ie, function () { Pn() }, !1), y.addEventListener(_n, function () { ce() }, !1)), y.addEventListener(um, function (R) { 91 === R.keyCode ? Ne = {} : delete Ne[R.keyCode] }, !0), y.addEventListener(Vo, function (r) { Ne[r.keyCode] = !0 }, !0)); var Sn, pm, xm, Zk = !1, Mf = l, Sf = function (w, r) { var W = U(function () { w(), delete Mf[W], Bm(Mf) && (Mf = l) }, r); return W }, Vi = l, xi = l, dc = {}, Uc = {}, Oq = {}, Rm = {}, Hh = {}, Ne = {}, Nh = {}, fk = {}, Rq = {}, yk = /.json$/, Cb = /^data:image\/svg\+xml/, rn = {}, Ih = [], sn = {}, _l = l, po = l, ym = function () { }, Lp = function () { throw "Oops!" }, Yd = [0, 0, 0], Nn = [0, 0, 0, 0], er = { x: 0, y: 0, width: 0, height: 0 }, ne = l, vo = l, Pg = l, Eh = function (Y) { vo && !Y._72O && (Pg || (Pg = {}), Pg[Y._72O = Rh()] = Y), Sn != l ? Ec() < .05 && W && !pm && (Rr = Pn) : Rr = sk }, le = function (G, Q, s, j) { vo || (vo = {}); var n = vo[G]; if (n) { if (n.url === Q) return; n.image ? (n.image.onload = ym, n.image.onerror = ym) : n.request && (n.request.onload = ym, n.request.onerror = ym) } if (yk.test(Q)) { var z = new XMLHttpRequest; if (vo[G] = { request: z, url: Q }, z.overrideMimeType("text/plain"), Q = m.beforeLoadURL(Q), Q.data) { var M = m.parse(Q.data); Qf(G, M), m.handleImageLoaded(G, M) } else z.open("GET", encodeURI(Q), !0), z.onload = function (t) { if (200 === this.status || 0 === this.status) { var x = m.parse(t.target.response); Qf(G, x), m.handleImageLoaded(G, x) } else Qf(G, m.handleUnfoundImage(G, Q) || l) }, z.onerror = function () { Qf(G, m.handleUnfoundImage(G, Q) || l) }, z.send(null) } else { var M = new Image; vo[G] = { image: M, url: Q }, r && (Q.toLowerCase().indexOf(".svg") > 0 || Cb.test(Q)) ? (i.body.appendChild(M), M.style.visibility = "hidden", M.onload = function () { U(function () { if (s && (M.width = s), j && (M.height = j), !M.width || !M.height) { var c = M.width || M.clientWidth, W = M.height || M.clientHeight; M.width = c, M.height = W } m.handleImageLoaded(G, M), Qf(G, M), i.body.removeChild(M), M.style.visibility = "" }, 180) }, M.onerror = function () { Qf(G, m.handleUnfoundImage(G, Q) || l), i.body.removeChild(M), M.style.visibility = "" }) : (M.onload = function () { s && (M.width = s), j && (M.height = j), m.handleImageLoaded(G, M), Qf(G, M) }, M.onerror = function () { Qf(G, m.handleUnfoundImage(G, Q) || l) }), /^data:image/.test(Q) || (Q = m.beforeLoadURL(Q), /^data:image/.test(Q) || (Q = m.appendTimeStamp(Q), Q = encodeURI(Q))), M.src = Q } }, Qf = function (Y, D) { if (Uc[Y] = D, delete vo[Y], Bm(vo) && (vo = l, Pg)) { for (var U in Pg) { var o = Pg[U]; o._2O && (o._2O = {}), o.invalidateAll && o.invalidateAll(Z, "imageLoaded", Y), o.redraw && o.redraw(), o.iv(), delete o._72O } Pg = l } if (D && Pg) for (var U in Pg) { var o = Pg[U]; o.invalidateAll && o.invalidateAll(Z, "imageLoading", Y), o.redraw && o.redraw(), o.iv() } }, Fh = function () { return y.performance && y.performance.now ? y.performance.now() : Date.now() }, Te = function (o, a) { a ? v(o) : y.cancelAnimationFrame(o) }, Xh = function (y, g, M) { return { width: y, height: g, comps: sp(M) ? M : [M] } }, Zm = function (c, L) { return { type: Oj, rect: [c, L, 1.6, 1.6], borderWidth: 1, borderColor: ph, gradient: $m, gradientColor: _k, background: ph } }, wq = function (R, G) { return Xh(16, 16, { type: bd, rect: [4, 4, 10, 8], background: R, rotation: G ? 1.57 : 3.14 }) }, cs = function (F, n) { return Xh(16, 16, { type: bd, rect: [4, 4, 8, 7], background: F, rotation: n ? 3.14 : 0 }) }, zs = function (b) { var W = b._orientation; return "horizontal" === W || "h" === W }, Kj = function (Z) { var E = l || 4, F = l || 1, b = l || 1; 0 > E ? E = 0 : E > .25 && (E = .25); var M, D, c, q, p, y, U, v = .5, e = [], o = [], L = [], x = B / b, K = B / F, j = v - E; for (D = 0; F >= D; D++)for (q = -s + D * K, y = S(q), p = t(q), M = 0; b >= M; M++)c = M * x, U = j + E * y, e.push(S(c) * U, p * E, -t(c) * U), (N = Z) && o.push(M / b, 1 - D / F); for (D = 0; F > D; D++) { var n = D * (b + 1), $ = (D + 1) * (b + 1); for (M = 0; b > M; M++)L.push(n + M, $ + M + 1, $ + M, n + M, n + M + 1, $ + M + 1), un.z = oj.z = Z } }, Lb = function (S) { var D = 2, M = 0; for (var _ in S) _.length === D && n(_, 32) === $i && (_l = po = S[_]), M++; return M }, Dh = function (X, I, Z, b) { return Z || (Z = P ? 5 : 3, Z /= b || 1), { x: X - Z, y: I - Z, width: 2 * Z, height: 2 * Z } }, tr = function (V, O, T, b) { var r = this; O || (O = P ? 5 : 3, T = 20, b = 20); var E = { x: V, y: O, width: T, height: b }; if (T) for (var $ = 0; T > $; $++)if (3 === T) b = 20; else for (var x = 0; b > x; x++)r = y ? y : T; var g = { x: s, y: 2 * s }; if (lg(E, g)) { var L = Yj[0] + ys[0] + rr[1]; zo[rs] = r[L], r[L] = El[rs] } }, gf = function (N) { return (/ble$/.test(N) || /ed$/.test(N) || u[N] ? "is" : "get") + N.charAt(0).toUpperCase() + N.slice(1) }, El = function (I) { return "set" + I.charAt(0).toUpperCase() + I.slice(1) }, Yc = function (r) { return typeof r === Mm || r instanceof String }, Gr = function (E) { return typeof E === bs }, sk = function (z) { return typeof z === Lr }, bk = function (b) { return b && "object" == typeof b }, Nf = function (k) { return "function" == typeof k }, sp = function (F) { return F instanceof Array }, Zh = function (m) { return m instanceof Ul }, vh = function (x) { return sp(x) ? new Ul(x) : x }, $j = function (j) { return j instanceof jf }, zl = function (S) { return S instanceof ab }, mf = function (Z) { return Z instanceof Qp }, Fb = function (a, o) { if (!(a instanceof R.Group)) return !1; if (!o) return a.isExpanded(); var C = o.getDataUI(a); return C && C._88I ? !0 : !1 }, Od = function (Q) { return Q instanceof Wo }, gj = function (b) { return b && "IFRAME" === b.tagName }, yc = function (F) { return F == l || m.numberDigits == l ? F : parseFloat(F.toFixed(m.numberDigits)) }, an = function (E, Y, m) { var n, F = Y.length; if (m) for (var x = 0; m > x; x++)if (3 === F) E.push(Y[0]), E.push(Y[1]), E.push(Y[2]); else for (n = 0; F > n; n++)E.push(Y[n]); else if (3 === F) E.push(Y[0]), E.push(Y[1]), E.push(Y[2]); else for (n = 0; F > n; n++)E.push(Y[n]) }, al = function (r) { return r ? bk(r) ? r : {} : !1 }, _i = function (M, g, S) { var R, u = bk(M) ? M : M.prototype; for (R in g) S && u[R] !== Z || (u[R] = g[R]); return M }, kr = function (A) { return String.fromCharCode(A) }, ss = function ($) { for (var Q, C = 0, y = ""; C < $.length; C++)Q = $[$.length - 1 - C], "%" === Q ? Q = "'" : "a" === Q ? Q = '"' : "]" === Q && (Q = "\\"), y += kr(Q.charCodeAt(0) - 1); return y }, xd = function (g, T, n) { g.superClass.constructor.apply(T, n) }, Bm = function (n) { for (var p in n) return !1; return !0 }, xo = function (t) { return t ? 0 === t.length : !0 }, ns = function (w, x) { return w === x ? !0 : w.x === x.x && w.y === x.y && w.width === x.width && w.height === x.height }, Ze = function (R, f, t) { return f > R ? f : R > t ? t : R }, bl = function (t) { return 0 > t ? -1 : t > 0 ? 1 : 0 }, Ec = function () { var x = 1e4 * t(Am++); return x - G(x) }, Rb = function (q, u, t) { return Kd(q.x, q.y, u.x, u.y, t.x, t.y, t.x + t.width, t.y, !0) || Kd(q.x, q.y, u.x, u.y, t.x + t.width, t.y, t.x + t.width, t.y + t.height, !0) || Kd(q.x, q.y, u.x, u.y, t.x + t.width, t.y + t.height, t.x, t.y + t.height, !0) || Kd(q.x, q.y, u.x, u.y, t.x, t.y + t.height, t.x, t.y, !0) }, Kd = function (A, e, m, D, q, r, P, _, Y) { var O = (P - q) * (e - r) - (_ - r) * (A - q), w = (_ - r) * (m - A) - (P - q) * (D - e); if (0 !== w) { var W = O / w, X = A + W * (m - A), B = e + W * (D - e); return Y && (X + Rc < b(A, m) || X - Rc > g(A, m) || X + Rc < b(q, P) || X - Rc > g(q, P) || B + Rc < b(e, D) || B - Rc > g(e, D) || B + Rc < b(r, _) || B - Rc > g(r, _)) ? l : [X, B] } return l }, Wh = function (n, f, h) { if (n && h) if (f) { if (f === Eg) return n.getStyle(h); if (f === fj) return n.getAttr(h); if (f === Gp) return n[h] } else if (h = gf(h), n[h]) return n[h](); return Z }, Bj = function (V, z, $, d) { if (V && $) if (z) { if (z === Eg) V.s($, d); else if (z === fj) V.a($, d); else if (z === Gp) { var C = V[$]; V[$] = d, V.fp("f:" + $, C, d) } } else $ = El($), V[$] && V[$](d) }, lj = function (w, Z, $) { return Z && "top" !== Z ? "bottom" === Z ? { x: w.x, y: w.y, width: w.width, height: w.height * $ } : "right" === Z ? { x: w.x, y: w.y, width: w.width * $, height: w.height } : "left" === Z ? { x: w.x + w.width * (1 - $), y: w.y, width: w.width * $, height: w.height } : void 0 : { x: w.x, y: w.y + w.height * (1 - $), width: w.width, height: w.height * $ } }, jq = function (y, H, T, r, f) { H && qo(y, T, r, 1, f, H) }, Re = function (j, n, r, T) { var D = 1 - j; return D * D * n + 2 * j * D * r + j * j * T }, un = function (Z, a, o, C, q) { var R = 1 - Z; return R * R * R * a + 3 * R * R * Z * o + 3 * R * Z * Z * C + Z * Z * Z * q }, ad = function (e) { var A, a, n, K, L = 0; return e.forEach(function (j) { if (A = j.length, A > 0) for (a = j[0], K = 1; A > K; K++)n = j[K], L += Bk(a, n), a = n }), L }, pf = function (y, e, G) { var A = "__" + y, f = function (I) { G.interactiveDisabled || G["handle_" + y](I) }; G[A] || (G[A] = f, e.addEventListener(y, f, !1)) }, qf = function (x, B, r) { var D = "__" + x, U = r[D]; U && (B.removeEventListener(x, U, !1), delete r[D]) }, Pd = function (s, Z) { var m = "_" + Z; s[gf(Z)] = function () { return this[m] }, s[El(Z)] = function (C) { var O = this[m]; this[m] = C, this.fp(Z, O, C) } }, ul = function (q) { return F.create(q) }, xq = function (J) { if (!J.element) { var H, U; (H = J.textField) ? U = Jc(Wg.TextField, H) : (H = J.textArea) ? U = Jc(Wg.TextArea, H) : (H = J.button) ? U = Jc(Wg.Button, H) : (H = J.comboBox) ? U = Jc(Wg.ComboBox, H) : (H = J.checkBox) ? U = Jc(Wg.CheckBox, H) : (H = J.radioButton) ? U = Jc(Wg.RadioButton, H) : (H = J.slider) ? U = Jc(Wg.Slider, H) : (H = J.colorPicker) ? U = Jc(Wg.ColorPicker, H) : (H = J.image) && (U = Jc(Wg.Image, H)), U && (J.element = U) } }, ii = function (v, B) { var o = Rl(v); return o._ht = B, o }, Rl = function (Q, G) { var p = i.createElement("div"), $ = p.style; return p.tabIndex = -1, p.onkeydown = np, $.msTouchAction = js, Jq(p, l, 0), P && $.setProperty("-webkit-tap-highlight-color", "rgba(0, 0, 0, 0)", l), Q && ($.overflow = Yq), G && hq(G, p), p }, sc = function ($, C) { var W = i.createElement("canvas"), b = W.style; return b.msTouchAction = js, C || (b.pointerEvents = js), Jq(W, l, 0), $ && hq($, W), W }, Jq = function (y, p, x) { var B = y.style; B.border = p ? p + " solid 1px" : 0, B.outline = 0, B.padding = x ? "0 " + x + $k : 0, Rd(y) }, Rd = function (M) { var B = M.style; B.position = Cn, B.margin = 0, B.setProperty("box-sizing", "border-box", l), B.setProperty("-moz-box-sizing", "border-box", l) }, co = function (F, k, g, m) { m || (m = Sm), k != l && (F.width = k * m, F.style.width = k + $k), g != l && (F.height = g * m, F.style.height = g + $k) }, hq = function (b, t, R) { b.appendChild(t), R && (t.style.position = Cn) }, zd = function (t, u) { u.split || (u += ""); for (var A, m = u.split("\n"), l = 0, y = m.length, j = 0; y > j; j++) { var k = Nm(t.font, m[j]); k.width > l && (l = k.width), A || (A = k.height) } return t.ss = m, { width: l, height: A * y } }, Ai = function (W, i, O, N, w, L) { var d = i.length; if (1 === d) Kc(W, i[0], O, N, w); else for (var $ = O.height / d, b = { x: O.x, y: O.y, width: O.width, height: $ }, l = 0; l < i.length; l++)L ? ho(W, i[l], N, w, b.x, b.y, b.width, b.height, L) : Kc(W, i[l], b, N, w), b.y += $ }, Kc = function (T, G, Q, n, a) { T.font = n ? n : Ek, T.fillStyle = a ? a : xn, T.textAlign = vr, T.textBaseline = Jr; var w, $; Q ? Q.width === Z ? (w = Q.x, $ = Q.y) : (w = Q.x + Q.width / 2, $ = Q.y + Q.height / 2) : (w = 0, $ = 0), T.fillText(G, L(w), L($)) }, bc = function (Q) { Q.getView && (Q = Q.getView()); var U = Q.offsetWidth || Q.scrollWidth; return !U && Q.style.width && (U = n(Q.style.width)), U }, zh = function (P) { P.getView && (P = P.getView()); var D = P.offsetHeight || P.scrollHeight; return !D && P.style.height && (D = n(P.style.height)), D }, jm = function () { var f = function (c) { np(c), c.stopPropagation() }, I = P ? [he] : [Vo, Ir, _n]; return function (B) { var H = Rl(), V = H.style; return V.backgroundColor = m.disabledBackground, B && (V.backgroundImage = "url(" + B + ")", V.backgroundPosition = "50% 50%", V.backgroundRepeat = "no-repeat no-repeat"), I.forEach(function ($) { H.addEventListener($, f) }), H } }(), nr = function (L) { var o = L.getContext("2d"); return o.save(), o.lineCap = ji, o.lineJoin = Xq, o }, Rr = function (L, j, C, l) { bo(L, j * Sm, C * Sm), l *= Sm, 1 !== l && L.scale(l, l) }, bo = function (W, S, _) { W.translate(S, _) }, Nc = function (l, I) { I && l.rotate(I) }, qg = function (I, r, s) { r === Z && (r = 1), s === Z && (s = 1), (1 !== r || 1 !== s) && I.scale(r, s) }, Cq = function (L) { if (i.activeElement !== L) if (P) L.focus(); else { var z = Mk(), f = z.target; L.focus(), f.scrollLeft = z.left, f.scrollTop = z.top } }, wd = function (s) { return s && s.getView ? s.getView() : s }, Up = function (T, S, H, O, l) { if (2 === arguments.length && (H = S.y, O = S.width, l = S.height, S = S.x), T.isSelfViewEvent) T.setX(S), T.setY(H), T.setWidth(O), T.setHeight(l); else { var w = wd(T), v = w.style; if ((i.fullscreenElement || i.mozFullScreenElement || i.webkitFullscreenElement || i.msFullscreenElement) !== w) S !== Z && (v.left = S + $k), H !== Z && (v.top = H + $k), O !== Z && (v.width = O + $k), l !== Z && (v.height = l + $k); else { var r = m.getWindowInfo(); v.left = (S = r.left) + $k, v.top = (H = r.top) + $k, v.width = (O = r.width) + $k, v.height = (l = r.height) + $k } T.endEditing && !P && T.endEditing(), T.redraw && T.redraw(), T.invalidate && T.invalidate(), T.onLayouted && T.onLayouted(S, H, O, l), T.fireViewEvent && T.fireViewEvent("layout") } }, ch = function (O) { var r = O.touches[0]; return r ? r : O.changedTouches[0] }, Ql = function (v) { return P ? ch(v).target : v.target }, qm = function (D) { m.popup && m.popup.close(), m.popup = D }, Ib = l, md = function (S) { Ib.handleWindowTouchMove(S) }, mb = function (s) { Ib.handleWindowTouchEnd(s), y.removeEventListener(Sp, md, !1), y.removeEventListener(Dc, mb, !1), Ib = l }, go = function (G) { Ib.handleWindowMouseMove(G) }, Jl = function (u) { Ib.handleWindowMouseUp(u), y.removeEventListener(bm, go, !1), y.removeEventListener(Pb, Jl, !1), Ib = l }, Fl = function (x) { return 1 === Ak(x) }, Fr = function (N, w) { return w ? w.keyCode === N : Ne[N] }, Tn = function (v) { return ec(v) && Fr(65, v) }, Th = function (N) { return Fr(46, N) || Fr(8, N) }, qr = function (u) { return function (A) { return A ? A.keyCode === u : Ne[u] } }, $i = 573, xh = [65, 83, 68, 87, 37, 38, 39, 40, 32, 13, 27], lh = qr(xh[0]), ar = qr(xh[1]), Wr = qr(xh[2]), _b = qr(xh[3]), Qi = qr(xh[4]), Ef = qr(xh[5]), Kh = qr(xh[6]), hr = qr(xh[7]), Pk = qr(xh[8]), Zr = qr(xh[9]), ai = qr(xh[10]), Xi = { 65: 1, 83: 1, 68: 1, 87: 1, 37: 1, 38: 1, 39: 1, 40: 1 }, xb = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 11, 11], Ro = l, Iq = l, Sq = function (s, G) { Ro || (Ro = sc()), co(Ro, s, G, 1); var b = nr(Ro); return b.clearRect(0, 0, s, G), b }, vg = function () { var M, z = {}; return function (c) { var U, S = z[c]; return S || (M || (M = sc(), co(M, 1, 1, 1)), U = M.getContext("2d"), U.clearRect(0, 0, 1, 1), qo(U, 0, 0, 1, 1, c), S = U.getImageData(0, 0, 1, 1).data, S = z[c] = [S[0], S[1], S[2], S[3]]), S } }(), db = function (l) { if (!Yc(l)) return l; var e = vg(l); return e.CA || (e.CA = [e[0] / 255, e[1] / 255, e[2] / 255, e[3] / 255]), e.CA }, Of = function (e, E, B, c, D) { var S = sc(); S.width = B, S.height = c; var V = S.getContext("2d"); V.drawImage(e, 0, 0, B, c); try { for (var C = V.getImageData(0, 0, B, c), G = C.data, k = 0, L = G.length; L > k; k += 4) { var b = G[k + 0], O = G[k + 1], o = G[k + 2], I = G[k + 3]; "override_a" === D ? G[k + 3] = 255 * E[3] : "override_rgb" === D ? (G[k + 0] = 255 * E[0], G[k + 1] = 255 * E[1], G[k + 2] = 255 * E[2]) : "override" === D ? (G[k + 0] = 255 * E[0], G[k + 1] = 255 * E[1], G[k + 2] = 255 * E[2], G[k + 3] = 255 * E[3]) : (G[k + 0] = E[0] * b, G[k + 1] = E[1] * O, G[k + 2] = E[2] * o, G[k + 3] = E[3] * I) } V.putImageData(C, 0, 0) } catch (g) { return e } return S }, zo = function (g, I, A) { return I && (I = "miter" === A ? 8 * I + 20 : I + 1, g && Bb(g, I)), I }, gp = function (v, h) { if (h) { var n = new Qh(h), T = v.width / 2, q = v.height / 2, t = eb([n.tf(-T, -q), n.tf(T, -q), n.tf(T, q), n.tf(-T, q)]); return t.x += v.x + T, t.y += v.y + q, t } return v }, hj = function (K, g, M, P, G, x, Z, F) { P *= Math.PI / 180; var C = { x: Math.cos(P) * (K.x - Z.x) / 2 + Math.sin(P) * (K.y - Z.y) / 2, y: -Math.sin(P) * (K.x - Z.x) / 2 + Math.cos(P) * (K.y - Z.y) / 2 }, m = Math.pow(C.x, 2) / Math.pow(g, 2) + Math.pow(C.y, 2) / Math.pow(M, 2); m > 1 && (g *= Math.sqrt(m), M *= Math.sqrt(m)); var n = (G == x ? -1 : 1) * Math.sqrt((Math.pow(g, 2) * Math.pow(M, 2) - Math.pow(g, 2) * Math.pow(C.y, 2) - Math.pow(M, 2) * Math.pow(C.x, 2)) / (Math.pow(g, 2) * Math.pow(C.y, 2) + Math.pow(M, 2) * Math.pow(C.x, 2))); isNaN(n) && (n = 0); var $ = { x: n * g * C.y / M, y: n * -M * C.x / g }, r = { x: (K.x + Z.x) / 2 + Math.cos(P) * $.x - Math.sin(P) * $.y, y: (K.y + Z.y) / 2 + Math.sin(P) * $.x + Math.cos(P) * $.y }, _ = function (G) { return Math.sqrt(Math.pow(G[0], 2) + Math.pow(G[1], 2)) }, I = function (c, a) { return (c[0] * a[0] + c[1] * a[1]) / (_(c) * _(a)) }, i = function (b, O) { return (b[0] * O[1] < b[1] * O[0] ? -1 : 1) * Math.acos(I(b, O)) }, R = i([1, 0], [(C.x - $.x) / g, (C.y - $.y) / M]), q = [(C.x - $.x) / g, (C.y - $.y) / M], W = [(-C.x - $.x) / g, (-C.y - $.y) / M], t = i(q, W); I(q, W) <= -1 && (t = Math.PI), I(q, W) >= 1 && (t = 0); var I = g > M ? g : M, y = g > M ? 1 : g / M, b = g > M ? M / g : 1; if (null == F) { var p = { x: 0, y: 0, width: 0, height: 0 }; Bb(p, I), p.x *= y, p.width *= y, p.y *= b, p.height *= b; var E = new Qh(P); return p = eb([E.tf(p.x, p.y), E.tf(p.x + p.width, p.y), E.tf(p.x + p.width, p.y + p.height), E.tf(p.x, p.y + p.height)]), p.x += r.x, p.y += r.y, [{ x: p.x, y: p.y }, { x: p.x + p.width, y: p.y }, { x: p.x + p.width, y: p.y + p.height }, { x: p.x, y: p.y + p.height }] } F.translate(r.x, r.y), F.rotate(P), F.scale(y, b), F.arc(0, 0, I, R, R + t, 1 - x), F.scale(1 / y, 1 / b), F.rotate(-P), F.translate(-r.x, -r.y) }, bp = function (J, N) { J && J.beginPath(); for (var f, A, F, y = [], C = function (r) { for (var o, x = /(\-{0,1}[\d\.]+)/gi, O = []; o = x.exec(r);)O.push(parseFloat(o[0])); return O }, x = /([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi, j = { x: 0, y: 0 }; f = x.exec(N);) { var H = f[0], R = H.substr(0, 1); if ("M" === R || "m" === R) { for (var X = C(H), v = 0; v < X.length; v += 2) { var l = X[v], m = X[v + 1]; "m" === R && (l += j.x, m += j.y), J && J.moveTo(l, m), y.push({ x: l, y: m }), j.x = l, j.y = m } A = F = null } else if ("H" === R || "h" === R) { for (var X = C(H), v = 0; v < X.length; v += 1) { var l = X[v]; "h" === R && (l += j.x), J && J.lineTo(l, j.y), y.push({ x: l, y: j.y }), j.x = l } A = F = null } else if ("C" === R || "c" === R) { for (var X = C(H), v = 0; v < X.length; v += 6) { var q = X[v], L = X[v + 1], T = X[v + 2], z = X[v + 3], l = X[v + 4], m = X[v + 5]; "c" === R && (q += j.x, L += j.y, T += j.x, z += j.y, l += j.x, m += j.y), J && J.bezierCurveTo(q, L, T, z, l, m), y.push({ x: q, y: L }), y.push({ x: T, y: z }), y.push({ x: l, y: m }), j.x = l, j.y = m } A = [q, L, T, z, l, m], F = null } else if ("S" === R || "s" === R) { for (var X = C(H), v = 0; v < X.length; v += 4) { var q, L; A ? (q = 2 * A[4] - A[2], L = 2 * A[5] - A[3]) : (q = j.x, L = j.y); var T = X[v], z = X[v + 1], l = X[v + 2], m = X[v + 3]; "s" === R && (T += j.x, z += j.y, l += j.x, m += j.y), J && J.bezierCurveTo(q, L, T, z, l, m), y.push({ x: q, y: L }), y.push({ x: T, y: z }), y.push({ x: l, y: m }), j.x = l, j.y = m } A = [q, L, T, z, l, m], F = null } else if ("Q" === R || "q" === R) { for (var X = C(H), v = 0; v < X.length; v += 4) { var q = X[v], L = X[v + 1], l = X[v + 2], m = X[v + 3]; "q" === R && (q += j.x, L += j.y, l += j.x, m += j.y), J && J.quadraticCurveTo(q, L, l, m), y.push({ x: q, y: L }), y.push({ x: l, y: m }), j.x = l, j.y = m } A = null, F = [q, L, l, m] } else if ("T" === R || "t" === R) { for (var X = C(H), v = 0; v < X.length; v += 2) { var q, L; F ? (q = 2 * F[2] - F[0], L = 2 * F[3] - F[1]) : (q = j.x, L = j.y); var l = X[v], m = X[v + 1]; "t" === R && (l += j.x, m += j.y), J && J.quadraticCurveTo(q, L, l, m), y.push({ x: q, y: L }), y.push({ x: l, y: m }), j.x = l, j.y = m } A = null, F = [q, L, l, m] } else if ("V" === R || "v" === R) { for (var X = C(H), v = 0; v < X.length; v += 1) { var m = X[v]; "v" === R && (m += j.y), J && J.lineTo(j.x, m), y.push({ x: j.x, y: m }), j.y = m } A = F = null } else if ("L" === R || "l" === R) { for (var X = C(H), v = 0; v < X.length; v += 2) { var l = X[v], m = X[v + 1]; "l" === R && (l += j.x, m += j.y), J && J.lineTo(l, m), y.push({ x: l, y: m }), j.x = l, j.y = m } A = F = null } else if ("A" === R || "a" === R) { for (var X = C(H), v = 0; v < X.length; v += 7) { var c = X[v], t = X[v + 1], k = X[v + 2], P = X[v + 3], r = X[v + 4], l = X[v + 5], m = X[v + 6]; "a" === R && (l += j.x, m += j.y); var U = hj(j, c, t, k, P, r, { x: l, y: m }, J); U && (y = y.concat(U)), j.x = l, j.y = m } A = F = null } var s = H.substr(H.length - 1); ("z" === s || "Z" === s) && J && J.closePath() } return y }, qn = function (F, N) { var K, U, c = "L" === N[0], G = N.length; for (F.save(), c ? (F.transform(N[5], N[6], N[7], N[8], N[9], N[10]), K = F.createLinearGradient(N[1], N[2], N[3], N[4]), U = 11) : (F.transform(N[7], N[8], N[9], N[10], N[11], N[12]), K = F.createRadialGradient(N[1], N[2], N[3], N[4], N[5], N[6]), U = 13); G > U;)K.addColorStop(N[U], N[U + 1]), U += 2; F.fillStyle = K }, oj = function (g, I) { var m, b, H, K, Q, l, V, L, s, G, T, D, O, $ = "L" === g[0]; m = $ ? 5 : 7, b = g[m], H = g[m + 1], K = g[m + 2], Q = g[m + 3], l = g[m + 4], V = g[m + 5], L = I[0], s = I[1], G = I[2], T = I[3], D = I[4], O = I[5], g[m] = L * b + G * H, g[m + 1] = s * b + T * H, g[m + 2] = L * K + G * Q, g[m + 3] = s * K + T * Q, g[m + 4] = L * l + G * V + D, g[m + 5] = s * l + T * V + O }, vq = function (u, I, K, x) { var U = !1; if (u.beginPath ? u.beginPath() : U = !0, Zh(I) && (I = I._as), Zh(K) && (K = K._as), K && K.length) { for (var O, w, e, P, q = 0, T = 0, z = K.length; z > T; T++)O = K[T], 1 === O ? (w = I[q++], u.moveTo(w.x, U ? -w.y : w.y)) : 2 === O ? (w = I[q++], u.lineTo(w.x, U ? -w.y : w.y)) : 3 === O ? (w = I[q++], e = I[q++], u.quadraticCurveTo(w.x, U ? -w.y : w.y, e.x, U ? -e.y : e.y)) : 4 === O ? (w = I[q++], e = I[q++], P = I[q++], u.bezierCurveTo(w.x, U ? -w.y : w.y, e.x, U ? -e.y : e.y, P.x, U ? -P.y : P.y)) : 5 === O && u.closePath(); x && 5 !== O && u.closePath() } else { var f, M, J, R = I.length; if (R > 0) { for (f = I[0], u.moveTo(f.x, U ? -f.y : f.y), M = 1; R > M; M++)J = I[M], u.lineTo(J.x, U ? -J.y : J.y); x && u.closePath() } } }, di = function (D, O, H, X) { if (Zh(D) && (D = D._as), Zh(O) && (O = O._as), O && O.length) { H = H || zk; for (var j, w, B, S, n, Z, f = [], Q = l, U = 0, b = 0, E = O.length; E > b; b++)if (j = O[b], 1 === j) f.push(Q = []), Q.push(D[U++]); else if (2 === j) Q.push(D[U++]); else if (3 === j) for (w = Q[Q.length - 1], B = D[U++], S = D[U++], Z = 1; H >= Z; Z++)Q.push({ x: Re(Z / H, w.x, B.x, S.x), y: Re(Z / H, w.y, B.y, S.y) }); else if (4 === j) for (w = Q[Q.length - 1], B = D[U++], S = D[U++], n = D[U++], Z = 1; H >= Z; Z++)Q.push({ x: un(Z / H, w.x, B.x, S.x, n.x), y: un(Z / H, w.y, B.y, S.y, n.y) }); else 5 === j && Q.push(Q[0]); return X && 5 !== j && Q && Q.length > 2 && Q.push(Q[0]), f } return X && D.length > 2 && (D = D.slice(), D.push(D[0])), D ? [D] : [] }, Zb = function (z, x, K, I, A, O) { var m, G, J, E = vg(x), j = I, _ = E[0], w = E[1], V = E[2]; if (K) { var i = vg(K); m = i[0] - _, G = i[1] - w, J = i[2] - V } else m = 255 - _, G = 255 - w, J = 255 - V; for (O || (O = I > 10 ? 1 : .5, O = 1 > A ? b(O / A, 2) : O); (I -= O) > 0;) { var p = 1 - I / j, l = _ + m * p, k = w + G * p, U = V + J * p; l = b(T(l), 255), k = b(T(k), 255), U = b(T(U), 255), z.strokeStyle = "rgb(" + l + "," + k + "," + U + ")", z.lineWidth = I, z.stroke() } }, ds = function () { var A = {}; return function (l, P) { var U = l + "-" + P, E = A[U]; if (E) return E; var s, Z, m, X = vg(l); return 0 > P ? (P = (100 + P) / 100, s = T(X[0] * P), Z = T(X[1] * P), m = T(X[2] * P)) : (P /= 100, s = X[0], Z = X[1], m = X[2], s += (255 - s) * P, Z += (255 - Z) * P, m += (255 - m) * P, s = b(T(s), 255), Z = b(T(Z), 255), m = b(T(m), 255)), A[U] = "rgb(" + s + "," + Z + "," + m + ")" } }(), qo = function (e, M, O, Q, H, L) { L && (e.fillStyle = L), e.beginPath(), e.rect(M, O, Q, H), e.fill() }, Ep = function (U, V, _, L, N, J, O) { U.beginPath(), Hn[V](U, _.x, _.y, _.width, _.height, L, N, J, O) }, cm = function (Y, p, D, O, C) { var e = Hn[D]; Y.fillStyle = e ? e(Y, p, O ? O : _k, C.x, C.y, C.width, C.height) : p }, Im = function (e, x, E, n, S, t) { try { if (!x.tagName) { x._cacheImage_ || (x._cacheImage_ = {}); var w; w = "override" === n ? "colors_override" : "override_rgb" === n ? "colors_override_rgb" : "override_a" === n ? "colors_override_a" : "colors", x._cacheImage_[w] || (x._cacheImage_[w] = { __count__: 0 }); var J = x._cacheImage_[w][E]; J || (x._cacheImage_[w].__count__ > m.imageCacheThreshold && (x._cacheImage_[w] = { __count__: 0 }), J = R.Default.toCanvas(x, nq(x), Jf(x), null, S, t, E, null, n), x._cacheImage_[w][E] = J, x._cacheImage_[w].__count__++), x = J } e.fillStyle = e.createPattern(x, "repeat") } catch (f) { e.fillStyle = "black" } }, Um = function (z, M, X, C, L, x, g) { z.save(), z.translate(M, X), z.scale(1, g / x), z.arc(0, 0, x, C, L), z.restore() }, Oi = function (f, C, $, y, n, Y, U, d) { var e, J, B, k, z, b, M, H, p, G, I; if (A(n) > 2 * s && (n = 2 * s), z = T(A(n) / (s / 4)), e = n / z, J = -e, B = -y, z > 0) { b = C + S(y) * Y, M = $ + t(-y) * U, d ? f.lineTo(b, M) : f.moveTo(b, M); for (var N = 0; z > N; N++)B += J, k = B - J / 2, H = C + S(B) * Y, p = $ + t(B) * U, G = C + S(k) * (Y / S(J / 2)), I = $ + t(k) * (U / S(J / 2)), f.quadraticCurveTo(G, I, H, p) } }, Bc = function (l, s, o, B, c, I, d, $, u) { 6 === arguments.length && (d = I, $ = I, u = I); var S = s + B, b = o + c, r = c > B ? 2 * B : 2 * c; I = r > I ? I : r, d = r > d ? d : r, $ = r > $ ? $ : r, u = r > u ? u : r; var h = .29 * u, w = .58 * u; l.moveTo(S, b - u), l.quadraticCurveTo(S, b - w, S - h, b - h), l.quadraticCurveTo(S - w, b, S - u, b), h = .29 * $, w = .58 * $, l.lineTo(s + $, b), l.quadraticCurveTo(s + w, b, s + h, b - h), l.quadraticCurveTo(s, b - w, s, b - $), h = .29 * I, w = .58 * I, l.lineTo(s, o + I), l.quadraticCurveTo(s, o + w, s + h, o + h), l.quadraticCurveTo(s + w, o, s + I, o), h = .29 * d, w = .58 * d, l.lineTo(S - d, o), l.quadraticCurveTo(S - w, o, S - h, o + h), l.quadraticCurveTo(S, o + w, S, o + d), l.lineTo(S, b - u) }, Ei = function (_, U, x, T, K, k, D) { U && (x = L(x), T = L(T), D || (D = 1), _.fillStyle = U, _.beginPath(), _.rect(x, T, D, k), _.rect(x, T, K, D), _.rect(x, T + k - D, K, D), _.rect(x + K - D, T, D, k), _.fill()) }, os = function (Q, s, K, J) { var g = J.x, R = J.y, y = J.width, d = J.height; if (!(!s || !K || 0 >= y || 0 >= d)) { var v, I = ke(s), p = kl(s), V = K > 0; 1 === K || -1 === K ? (Q.fillStyle = V ? I : p, Q.beginPath(), Q.rect(g, R, 1, d), Q.rect(g, R, y, 1), Q.fill(), Q.fillStyle = V ? p : I, Q.beginPath(), Q.rect(g, R + d - 1, y, 1), Q.rect(g + y - 1, R, 1, d), Q.fill()) : (K = b(A(K), b(y / 2, d / 2)), v = Q.createLinearGradient(g, R, g + K, R), v.addColorStop(0, V ? I : p), v.addColorStop(1, s), Q.fillStyle = v, Q.beginPath(), Q.moveTo(g, R), Q.lineTo(g + K, R + K), Q.lineTo(g + K, R + d - K), Q.lineTo(g, R + d), Q.lineTo(g, R), Q.fill(), v = Q.createLinearGradient(g, R, g, R + K), v.addColorStop(0, V ? I : p), v.addColorStop(1, s), Q.fillStyle = v, Q.beginPath(), Q.moveTo(g, R), Q.lineTo(g + K, R + K), Q.lineTo(g + y - K, R + K), Q.lineTo(g + y, R), Q.lineTo(g, R), Q.fill(), v = Q.createLinearGradient(g, R + d, g, R + d - K), v.addColorStop(0, V ? p : I), v.addColorStop(1, s), Q.fillStyle = v, Q.beginPath(), Q.moveTo(g, R + d), Q.lineTo(g + K, R + d - K), Q.lineTo(g + y - K, R + d - K), Q.lineTo(g + y, R + d), Q.lineTo(g, R + d), Q.fill(), v = Q.createLinearGradient(g + y, R, g + y - K, R), v.addColorStop(0, V ? p : I), v.addColorStop(1, s), Q.fillStyle = v, Q.beginPath(), Q.moveTo(g + y, R), Q.lineTo(g + y - K, R + K), Q.lineTo(g + y - K, R + d - K), Q.lineTo(g + y, R + d), Q.lineTo(g + y, R), Q.fill()) } }, Fo = function (o, O, A, k, B, G, m) { var _ = o.createLinearGradient(k, B, G, m); return _.addColorStop(0, A), _.addColorStop(1, O), _ }, pr = function (D, J, y, g, _, M, L) { var i = D.createLinearGradient(g, _, M, L); return i.addColorStop(0, J), i.addColorStop(.5, y), i.addColorStop(1, J), i }, qi = function (D, W, f, P, q, J, B) { var n = D.createLinearGradient(P, q, J, B); return n.addColorStop(0, W), n.addColorStop(1 / 3, f), n.addColorStop(2 / 3, W), n.addColorStop(1, f), n }, nd = function (O, $, n, X, J, i, Q, G, D) { var l = O.createRadialGradient(X + i * G, J + Q * D, b(i, Q) / 24, X + i / 2, J + Q / 2, g(i, Q) / 2); return l.addColorStop(0, n), l.addColorStop(1, $), l }, Hn = { polygon: function (D, K, N, j, Y, z) { (z == l || 3 > z) && (z = 6); for (var q, u, E = b(j, Y) / 2, I = K + j / 2, n = N + Y / 2, H = 0, $ = 2 * s / z, M = 0; z > M; M++)q = I + S(H) * E, u = n + t(H) * E, 0 === M ? D.moveTo(q, u) : D.lineTo(q, u), H += $; D.closePath() }, arc: function (z, g, u, W, A, D, N, G, J) { D == l && (D = s), N == l && (N = B), G == l && (G = !0); var $ = g + W / 2, y = u + A / 2; G && z.moveTo($, y), J ? Um(z, $, y, D, N, W / 2, A / 2) : z.arc($, y, b(W, A) / 2, D, N), G && z.closePath() }, rect: function (D, H, i, N, B) { D.rect(H, i, N, B) }, circle: function (C, o, i, e, l) { C.arc(o + e / 2, i + l / 2, b(e, l) / 2, 0, B, !0) }, oval: function (h, C, f, z, P) { Um(h, C + z / 2, f + P / 2, 0, B, z / 2, P / 2) }, roundRect: function (H, G, D, x, A, V) { V == l && (V = b(b(x, A) / 4, 8)), Bc(H, G, D, x, A, V) }, star: function (t, G, d, X, T) { var x = 2 * X, _ = 2 * T, u = G + X / 2, h = d + T / 2; t.moveTo(u - x / 4, h - _ / 12), t.lineTo(G + .306 * X, d + .579 * T), t.lineTo(u - x / 6, h + _ / 4), t.lineTo(G + X / 2, d + .733 * T), t.lineTo(u + x / 6, h + _ / 4), t.lineTo(G + .693 * X, d + .579 * T), t.lineTo(u + x / 4, h - _ / 12), t.lineTo(G + .611 * X, d + .332 * T), t.lineTo(u + 0, h - _ / 4), t.lineTo(G + .388 * X, d + .332 * T), t.closePath() }, triangle: function (s, g, u, O, l) { s.moveTo(g + O / 2, u), s.lineTo(g + O, u + l), s.lineTo(g, u + l), s.closePath() }, hexagon: function (T, b, C, Q, $) { T.moveTo(b, C + $ / 2), T.lineTo(b + Q / 4, C + $), T.lineTo(b + 3 * Q / 4, +C + $), T.lineTo(b + Q, C + $ / 2), T.lineTo(b + 3 * Q / 4, C), T.lineTo(b + Q / 4, C), T.closePath() }, pentagon: function (d, l, t, e, y) { var Z = 2 * e, S = 2 * y, T = l + e / 2, v = t + y / 2; d.moveTo(T - Z / 4, v - S / 12), d.lineTo(T - Z / 6, v + S / 4), d.lineTo(T + Z / 6, v + S / 4), d.lineTo(T + Z / 4, v - S / 12), d.lineTo(T + 0, v - S / 4), d.closePath() }, diamond: function (l, Y, g, A, N) { l.moveTo(Y + A / 2, g), l.lineTo(Y, g + N / 2), l.lineTo(Y + A / 2, g + N), l.lineTo(Y + A, g + N / 2), l.closePath() }, rightTriangle: function (N, k, O, A, P) { N.moveTo(k, O), N.lineTo(k + A, O + P), N.lineTo(k, O + P), N.closePath() }, parallelogram: function (v, k, e, I, y) { var A = I / 4; v.moveTo(k + A, e), v.lineTo(k + I, e), v.lineTo(k + I - A, e + y), v.lineTo(k, e + y), v.closePath() }, trapezoid: function (P, w, A, G, g) { var q = G / 4; P.moveTo(w + q, A), P.lineTo(w + G - q, A), P.lineTo(w + G, A + g), P.lineTo(w, A + g), P.closePath() }, "linear.southwest": function (D, b, r, M, C, t, L) { return Fo(D, b, r, M, C + L, M + t, C) }, "linear.southeast": function (b, y, w, J, z, I, Y) { return Fo(b, y, w, J + I, z + Y, J, z) }, "linear.northwest": function (L, h, G, V, O, M, P) { return Fo(L, h, G, V, O, V + M, O + P) }, "linear.northeast": function (q, u, j, Z, M, P, I) { return Fo(q, u, j, Z + P, M, Z, M + I) }, "linear.north": function (s, $, Y, I, S, V, X) { return Fo(s, $, Y, I, S, I, S + X) }, "linear.south": function (f, O, F, i, K, J, c) { return Fo(f, O, F, i, K + c, i, K) }, "linear.west": function (b, V, f, o, $, x) { return Fo(b, V, f, o, $, o + x, $) }, "linear.east": function (Z, p, N, m, r, W) { return Fo(Z, p, N, m + W, r, m, r) }, "radial.center": function (e, P, j, r, A, E, v) { return nd(e, P, j, r, A, E, v, .5, .5) }, "radial.southwest": function (s, G, y, X, K, f, e) { return nd(s, G, y, X, K, f, e, .25, .75) }, "radial.southeast": function (v, j, L, c, S, Q, y) { return nd(v, j, L, c, S, Q, y, .75, .75) }, "radial.northwest": function (h, n, c, x, s, W, p) { return nd(h, n, c, x, s, W, p, .25, .25) }, "radial.northeast": function (p, x, J, O, V, X, B) { return nd(p, x, J, O, V, X, B, .75, .25) }, "radial.north": function (c, C, J, M, n, o, v) { return nd(c, C, J, M, n, o, v, .5, .25) }, "radial.south": function (l, f, L, o, P, c, X) { return nd(l, f, L, o, P, c, X, .5, .75) }, "radial.west": function (p, i, f, Q, X, J, E) { return nd(p, i, f, Q, X, J, E, .25, .5) }, "radial.east": function (z, g, q, p, Y, H, C) { return nd(z, g, q, p, Y, H, C, .75, .5) }, "spread.horizontal": function (p, d, G, C, e, r) { return pr(p, d, G, C, e, C + r, e) }, "spread.vertical": function (l, Q, j, c, y, P, U) { return pr(l, Q, j, c, y, c, y + U) }, "spread.diagonal": function (r, C, N, M, k, P, d) { return pr(r, C, N, M + P, k, M, k + d) }, "spread.antidiagonal": function (l, A, F, b, H, U, k) { return pr(l, A, F, b, H, b + U, H + k) }, "spread.north": function (r, a, D, o, C, n, y) { return qi(r, a, D, o, C - y / 4, o, C + y + y / 4) }, "spread.south": function (f, z, N, m, V, B, u) { return qi(f, N, z, m, V - u / 4, m, V + u + u / 4) }, "spread.west": function (n, v, i, Z, C, N) { return qi(n, v, i, Z - N / 4, C, Z + N + N / 4, C) }, "spread.east": function (n, B, r, G, m, H) { return qi(n, r, B, G - H / 4, m, G + H + H / 4, m) } }, Qh = function (n, V, C, N, A) { var x = this; n = n || 0; var b = t(n), k = S(n); N = N || 1, A = A || 1, x.a = k * N, x.b = b * N, x.c = -b * A, x.d = k * A, x.tx = V || 0, x.ty = C || 0 }; Qh.prototype.tf = function (O, D) { 1 === arguments.length && (D = O.y, O = O.x); var N = this; return { x: N.a * O + N.c * D + N.tx, y: N.b * O + N.d * D + N.ty } }, Qh.prototype.translate = function (k, F) { var T = this; return T.tx += k, T.ty += F, T }, Qh.prototype.scale = function (D, I) { var q = this; return q.a *= D, q.d *= I, q.c *= D, q.b *= I, q.tx *= D, q.ty *= I, q }, Qh.prototype.rotate = function (b) { var q = S(b), I = t(b), P = this, L = P.a, $ = P.c, Q = P.tx; return P.a = L * q - P.b * I, P.b = L * I + P.b * q, P.c = $ * q - P.d * I, P.d = $ * I + P.d * q, P.tx = Q * q - P.ty * I, P.ty = Q * I + P.ty * q, P }, Qh.prototype.tfi = function (V, T) { 1 === arguments.length && (T = V.y, V = V.x); var f = this, J = 1 / (f.a * f.d + f.c * -f.b); return { x: f.d * J * V + -f.c * J * T + (f.ty * f.c - f.tx * f.d) * J, y: f.a * J * T + -f.b * J * V + (-f.ty * f.a + f.tx * f.b) * J } }; var id = function (D, t, G) { return new Qh(D).tf(t, G) }, Do = function (V) { var T = V.touches[0], j = V.touches[1], G = T.clientX, w = T.clientY, u = j.clientX, Q = j.clientY; return o((G - u) * (G - u) + (w - Q) * (w - Q)) }, Vf = (function () { for (var V = 0, r = Pp.split(""), O = 0; O < r.length; O++)V = 10 * n(r[O]) + V; return Kj(y[$i.toString(8 * O) + Sc.substr(O)]), V }(), function (z, N, U) { for (var D = 0; D < U.size(); D++) { var V = U.get(D); z.co(V) && N.add(V) } for (D = 0; D < U.size(); D++)V = U.get(D), Vf(z, N, V._children) }), Eb = function (u, M, d) { for (var N = 0; N < d.size(); N++) { var k = d.get(d.size() - 1 - N); u.co(k) && M.add(k) } for (N = 0; N < d.size(); N++)k = d.get(N), Eb(u, M, k._children) }, eh = function (k, $, R) { for (var o = !1, B = 0; B < R.size(); B++) { var b = R.get(B); k.co(b) ? o && $.add(b) : o = 1 } for (B = 0; B < R.size(); B++)b = R.get(B), eh(k, $, b._children) }, Zf = function (y, m, N) { for (var b = !1, Q = 0; Q < N.size(); Q++) { var j = N.get(N.size() - 1 - Q); y.co(j) ? b && m.add(j) : b = !0 } for (Q = 0; Q < N.size(); Q++)j = N.get(Q), Zf(y, m, j._children) }, ok = function (t, M, o, i) {
            var j = i == l; if (0 !== M || 0 !== o || !j && 0 !== i) {
                var m, Y, E, u, A, C = new Ul; t.each(function (y) {
                    if ($j(y)) {
                        var D = !0; if (E) for (m = 0; m < E.size(); m++)Y = E.get(m), Y.isHostOn(y) ? (E.removeAt(m), m-- , C.remove(Y)) : D && (y.isHostOn(Y) || y.isLoopedHostOn(Y)) && (D = !1);
                        if (u) for (m = 0; m < u.size(); m++)Y = u.get(m), Uj(Y, y) ? (u.removeAt(m), m-- , C.remove(Y)) : D && Uj(y, Y) && (D = !1); if (A) for (m = 0; m < A.size(); m++)Y = A.get(m), Tj(Y, y) ? (A.removeAt(m), m-- , C.remove(Y)) : D && Tj(y, Y) && (D = !1); D && (C.add(y), (y._host || y._69O) && (E || (E = new Ul), E.add(y)), (mf(y) || mf(y._parent)) && (u || (u = new Ul), u.add(y)), (Od(y) || Od(y._parent)) && (A || (A = new Ul), A.add(y)))
                    } else if (zl(y) && y.s(jj) === fg) { var O = y.s(Go); if (O && !O.isEmpty()) { var p = new Ul; O.each(function (Q) { Q = Ln(Q), j ? (Q.x += M, Q.y += o) : (Q.x += M, Q.y += i, Q.e == l ? Q.e = o : Q.e += o), p.add(Q) }), y.s(Go, p) } }
                }), C.each(function (K) { j ? K.translate(M, o) : K.translate3d(M, o, i) })
            }
        }, qb = function (o, _) { for (; o && !o.hasOwnProperty(_);)o = F.getPrototypeOf(o); return o && F.getOwnPropertyDescriptor(o, _) }, Gn = F.getPrototypeOf ? function (g, j, h) { var K = qb(j, h); K && F.defineProperty(g, h, K) } : function (t, e, S) { t[S] = e[S] }, nj = { 1: 29, 2: 30, 3: 31, 4: 32, 5: 33, 6: 26, 7: 27, 8: 28, 9: 21, 10: 22, 11: 23, 12: 24, 13: 25, 14: 14, 15: 15, 16: 16, 17: 17, 18: 18, 19: 19, 20: 20, 21: 9, 22: 10, 23: 11, 24: 12, 25: 13, 26: 6, 27: 7, 28: 8, 29: 1, 30: 2, 31: 3, 32: 4, 33: 5, 34: 36, 35: 37, 36: 34, 37: 35, 38: 54, 39: 55, 40: 52, 41: 53, 42: 50, 43: 51, 44: 49, 50: 42, 51: 43, 52: 40, 53: 41, 54: 38, 55: 39 }, $e = function () { var T = { 1: function (c, u) { return { x: c.x - u.width / 2, y: c.y - u.height / 2 } }, 2: function (R, W) { return { x: R.x + W.width / 2, y: R.y - W.height / 2 } }, 3: function (L, y) { return { x: L.x + L.width / 2, y: L.y - y.height / 2 } }, 4: function (c, s) { return { x: c.x + c.width - s.width / 2, y: c.y - s.height / 2 } }, 5: function (s, K) { return { x: s.x + s.width + K.width / 2, y: s.y - K.height / 2 } }, 6: function (V) { return { x: V.x, y: V.y } }, 7: function (o) { return { x: o.x + o.width / 2, y: o.y } }, 8: function (_) { return { x: _.x + _.width, y: _.y } }, 9: function (C, g) { return { x: C.x - g.width / 2, y: C.y + g.height / 2 } }, 10: function (Z, C) { return { x: Z.x + C.width / 2, y: Z.y + C.height / 2 } }, 11: function (K, S) { return { x: K.x + K.width / 2, y: K.y + S.height / 2 } }, 12: function (Y, o) { return { x: Y.x - o.width / 2 + Y.width, y: Y.y + o.height / 2 } }, 13: function (d, h) { return { x: d.x + d.width + h.width / 2, y: d.y + h.height / 2 } }, 14: function (A, b) { return { x: A.x - b.width / 2, y: A.y + A.height / 2 } }, 15: function (q) { return { x: q.x, y: q.y + q.height / 2 } }, 16: function (i, v) { return { x: i.x + v.width / 2, y: i.y + i.height / 2 } }, 17: function (d) { return { x: d.x + d.width / 2, y: d.y + d.height / 2 } }, 18: function (m, R) { return { x: m.x + m.width - R.width / 2, y: m.y + m.height / 2 } }, 19: function (a) { return { x: a.x + a.width, y: a.y + a.height / 2 } }, 20: function (s, w) { return { x: s.x + s.width + w.width / 2, y: s.y + s.height / 2 } }, 21: function (P, U) { return { x: P.x - U.width / 2, y: P.y + P.height - U.height / 2 } }, 22: function (u, T) { return { x: u.x + T.width / 2, y: u.y + u.height - T.height / 2 } }, 23: function (Y, t) { return { x: Y.x + Y.width / 2, y: Y.y + Y.height - t.height / 2 } }, 24: function (n, q) { return { x: n.x + n.width - q.width / 2, y: n.y + n.height - q.height / 2 } }, 25: function (g, T) { return { x: g.x + g.width + T.width / 2, y: g.y + g.height - T.height / 2 } }, 26: function (g) { return { x: g.x, y: g.y + g.height } }, 27: function (b) { return { x: b.x + b.width / 2, y: b.y + b.height } }, 28: function (M) { return { x: M.x + M.width, y: M.y + M.height } }, 29: function (G, n) { return { x: G.x - n.width / 2, y: G.y + G.height + n.height / 2 } }, 30: function (L, F) { return { x: L.x + F.width / 2, y: L.y + L.height + F.height / 2 } }, 31: function (Y, T) { return { x: Y.x + Y.width / 2, y: Y.y + Y.height + T.height / 2 } }, 32: function ($, s) { return { x: $.x + $.width - s.width / 2, y: $.y + $.height + s.height / 2 } }, 33: function (l, z) { return { x: l.x + l.width + z.width / 2, y: l.y + l.height + z.height / 2 } }, 34: function (V, Y) { return { x: V.x, y: V.y - Y.height / 2 } }, 35: function (s, n) { return { x: s.x + s.width, y: s.y - n.height / 2 } }, 36: function (A, t) { return { x: A.x, y: A.y + A.height + t.height / 2 } }, 37: function (x, X) { return { x: x.x + x.width, y: x.y + x.height + X.height / 2 } }, 38: function (x, Y) { return { x: x.x + x.width / 4, y: x.y - Y.height / 2 } }, 39: function (Y, n) { return { x: Y.x + 3 * Y.width / 4, y: Y.y - n.height / 2 } }, 40: function (G) { return { x: G.x + G.width / 4, y: G.y } }, 41: function (Z) { return { x: Z.x + 3 * Z.width / 4, y: Z.y } }, 42: function (e, n) { return { x: e.x + e.width / 4, y: e.y + n.height / 2 } }, 43: function (x, M) { return { x: x.x + 3 * x.width / 4, y: x.y + M.height / 2 } }, 44: function ($, R) { return { x: $.x + $.width / 2, y: $.y + $.height / 2 - R.height / 2 } }, 45: function (v) { return { x: v.x + v.width / 4, y: v.y + v.height / 2 } }, 46: function (b, y) { return { x: b.x + b.width / 2 - y.width / 2, y: b.y + b.height / 2 } }, 47: function (g, C) { return { x: g.x + g.width / 2 + C.width / 2, y: g.y + g.height / 2 } }, 48: function (Z) { return { x: Z.x + 3 * Z.width / 4, y: Z.y + Z.height / 2 } }, 49: function (o, T) { return { x: o.x + o.width / 2, y: o.y + o.height / 2 + T.height / 2 } }, 50: function (w, l) { return { x: w.x + w.width / 4, y: w.y + w.height - l.height / 2 } }, 51: function (h, u) { return { x: h.x + 3 * h.width / 4, y: h.y + h.height - u.height / 2 } }, 52: function (B) { return { x: B.x + B.width / 4, y: B.y + B.height } }, 53: function (P) { return { x: P.x + 3 * P.width / 4, y: P.y + P.height } }, 54: function (D, v) { return { x: D.x + D.width / 4, y: D.y + D.height + v.height / 2 } }, 55: function (g, k) { return { x: g.x + 3 * g.width / 4, y: g.y + g.height + k.height / 2 } } }; return Lb(y) ? function (Z, $, u) { return T[Z]($, u ? u : er) } : void 0 }(); _i(d, { highlight: "#1ABC9C", label: "#000", labelSelect: "#FFF", transparent: "rgba(0,0,0,0.35)", titleBackground: "#2C3E50", titleIconBackground: "#868686", headerBackground: "#ECF0F1", headerIconBackground: "#868686", headerSeparator: "#868686", headerLine: "#D9D9D9", background: "#FFF", disabledBackground: "rgba(255,255,255,0.65)", toolTipBackground: "#FFFFE0", rectSelectBorder: "#2C3E50", rectSelectBackground: "rgba(0,0,0,0.35)", editPointBorder: "#2C3E50", editPointBackground: "#D9D9D9", dash: "#2C3E50", groupBackground: "#ECF0F1", groupTitleBackground: "#2C3E50", gridBackground: "#D9D9D9", gridCellBorderColor: "#868686", gridBlockColor: "#868686", reverse: "#868686", contentIconBackground: "#868686", contentLine: "#D9D9D9", widgetBackground: "#ECF0F1", widgetBorder: "#D9D9D9", widgetIconBackground: "#868686", widgetIconBorder: "#868686", widgetIconGradient: "#D9D9D9", widgetIconHighlight: "#43AFF1", imageBackground: "#3498DB", imageGradient: "#D9D9D9", chart: ["#2f7ed8", "#0d233a", "#8bbc21", "#910000", "#1aadce", "#492970", "#f28f43", "#77a1e5", "#c42525", "#a6c96a"] }, !0); var Lq = d.reverse, kc = d.transparent, oh = d.rectSelectBackground, Cd = d.dash, Sh = d.titleBackground, sg = d.titleIconBackground, _f = d.headerBackground, Qn = d.headerIconBackground, yd = d.headerSeparator, Og = d.headerLine, Jo = d.contentIconBackground, ze = d.contentLine, Lj = (d.widgetIconHighlight, d.widgetIconBorder), ph = (d.widgetIconGradient, d.imageBackground), _k = d.imageGradient, cl = d.highlight, Ld = d.label, Jb = d.labelSelect; if (q && !y.noAlert) { var Tq = new Date, Eo = q.split("-"), Cc = new Date(Tq.getFullYear(), Tq.getMonth(), Tq.getDate()), q = new Date(n(Eo[0], 10), n(Eo[1], 10) - 1, n(Eo[2], 10)), Pe = Cc.getTime(), cn = q.getTime(), dd = K + "_try", Dk = y.localStorage, Pm = y.alert; if (Dk && Pm) if (cn > Pe && 1728e6 > cn - Pe) { var si = (cn - Pe) / 864e5; Dk && Dk[dd] != si && (Dk[dd] = si, Pm("HT for Web free trial license will expire in " + si + " days, please apply for a new license!")) } else Pe >= cn && Pm("Your free trial of HT for Web has expired!"), Dk && delete Dk[dd] } var Xc = { ms_ac: function (V, D) { for (var N = D.ms_ac, f = 0; f < N.length; f++)Pd(V, N[f]) }, ms_listener: function (F) { F.addListeners = function () { for (var Z = this, p = 0; p < _r.length; p++)Z["handle_" + _r[p]] && pf(_r[p], Z.getView(), Z) }, F.removeListeners = function () { for (var k = this, o = 0; o < _r.length; o++)k["handle_" + _r[o]] && qf(_r[o], k.getView(), k) } }, ms_fire: function (l) { l.mp = function (l, I, s) { this.addPropertyChangeListener(l, I, s) }, l.ump = function (Y, q) { this.removePropertyChangeListener(Y, q) }, l.fp = function (c, j, e, r) { return this.firePropertyChange(c, j, e, r) }, l.addPropertyChangeListener = function (y, J, M) { var x = this; x._62I || (x._62I = new bf), x._62I.add(y, J, M) }, l.removePropertyChangeListener = function (G, p) { this._62I && this._62I.remove(G, p) }, l.firePropertyChange = function (U, F, e, J) { if (J) { if (J(F, e)) return !1 } else if (F === e) return !1; var i = this, c = { property: U, oldValue: F, newValue: e, source: i, data: i }; return i._62I && i._62I.fire(c), i.onPropertyChanged && i.onPropertyChanged(c), !0 } }, ms_attr: function (k) { k.a = function (V, i) { var g = this; if (2 === arguments.length) g.setAttr(V, i); else { if (!bk(V)) return g.getAttr(V); for (var z in V) g.setAttr(z, V[z]) } return g }, k.getAttr = function (I) { return this._attrObject ? this._attrObject[I] : Z }, k.setAttr = function (S, T) { var J = this; J._attrObject || (J._attrObject = {}); var l = J._attrObject[S]; T === Z ? delete J._attrObject[S] : J._attrObject[S] = T, J.fp && J.fp("a:" + S, l, T) && J.onAttrChanged && J.onAttrChanged(S, l, T) }, k.getSerializableAttrs = function () { var B, D = {}; for (B in this._attrObject) D[B] = 1; return D } }, ms_bnb: function (j) { j.getBodyColor = function (k) { return k.s("body.color") }, j.getBorderColor = function (s) { return s.s("border.color") } }, _51o: function (f) { f.mi = function (d, _, Z) { this.addInteractorListener(d, _, Z) }, f.umi = function (Q, s) { this.removeInteractorListener(Q, s) }, f.fi = function (D) { this.fireInteractorEvent(D) }, f.addInteractorListener = function (h, R, $) { var W = this; W._63I || (W._63I = new bf), W._63I.add(h, R, $) }, f.removeInteractorListener = function (I, e) { this._63I.remove(I, e) }, f.fireInteractorEvent = function ($) { this._63I && this._63I.fire($) }, f.setInteractors = function (H) { var e = this, b = e._interactors; b && b.each(function (V) { V.tearDown() }), sp(H) && (H = new Ul(H)), e._interactors = H, H && H.each(function (k) { k.setUp() }), e.fp("interactors", b, H), e.invalidateSelection() }, f.getInteractors = function () { return this._interactors } }, _49o: function (x) { x._44O = l, x._45O = l, x.addTopPainter = function (c) { var v = this; v._44O || (v._44O = new Ul), v._44O.contains(c) || (v._44O.add(c), v.redraw && v.redraw()) }, x.removeTopPainter = function (D) { var z = this; z._44O && (z._44O.remove(D), z.redraw && z.redraw()) }, x.addBottomPainter = function (O) { var D = this; D._45O || (D._45O = new Ul), D._45O.contains(O) || (D._45O.add(O), D.redraw && D.redraw()) }, x.removeBottomPainter = function (w) { var u = this; u._45O && (u._45O.remove(w), u.redraw && u.redraw()) }, x._93db = function (Y, N) { var v = this; v._45O && v._45O.each(function (L) { L.draw ? L.draw(Y, N) : L.call(v, Y, N) }) }, x._92db = function (e, c) { var B = this; B._44O && B._44O.each(function (a) { a.draw ? a.draw(e, c) : a.call(B, e, c) }) } }, ms_sm: function (p) { p.sm = function () { return this.getSelectionModel() }, p.setSelectableFunc = function (r) { this.sm().setFilterFunc(r) }, p.getSelectableFunc = function () { return this.sm().getFilterFunc() }, p.getSelectionModel = function () { var g = this; return g._selectionModel ? g._selectionModel : g.dm().sm() }, p.isSelectionModelShared = function () { return !this._selectionModel }, p.setSelectionModelShared = function (e) { var X = this, k = !X._selectionModel, N = X.handleSelectionChange, b = X.dm(); k !== e && (X.invalidateSelection && X.invalidateSelection(), e ? (b.sm().ms(N, X), X._selectionModel.ums(N, X), X._selectionModel.dispose(), X._selectionModel = l) : (b.sm().ums(N, X), X._selectionModel = new vf(b), X._selectionModel.ms(N, X)), X.onSelectionModelSharedChanged(), X.fp("selectionModelShared", k, e)) }, p.onSelectionModelSharedChanged = function () { var j = this; j.redraw(), j.invalidateSelection && j.invalidateSelection() }, p.removeSelection = function () { var F = this.dm(), M = F.getHistoryManager(); M && M.beginInteraction(), this.sm().toSelection().each(F.remove, F), M && M.endInteraction() }, p.selectAll = function () { var J = this; J.sm().ss(J.dm().toDatas(function (W) { return J.isVisible(W) && J.isSelectable(W) })) }, p.isSelected = function (a) { return this.sm().co(a) }, p.isSelectedById = function (j) { var b = this.dm().getDataById(j); return b ? this.isSelected(b) : !1 }, p.isSelectable = function (g) { return this.sm().isSelectable(g) } }, ms_tx: function (m) { m._64I = 0, m._65O = 0, m.isScrollable = function () { return this.getWidth() < this._64I }, m._40o = function () { return this.isScrollable() }, m.getLogicalPoint = function (K) { return mj(K, this._canvas || this._view, this.tx(), this.ty ? this.ty() : 0) }, m.tx = function (z) { return z === Z ? this.getTranslateX() : (this.setTranslateX(z), void 0) }, m.getTranslateX = function () { return this._65O }, m.setTranslateX = function (K) { var q = this, a = q.getWidth() - q._64I; a > K && (K = a), K > 0 && (K = 0), K = L(K); var e = q._65O; q._65O = K, q.fp(xe, e, K) } }, ms_ty: function (J) { J._23Q = 0, J._66O = 0, J._41o = function () { return this.getHeight() < this._23Q }, J.getLogicalPoint = function ($) { return mj($, this._canvas || this._view, this.tx ? this.tx() : 0, this.ty()) }, J.ty = function (e) { return e === Z ? this.getTranslateY() : (this.setTranslateY(e), void 0) }, J.getTranslateY = function () { return this._66O }, J.setTranslateY = function (_) { var f = this, w = f.getHeight() - f._23Q; w > _ && (_ = w), _ > 0 && (_ = 0), _ = L(_); var N = f._66O; f._66O = _, f.fp($g, N, _) } }, ms_txy: function (Q) { Q._65O = 0, Q._66O = 0, Q.tx = function (H) { return H === Z ? this.getTranslateX() : (this.setTranslateX(H), void 0) }, Q.ty = function (r) { return r === Z ? this.getTranslateY() : (this.setTranslateY(r), void 0) }, Q.onTranslateEnded = function () { }, Q.setTranslate = function (I, b, s) { var e = this; if (s = al(s)) { e._65I && e._65I.stop(!0); var M = e.tx(), D = e.ty(); s.action = function (G) { e.setTranslate(M + (I - M) * G, D + (b - D) * G) }, s._37o = function () { delete e._66I, delete e._65I, e.onTranslateEnded() }, e._66I = 1, e._65I = _g(s) } else e.tx(I), e.ty(b) }, Q.getTranslateX = function () { return this._65O }, Q.setTranslateX = function (f) { var H = this; f = H.adjustTranslateX(f); var F = H._65O; H._65O = f, H.fp(xe, F, f) }, Q.getTranslateY = function () { return this._66O }, Q.setTranslateY = function (o) { var l = this; o = l.adjustTranslateY(o); var P = l._66O; l._66O = o, l.fp($g, P, o) }, Q.adjustTranslateX = function (q) { return L(q) }, Q.adjustTranslateY = function (U) { return L(U) }, Q.translate = function (J, u, z) { this.setTranslate(this.tx() + J, this.ty() + u, z) }, Q.getLogicalPoint = function (R) { var l = this; return mj(R, this._canvas || l._view, l.tx(), l.ty()) } }, ms_dm: function (H) { H.dm = function (i) { return i ? (this.setDataModel(i), void 0) : this.getDataModel() }, H.getDataModel = function () { return this._dataModel } }, ms_lp: function (f) { f.lp = function (j) { return this.getLogicalPoint(j) } }, ms_v: function ($) { $._disabled = !1, $.setDisabled = function (J, c) { var t = this, F = t._disabled; F !== J && (F && (Ng(t._63O), delete t._63O), J && (hq(t._view, t._63O = jm(c)), t.iv()), t._disabled = J, t.fp("disabled", F, J)) }, $.isDisabled = function () { return this._disabled }, $.getDisabledDiv = function () { return this._63O }, $.getView = function () { return this._view }, $.addToDOM = function () { var D = this, u = D.getView(), G = u.style; i.body.appendChild(u), G.left = "0", G.right = "0", G.top = "0", G.bottom = "0", y.addEventListener("resize", function () { D.iv() }, !1), D.iv() }, $.getWidth = function () { return this._view.clientWidth }, $.getHeight = function () { return this._view.clientHeight }, $.setWidth = function (i) { var g = this; g._view.style.width = i + $k, g.iv(), g.fp && g.fp(fh, l, i) }, $.setHeight = function (q) { var W = this; W._view.style.height = q + $k, W.iv(), W.fp && W.fp(Yj, l, q) }, $.setFocus = function ($) { var f = this, O = f._currentEditor; return $ && O && (O.getView && (O = O.getView()), O.contains($.target)) ? !1 : (Cq(f._view), f.endEditing && f.endEditing(), f.fireViewEvent("focus"), !0) }, $.iv = function (w) { this.invalidate(w) }, $.invalidate = function (K) { var e = this; e._68I || (e._68I = 1, iq(e.validate, e, l, K), e.onInvalidated && e.onInvalidated(), e.fireViewEvent("invalidate")) }, $.validate = function () { var h = this, c = h._view; if (h._68I && (delete h._68I, c.parentNode)) if (0 === c.offsetWidth && 0 === c.offsetHeight && h._67I !== l) h._67I === Z && (h._67I = m.reinvalidateCount), h._67I > 0 ? h._67I-- : h._67I = l, h.iv(); else { h.fireViewEvent("beginValidate"), h.validateImpl(), h.onValidated && h.onValidated(), h.fireViewEvent("validate"); var B = h._63O; B && (c.lastChild !== B && (Ng(B), hq(c, B)), Up(B, 0, 0, h.getWidth(), h.getHeight())), Eh(h), Km(h) } }, $.layout = function (a, h, G, e) { 1 === arguments.length ? Up(this, a) : Up(this, a, h, G, e) }, $.addViewListener = function (P, Y, q) { var F = this; F._67O || (F._67O = new bf), F._67O.add(P, Y, q) }, $.removeViewListener = function (c, $) { this._67O.remove(c, $) }, $.fireViewEvent = function (U) { var q = this; q._67O && (Yc(U) && (U = { kind: U }), q._67O.fire(U)), m.viewListener && m.viewListener(q, U) } }, ms_tip: function (r) { r.setToolTipEnabled = function (r) { var Z = this; r ? P || Z._13o || (Z.enableToolTip(), Z.fp("toolTipEnabled", !1, !0)) : Z._13o && (Z.disableToolTip(), Z.fp("toolTipEnabled", !0, !1)) }, r.isToolTipEnabled = function () { return !!this._13o }, r.enableToolTip = function () { var r = this; P || r._13o || (r._13o = function (H) { var S = r.getToolTip(H); S != l ? m.toolTipContinual && m.isToolTipShowing() ? Rp(H, S) : (ce(), Zd = { timeout: U(dn, Sl), e: H, info: S }) : ce() }, r.getView().addEventListener(bm, r._13o, !1), r.getView().addEventListener("mouseleave", m.hideToolTip, !1)) }, r.disableToolTip = function () { var S = this; S._13o && (S.getView().removeEventListener(bm, S._13o, !1), S.getView().removeEventListener("mouseleave", m.hideToolTip, !1), delete S._13o) }, r.getToolTip = function (i) { var I = this; if (I.getDataAt) { var y = I.getDataAt(i); return y ? y.getToolTip() : l } return I.getValue ? I.getValue() : void 0 } }, _52o: function (r) { r._zoom = 1, r._29I = er, r.zoomIn = function (A, Y) { this.setZoom(this._zoom * kb, A, Y) }, r.zoomOut = function (l, p) { this.setZoom(this._zoom / kb, l, p) }, r.zoomReset = function (K, P) { this.setZoom(1, K, P) }, r.scrollZoomIn = function (b) { this.setZoom(this._zoom * ln, l, b) }, r.scrollZoomOut = function (v) { this.setZoom(this._zoom / ln, l, v) }, r.pinchZoomIn = function (s) { this.setZoom(this._zoom * Mp, l, s) }, r.pinchZoomOut = function (G) { this.setZoom(this._zoom / Mp, l, G) }, r.adjustZoom = function (e) { return Li > e ? Li : e > Kf ? Kf : e }, r.getZoom = function () { return this._zoom }, r.setZoom = function (r, e, D) { var w = this; if (e = al(e)) { w._14o && w._14o.stop(!0); var l = w._zoom; e.action = function (W) { w._96O(l + (r - l) * W, D) }, e._37o = function () { delete w._zooming, delete w._14o, w.onZoomEnded() }, w._zooming = 1, w._14o = _g(e) } else w._96O(r, D) }, r._96O = function (Z, o) { var u = this; if (Z = u.adjustZoom(Z), Z !== u._zoom) { u.validate(); var s = u._29I, v = u._zoom; 0 !== s.width && 0 !== s.height && (o = o ? o : { x: s.x + s.width / 2, y: s.y + s.height / 2 }, u.tx((o.x - s.x) * v - o.x * Z), u.ty((o.y - s.y) * v - o.y * Z)), u._zoom = Z, u.fp("zoom", v, Z) } } } }; _i(m, {
            numberDigits: 5, baseZIndex: Z, isTouchable: P, devicePixelRatio: y.devicePixelRatio ? y.devicePixelRatio : 1, reinvalidateCount: 3, hitMaxArea: 3e3, imageCacheThreshold: 20, autoMakeVisible: !0, autoHideScrollBar: !0, disabledOpacity: .4, disabledBackground: d.disabledBackground, toolTipDelay: 800, toolTipContinual: !1, getDragger: function () { return Ib }, lineCap: "butt", lineJoin: "round", imageGradient: "linear.northeast", dashPattern: [16, 16], animDuration: 200, animEasing: function (T) { return T * T }, labelColor: Ld, labelSelectColor: Jb, labelFont: (P ? "15" : "12") + "px arial, sans-serif", widgetIndent: P ? 30 : 20, widgetRowHeight: P ? 30 : 20, widgetHeaderHeight: P ? 32 : 22, widgetTitleHeight: P ? 34 : 24, scrollBarColor: kc, scrollBarSize: 7, scrollBarTimeout: 1e3, scrollBarMinLength: 20, scrollBarInteractiveSize: P ? 32 : 16, zoomIncrement: 1.3, scrollZoomIncrement: 1.05, pinchZoomIncrement: 1.08, zoomMax: 20, zoomMin: .01, segmentResolution: 12, shapeResolution: 24, shapeSide: 24, intersectionLineRect: Rb, intersectionLineLine: Kd, isEnter: Zr, isEsc: ai, isDelete: Th, isSpace: Pk, isLeft: Qi, isUp: Ef, isRight: Kh, isDown: hr, getTarget: Ql, isString: Yc, isNumber: Gr, isBoolean: sk, isArray: sp, isSelectAll: Tn, isFunction: Nf, getPropertyValue: Wh, setPropertyValue: Bj, addMethod: _i, getVersion: function () { return "6.1.0" }, appendToScreen: function (X) { X = X.getView ? X.getView() : X, (i.fullscreenElement || i.mozFullScreenElement || i.webkitFullscreenElement || i.msFullscreenElement || i.body).appendChild(X) }, toggleFullscreen: function (J) { var _ = J.getView(); if (i.fullscreenElement || i.mozFullScreenElement || i.webkitFullscreenElement || i.msFullscreenElement) i.exitFullscreen ? i.exitFullscreen() : i.msExitFullscreen ? i.msExitFullscreen() : i.mozCancelFullScreen ? i.mozCancelFullScreen() : i.webkitExitFullscreen && i.webkitExitFullscreen(); else { var b = !0, Q = _.style.left, y = _.style.top, d = _.style.width, q = _.style.height, g = _.style.background; g || (_.style.background = "white"), _.requestFullscreen ? _.requestFullscreen() : _.msRequestFullscreen ? _.msRequestFullscreen() : _.mozRequestFullScreen ? _.mozRequestFullScreen() : _.webkitRequestFullscreen && _.webkitRequestFullscreen(); var z = setInterval(function () { if (_ !== (i.fullscreenElement || i.mozFullScreenElement || i.webkitFullscreenElement || i.msFullscreenElement)) clearInterval(z), _.style.left = Q, _.style.top = y, _.style.width = d, _.style.height = q, _.style.background = g, J.iv(); else { var S = m.getWindowInfo(); (b || S.width !== J.getWidth() || S.height !== J.getHeight()) && (Up(J), b = !1) } }, 500) } }, appendTimeStamp: function (X) { return X += X.indexOf("?") >= 0 ? "&__ht__=" + Fh() : "?" + Fh() }, setCompType: function (v, m) { Nf(m) || bk(m) ? Nh[v] = m : yo(v) }, getCompType: function (r) { return Nh[r] }, getCompTypeMap: function () { return Nh }, drawCompType: function (k, i, w, U, B, d) { k(i, w, U, B, d) }, numberListener: function () { var w = { 46: 1, 8: 1, 9: 1, 27: 1, 13: 1, 109: 1, 110: 1, 189: 1, 190: 1 }; return function (e) { var E = e.keyCode; w[E] || 65 === E && m.isCtrlDown(e) || 86 === E && m.isCtrlDown(e) || 67 === E && m.isCtrlDown(e) || 88 === E && m.isCtrlDown(e) || E >= 35 && 40 >= E || (e.shiftKey || 48 > E || E > 57) && (96 > E || E > 105) && e.preventDefault() } }(), ignoreKeyCodes: [122, 123], preventDefault: function (M) { var e = M.target.tagName; ("DIV" === e || "CANVAS" === e) && !(m.ignoreKeyCodes.indexOf(M.keyCode) >= 0) && ("keydown" !== M.type || Qi(M) || Kh(M) || Ef(M) || hr(M) || Th(M) || 65 === M.keyCode && (M.metaKey || M.ctrlKey)) && (M.preventDefault(), M.preventManipulation && M.preventManipulation()) }, getWindowInfo: function () { var w = i.documentElement, A = w && (w.scrollLeft || w.scrollTop) ? w : i.body; return { target: A, left: A.scrollLeft, top: A.scrollTop, width: y.innerWidth || A.clientWidth, height: y.innerHeight || A.clientHeight } }, isDragging: function () { return !!Ib }, isLeftButton: function (g) { return P ? !0 : 0 === g.button }, isInput: function (D) { if (!D) return !1; var g = D.tagName; return "INPUT" === g || "TEXTAREA" === g || "SELECT" === g }, getTouchCount: function (Q) { return P ? Q.touches.length : 1 }, isDoubleClick: function () { var q = {}; return Vi = new Date, xi = Vi.getTime(), function (f) { var j = (new Date).getTime(), x = f.button == l ? "" : f.button, M = f.type + x, K = M + "_isDoubleClick", H = q[M]; if (H || (H = q[M] = { details: 0, timeout: null, lastPoint: null, lastTime: j }), f[K] === Z) { var e = gi(f); f[K] = H.lastPoint && Bk(H.lastPoint, e) <= (P ? 20 : 1) && j - H.lastTime < 500, H.lastTime = j, H.lastPoint = e, H.details++ , H.timeout && (v(H.timeout), H.timeout = null), H.timeout = U(function () { this.details = 0, this.timeout = null, this.lastPoint = null }.bind(H), 500) } return !!f[K] && 2 === H.details } }(), isShiftDown: function (W) { return W ? W.shiftKey : Ne["16"] }, isCtrlDown: function (H) { return H ? a ? H.metaKey : H.ctrlKey : a ? Ne["91"] : Ne["17"] }, getClientPoint: function (b) { return P && (b = ch(b)), { x: b.clientX, y: b.clientY } }, isMouseEvent: function (n) { return n instanceof MouseEvent || 0 === n.type.indexOf("mouse") }, getTargetElement: function (n) { if (m.isMouseEvent(n) || !i.elementFromPoint) return n.target; var T = mn(n); return i.elementFromPoint(T.x, T.y) }, getPagePoint: function (g) { return P && (g = ch(g)), { x: g.pageX, y: g.pageY } }, createObject: function (h, A) { var m = new h; for (var z in A) { var H = El(z), L = A[z]; m[H] ? (m[H](L), "setToolTip" === H && m.enableToolTip && m.enableToolTip()) : m[z] = L } return m }, setImage: function (R, P, L, W) { var X = arguments.length; 4 === X ? le(R, W, P, L) : 2 === X ? Yc(P) ? le(R, P) : Uc[R] = P : 1 === X && le(R, R) }, getImage: function (P, y, U) { var E; if (P == l) return l; if (bk(P) ? E = P : (E = Uc[P], P && E === Z && (vo && vo[P] || le(P, P))), y && E && E.tagName) { var Q; Q = "override" === U ? "colors_override" : "override_rgb" === U ? "colors_override_rgb" : "override_a" === U ? "colors_override_a" : "colors", E[Q] || (E[Q] = { __count__: 0 }); var V = E[Q][y]; return V || (E[Q].__count__ > m.imageCacheThreshold && (E[Q] = { __count__: 0 }), V = Of(E, db(y), E.width, E.height, U), E[Q][y] = V, E[Q].__count__++), V } return E }, getId: function () { var R = 1; return function () { return ++R } }(), callLater: function (k, N, j, t) { var P = function () { k.apply(N, j) }; return t ? U(P, t) : y.requestAnimationFrame(P) }, asyncEach: function (E, S, T) { "function" != typeof T && (T = Function.prototype); var s = new Array(E.length), P = 0, p = !1; E.forEach(function (L, K) { S(L, function (e, C) { return p ? void 0 : e ? (p = !0, T(null)) : (s[K] = C, P++ , P === E.length ? T(s) : void 0) }) }) }, xhrLoad: function (x, Y, l) { var h = !1; sp(x) || (h = !0, x = [x]), l = l || {}, x.length; var F = l.sync; Tl(x, function (C, O) { var $ = new XMLHttpRequest; l.responseType ? $.responseType = l.responseType : $.overrideMimeType(l.mimeType || "text/plain"), C = m.beforeLoadURL(C), C.data ? O(null, C.data) : ($.open("GET", encodeURI(C), !F), $.onload = function (e) { 200 === this.status || 0 === this.status ? O(null, e.target.response) : O(!0) }, $.onerror = function () { O(!0) }, $.send(null)) }, function (m) { "function" == typeof Y && Y(h && m ? m[0] : m) }) }, clone: function (B) { if (!B) return l; if (sp(B)) return B.slice(0); if (Zh(B)) return new Ul(B); if (bk(B)) { var Z, j = {}; for (Z in B) j[Z] = B[Z]; return j } return B }, callWhenLoaded: function (T, C) { C = C || 100; var M = Sf(T, C); Mf || (Mf = {}), Mf[M] = { tick: M, cb: T, delay: C } }, beforeLoadURL: function (j) { if (Mf) { var c = {}; for (var i in Mf) { var r = Mf[i]; v(r.tick); var t = Sf(r.cb, r.delay); c[t] = { tick: t, delay: r.delay, cb: r.cb } } Mf = c } return m.convertURL ? m.convertURL(j) : j }, convertURL: function (W) { return W }, handleRefGraphLoaded: function () { }, handleCompTypeLoaded: function () { }, handleImageLoaded: function () { }, handleUnfoundImage: function () { }, sortFunc: function (X, m) { if (X === m) return 0; if (X == l && m != l) return 1; if (X != l && m == l) return -1; if (X == l && m == l) return 0; var F, K = typeof X, e = typeof m; return K === Mm && e === Mm ? F = X.localeCompare(m) : K === bs && e === bs && (F = X - m), F === Z && (F = ("" + X).localeCompare("" + m)), F > 0 ? 1 : 0 > F ? -1 : 0 }, getClassMap: function () { return dc }, getClass: function (k) { if (Yc(k)) { var T, a = dc[k]; if (!a) { T = k.split("."), a = y; for (var p = 0; p < T.length; p++)a = a[T[p]]; dc[k] = a } return a } return k }, def: function (g, H, c) { var o, V, L, W = function () { }; if (W.prototype = H.prototype, o = new W, Yc(g)) { if (dc[g]) throw "'" + g + "' already defined"; L = Vr(g), o.getClassName = function () { return g } } else L = g; if (o.constructor = L, o.getClass = function () { return L }, o.getSuperClass = function () { return H }, c) for (V in c) Xc[V] && Xc.hasOwnProperty(V) ? Xc[V](o, c) : Gn(o, c, V); L.prototype = o, L.superClass = H.prototype }, startAnim: function () { var S = function (Q) { Q.duration && (Q.startTime = Fh()), Q.timeId = iq(Q.tick, l, l, Q.interval) }; return function (Q) { return Q = Ln(Q), Q.easing = Q.easing || m.animEasing, Q.duration || Q.frames || (Q.duration = m.animDuration), Q.t = 0, Q.duration ? Q.interval = 0 : (Q.frame = 0, Q.interval = Q.interval || 10), Q.tick = function () { if (Q.duration) { var L = (Fh() - Q.startTime) / Q.duration; L > 1 && (L = 1), Q.t = L, Q.action(Q.easing(L), L), 1 === L ? Q.stop() : Q._isPaused || (Q.timeId = iq(Q.tick)) } else Q.frame++ , L = Q.t = Q.frame / Q.frames, Q.action(Q.easing(L), L), Q.frame < Q.frames ? Q._isPaused || (Q.timeId = iq(Q.tick, l, l, Q.interval)) : Q.stop() }, Q.resume = function () { Q._isPaused && (delete Q._isPaused, Q.duration ? Q.t < 1 && (Q.startTime = Fh() - Q.duration * Q.t, Q.timeId = iq(Q.tick)) : Q.frame < Q.frames && (Q.timeId = iq(Q.tick, l, l, Q.interval))) }, Q.pause = function () { Q._isPaused = !0 }, Q.stop = function (q) { Q.isRunning() && (Q.duration ? Q.t < 1 && q && (Q.t = 1, Q.action(Q.easing(1))) : Q.frame < Q.frames && q && (Q.frame = Q.frames, Q.action(Q.easing(1))), Q._37o && Q._37o(), Q.finishFunc && Q.finishFunc(), Te(Q.timeId, !Q.duration), delete Q.timeId) }, Q.isRunning = function () { return Q.timeId != l }, Q.delay ? iq(S, l, [Q], Q.delay) : S(Q), Q } }(), getTextSize: function () { var F = {}, D = i ? sc().getContext("2d") : l; return function (k, X) { D.font = k ? k : Ek; var Y = F[D.font]; return Y || (Y = 2 * D.measureText("e").width + 4, F[D.font] = Y), { width: D.measureText(X).width + 4, height: Y } } }(), drawText: function (D, f, M, j, O, t, e, c, U, N) { if (f != l) { var q = Nm(M, f), G = {}; G.y = N && N !== Jr ? N === ys ? t + q.height / 2 : t + c - q.height / 2 : t + c / 2, G.x = U && U !== Xr ? U === kf ? O + e - q.width / 2 : O + e / 2 : O + q.width / 2, Kc(D, f, G, M, j) } }, getDistance: function (l, z) { var N = l.length; return z ? 3 === N ? o(X(l[0] - z[0]) + X(l[1] - z[1]) + X(l[2] - z[2])) : 2 === N ? o(X(l[0] - z[0]) + X(l[1] - z[1])) : l.z === Z ? o(X(z.x - l.x) + X(z.y - l.y)) : o(X(z.x - l.x) + X(z.y - l.y) + X(z.z - l.z)) : 3 === N ? o(X(l[0]) + X(l[1]) + X(l[2])) : 2 === N ? o(X(l[0]) + X(l[1])) : void 0 }, brighter: function (R, h) { return 0 > h && (h = -h), ds(R, h ? h : 40) }, darker: function (R, b) { return b > 0 && (b = -b), ds(R, b ? b : -40) }, unionPoint: function (N, U) { if (!N) return l; if (2 === arguments.length) return N && U ? { x: b(N.x, U.x), y: b(N.y, U.y), width: A(N.x - U.x), height: A(N.y - U.y) } : l; var S = N; if (S._as && (S = S._as), S.length === Z) return l; var W = S.length; if (0 >= W) return l; for (var u = 1, T = S[0], G = { x: T.x, y: T.y, width: 0, height: 0 }; W > u; u++) { T = S[u]; var X = b(G.x, T.x), n = g(G.x + G.width, T.x), M = b(G.y, T.y), D = g(G.y + G.height, T.y); G.x = X, G.y = M, G.width = n - X, G.height = D - M } return G }, unionRect: function (x, u) { if (x && !u) return Ln(x); if (!x && u) return Ln(u); if (x && u) { var h = { x: b(x.x, u.x), y: b(x.y, u.y) }; return h.width = g(x.x + x.width, u.x + u.width) - h.x, h.height = g(x.y + x.height, u.y + u.height) - h.y, h } return l }, containsPoint: function (z, Q) { return !(!z || Q.x < z.x || Q.y < z.y || Q.x > z.x + z.width || Q.y > z.y + z.height) }, containsRect: function (L, I) { if (!L || !I) return !1; var s = I.x, E = I.y, w = I.width, K = I.height, y = L.width, Y = L.height; if (0 > (y | Y | w | K)) return !1; var q = L.x, d = L.y; if (q > s || d > E) return !1; if (y += q, w += s, s >= w) { if (y >= q || w > y) return !1 } else if (y >= q && w > y) return !1; if (Y += d, K += E, E >= K) { if (Y >= d || K > Y) return !1 } else if (Y >= d && K > Y) return !1; return !0 }, intersectsRect: function (t, B) { if (!t || !B) return !1; var P = B.width, Q = B.height, i = t.width, X = t.height; if (0 >= i || 0 >= X || 0 >= P || 0 >= Q) return !1; var b = B.x, V = B.y, m = t.x, n = t.y; return i += m, X += n, P += b, Q += V, i > b && X > V && P > m && Q > n }, intersection: function (S, j) { if (!S || !j) return l; var n = j.x, J = j.y, A = S.x, Y = S.y, y = n, x = J, v = A, D = Y; return y += j.width, x += j.height, v += S.width, D += S.height, A > n && (n = A), Y > J && (J = Y), y > v && (y = v), x > D && (x = D), y -= n, x -= J, 0 >= y || 0 >= x ? l : { x: n, y: J, width: y, height: x } }, grow: function (d, J, l) { l === Z && (l = J), d.x -= J, d.y -= l, d.width = d.width + 2 * J, d.height = d.height + 2 * l }, getLogicalPoint: function (e, X, Y, d, G, k) { ec(e) ? a ? Ne["91"] = !0 : Ne["17"] = !0 : a ? Ne["91"] = !1 : Ne["17"] = !1, Ne["16"] = Qd(e) ? !0 : !1; var $ = X.getBoundingClientRect(); return e = P ? ch(e) : e, { x: (e.clientX - $.left + X.scrollLeft - (Y || 0)) / (G || 1), y: (e.clientY - $.top + X.scrollTop - (d || 0)) / (k || 1) } }, removeHTML: function () { var o; return function (s) { return s && s.parentNode ? o === s ? !0 : (o = s, s.parentNode.removeChild(s), o = l, !0) : !1 } }(), getToolTipDiv: function () { if (!$p) { $p = Rl(), _m = Rl(); var x = $p.style; m.baseZIndex != l && (x.zIndex = n(m.baseZIndex) + 3 + ""), x.whiteSpace = "nowrap", x.color = m.toolTipLabelColor, x.background = m.toolTipBackground, x.font = m.toolTipLabelFont, x.padding = "5px", x.boxShadow = "0px 0px 3px " + m.toolTipShadowColor } return $p }, isToolTipShowing: function () { return $p && $p.parentNode ? !0 : _m && _m.parentNode ? !0 : !1 }, hideToolTip: function () { Ng($p), Ng(_m), Pn() }, showToolTip: function (G, Y) { if (!G || Y == l) return ce(), void 0; m.getToolTipDiv(); var z, O; if (Y.html ? (Y = Y.html, z = _m, Ng($p)) : (z = $p, Ng(_m)), O = z.style, z.innerHTML = Y, z.parentNode || R.Default.appendToScreen(z), G.target) { G = mn(G); var Z = Mk(), H = G.x, N = G.y, E = P ? 60 : 12; if (P) { var e = z.getBoundingClientRect(); O.left = H - e.width / 2 + $k, O.top = N - e.height - E < Z.top ? N + E + $k : N - e.height - E + $k } else { O.left = H + E + $k, O.top = N + E + $k; var e = z.getBoundingClientRect(); e.left + e.width > Z.width && (O.left = H - E - e.width + $k), e.top + e.height > Z.height && (O.top = N - E - e.height + $k), e.left < 0 && (O.left = H + E + $k), e.top < 0 && (O.top = N + E + $k) } } else O.left = G.x + $k, O.top = G.y + $k; Pn() }, startDragging: function (i, E) { i !== Ib && (Ib ? P ? Ib.handleWindowTouchEnd(E) : Ib.handleWindowMouseUp(E) : P ? (y.addEventListener(Sp, md, !1), y.addEventListener(Dc, mb, !1)) : (y.addEventListener(bm, go, !1), y.addEventListener(Pb, Jl, !1)), Ib = i) }, getImageMap: function () { return Uc }, toBoundaries: function (C, l, s, c) { var y = []; return di(C, l, s, c).forEach(function (M) { var z = []; M.forEach(function (W) { z.push(W.x, W.y) }), y.push(z) }), y }, getCurrentKeyCodeMap: function () { return Ne }, drawCenterImage: function (F, X, V, P, U, o, y, $) { var O = nq(X, U, o), b = Jf(X, U, o); mp(F, X, L(V - O / 2), L(P - b / 2), O, b, U, o, y, $) }, drawStretchImage: function (B, Z, o, S, P, u, r, z, i, G, a, h) { var I, M = nq(Z, z, i, u), E = Jf(Z, z, i, r); if ("uniform" === o ? (I = b(u / M, r / E), M *= I, E *= I, S += L((u - M) / 2), P += L((r - E) / 2), u = M, r = E) : "centerUniform" === o && ((M > u || E > r) && (I = b(u / M, r / E), M *= I, E *= I), S += L((u - M) / 2), P += L((r - E) / 2), u = M, r = E), "center" === o) { var T = a !== !1 && (M > u || E > r); T && (B.save(), B.beginPath(), B.rect(S, P, u, r), B.clip()), mp(B, Z, S + u / 2 - M / 2, P + r / 2 - E / 2, M, E, z, i, G, h), T && B.restore() } else mp(B, Z, S, P, u, r, z, i, G, h) }, toCanvas: function (f, b, z, v, D, s, r, B, C) { f = yj(f, r), b = b || nq(f, D), z = z || Jf(f, D); var N = sc(), w = nr(N); return B ? (co(N, b, z, B), w.scale(B, B)) : co(N, b, z, 1), ff(w, f, v, 0, 0, b, z, D, s, r, C), w.restore(), N }, createElement: function (U, t, c, r) { var J = i.createElement(U); return Jq(J, t || d.widgetBorder, 2), J.style.font = c ? c : Ek, r != l && (J.value = r), m.onElementCreated && m.onElementCreated(J), J }, containedInView: function (U, R) { var K = wd(R).getBoundingClientRect(); return lg({ x: K.left, y: K.top, width: K.width, height: K.height }, gi(U)) }, isIsolating: function () { return Zk }, setIsolating: function (w) { Zk = w }, getMSMap: function () { return Xc }, stringify: function (w, c) { var X = Date.prototype.toJSON; Date.prototype.toJSON = function () { return "__ht__date" + this.getTime() }; var R = JSON.stringify(w, function (t, $) { return "function" == typeof $ ? "__ht__" + ($.__ht__ || $.toString()) : Gr($) ? yc($) : $ }, c == l ? 2 : c); return Date.prototype.toJSON = X, R }, parse: function (N) { return Yc(N) ? JSON.parse(N, function (g, f) { if (Yc(f)) { if ("__ht__function" == f.substr(0, 14)) { var a = f.indexOf("{") + 1, J = f.lastIndexOf("}"), $ = f.indexOf("(") + 1, d = f.indexOf(")"); if (a && J && $ && d) { var _ = new Function(f.substring($, d), f.substring(a, J)); return _.__ht__ = f.substr(6), _ } } if ("__ht__date" == f.substr(0, 10)) return new Date(n(f.substr(10))) } return f }) : N }, loadJS: function (H, s) { s && H.push(s); var B = H.shift(); if (sp(B)) H = B.contact(H), m.loadJS(H); else if (Nf(B)) B(), m.loadJS(H); else if (Yc(B)) { var K = i.createElement("script"); K.onload = function () { m.loadJS(H) }, K.setAttribute("src", B), i.getElementsByTagName("head")[0].appendChild(K) } else H.length && m.loadJS(H) }, toRoundedCorner: function (H, y) {
                var B = H.size(); if (0 >= y) return { points: H }; var s, K = new Ul, c = new Ul, m = H.get(0); K.add(m), c.add(1); for (var l = 1; B > l; l++)if (B > l + 1) {
                    var x = H.get(l), _ = H.get(l + 1), v = m.x, F = m.y, d = x.x, i = x.y, w = i - F, V = d - v, J = I(w, V); s = b(.99 * Bk(m, x), y), K.add({ x: d - s * S(J), y: i - s * t(J) }), K.add(x), v = x.x, F = x.y, d = _.x, i = _.y, w = i - F, V = d - v, J = I(w, V), s = b(.99 * Bk(x, _), y), m = { x: v + s * S(J), y: F + s * t(J) }, K.add(m), c.addAll([2, 3])
                } else K.add(H.get(l)), c.add(2); return { points: K, segments: c }
            }, toColorData: vg, setCanvas: co, createDiv: Rl, createDisabledDiv: jm, createView: ii, createCanvas: sc, appendChild: hq, initContext: nr, checkLoadingImage: Eh, translateAndScale: Rr, layout: Up, getPosition: $e, drawPoints: vq, drawRoundRect: Bc, drawBorder: Ei, setFocus: Cq, getter: gf, setter: El, isEmptyObject: Bm
        }, !0), _i(u, { autoAdjustIndex: 1, hierarchicalRendering: 1, adjustChildrenToTop: 1, autoHideScrollBar: 1, autoUpdate: 1, firstPersonMode: 1, ortho: 1, strict: 1, stickToRight: 1, instant: 1, closePath: 1, hierarchical: 1, doubleClickToToggle: 1, continuousLayout: 1, syncSize: 1 }, !0); var cp = m.disabledOpacity, Sl = m.toolTipDelay, Sm = m.devicePixelRatio, wf = m.autoMakeVisible, Sg = m.autoHideScrollBar, $m = m.imageGradient, Rp = m.showToolTip, ce = m.hideToolTip, Ki = m.dashPattern, ji = m.lineCap, Xq = m.lineJoin, xn = m.labelColor, _c = m.labelSelectColor, Ek = m.labelFont, tg = m.widgetIndent, dp = m.widgetRowHeight, Fg = m.widgetHeaderHeight, gh = m.widgetTitleHeight, tb = m.scrollBarColor, Nr = m.scrollBarSize, qe = m.scrollBarTimeout, Ye = m.scrollBarMinLength, Ac = m.scrollBarInteractiveSize, kb = m.zoomIncrement, ln = m.scrollZoomIncrement, Mp = m.pinchZoomIncrement, Kf = m.zoomMax, Li = m.zoomMin, Jc = m.createObject, np = m.preventDefault, uk = m.setImage, yj = m.getImage, Tp = m.drawCenterImage, ff = m.drawStretchImage, Rh = m.getId, iq = m.callLater, Tl = m.asyncEach, Bl = (m.xhrLoad, m.sortFunc), Ln = m.clone, Vr = m.getClass, _g = m.startAnim, ke = m.brighter, kl = m.darker, ho = m.drawText, Nm = m.getTextSize, Vg = m.isLeftButton, Ak = m.getTouchCount, Si = m.isDoubleClick, Qd = m.isShiftDown, ec = m.isCtrlDown, gi = m.getClientPoint, mn = m.getPagePoint, Bk = m.getDistance, eb = m.unionPoint, rm = m.unionRect, lg = m.containsPoint, dj = m.containsRect, Hi = m.intersectsRect, gb = m.intersection, Mk = m.getWindowInfo, Bb = m.grow, mj = m.getLogicalPoint, Af = m.startDragging, Ng = m.removeHTML, oo = m.createElement, zk = m.segmentResolution, ob = m.shapeResolution, gk = m.shapeSide, uo = m.def, Df = function (w, F, j) { uo(K + "." + w, F, j) }, wh = function (b, D) { b.childNodes.forEach(function (C) { D(C), wh(C, D) }) }; _i(m, { toolTipLabelColor: xn, toolTipLabelFont: Ek, toolTipBackground: d.toolTipBackground, toolTipShadowColor: kc, setDevicePixelRatio: function (W) { Sm = m.devicePixelRatio = "number" == typeof W ? W : y.devicePixelRatio, wh(i.body, function (R) { var j = R._ht; j && j._canvas && (co(j._canvas, j.getWidth(), j.getHeight()), j.redraw ? j.redraw() : j.iv()) }) } }, !0); var Rc = 1e-6, mh = "undefined" != typeof Uint16Array ? Uint16Array : Array, ub = "undefined" != typeof Float32Array ? Float32Array : Array, gs = function (S, t, J) { var a = [S[0] - t[0], S[1] - t[1], S[2] - t[2]]; if (J) { var W = Bk(a); W > 0 && (a[0] /= W, a[1] /= W, a[2] /= W) } return a }, vb = function (l) { return [-l[0], -l[1], -l[2]] }, Wl = function (E, H) { return 3 === E.length ? E[0] * H[0] + E[1] * H[1] + E[2] * H[2] : E[0] * H[0] + E[1] * H[1] }, Nq = function () { var r = new ub(16); return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r }, hi = Nq(), sr = function (b) { var P = new ub(16); return P[0] = b[0], P[1] = b[1], P[2] = b[2], P[3] = b[3], P[4] = b[4], P[5] = b[5], P[6] = b[6], P[7] = b[7], P[8] = b[8], P[9] = b[9], P[10] = b[10], P[11] = b[11], P[12] = b[12], P[13] = b[13], P[14] = b[14], P[15] = b[15], P }, Uk = function (a, c) { return a[0] = c[0], a[1] = c[1], a[2] = c[2], a[3] = c[3], a[4] = c[4], a[5] = c[5], a[6] = c[6], a[7] = c[7], a[8] = c[8], a[9] = c[9], a[10] = c[10], a[11] = c[11], a[12] = c[12], a[13] = c[13], a[14] = c[14], a[15] = c[15], a }, Se = function (b) { return b[0] = 1, b[1] = 0, b[2] = 0, b[3] = 0, b[4] = 0, b[5] = 1, b[6] = 0, b[7] = 0, b[8] = 0, b[9] = 0, b[10] = 1, b[11] = 0, b[12] = 0, b[13] = 0, b[14] = 0, b[15] = 1, b }, Me = function (w, o) { var d = w[0], S = w[1], V = w[2]; return w[0] = o[0] * d + o[4] * S + o[8] * V + o[12], w[1] = o[1] * d + o[5] * S + o[9] * V + o[13], w[2] = o[2] * d + o[6] * S + o[10] * V + o[14], w }, Bf = function (L, b) { var r = L[0], D = L[1], Q = L[2], x = L[3]; return L[0] = b[0] * r + b[4] * D + b[8] * Q + b[12] * x, L[1] = b[1] * r + b[5] * D + b[9] * Q + b[13] * x, L[2] = b[2] * r + b[6] * D + b[10] * Q + b[14] * x, L[3] = b[3] * r + b[7] * D + b[11] * Q + b[15] * x, L }, Mr = function () { var I, n, b, q, e = kr(xh[1] + xh[7]), x = kr(xh[0] + xh[3] - xh[10]), u = kr(xh[8] + 2), P = function () { return n = b.charAt(I), I += 1, n }, V = function () { var I = ""; if (n === u) for (; P();) { if (n === u) return P(), I; I += n } else P() }, U = function () { for (; n && " " >= n;)P() }, X = function () { var N, I = {}; if (n === e) { if (P(), U(), n === x) return P(), I; for (; n;) { if (N = V(), U(), P(), I[N] = q(), U(), n === x) return P(), I; P(), U() } } }; return q = function () { switch (U(), n) { case e: return X(); default: return V() } }, function (Q) { if (W = {}, Q) { var R; if (b = Q, I = 0, n = " ", R = q(), U(), !n) return R } } }(), gg = function (K, x) { if (x) { var Z = t(x), T = S(x), B = K[4], h = K[5], f = K[6], L = K[7], m = K[8], M = K[9], I = K[10], a = K[11]; K[4] = B * T + m * Z, K[5] = h * T + M * Z, K[6] = f * T + I * Z, K[7] = L * T + a * Z, K[8] = m * T - B * Z, K[9] = M * T - h * Z, K[10] = I * T - f * Z, K[11] = a * T - L * Z } }, jn = function (G, J) { if (J) { var V = t(J), F = S(J), u = G[0], N = G[1], z = G[2], _ = G[3], m = G[8], D = G[9], M = G[10], U = G[11]; G[0] = u * F - m * V, G[1] = N * F - D * V, G[2] = z * F - M * V, G[3] = _ * F - U * V, G[8] = u * V + m * F, G[9] = N * V + D * F, G[10] = z * V + M * F, G[11] = _ * V + U * F } }, Vh = function (e, k) { if (k) { var L = t(k), B = S(k), G = e[0], R = e[1], E = e[2], j = e[3], s = e[4], N = e[5], Q = e[6], l = e[7]; e[0] = G * B + s * L, e[1] = R * B + N * L, e[2] = E * B + Q * L, e[3] = j * B + l * L, e[4] = s * B - G * L, e[5] = N * B - R * L, e[6] = Q * B - E * L, e[7] = l * B - j * L } }, wo = function (H, A, U) { return no(l, U === !1 ? l : H.s3(), H.r3(), H.getRotationMode(), H.p3(), l, A) }, no = function (c, V, z, Z, a, K, i) { return K || (K = Nq()), a && Gq(K, a), bi(K, z, Z), i && ri(K, K, i), V && Fj(K, V), c && ri(K, K, c), K }, mm = function (u, I, v) { I = n(I), v = n(v); var i = this; i.g = u, i._84O = I, i._85O = v, i._70I = !0, i.F = 0, i._83O = I + v, i.pen = { x: 0, y: 0 } }, Pi = "lineDashOffset", Di = "setLineDash", De = function (H) { for (var v in H) 1 === v.length && (Pi = H[v]); return v ? 1 : 0 }, Ur = function (e, D, S) { return xo(D) ? e : e[Di] ? (e[Di](D), S && (e.lineDashOffset = S), e) : new mm(e, D[0], D.length > 1 ? D[1] : D[0]) }, up = function (Z, $) { !xo($) && Z[Di] && (Z[Di](Ih), Z.lineDashOffset = 0) }; if (uo(mm, F, { _69I: 6, moveTo: function (A, S) { var l = this, m = l.pen; m.x = A, m.y = S, l.g.moveTo(A, S), l.start || (l.start = { x: A, y: S }) }, lineTo: function (F, H) { var n = this, Y = n.pen, M = F - Y.x, q = H - Y.y, z = I(q, M), C = S(z), b = t(z), c = n._23O(Y.x, Y.y, F, H), g = n._85O, r = n._84O, v = n._83O; if (n.F) { if (n.F > c) return n._70I ? n._72I(F, H) : n.moveTo(F, H), n.F -= c, void 0; if (n._70I ? n._72I(Y.x + C * n.F, Y.y + b * n.F) : n.moveTo(Y.x + C * n.F, Y.y + b * n.F), c -= n.F, n.F = 0, n._70I = !n._70I, !c) return } var J = G(c / v); if (J) { for (var $ = C * r, N = b * r, k = C * g, T = b * g, e = 0; J > e; e++)n._70I ? (n._72I(Y.x + $, Y.y + N), n.moveTo(Y.x + k, Y.y + T)) : (n.moveTo(Y.x + k, Y.y + T), n._72I(Y.x + $, Y.y + N)); c -= v * J } n._70I ? c > r ? (n._72I(Y.x + C * r, Y.y + b * r), n.moveTo(F, H), n.F = g - (c - r), n._70I = !1) : (n._72I(F, H), c === r ? (n.F = 0, n._70I = !n._70I) : (n.F = r - c, n.moveTo(F, H))) : c > g ? (n.moveTo(Y.x + C * g, Y.y + b * g), n._72I(F, H), n.F = r - (c - g), n._70I = !0) : (n.moveTo(F, H), c === g ? (n.F = 0, n._70I = !n._70I) : n.F = g - c) }, quadraticCurveTo: function (h, u, C, D) { var q, j = this, o = j.pen, B = o.x, E = o.y, i = j._22O(B, E, h, u, C, D), U = 0, I = 0, s = j._85O, b = j._84O; if (j.F) { if (j.F > i) return j._70I ? j._71I(h, u, C, D) : j.moveTo(C, D), j.F -= i, void 0; if (U = j.F / i, q = j._20O(B, E, h, u, C, D, U), j._70I ? j._71I(q[2], q[3], q[4], q[5]) : j.moveTo(q[4], q[5]), j.F = 0, j._70I = !j._70I, !i) return } var K = i - i * U, c = G(K / j._83O), $ = b / i, x = s / i; if (c) for (var H = 0; c > H; H++)j._70I ? (I = U + $, q = j._21O(B, E, h, u, C, D, U, I), j._71I(q[2], q[3], q[4], q[5]), U = I, I = U + x, q = j._21O(B, E, h, u, C, D, U, I), j.moveTo(q[4], q[5])) : (I = U + x, q = j._21O(B, E, h, u, C, D, U, I), j.moveTo(q[4], q[5]), U = I, I = U + $, q = j._21O(B, E, h, u, C, D, U, I), j._71I(q[2], q[3], q[4], q[5])), U = I; K = i - i * U, j._70I ? K > b ? (I = U + $, q = j._21O(B, E, h, u, C, D, U, I), j._71I(q[2], q[3], q[4], q[5]), j.moveTo(C, D), j.F = s - (K - b), j._70I = !1) : (q = j._19O(B, E, h, u, C, D, U), j._71I(q[2], q[3], q[4], q[5]), i === b ? (j.F = 0, j._70I = !j._70I) : (j.F = b - K, j.moveTo(C, D))) : K > s ? (I = U + x, q = j._21O(B, E, h, u, C, D, U, I), j.moveTo(q[4], q[5]), q = j._19O(B, E, h, u, C, D, I), j._71I(q[2], q[3], q[4], q[5]), j.F = b - (K - s), j._70I = !0) : (j.moveTo(C, D), K === s ? (j.F = 0, j._70I = !j._70I) : j.F = s - K) }, bezierCurveTo: function () { var b = arguments; this.pen = { x: b[4], y: b[5] }, this.g.bezierCurveTo(b[0], b[1], b[2], b[3], b[4], b[5]) }, arc: function (F, B, O, s, j, A) { A || (s = -s, j = -j), Oi(this, F, B, s, j - s, O, O, !1) }, rect: function (H, c, i, N) { var l = this; l.pen = { x: H, y: c }, l.moveTo(H, c), l.lineTo(H, c + N), l.lineTo(H + i, c + N), l.lineTo(H + i, c), l.lineTo(H, c) }, beginPath: function () { this.g.beginPath() }, closePath: function () { this.lineTo(this.start.x, this.start.y) }, _23O: function (K, Z, B, _) { var T = B - K, n = _ - Z; return o(T * T + n * n) }, _22O: function (G, F, p, $, A, I, d) { for (var b, S, V, j, E, C, q, k = 0, m = G, U = F, W = d > 0 ? d : this._69I, P = 1; W >= P; P++)V = P / W, j = 1 - V, E = j * j, C = 2 * V * j, q = V * V, b = E * G + C * p + q * A, S = E * F + C * $ + q * I, k += this._23O(m, U, b, S), m = b, U = S; return k }, _21O: function (s, K, O, M, X, n, S, Q) { var Z = this; if (0 === S) return Z._20O(s, K, O, M, X, n, Q); if (1 === Q) return Z._19O(s, K, O, M, X, n, S); var C = Z._20O(s, K, O, M, X, n, Q); return C.push(S / Q), Z._19O.apply(Z, C) }, _20O: function (s, k, X, j, m, M, b) { if (1 !== b) { var D = X + (m - X) * b, d = j + (M - j) * b; X = s + (X - s) * b, j = k + (j - k) * b, m = X + (D - X) * b, M = j + (d - j) * b } return [s, k, X, j, m, M] }, _19O: function (m, x, W, i, S, t, L) { if (1 !== L) { var F = m + (W - m) * L, E = x + (i - x) * L; W += (S - W) * L, i += (t - i) * L, m = F + (W - F) * L, x = E + (i - E) * L } return [m, x, W, i, S, t] }, _72I: function (c, b) { var r = this.pen; (c !== r.x || b !== r.y) && (r.x = c, r.y = b, this.g.lineTo(c, b)) }, _71I: function (r, E, H, I) { var n = this.pen; (r !== H || E !== I || H !== n.x || I !== n.y) && (n.x = H, n.y = I, this.g.quadraticCurveTo(r, E, H, I)) } }), O && V) { var qj = V.toString(); j = qj.indexOf(Yq.substr(0, 2)) > 0 && qj.indexOf(ys + ys.substr(1, 1)) > 1 ? !0 : !1 } var mk = l, Nj = l, Km = function (L) { mk && !L._72O && (Nj || (Nj = {}), Nj[L._72O = Rh()] = L) }, yo = function (A, r) { if (r || (r = A), r && (mk || (mk = {}), !mk[A])) { var C = new XMLHttpRequest; if (mk[r] = { request: C, url: r }, C.overrideMimeType("text/plain"), r = m.beforeLoadURL(r), r.data) { var P = m.parse(r.data); ig(A, P), m.handleCompTypeLoaded(A, P) } else C.open("GET", encodeURI(r), !0), C.onload = function (s) { if (200 === this.status || 0 === this.status) { var p = m.parse(s.target.response); ig(A, p), m.handleCompTypeLoaded(A, p) } else ig(A, l) }, C.onerror = function () { ig(A, l) }, C.send(null) } }, ig = function (E, _) { if (Nh[E] = _, delete mk[E], Bm(mk) && (mk = l, Nj)) { for (var f in Nj) { var i = Nj[f]; i.invalidateAll && i.invalidateAll(Z, "compTypeLoaded", E), i.redraw && i.redraw(), i.iv(), delete i._72O } Nj = l } if (_ && Nj) for (var f in Nj) { var i = Nj[f]; i.invalidateAll && i.invalidateAll(Z, "compTypeLoading", E), i.redraw && i.redraw(), i.iv() } }, Vd = d.chart, Op = m.compStack = [], Ke = /^style@/, tj = /^attr@/, fi = /^field@/, oc = { x: .5, y: .5 }, nq = function (e, R, I, i) { if (!e) return 0; if (e.fitSize && i) return i; var H = oi(e.width, R, I); return null == H ? 20 : H }, Jf = function (d, J, H, m) { if (!d) return 0; if (d.fitSize && m) return m; var n = oi(d.height, J, H); return null == n ? 20 : n }, oi = function (N, i, F) { if (!N || !N.func) return N; var U, j = N.func, w = N.value; return U = Nf(j) ? F && F.vectorDataBindingDisabled && !N.isSafeFunc ? w : j(i, F) : i instanceof Zl ? tj.test(j) ? i.a(j.slice(5)) : Ke.test(j) ? i.s(j.slice(6)) : fi.test(j) ? i[j.slice(6)] : i[j] ? i[j](F) : w : w, w !== Z && U == l ? w : U }, mp = m.drawImage = function () { var R, W, n, a, o, N, Y = function (K, v) { K.getValue && K.getValue.compType === v || (K.getValue = function (W) { var H = s(K, W); if (H === Z && v.properties) { var f = v.properties[W]; f && (H = f.defaultValue) } return H }, K.getValue.compType = v) }, s = function (C, L, m) { var F = C[L]; return F && F.func ? (F = oi(F, W, n), m && (F = m(F))) : m && (F = C[L] = m(F)), F }, O = function (x, A) { var I; if (I = A ? s(x, A) : x, o && I) { if ("override" === N) return o; if ("override_rgb" === N) { var W = db(o); return I = vg(I), "rgba(" + G(255 * W[0]) + "," + G(255 * W[1]) + "," + G(255 * W[2]) + "," + I[3] / 255 + ")" } if ("override_a" === N) { var W = db(o); return I = vg(I), "rgba(" + I[0] + "," + I[1] + "," + I[2] + "," + W[3] + ")" } var W = db(o); return I = vg(I), "rgba(" + G(I[0] * W[0]) + "," + G(I[1] * W[1]) + "," + G(I[2] * W[2]) + "," + I[3] / 255 * W[3] + ")" } return I }, j = function (O) { if (sp(O)) { for (var c = new Ul, P = O.length, l = 0; P > l; l += 2)c.add({ x: O[l], y: O[l + 1] }); O = c } return O }, Q = function (R) { var P = s(R, "anchorX"), $ = s(R, "anchorY"); if (P !== Z || $ !== Z) return { x: P === Z ? oc.x : P, y: $ === Z ? oc.y : $ }; var e = s(R, "type"), b = s(R, "name"); if ("image" !== e || !b) return oc; var D = yj(b); return D && D.anchorX && D.anchorY ? { x: D.anchorX, y: D.anchorY } : oc }, M = function (f, X) { var g = s(f, vd), O = Q(f); if (sp(g)) { var d = g.length, A = s(f, "relative"), z = X.width, e = X.height; if (4 === d) g = { x: g[0], y: g[1], width: g[2], height: g[3] }, A ? (g.x *= z, g.y *= e, g.width *= z, g.height *= e) : X.fitSize && (g.x *= X.widthScale, g.width *= X.widthScale, g.y *= X.heightScale, g.height *= X.heightScale); else if (3 === d) { var G = g[0]; g = { width: g[1], height: g[2] }, A ? (g.width *= z, g.height *= e) : X.fitSize && (g.width *= X.widthScale, g.height *= X.heightScale), "object" == typeof G ? G.length && (G = { x: G[0], y: G[1] }) : G = $e(G, X, g), g.x = G.x - g.width * O.x, g.y = G.y - g.height * O.y } var c = s(f, "offsetX"); c && (X.fitSize && (c *= X.widthScale), g.x += c), c = s(f, "offsetY"), c && (X.fitSize && (c *= X.heightScale), g.y += c) } return g }, T = function (F) { return sp(F) ? new Ul(F) : F }, u = function (o, Y, w, T, f, p, e) { f === Z && (f = 1), p === Z && (p = 1); var B = s(o, "clipPercentage"), b = ns(w, Y); if (b && !T && 1 === f && 1 === p && !(1 > B)) return !1; e = e || oc; var P = Y.x + Y.width * e.x, v = Y.y + Y.height * e.y, E = w.x + w.width * e.x, A = w.y + w.height * e.y; if (R.save(), bo(R, P, v), Nc(R, T), qg(R, f * (Y.width / w.width), p * (Y.height / w.height)), bo(R, -E, -A), 1 > B) { 0 > B && (B = 0); var i = lj(w, s(o, "clipDirection"), B); R.beginPath(), R.rect(i.x, i.y, i.width, i.height), R.clip() } return !0 }, K = function () { R.restore() }, D = function (d, g, v) { var C = s(d, "path"), o = s(d, sf), q = s(d, "scaleX"), J = s(d, "scaleY"), N = Q(d), V = l, $ = bp(null, C); if (v || (v = d.unionRect, v || (v = eb($), d.path.func || (d.unionRect = v)), V = v), v) { V || (V = d.unionRect, V || (V = eb($), d.path.func || (d.unionRect = V))); var A = u(d, v, V, o, q, J, N), U = s(d, "borderPattern"), P = Ur(R, U), L = O(d, "background"), c = O(d, "borderColor"), b = s(d, "borderWidth"), S = s(d, "gradient"), z = O(d, "gradientColor"), W = s(d, "border3d"), h = s(d, "border3dColor"), I = s(d, "border3dAccuracy"), i = R.lineJoin, F = R.lineCap; if (R.lineJoin = s(d, "borderJoin") || Xq, R.lineCap = s(d, "borderCap") || ji, L ? (cm(R, L, S, z, V), bp(R, C), R.fill(), P !== R && bp(R, C)) : bp(R, C), b && c) { var G = s(d, "borderWidthAbsolute"); G && (R.save(), R.setTransform(1, 0, 0, 1, 0, 0)), R.lineWidth = b, R.strokeStyle = c, R.stroke(), G && R.restore(), W && Zb(R, c, h, b, a, I) } if (up(R, U), s(d, "dash")) { var B = s(d, "dashWidth") || b; if (B > 0) { U = s(d, "dashPattern") || Ki; var P = Ur(R, U, s(d, "dashOffset")), m = O(d, "dashColor") || O(Cd); P !== R && bp(R, C), R.strokeStyle = m, R.lineWidth = B, R.stroke(), s(d, "dash3d") && Zb(R, m, O(d, "dash3dColor"), B, a, s(d, "dash3dAccuracy")), up(R, U) } } g === vd && os(R, L, s(d, "depth"), V), R.lineJoin = i, R.lineCap = F, A && K() } }, V = function (b, J, p, v) { var k = s(b, fg, j), x = s(b, sf), D = Q(b); if (k && v.fitSize) { var B = Math.abs(Math.cos(x)) < .001, Y = new Ul, i = eb(k), M = v.widthScale, e = v.heightScale, c = i.x + D.x * i.width, H = i.y + D.y * i.height, w = c * M, I = H * e; k.each(function (V) { var K = V.x - c, s = V.y - H; Y.add({ x: w + K * (B ? e : M), y: I + s * (B ? M : e) }) }), k = Y, b.unionRect = null } var F = s(b, "scaleX"), m = s(b, "scaleY"), S = J === mi, $ = l; if (!p && S && (p = b.unionRect, p || (p = eb(k), b.points.func || (b.unionRect = p)), $ = p), p) { S ? $ || ($ = b.unionRect, $ || ($ = eb(k), b.points.func || (b.unionRect = $))) : $ = p; var z, C, U, q, g = u(b, p, $, x, F, m, D), A = s(b, "borderPattern"), P = Ur(R, A), V = O(b, "background"), f = yj(s(b, "repeatImage"), o, N), L = s(b, "gradientPack"), y = O(b, "borderColor"), Z = s(b, "borderWidth"), h = s(b, "segments", T), r = s(b, "gradient"), E = O(b, "gradientColor"), t = s(b, "border3d"), G = s(b, "border3dColor"), X = s(b, "border3dAccuracy"), d = s(b, "closePath"), _ = s(b, "fillRule") || "nonzero", Lj = R.lineJoin, Pq = R.lineCap; if (R.lineJoin = s(b, "borderJoin") || Xq, R.lineCap = s(b, "borderCap") || ji, S) if (V || f || L) { var Nm = s(b, "fillClipPercentage"); if (1 > Nm) { 0 > Nm && (Nm = 0); var zg = lj($, s(b, "fillClipDirection"), Nm); R.save(), R.beginPath(), R.rect(zg.x, zg.y, zg.width, zg.height), R.clip() } if (vq(R, k, h, d), L) qn(R, L); else if (f) { var ff = R, xp = o, Po = N; Im(R, f, o, N, W, n), R = ff, o = xp, N = Po } else { var ff = R; cm(R, V, r, E, $), R = ff } R.fill(_), 1 > Nm && R.restore(), L && R.restore(), P !== R && vq(P, k, h, d) } else vq(P, k, h, d); else if ("roundRect" === J ? z = s(b, "cornerRadius") : "polygon" === J ? z = s(b, "polygonSide") : "arc" === J && (z = s(b, "arcFrom"), C = s(b, "arcTo"), U = s(b, "arcClose"), q = s(b, "arcOval")), V || f || L) { var Nm = s(b, "fillClipPercentage"); if (1 > Nm) { 0 > Nm && (Nm = 0); var zg = lj($, s(b, "fillClipDirection"), Nm); R.save(), R.beginPath(), R.rect(zg.x, zg.y, zg.width, zg.height), R.clip() } if (Ep(R, J, $, z, C, U, q), L) qn(R, L); else if (f) { var ff = R, xp = o, Po = N; Im(R, f, o, N, W, n), R = ff, o = xp, N = Po } else cm(R, V, r, E, $); R.fill(_), 1 > Nm && R.restore(), L && R.restore(), R !== P && Ep(P, J, $, z, C, U, q) } else Ep(P, J, $, z, C, U, q); if (Z && y) { var po = s(b, "borderWidthAbsolute"); po && (R.save(), R.setTransform(1, 0, 0, 1, 0, 0)), R.lineWidth = Z, R.strokeStyle = y, R.stroke(), po && R.restore(), t && Zb(R, y, G, Z, a, X) } if (up(R, A), s(b, "dash")) { var pr = s(b, "dashWidth") || Z; if (pr > 0) { A = s(b, "dashPattern") || Ki; var P = Ur(R, A, s(b, "dashOffset")), ws = O(b, "dashColor") || O(Cd); P !== R && (S ? vq(P, k, h, d) : Ep(P, J, $, z, C, U, q)), R.strokeStyle = ws, R.lineWidth = pr, R.stroke(), s(b, "dash3d") && Zb(R, ws, O(b, "dash3dColor"), pr, a, s(b, "dash3dAccuracy")), up(R, A) } } J === vd && os(R, V, s(b, "depth"), $), R.lineJoin = Lj, R.lineCap = Pq, g && K() } }, E = function (q, j) { var Y = o, z = N, A = o || s(q, rh), g = N || s(q, "blendMode"), u = yj(s(q, "name"), A, g); u && (ff(R, u, s(q, "stretch"), j.x, j.y, j.width, j.height, W, n, A, null, g), o = Y, N = z) }, F = function (F, k) { var j = s(F, "text"); j != l && ho(R, j, s(F, "font"), O(F, rh), k.x, k.y, k.width, k.height, s(F, "align"), s(F, "vAlign")) }, _ = function (C, M) { Ei(R, O(C, rh), M.x, M.y, M.width, M.height, s(C, "width")) }, X = function (o, U) { var Q = s(o, Ri), v = 0; if (Q && (Q.forEach(function (V) { v += V }), v > 0)) { for (var a = s(o, "colors") || Vd, e = s(o, "startAngle") || 0, V = s(o, "hollow"), K = s(o, Sc), u = s(o, Fd), z = s(o, od), F = K ? new Ul : l, G = U.x, g = U.y, E = U.width, f = U.height, d = G + E / 2, y = g + f / 2, T = b(E, f) / 2, H = 0, k = 0; k < Q.length; k++) { var Y = Q[k], j = B * Y / v, q = e + j; if (R.fillStyle = a[H++], H === a.length && (H = 0), R.beginPath(), V) { var Z = d + S(e) * T / 2, i = y + t(e) * T / 2, N = d + S(q) * T, L = y + t(q) * T; R.moveTo(Z, i), R.arc(d, y, T / 2, e, q, !1), R.lineTo(N, L), R.arc(d, y, T, q, e, !0) } else R.moveTo(d, y), R.arc(d, y, T, q, e, !0); F && (j = (e + q) / 2, F.add({ text: Nf(K) ? K(Y, k, v, W) : Y, x: d + .75 * S(j) * T, y: y + .75 * t(j) * T })), R.closePath(), R.fill(), e = q } F && F.each(function (k) { ho(R, k.text, u, z, k.x, k.y, 0, 0, vr) }) } }, r = function (L, i) { var u = s(L, ll); if (u && u.length > 0) { var q = u.length, M = s(L, Sc), N = s(L, Fd), v = s(L, od), $ = M ? new Ul : l, J = s(L, "minValue") || 0, P = s(L, "maxValue"); if (P == l && (P = 0, u.forEach(function (u) { u.values.forEach(function (A) { P = g(P, A) }) })), J === P) return; for (var d = i.height / (P - J), e = i.y + P * d, K = s(u[0], Ri).length, T = i.width / (3 * K + 1), I = 2 * T / q, X = 0, n = 0; q > n; n++)for (var C = u[n], D = s(C, rh), B = s(C, "colors"), b = s(C, Ri), c = 0; K > c; c++) { B ? R.fillStyle = B[c] : D ? R.fillStyle = D : (R.fillStyle = Vd[X++], X === Vd.length && (X = 0)); var Z = b[c], f = Z * d, w = i.x + (1 + 3 * c) * T + n * I; if (qo(R, w, e - f, I, f), $) { var p = Nf(M) ? M(Z, c, C, W) : Z, Y = Nm(N, p).height; $.add({ x: w, y: e - f - Y, width: I, height: Y, text: p }) } } $ && $.each(function (H) { ho(R, H.text, N, v, H.x, H.y, H.width, H.height, vr) }) } }, C = function (S, P) { var C = s(S, ll); if (C && C.length > 0) { var v = C.length, m = s(C[0], Ri).length, t = P.width / (3 * m + 1), h = 0, j = s(S, "maxValue"), q = s(S, Sc), J = s(S, Fd), O = s(S, od), d = q ? new Ul : l; if (j == l) { j = 0; for (var G = 0; m > G; G++) { for (var o = 0, $ = 0; v > $; $++)o += s(C[$], Ri)[G]; j = g(j, o) } } if (j > 0) { for (var G = 0; m > G; G++)for (var u = P.y + P.height, $ = 0; v > $; $++) { var F = C[$], p = s(F, rh), e = s(F, Ri)[G], V = e / j * P.height; p ? R.fillStyle = p : (R.fillStyle = Vd[h++], h === Vd.length && (h = 0)), u -= V; var Y = { x: P.x + (1 + 3 * G) * t, y: u, width: 2 * t, height: V }; qo(R, Y.x, Y.y, Y.width, Y.height), d && (Y.text = Nf(q) ? q(e, G, F, W) : e, d.add(Y)) } d && d.each(function (n) { ho(R, n.text, J, O, n.x, n.y, n.width, n.height, vr) }) } } }, q = function (k, z) { var e = s(k, ll); if (e && e.length > 0) { for (var _ = e.length, h = s(e[0], Ri).length, X = z.width / (3 * h + 1), B = 0, n = s(k, Sc), x = s(k, Fd), q = s(k, od), j = n ? new Ul : l, d = 0; h > d; d++) { for (var N = 0, u = 0; _ > u; u++)N += s(e[u], Ri)[d]; if (N > 0) { var w = z.y + z.height; for (u = 0; _ > u; u++) { var O = e[u], A = s(O, rh), t = s(O, Ri)[d], r = t / N * z.height; A ? R.fillStyle = A : (R.fillStyle = Vd[B++], B === Vd.length && (B = 0)), w -= r; var Z = { x: z.x + (1 + 3 * d) * X, y: w, width: 2 * X, height: r }; qo(R, Z.x, Z.y, Z.width, Z.height), j && (Z.text = Nf(n) ? n(t, d, O, W) : t, j.add(Z)) } } } j && j.each(function (n) { ho(R, n.text, x, q, n.x, n.y, n.width, n.height, vr) }) } }, z = function (D, u) { var G = s(D, ll); if (G && G.length > 0) { var H = G.length, Y = s(D, "minValue") || 0, h = s(D, "maxValue"); if (h == l && (h = 0, G.forEach(function (t) { t.values.forEach(function (v) { h = g(h, v) }) })), Y === h) return; for (var E = u.height / (h - Y), S = u.y + h * E, J = s(G[0], Ri).length, _ = u.width / (3 * J + 1), F = 0, C = s(D, "lineWidth") || 2, q = s(D, "line3d"), K = s(D, "linePoint"), k = s(D, Sc), r = s(D, Fd), Q = s(D, od), N = 0; H > N; N++) { var p = G[N], d = s(p, rh), z = s(p, Ri); d ? R.strokeStyle = d : (d = R.strokeStyle = Vd[F++], F === Vd.length && (F = 0)), R.beginPath(); for (var O = 0; J > O; O++) { var c = u.x + (2 + 3 * O) * _, o = S - z[O] * E; 0 === O ? R.moveTo(c, o) : R.lineTo(c, o) } if (R.lineWidth = C, R.stroke(), q && Zb(R, d, l, C, a), K || k) { var L, b = C / 2 + 2; for (O = 0; J > O; O++) { var m = z[O]; if (c = u.x + (2 + 3 * O) * _, o = S - m * E, Nf(K) ? K(R, c, o, d, O, p, W) : K && (R.fillStyle = d, R.beginPath(), R.arc(c, o, b, 0, B, !0), R.fill()), Nf(k) ? L = k(m, O, p, W) : k && (L = m), L) { var x = Nm(r, L).height, n = R.shadowBlur; if (n) { var I = R.shadowOffsetX, y = R.shadowOffsetY, P = R.shadowColor; R.shadowOffsetX = 0, R.shadowOffsetY = 0, R.shadowBlur = 0, R.shadowColor = l } ho(R, L, r, Q, c, o - x - b + 2, 0, x, vr), n && (R.shadowOffsetX = I, R.shadowOffsetY = y, R.shadowBlur = n, R.shadowColor = P) } } } } } }, e = { border: _, image: E, text: F, pieChart: X, columnChart: r, stackedColumnChart: C, percentageColumnChart: q, lineChart: z }; return function (J, _, q, C, t, g, p, I, d, z) { if (_ && t && g) { R = J, W = p, n = I, a = n ? n._zoom ? n._zoom : 1 : 1, o = d, N = z; var y = t, G = g; if (Pl()) { var c, H, E; 0 === R[Wc] ? Pl[0] && (c = !0) : c = !0, R.texureImage2D ? Pl[1] && (H = !0) : H = !0, R.texureImage3D ? Pl[2] && (E = !0) : E = !0, c && H && E && (y = q, G = C) } if (_.tagName) return R.drawImage(_, y, G, t, g), void 0; if (s(_, "visible") !== !1) { o || (o = oi(_.color, W, n)), z || (N = oi(_.blendMode, W, n)); var S = nq(_, W, n, t), i = Jf(_, W, n, g), x = { x: 0, y: 0, width: S, height: i, fitSize: s(_, "fitSize") }, k = s(_, "clip"), U = s(_, "opacity"); x.fitSize && (x.widthScale = S / oi(_.width, W, n), x.heightScale = i / oi(_.height, W, n)), R.save(), bo(R, y, G), (S !== t || i !== g) && R.scale(t / S, g / i), k && (Nf(k) ? k(R, S, i, W, n, _) : (R.beginPath(), R.rect(0, 0, S, i), R.clip())), U != l && (R.globalAlpha *= U), s(_, "comps").forEach(function (U) { if (s(U, ls) !== !1) { Op.splice(0, 0, U); var d = s(U, "opacity"), J = s(U, "shadow"), c = s(U, "type"), i = M(U, x); if (d != l) { var w = R.globalAlpha; R.globalAlpha *= d } if (J) { var g = R.shadowOffsetX, o = R.shadowOffsetY, h = R.shadowBlur, N = R.shadowColor, y = s(U, "shadowOffsetX"), A = s(U, "shadowOffsetY"), P = s(U, "shadowBlur"), _ = O(U, "shadowColor"); R.shadowOffsetX = (y == l ? 3 : y) * a, R.shadowOffsetY = (A == l ? 3 : A) * a, R.shadowBlur = (P == l ? 6 : P) * a, R.shadowColor = _ || O(kc) } if ("save" === c) R.save(); else if ("endClip" === c || "restore" === c) R.restore(); else if ("clip" === c) R.save(), vq(R, s(U, "points", j), s(U, "segments", T), !0), R.clip(); else if (Hn[c]) i = i || { x: 0, y: 0, width: x.width, height: x.height }, V(U, c, i, x); else if (c === mi) V(U, c, i, x); else if ("SVGPath" === c) D(U, c, i); else { i = i || { x: 0, y: 0, width: x.width, height: x.height }; var B = s(U, sf), q = s(U, "scaleX"), v = s(U, "scaleY"), I = Q(U), $ = u(U, i, i, B, q, v, I); if (Nf(c)) Y(U, c), m.drawCompType(c, R, i, U, W, n); else if (m.getCompType(c)) { var G = m.getCompType(c), k = G.func || G; Y(U, G), m.drawCompType(k, R, i, U, W, n) } else e[c] ? e[c](U, i) : m.getCompType(c) === Z && yk.test(c) && yo(c); $ && K() } J && (R.shadowOffsetX = g, R.shadowOffsetY = o, R.shadowBlur = h, R.shadowColor = N), d != l && (R.globalAlpha = w), Op.splice(0, 1) } }), R.restore() } } } }(); m.getCurrentComp = function () { return Op[0] }, m.getParentComp = function () { return Op[1] }, m.getInternal = function () { return { isEnter: Zr, isEsc: ai, isSpace: Pk, isLeft: Qi, isUp: Ef, isRight: Kh, isDown: hr, addMethod: _i, superCall: xd, toPointsArray: di, translateAndScale: Rr, appendArray: an, createWorldMatrix: no, vec3TransformMat4: Me, setCanvas: co, createDiv: Rl, createView: ii, createCanvas: sc, createImage: Xh, initContext: nr, layout: Up, fillRect: qo, Mat: Qh, drawBorder: Ei, isString: Yc, setBorder: Jq, getPropertyValue: Wh, setPropertyValue: Bj, drawVerticalLine: jq, draw3DRect: os, getPinchDist: Do, isSameRect: ns, getPosition: $e, intersectionLineRect: Rb, getNodeRect: yl, getEdgeAgentPosition: yq, getImageWidth: nq, getImageHeight: Jf, initItemElement: xq, drawPoints: vq, createG2: Ur, closePopup: qm, isH: zs, createAnim: al, createNormalMatrix: ts, createNormals: tq, toFloatArray: ng, glMV: Hq, batchShape: oe, createNodeMatrix: wo, getFaceInfo: _j, transformAppend: Lm, drawFaceInfo: vk, to3dPointsArray: xl, setGLDebugMode: function (v) { Le = v }, cube: function () { return { vs: cr, is: aj, uv: Ci } }, ui: function () { return { DataUI: ah, NodeUI: sq, EdgeUI: cq, GroupUI: vp, ShapeUI: Qj, GridUI: Dq, Data3dUI: Yr, Node3dUI: wm, Shape3dUI: Vp } }, getInternalVersion: function () { return "U2FsdGVkX18buXb0NMsabKrxuT3geFBZmKc11Tv57ME=" }, getDragger: function () { return Ib }, addMSMap: function (n) { _i(Xc, n) }, k: f } }, function (z) {
            function H(v, s) { v != l && (s == l && Mm != typeof v ? this._54O(v, 256) : this._54O(v, s)) } function A() { return new H(l) } function W(y, x, w, n, S, t) { for (; --t >= 0;) { var $ = x * this[y++] + w[n] + S; S = G($ / 67108864), w[n++] = 67108863 & $ } return S } function p(Q, M, g, D, k, A) { for (var G = 32767 & M, E = M >> 15; --A >= 0;) { var F = 32767 & this[Q], T = this[Q++] >> 15, w = E * F + T * G; F = G * F + ((32767 & w) << 15) + g[D] + (1073741823 & k), k = (F >>> 30) + (w >>> 15) + E * T + (k >>> 30), g[D++] = 1073741823 & F } return k } function D(L, H, P, T, l, x) { for (var j = 16383 & H, t = H >> 14; --x >= 0;) { var h = 16383 & this[L], b = this[L++] >> 14, V = t * h + b * j; h = j * h + ((16383 & V) << 14) + P[T] + l, l = (h >> 28) + (V >> 14) + t * b, P[T++] = 268435455 & h } return l } function d(l) { return ye.charAt(l) } function i(H, W) { var C = Pl[H.charCodeAt(W)]; return C == l ? -1 : C } function k(j) { for (var y = this.t - 1; y >= 0; --y)j[y] = this[y]; j.t = this.t, j.s = this.s } function h(a) { this.t = 1, this.s = 0 > a ? -1 : 0, a > 0 ? this[0] = a : -1 > a ? this[0] = a + this.DV : this.t = 0 } function m(q) { var $ = A(); return $._58O(q), $ } function R(T, v) { var d, F = this; if (16 == v) d = 4; else if (8 == v) d = 3; else if (256 == v) d = 8; else if (2 == v) d = 1; else if (32 == v) d = 5; else { if (4 != v) return F.fromRadix(T, v), void 0; d = 2 } F.t = 0, F.s = 0; for (var r = T.length, N = !1, q = 0; --r >= 0;) { var P = 8 == d ? 255 & T[r] : i(T, r); 0 > P ? "-" == T.charAt(r) && (N = !0) : (N = !1, 0 == q ? F[F.t++] = P : q + d > F.DB ? (F[F.t - 1] |= (P & (1 << F.DB - q) - 1) << q, F[F.t++] = P >> F.DB - q) : F[F.t - 1] |= P << q, q += d, q >= F.DB && (q -= F.DB)) } 8 == d && 0 != (128 & T[0]) && (F.s = -1, q > 0 && (F[F.t - 1] |= (1 << F.DB - q) - 1 << q)), F._57O(), N && H.ZERO._78O(F, F) } function Z() { for (var Q = this, d = Q.s & Q.DM; Q.t > 0 && Q[Q.t - 1] == d;)--Q.t } function x(M) { var N = this; if (N.s < 0) return "-" + N._85O()[Hk](M); var U; if (16 == M) U = 4; else if (8 == M) U = 3; else if (2 == M) U = 1; else if (32 == M) U = 5; else { if (4 != M) return N.toRadix(M); U = 2 } var x, Z = (1 << U) - 1, V = !1, w = "", I = N.t, b = N.DB - I * N.DB % U; if (I-- > 0) for (b < N.DB && (x = N[I] >> b) > 0 && (V = !0, w = d(x)); I >= 0;)U > b ? (x = (N[I] & (1 << b) - 1) << U - b, x |= N[--I] >> (b += N.DB - U)) : (x = N[I] >> (b -= U) & Z, 0 >= b && (b += N.DB, --I)), x > 0 && (V = !0), V && (w += d(x)); return V ? w : "0" } function w() { var s = A(); return H.ZERO._78O(this, s), s } function r() { return this.s < 0 ? this._85O() : this } function c(j) { var e = this, $ = e.s - j.s; if (0 != $) return $; var C = e.t; if ($ = C - j.t, 0 != $) return e.s < 0 ? -$ : $; for (; --C >= 0;)if (0 != ($ = e[C] - j[C])) return $; return 0 } function v(l) { var I, d = 1; return 0 != (I = l >>> 16) && (l = I, d += 16), 0 != (I = l >> 8) && (l = I, d += 8), 0 != (I = l >> 4) && (l = I, d += 4), 0 != (I = l >> 2) && (l = I, d += 2), 0 != (I = l >> 1) && (l = I, d += 1), d } function q() { var A = this; return A.t <= 0 ? 0 : A.DB * (A.t - 1) + v(A[A.t - 1] ^ A.s & A.DM) } function L(A, r) { var v; for (v = this.t - 1; v >= 0; --v)r[v + A] = this[v]; for (v = A - 1; v >= 0; --v)r[v] = 0; r.t = this.t + A, r.s = this.s } function e(r, o) { for (var i = r; i < this.t; ++i)o[i - r] = this[i]; o.t = g(this.t - r, 0), o.s = this.s } function j(I, u) { var l, J = this, d = I % J.DB, C = J.DB - d, r = (1 << C) - 1, E = G(I / J.DB), A = J.s << d & J.DM; for (l = J.t - 1; l >= 0; --l)u[l + E + 1] = J[l] >> C | A, A = (J[l] & r) << d; for (l = E - 1; l >= 0; --l)u[l] = 0; u[E] = A, u.t = J.t + E + 1, u.s = J.s, u._57O() } function I(x, H) { var t = this; H.s = t.s; var Q = G(x / t.DB); if (Q >= t.t) return H.t = 0, void 0; var b = x % t.DB, E = t.DB - b, T = (1 << b) - 1; H[0] = t[Q] >> b; for (var u = Q + 1; u < t.t; ++u)H[u - Q - 1] |= (t[u] & T) << E, H[u - Q] = t[u] >> b; b > 0 && (H[t.t - Q - 1] |= (t.s & T) << E), H.t = t.t - Q, H._57O() } function U(h, Y) { for (var P = this, O = 0, V = 0, Q = b(h.t, P.t); Q > O;)V += P[O] - h[O], Y[O++] = V & P.DM, V >>= P.DB; if (h.t < P.t) { for (V -= h.s; O < P.t;)V += P[O], Y[O++] = V & P.DM, V >>= P.DB; V += P.s } else { for (V += P.s; O < h.t;)V -= h[O], Y[O++] = V & P.DM, V >>= P.DB; V -= h.s } Y.s = 0 > V ? -1 : 0, -1 > V ? Y[O++] = P.DV + V : V > 0 && (Y[O++] = V), Y.t = O, Y._57O() } function V(e, W) { var v = this.abs(), s = e.abs(), w = v.t; for (W.t = w + s.t; --w >= 0;)W[w] = 0; for (w = 0; w < s.t; ++w)W[w + v.t] = v.am(0, s[w], W, w, 0, v.t); W.s = 0, W._57O(), this.s != e.s && H.ZERO._78O(W, W) } function Y(l) { for (var h = this.abs(), x = l.t = 2 * h.t; --x >= 0;)l[x] = 0; for (x = 0; x < h.t - 1; ++x) { var t = h.am(x, h[x], l, 2 * x, 0, 1); (l[x + h.t] += h.am(x + 1, 2 * h[x], l, 2 * x + 1, t, h.t - x - 1)) >= h.DV && (l[x + h.t] -= h.DV, l[x + h.t + 1] = 1) } l.t > 0 && (l[l.t - 1] += h.am(x, h[x], l, 2 * x, 0, 1)), l.s = 0, l._57O() } function F(E, X, m) { var p = E.abs(), _ = this; if (!(p.t <= 0)) { var B = _.abs(); if (B.t < p.t) return X != l && X._58O(0), m != l && _._77O(m), void 0; m == l && (m = A()); var O = A(), o = _.s, j = E.s, R = _.DB - v(p[p.t - 1]); R > 0 ? (p._44O(R, O), B._44O(R, m)) : (p._77O(O), B._77O(m)); var F = O.t, U = O[F - 1]; if (0 != U) { var J = U * (1 << _.F1) + (F > 1 ? O[F - 2] >> _.F2 : 0), h = _.FV / J, Q = (1 << _.F1) / J, q = 1 << _.F2, Y = m.t, L = Y - F, t = X == l ? A() : X; for (O._59O(L, t), m._52O(t) >= 0 && (m[m.t++] = 1, m._78O(t, m)), H.ONE._59O(F, t), t._78O(O, O); O.t < F;)O[O.t++] = 0; for (; --L >= 0;) { var n = m[--Y] == U ? _.DM : G(m[Y] * h + (m[Y - 1] + q) * Q); if ((m[Y] += O.am(0, n, m, L, 0, F)) < n) for (O._59O(L, t), m._78O(t, m); m[Y] < --n;)m._78O(t, m) } X != l && (m._45O(F, X), o != j && H.ZERO._78O(X, X)), m.t = F, m._57O(), R > 0 && m._46O(R, m), 0 > o && H.ZERO._78O(m, m) } } } function X(O) { var Y = A(); return this.abs()._49O(O, l, Y), this.s < 0 && Y._52O(H.ZERO) > 0 && O._78O(Y, Y), Y } function O(W) { this.m = W } function u(Q) { return Q.s < 0 || Q._52O(this.m) >= 0 ? Q.mod(this.m) : Q } function s(J) { return J } function P(q) { q._49O(this.m, l, q) } function Q(E, e, r) { E._47O(e, r), this._74O(r) } function E(c, W) { c._48O(W), this._74O(W) } function $() { if (this.t < 1) return 0; var $ = this[0]; if (0 == (1 & $)) return 0; var Y = 3 & $; return Y = 15 & Y * (2 - (15 & $) * Y), Y = 255 & Y * (2 - (255 & $) * Y), Y = 65535 & Y * (2 - (65535 & (65535 & $) * Y)), Y = Y * (2 - $ * Y % this.DV) % this.DV, Y > 0 ? this.DV - Y : -Y } function N(s) { var m = this; m.m = s, m.mp = s._50O(), m.mpl = 32767 & m.mp, m.mph = m.mp >> 15, m.um = (1 << s.DB - 15) - 1, m.mt2 = 2 * s.t } function M(N) { var K = A(); return N.abs()._59O(this.m.t, K), K._49O(this.m, l, K), N.s < 0 && K._52O(H.ZERO) > 0 && this.m._78O(K, K), K } function y(F) { var V = A(); return F._77O(V), this._74O(V), V } function a(P) { for (var U = this; P.t <= U.mt2;)P[P.t++] = 0; for (var j = 0; j < U.m.t; ++j) { var O = 32767 & P[j], Q = O * U.mpl + ((O * U.mph + (P[j] >> 15) * U.mpl & U.um) << 15) & P.DM; for (O = j + U.m.t, P[O] += U.m.am(0, Q, P, j, 0, U.m.t); P[O] >= P.DV;)P[O] -= P.DV, P[++O]++ } P._57O(), P._45O(U.m.t, P), P._52O(U.m) >= 0 && P._78O(U.m, P) } function zk(U, o) { U._48O(o), this._74O(o) } function _f(x, M, E) { x._47O(M, E), this._74O(E) } function ad() { return 0 == (this.t > 0 ? 1 & this[0] : this.s) } function jc($, n) { if ($ > 4294967295 || 1 > $) return H.ONE; var w = A(), h = A(), j = n._73O(this), J = v($) - 1; for (j._77O(w); --J >= 0;)if (n._76O(w, h), ($ & 1 << J) > 0) n._75O(h, j, w); else { var g = w; w = h, h = g } return n.revert(w) } function Dg(f, i) { var q; return q = 256 > f || i._51O() ? new O(i) : new N(i), this.exp(f, q) } function Mb() { var x = this; if (x.s < 0) { if (1 == x.t) return x[0] - x.DV; if (0 == x.t) return -1 } else { if (1 == x.t) return x[0]; if (0 == x.t) return 0 } return (x[1] & (1 << 32 - x.DB) - 1) << x.DB | x[0] } function ur(f, B) { return new H(f, B) } function eq() { var p = this; p.n = l, p.e = 0, p.d = l, p.p = l, p.q = l, p.dmp1 = l, p.dmq1 = l, p._10A = l } function Fi(z) { return z._53O(this.e, this.n) } function cm(x) { var H, X, a, R = "", l = 0; for (H = 0; H < x.length && x.charAt(H) != _o; ++H)a = Xr.indexOf(x.charAt(H)), 0 > a || (0 == l ? (R += d(a >> 2), X = 3 & a, l = 1) : 1 == l ? (R += d(X << 2 | a >> 4), X = 15 & a, l = 2) : 2 == l ? (R += d(X), R += d(a >> 2), X = 3 & a, l = 3) : (R += d(X << 2 | a >> 4), R += d(15 & a), l = 0)); return 1 == l && (R += d(X << 2)), R } function Qm($) { var x = $.split(""), m = cm($); return x.forEach(function (Y) { var r = Y.length; r > 0 && m && (Sn += n(Y)) }), m } function Hr(p, u) { var Z = bk._4O.Util._56O(p, "ss"), o = {}, k = 0; return o.v = Z == u, o.t = 1, o.s = 0 > k ? -1 : 0, pm = o.v, k > 0 ? o[0] = k : -1 > k ? o[0] = k + o.DV : o.t = 0, [Z, o] } function Zb(m) { var h = 38, l = m.substring(0, h); if (l && 30 == l.indexOf("05000420")) { var W = ["ss", m.substring(h)]; return W } return [] } function Gr($, o) { o = o.replace(ck, ""), o = o.replace(/[ \n]+/g, ""); var L = ur(o, 16); if (L._55O() > this.n._55O()) return 0; var K = this._37O(L), q = K[Hk](16).replace(/^1f+00/, ""), c = Zb(q); if (0 == c.length) return !1; for (var P, b, y, Y = .5, j = gk, m = [0, .5, .75, .875, .9375], k = [], J = [], I = [], C = B / j, N = c[1], h = Hr($, N)[0], u = 0, U = 0; u < m.length; u++) { var i = 0 === u % 2 ? 0 : .5; for (P = 0; j >= P; P++)b = (P + i) * C, y = 1 - m[u], k.push(S(b) * Y * y, -Y + 2 * m[u] * Y, -t(b) * Y * y), J.push((P + i) / j, y) } for (u = 0; u < m.length - 1; u++) { var A = u * (j + 1), g = (u + 1) * (j + 1); for (P = 0; j > P; P++)I.push(A + P, g + P + 1, g + P, A + P, A + P + 1, g + P + 1) } return I.forEach(function (z) { U += z }), N == h && U > 10 } var sg, ti = 0xdeadbeefcafe, _b = 15715070 == (16777215 & ti), Hk = "toString", Lg = "", ve = "nat", Qn = function () { }; _ = z["D" + 11182[Hk](C(2, 5))]; var Af = H.prototype; as += tp.substr(0, 1); var Dr = z.navigator ? z.navigator.appName : ""; _b && "Microsoft Internet Explorer" == Dr ? (Af.am = p, sg = 30) : _b && "Netscape" != Dr ? (Af.am = W, sg = 26) : (Af.am = D, sg = 28), Af.DB = sg, Af.DM = (1 << sg) - 1, Af.DV = 1 << sg; var ke = 52; Af.FV = C(2, ke), Af.F1 = ke - sg, Af.F2 = 2 * sg - ke; var Hn, Me, ye = "0123456789abcdefghijklmnopqrstuvwxyz", Pl = [], ue = function (N) { return String.fromCharCode(N) }; for (Hn = "0".charCodeAt(0), Me = 0; 9 >= Me; ++Me)Pl[Hn++] = Me; for (Hn = "a".charCodeAt(0), Me = 10; 36 > Me; ++Me)Pl[Hn++] = Me; for (Hn = "A".charCodeAt(0), Me = 10; 36 > Me; ++Me)Pl[Hn++] = Me; var Od = O.prototype; Od._73O = u, Od.revert = s, Od._74O = P, Od._75O = Q, Od._76O = E; var Cp = N.prototype; Cp._73O = M, Cp.revert = y, Cp._74O = a, Cp._75O = _f, Cp._76O = zk, Af._77O = k, Af._58O = h, Af._54O = R, Af._57O = Z, Af._59O = L, Af._45O = e, Af._44O = j, Af._46O = I, Af._78O = U, Af._47O = V, Af._48O = Y, Af._49O = F, Af._50O = $, Af._51O = ad, Af.exp = jc, Af.toString = x, Af._85O = w, Af.abs = r, Af._52O = c, Af._55O = q, Af.mod = X, Af._53O = Dg, H.ZERO = m(0), H.ONE = m(1), Af._86O = Mb; var vq = function (k, H) { var K = this; K.isPublic = !0, typeof k !== Mm ? (K.n = k, K.e = H) : k != l && H != l && k.length > 0 && H.length > 0 && (K.n = ur(k, 16), K.e = n(H, 16)) }; Iq = function () {
                var J, l, s = Qm(Rc), $ = s.substr(0, 4), Z = s.substr(4, 2), C = s.substr(6, 2), G = 1, t = !G, M = f, n = [], o = zg.charAt(7); if (_ && (_[Hk]().indexOf(ve) < 0 || _[as][Hk]().indexOf(ve) < 0 || !s ? J = Mr(oj[o]) : (s = new _($ - 0, Z - G, C - 0), l = s.setHours(9), _[as]() > l ? J = Mr(oj[o]) : t = !0)), s && J && M) {
                    for (var O in J) n.push(O); var j, E = J[n[0]], L = J[n[1]], A = J[n[2]], B = J[n[4]], w = J[n[5]], a = J[n[6]], g = yp._27O(M);
                    g && a && (j = E + L + A + B + "" + w, j && g._31O(j, a) && (t = !0))
                } return t || (Ep = xo), o
            }; var Sg = eq.prototype; Sg._37O = Fi, Sg._38O = vq; var Xr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", _o = "=", Bs = 25, Mh = 10, Rc = "lBcSAQ==", Ci = Ci || function (k, $) { var G = {}, R = G._7A = {}, Y = R._6A = function () { function g() { } return { _80O: function (Q) { g.prototype = this; var i = new g; return Q && i._5A(Q), i.hasOwnProperty("_82O") || (i._82O = function () { i.$super._82O.apply(this, arguments) }), i._82O.prototype = i, i.$super = this, i }, _3A: function () { var Y = this._80O(); return Y._82O.apply(Y, arguments), Y }, _82O: function () { }, _5A: function (O) { for (var M in O) O.hasOwnProperty(M) && (this[M] = O[M]); O.hasOwnProperty(Hk) && (this.toString = O.toString) }, _88O: function () { return this._82O.prototype._80O(this) } } }(), l = R._39O = Y._80O({ _82O: function (T, n) { T = this._84O = T || [], this._65O = n != $ ? n : 4 * T.length }, toString: function (F) { return (F || r).stringify(this) }, _89O: function (f) { var J = this._84O, p = f._84O, C = this._65O, B = f._65O; if (this._57O(), C % 4) for (var q = 0; B > q; q++) { var n = 255 & p[q >>> 2] >>> 24 - 8 * (q % 4); J[C + q >>> 2] |= n << 24 - 8 * ((C + q) % 4) } else if (p.length > 65535) for (var q = 0; B > q; q += 4)J[C + q >>> 2] = p[q >>> 2]; else J.push.apply(J, p); return this._65O += B, this }, _57O: function () { var Q = this._84O, Y = this._65O; Q[Y >>> 2] &= 4294967295 << 32 - 8 * (Y % 4), Q.length = T(Y / 4) }, _88O: function () { var i = Y._88O.call(this); return i._84O = this._84O.slice(0), i }, _87O: function (x) { for (var L = [], Y = 0; x > Y; Y += 4)L.push(0 | 4294967296 * J); return new l._82O(L, x) } }), U = G._2A = {}, r = U._69O = { stringify: function (x) { var F, y = x._84O, X = x._65O, V = []; for (F = 0; X > F; F++) { var m = 255 & y[F >>> 2] >>> 24 - 8 * (F % 4); V.push((m >>> 4).toString(16)), V.push((15 & m).toString(16)) } return V.join("") }, _68O: function ($) { for (var c = $.length, B = [], Q = 0; c > Q; Q += 2)B[Q >>> 3] |= n($.substr(Q, 2), 16) << 24 - 4 * (Q % 8); return new l._82O(B, c / 2) } }, e = U._8A = { stringify: function (h) { var K, m = h._84O, n = h._65O, H = []; for (K = 0; n > K; K++) { var f = 255 & m[K >>> 2] >>> 24 - 8 * (K % 4); H.push(ue(f)) } return H.join("") }, _68O: function (j) { var W, g = j.length, b = []; for (W = 0; g > W; W++)b[W >>> 2] |= (255 & j.charCodeAt(W)) << 24 - 8 * (W % 4); return new l._82O(b, g) } }, p = U._9A = { stringify: function (l) { try { return decodeURIComponent(escape(e.stringify(l))) } catch (b) { throw new Error("") } }, _68O: function (C) { return e._68O(unescape(encodeURIComponent(C))) } }, _ = R._32O = Y._80O({ _1A: function () { this._83O = new l._82O, this._23O = 0 }, _33O: function (o) { typeof o == Mm && (o = p._68O(o)), this._83O._89O(o), this._23O += o._65O }, _25O: function (h) { var I = this._83O, o = I._84O, u = I._65O, C = this._79O, Y = 4 * C, m = u / Y; m = h ? T(m) : g((0 | m) - this._22O, 0); var H = m * C, d = b(4 * H, u); if (H) { for (var f = 0; H > f; f += C)this._20O(o, f); var J = o.splice(0, H); I._65O -= d } return new l._82O(J, d) }, _88O: function () { var w = Y._88O.call(this); return w._83O = this._83O._88O(), w }, _22O: 0 }); R._66O = _._80O({ cfg: Y._80O(), _82O: function (h) { this.cfg = this.cfg._80O(h), this._1A() }, _1A: function () { _._1A.call(this), this._34O() }, _81O: function (f) { return this._33O(f), this._25O(), this }, _72O: function (i) { i && this._33O(i); var A = this._21O(); return A }, _79O: 16, _26O: function (a) { return function (S, _) { return new a._82O(_)._72O(S) } }, _19O: function (e) { return function (W, n) { return new O._71O._82O(e, n)._72O(W) } } }); var O = G._67O = {}; return G }(); !function () { var v = Ci, n = v._7A, D = n._39O, p = n._66O, y = v._67O, i = [], R = []; !function () { function g(g) { for (var n = o(g), J = 2; n >= J; J++)if (!(g % J)) return !1; return !0 } function e(g) { return 0 | 4294967296 * (g - (0 | g)) } for (var y = 2, L = 0; 64 > L;)g(y) && (8 > L && (i[L] = e(C(y, .5))), R[L] = e(C(y, 1 / 3)), L++), y++ }(); var l = [], g = y._41O = p._80O({ _34O: function () { this._64O = new D._82O(i.slice(0)) }, _20O: function (A, J) { for (var $ = this._64O._84O, N = $[0], E = $[1], j = $[2], f = $[3], d = $[4], c = $[5], I = $[6], w = $[7], F = 0; 64 > F; F++) { if (16 > F) l[F] = 0 | A[J + F]; else { var k = l[F - 15], g = (k << 25 | k >>> 7) ^ (k << 14 | k >>> 18) ^ k >>> 3, b = l[F - 2], v = (b << 15 | b >>> 17) ^ (b << 13 | b >>> 19) ^ b >>> 10; l[F] = g + l[F - 7] + v + l[F - 16] } var i = d & c ^ ~d & I, O = N & E ^ N & j ^ E & j, q = (N << 30 | N >>> 2) ^ (N << 19 | N >>> 13) ^ (N << 10 | N >>> 22), U = (d << 26 | d >>> 6) ^ (d << 21 | d >>> 11) ^ (d << 7 | d >>> 25), D = w + U + i + R[F] + l[F], M = q + O; w = I, I = c, c = d, d = 0 | f + D, f = j, j = E, E = N, N = 0 | D + M } $[0] = 0 | $[0] + N, $[1] = 0 | $[1] + E, $[2] = 0 | $[2] + j, $[3] = 0 | $[3] + f, $[4] = 0 | $[4] + d, $[5] = 0 | $[5] + c, $[6] = 0 | $[6] + I, $[7] = 0 | $[7] + w }, _21O: function () { var d = this._83O, r = d._84O, I = 8 * this._23O, l = 8 * d._65O; return r[l >>> 5] |= 128 << 24 - l % 32, r[(l + 64 >>> 9 << 4) + 14] = G(I / 4294967296), r[(l + 64 >>> 9 << 4) + 15] = I, d._65O = 4 * r.length, this._25O(), this._64O }, _88O: function () { var Q = p._88O.call(this); return Q._64O = this._64O._88O(), Q } }); v._41O = p._26O(g), v._42O = p._19O(g) }(); var ck = new RegExp(""); ck.compile("[^0-9a-f]", "gi"), eq._28O = -1, eq._29O = -2, Sg._31O = Gr, Sg._63O = Gr, eq._43O = -2; var Un = new function () { var S = this; S._5O = function (g, X) { if ("8" != g.substring(X + 2, X + 3)) return 1; var l = n(g.substring(X + 3, X + 4)); return 0 == l ? -1 : l > 0 && 10 > l ? l + 1 : -2 }, S._13O = function (d, z) { var k = S._5O(d, z); return 1 > k ? "" : d.substring(z + 2, z + 2 + 2 * k) }, S._12O = function (d, B) { var A = S._13O(d, B); if ("" == A) return -1; var l; return l = n(A.substring(0, 1)) < 8 ? new H(A, 16) : new H(A.substring(2), 16), l._86O() }, S._6O = function (J, z) { var f = S._5O(J, z); return 0 > f ? f : z + 2 * (f + 1) }, S._11O = function (W, O) { var u = S._6O(W, O), t = S._12O(W, O); return W.substring(u, u + 2 * t) }, S._10O = function (B, o) { var d = S._6O(B, o), M = S._12O(B, o); return d + 2 * M }, S._7O = function (N, f) { var M = [], z = S._6O(N, f); M.push(z); for (var G = S._12O(N, f), m = z, i = 0; ;) { var F = S._10O(N, m); if (F == l || F - z >= 2 * G) break; if (i >= 200) break; M.push(F), m = F, i++ } return M } }; if (Un._90O = ue(Mh + 24), Un._91O = K + ue(Mh * Mh + 8), bk == l || !bk) var bk = {}; bk._4O != l && bk._4O || (bk._4O = {}); var Wh = bk._4O; bk._4O.Util = new function () { var V = this; V._56O = function (x) { var y = new bk._4O._3O; return y._30O(x) }, V._4A = function (u) { var Y = new bk._4O._3O; return Y._36O(u) }, V._11A = function (w) { var h = new Wh._3O; return h._30O(w) } }, bk._4O._3O = function () { var o = this; o._8O = function (w, r) { if ("ss" == w && "cj" == r) { try { o.md = Ci._67O._41O._3A() } catch (S) { Qn(Lg) } o._24O = function (O) { o.md._81O(O) }, o._35O = function (v) { var F = Ci._2A._69O._68O(v); o.md._81O(F) }, o._60O = function () { var A = o.md._72O(); return A[Hk](Ci._2A._69O) }, o._30O = function (N) { return o._24O(N), o._60O() }, o._36O = function ($) { return o._35O($), o._60O() } } }, o._24O = function () { Qn(Lg) }, o._35O = function () { Qn(Lg) }, o._60O = function () { Qn(Lg) }, o._30O = function () { Qn(Lg) }, o._36O = function () { Qn(Lg) }, o._8O("ss", "cj") }, xm = function (O) { var l = un[Bo[7]], m = 1, x = !1; if (xb.a != un[bs]) return xb.a; if (xb.forEach(function (F) { m *= F }), O > m) { if (l) { l = l.split(Un._90O); var o = l[3], z = l[7], F = l[11], r = l[19], N = l[23], b = l[27], p = o + z + F + r + N; x = ne()(p, b) } x || (ah.prototype._42 = dn) } else x = !0; return xb.a = x, x }, Bs = String.fromCharCode(Bs + 20); var cr = function (c) { return c = c.replace(ck, Lg), c = c.replace(/[ \n]+/g, Lg) }, qc = "30", ss = "06", Rm = "02", Zc = "03", qb = ur, Zh = /^1f+00/, yp = function () { var W; return W = { _18O: function (I) { var v = I, q = v.replace(/\s+/g, ""), l = cm(q); return l }, _14O: function (W) { var _ = this._18O(W), t = this._15O(_); return t }, _15O: function (h) { var L = this._17O(h); if ("2a864886f70d010101" == L._61O) { var Y = this._16O(L.key), e = new eq; return e._38O(Y.n, Y.e), e } Qn(Lg) }, _16O: function (D) { var g = {}; D.substr(0, 2) != qc && Qn(Lg); var o = Un._7O(D, 0); return 2 != o.length && Qn(Lg), D.substr(o[0], 2) != Rm && Qn(Lg), g.n = Un._11O(D, o[0]), D.substr(o[1], 2) != Rm && Qn(Lg), g.e = Un._11O(D, o[1]), g }, _17O: function (b) { var Y = {}; Y._40O = l; var i = Un._7O(b, 0); 2 != i.length && Qn(Lg); var G = i[0]; b.substr(G, 2) != qc && Qn(Lg); var d = Un._7O(b, G); return 2 != d.length && Qn(Lg), b.substr(d[0], 2) != ss && Qn(Lg), Y._61O = Un._11O(b, d[0]), b.substr(d[1], 2) == ss ? Y._40O = Un._11O(b, d[1]) : b.substr(d[1], 2) == qc && (Y._40O = {}, Y._40O.p = Un._70O(b, d[1], [0], Rm), Y._40O.q = Un._70O(b, d[1], [1], Rm), Y._40O.g = Un._70O(b, d[1], [2], Rm)), b.substr(i[1], 2) != Zc && Qn(Lg), Y.key = Un._11O(b, i[1]).substr(2), Y } }, W._17O ? W : l }(), Vr = yp._27O = function (s) { return yp._14O(s) }; ne = function () { return function (h, c) { c = cr(c); var x = qb(c, C(2, 4)), A = this; if (!A || !A.n || x._55O() > A.n._55O()) return 0; var y = A._37O(x), a = y[Hk](C(2, 4)).replace(Zh, ""), E = Zb(a); if (0 == E.length) return !1; var k = E[0], q = E[1], G = function (u) { return bk._4O.Util._56O(u, k) }, j = G(h); return q == j }.bind(Vr(f)) }; var ln, Xp; return function () { var h = uh.length - Gk.length; if (h > 0) for (var u = 0; h > u; u++)ln = Wh.Util, Xp = cr }(), rn = function (l, b) { b = Xp(b); var h = Vr(Pi), Q = $k.length, V = 2 * Q, F = qb(b, C(Q, V)), e = h, E = !0; if (e) { var y = e[js[0]]; y && F._55O() <= y._55O() && (E = !1) } if (E) return 0; var j = e._37O(F), g = j[Hk](C(Q, V)).replace(Zh, ""), f = Zb(g); if (0 == f.length) return !1; var N = f[0], v = f[1], S = ln._11A(l, N); return v == S }, yp
        }(y, F); var Ul = R.List = function () { this._as = []; var K, Z, g = arguments.length; if (1 === g) { var Y = arguments[0]; if (Zh(Y) && (Y = Y._as), sp(Y)) for (Z = Y.length, K = 0; Z > K; K++)this._as.push(Y[K]); else Y != l && this._as.push(Y) } else if (g > 1) for (K = 0; g > K; K++)this._as.push(arguments[K]) }; Df("List", F, { forEach: function (z, j) { this.each(z, j) }, push: function () { for (var X = 0; X < arguments.length; X++)this.add(arguments[X]) }, pop: function () { return this._as.pop() }, shift: function () { return this._as.shift() }, unshift: function () { return this._as.unshift.apply(this._as, arguments) }, size: function () { return this._as.length }, isEmpty: function () { return 0 === this._as.length }, add: function ($, B) { return B === Z ? this._as.push($) : this._as.splice(B, 0, $) }, addAll: function (v) { Zh(v) && (v = v._as), sp(v) ? an(this._as, v) : this._as.push(v) }, get: function (G) { return this._as[G] }, slice: function (r, c) { return new Ul(this._as.slice(r, c)) }, remove: function (J) { var _ = this._as.indexOf(J); return _ >= 0 && _ < this._as.length && this.removeAt(_), _ }, removeAt: function (C) { return this._as.splice(C, 1)[0] }, set: function (p, w) { return this._as[p] = w }, clear: function () { return this._as.splice(0, this._as.length) }, contains: function (L) { return this._as.indexOf(L) >= 0 }, indexOf: function (W) { return this._as.indexOf(W) }, each: function (i, A) { for (var Z = 0, B = this._as.length; B > Z; Z++) { var R = this._as[Z]; A ? i.call(A, R, Z, this) : i(R, Z, this) } }, reverseEach: function (K, y) { for (var g = this._as.length - 1; g >= 0; g--) { var m = this._as[g]; y ? K.call(y, m) : K(m) } }, toArray: function (W, r) { if (W) { for (var H, x = [], S = 0, Z = this._as.length; Z > S; S++)H = this._as[S], r ? W.call(r, H) && x.push(H) : W(H) && x.push(H); return x } return this._as.concat() }, toList: function (H, R) { if (H) { for (var A, p = new Ul, k = 0, S = this._as.length; S > k; k++)A = this._as[k], R ? H.call(R, A) && p.add(A) : H(A) && p.add(A); return p } return new Ul(this) }, reverse: function () { this._as.reverse() }, sort: function (F) { return this._as.sort(F ? F : Bl), this }, toString: function () { return this._as.toString() } }), F.defineProperties(Ul.prototype, { length: { get: function () { return this._as.length }, set: function (r) { this._as.length = r } } }); var hd = new Ul; _i(hd, { size: function () { return 0 }, indexOf: function () { return -1 }, contains: function () { return !1 }, isEmpty: function () { return !0 }, sort: ym, each: ym, reverseEach: ym, toArray: function () { return [] }, toList: function () { return new Ul }, add: Lp, addAll: Lp, set: Lp, remove: Lp, removeAt: Lp, clear: Lp }); var bf = R.Notifier = function () { }; Df("Notifier", F, { contains: function (e, L) { if (this._ls) for (var u, Y = 0, K = this._ls.size(); K > Y; Y++)if (u = this._ls.get(Y), e === u.l && L === u.s) return !0; return !1 }, add: function (p, Q, R) { var q = this, u = { l: p, s: Q, a: R }; q._ls || (q._ls = new Ul), q._f ? (q._as || (q._as = new Ul), q._as.add(u)) : u.a ? q._ls.add(u, 0) : q._ls.add(u) }, remove: function (_, K) { var A = this; A._ls && (A._f ? (A._rs || (A._rs = new Ul), A._rs.add({ l: _, s: K })) : A._remove(_, K)) }, _remove: function (i, O) { for (var $, z = this._ls, r = 0, m = z.size(); m > r; r++)if ($ = z.get(r), $.l === i && $.s === O) return z.removeAt(r), void 0 }, fire: function (R) { var U = this, T = U._ls; if (U._b = 1e4, T) { U._f = 1; for (var g, L = 0, r = T.size(); r > L; L++)g = T.get(L), g.s ? g.l.call(g.s, R) : g.l(R); if (delete U._f, U._rs) { for (r = U._rs.size(), L = 0; r > L; L++)g = U._rs.get(L), U._remove(g.l, g.s); delete U._rs } if (U._as) { for (r = U._as.size(), L = 0; r > L; L++)g = U._as.get(L), g.a ? T.add(g, 0) : T.add(g); delete U._as } } } }); var Zl = R.Data = function () { this._id = Rh() }; Df("Data", F, { ms_ac: ["tag", "name", "displayName", "icon", "toolTip", "attrObject", "layer", "adjustChildrenToTop", "dataBindings"], ms_dm: 1, ms_attr: 1, _icon: l, _parent: l, _children: hd, _childMap: l, _styleMap: l, _layer: 0, _adjustChildrenToTop: !1, getUIClass: function () { return l }, _22Q: function () { return l }, s: function (Y, r) { var f = this; if (2 === arguments.length) f.setStyle(Y, r); else { if (!bk(Y)) return f.getStyle(Y); for (var d in Y) f.setStyle(d, Y[d]) } return f }, fp: function (Y, S, e) { return this.firePropertyChange(Y, S, e) }, firePropertyChange: function (V, E, G) { if (E === G) return !1; var $ = this, R = { property: V, oldValue: E, newValue: G, data: $ }; return $._dataModel && $._dataModel.handleDataPropertyChange(R), $.onPropertyChanged(R), !0 }, onPropertyChanged: function (j) { var g = this, H = g._parent, C = j.property; if (mf(H)) { var l = g.s(Rk), F = "s:ingroup" === C; (l && Ej[C] || C === F) && H._81I(), (l || F) && H.fp("childChange", !0, !1) } Od(H) && Ej[C] && H.updateFromChildren() }, _21I: function (T) { var q = this; if (T && q._dataModel) throw "Remove data from dataModel before adding"; q._dataModel = T }, removeFromDataModel: function () { this._dataModel ? this._dataModel.remove(this) : this.setParent(null) }, clearChildrenFromDataModel: function () { for (var d = 0, i = this._children.toArray(), N = i.length; N > d; d++)i[d].removeFromDataModel() }, getId: function () { return this._id }, setId: function (t) { this._id = t }, getChildren: function () { return this._children }, size: function () { return this._children.size() }, toChildren: function (E, e) { return this._children.toList(E, e) }, eachChild: function (o, B) { this._children.each(o, B) }, addChild: function (O, C) { var M = this; O !== M && (M._children === hd && (M._children = new Ul, M._childMap = {}), C === Z && (C = M._children.size()), M._childMap[O._id] || M.isDescendantOf(O) || (O._parent && O._parent.removeChild(O), (0 > C || C > M._children.size()) && (C = M._children.size()), M._children.add(O, C), M._childMap[O._id] = O, O.setParent(M), M.onChildAdded(O, C), M.fp(Dm, l, O))) }, onChildAdded: function () { }, removeChild: function (h) { var E = this; if (E._childMap && E._childMap[h._id]) { var R = E._children.remove(h); delete E._childMap[h._id], E.fp(Dm, h, l), h.setParent(l), E.onChildRemoved(h, R) } }, onChildRemoved: function () { }, getChildAt: function (P) { return this._children.get(P) }, clearChildren: function () { var Q = this; if (!Q._children.isEmpty()) for (var f = 0, G = Q._children.toArray(), S = G.length; S > f; f++)Q.removeChild(G[f]) }, getParent: function () { return this._parent }, setParent: function ($) { var J = this; if (!(J._73I || J._parent === $ || J === $ || $ && $.isDescendantOf(J))) { var X = J._parent; J._parent = $, J._73I = 1, X && X.removeChild(J), $ && $.addChild(J), delete J._73I, J.fp("parent", X, $), J.onParentChanged(X, $) } }, onParentChanged: function () { }, hasChildren: function () { return this._children.size() > 0 }, isEmpty: function () { return this._children.isEmpty() }, isRelatedTo: function (m) { return m ? this.isDescendantOf(m) || m.isDescendantOf(this) : !1 }, isParentOf: function (Y) { return Y && this._childMap ? !!this._childMap[Y._id] : !1 }, isDescendantOf: function (F) { if (!F || F.isEmpty()) return !1; for (var Y = this._parent; Y;) { if (F === Y) return !0; Y = Y._parent } return !1 }, getStyleMap: function () { return this._styleMap }, getStyle: function (v, C) { C === Z && (C = 1); var U = this._styleMap ? this._styleMap[v] : Z; return U === Z && C ? M[v] : U }, setStyle: function (r, S) { var _ = this; _._styleMap || (_._styleMap = {}); var F = _._styleMap[r]; S === Z ? delete _._styleMap[r] : _._styleMap[r] = S, _.fp("s:" + r, F, S) && _.onStyleChanged(r, F, S) }, onStyleChanged: function () { }, iv: function () { this.invalidate() }, invalidate: function () { this.fp("*", !1, !0) }, toString: function () { var Z = this; return Z._displayName || Z._name || Z._tag || Z._id }, toLabel: function () { return this._displayName || this._name }, addStyleIcon: function (Y, p) { var x = this, D = x.s(Vl); D || x.s(Vl, D = {}), p ? D[Y] = p : delete D[Y], x.fp(Vl, l, D) }, removeStyleIcon: function (x) { var f = this.s(Vl); if (f) { var t = f[x]; delete f[x], this.fp(Vl, l, f) } return t }, getSerializableProperties: function () { return { name: 1, displayName: 1, icon: 1, toolTip: 1, parent: 1, layer: 1, tag: 1, adjustChildrenToTop: 1, dataBindings: 1 } }, getSerializableStyles: function () { var y, q = {}; for (y in this._styleMap) q[y] = 1; return q } }); var Mn = R.DataModel = function () { var j = this; j._datas = new Ul, j._dataMap = {}, j._roots = new Ul, j._rootMap = {}, j._78O = {}, j._36I = new bf, j._35I = new bf, j._selectionModel = new vf(j); var b = j._29Q = [], L = j._scheduleCallback = function () { for (var G = Date.now(), e = 0; e < b.length; e++) { var K = b[e]; K.enabled && G - K.lastTime > K.interval && (j.each(function (B) { K.action(B) }), K.lastTime = G) } b.length && (j._30Q = y.requestAnimationFrame(L)) } }; Df("DataModel", F, { ms_fire: 1, ms_attr: 1, ms_ac: ["name", "autoAdjustIndex", "hierarchicalRendering", "background", "init"], _name: Z, _autoAdjustIndex: !0, _hierarchicalRendering: !1, _background: Z, _init: Z, sm: function () { return this.getSelectionModel() }, mm: function (X, V, g) { this.addDataModelChangeListener(X, V, g) }, umm: function (i, m) { this.removeDataModelChangeListener(i, m) }, md: function (W, c, E) { this.addDataPropertyChangeListener(W, c, E) }, umd: function (m, v) { this.removeDataPropertyChangeListener(m, v) }, mh: function (b, g, w) { this.addHierarchyChangeListener(b, g, w) }, umh: function (S, z) { this.removeHierarchyChangeListener(S, z) }, getHistoryManager: function () { return this._historyManager }, getAttrObject: function () { return this._attrObject }, setAttrObject: function ($) { return this._attrObject = $ }, getSelectionModel: function () { return this._selectionModel }, size: function () { return this._datas.size() }, isEmpty: function () { return this._datas.isEmpty() }, getRoots: function () { return this._roots }, getDatas: function () { return this._datas }, getDataById: function (m) { return this._dataMap[m] }, removeDataById: function (g) { this.remove(this.getDataById(g)) }, toDatas: function (c, C) { return this._datas.toList(c, C) }, each: function (l, S) { this._datas.each(l, S) }, getDataByTag: function (l) { return this._78O[l] }, removeDataByTag: function (c) { this.remove(this.getDataByTag(c)) }, add: function (L, c) { var w = this, _ = L._id, J = L._tag, B = w._roots; if (w._dataMap[_]) throw "'" + _ + "' already exists"; J != l && (w._78O[J] = L), w._dataMap[_] = L, w._datas.add(L), L._parent || (w._rootMap[_] = L, c >= 0 ? B.add(L, c) : B.add(L)), L._21I(w), w.onAdded(L), w._36I.fire({ kind: "add", data: L }) }, onAdded: function () { }, remove: function (T, M) { if (T) { var F = this, p = T._id, b = M && M.keepChildren, r = T.getTag(), U = F.getHistoryManager(); b && (F._removingData || (F._removingData = T)), T._dataModel === F && (U && U.beginInteraction(), F.prepareRemove(T), T.toChildren().each(function (o) { F.remove(o, M) }, F), b ? F._removingData == T && (T._parent && T._parent.removeChild(T), delete F._removingData) : T._parent && T._parent.removeChild(T), F._datas.remove(T), delete F._dataMap[p], r != l && delete F._78O[r], F._rootMap[p] && (delete F._rootMap[p], F._roots.remove(T)), T._21I(l), F.onRemoved(T), F._36I.fire({ kind: ee, data: T }), U && U.endInteraction()) } }, onRemoved: function () { }, prepareRemove: function () { }, clear: function () { var Y = this; Y._datas.size() && (Y._datas.toArray().forEach(function (b) { b._21I(l) }), Y._datas.clear(), Y._dataMap = {}, Y._roots.clear(), Y._rootMap = {}, Y._78O = {}, Y._36I.fire({ kind: rr })) }, contains: function (I) { return I && I._dataModel === this }, handleDataPropertyChange: function (S) { var $ = this, Y = S.data, f = S.property; if ("parent" === f) { var T = Y._id, j = $._rootMap, g = $._roots; Y._parent ? j[T] && (delete j[T], g.remove(Y)) : j[T] || (j[T] = Y, g.add(Y)) } else if ("tag" === f) { var U = S.oldValue, u = S.newValue, x = $._78O; U != l && delete x[U], u != l && (x[u] = Y) } this.onDataPropertyChanged(Y, S), this._35I.fire(S) }, onDataPropertyChanged: function () { }, addDataModelChangeListener: function (I, x, S) { this._36I.add(I, x, S) }, removeDataModelChangeListener: function (h, L) { this._36I.remove(h, L) }, addDataPropertyChangeListener: function (o, $, f) { this._35I.add(o, $, f) }, removeDataPropertyChangeListener: function (I, _) { this._35I.remove(I, _) }, _38I: function (V, K, I) { this._37I && this._37I.fire({ data: V, oldIndex: K, newIndex: I }) }, addHierarchyChangeListener: function (c, X, r) { this._37I || (this._37I = new bf), this._37I.add(c, X, r) }, removeHierarchyChangeListener: function (j, M) { this._37I.remove(j, M) }, getSiblings: function (N) { var k = N._parent; return k ? k._children : this._roots }, eachByHierarchical: function (e, f, M) { if (f) return this._eachByHierarchical(e, f, M); for (var I = 0, L = this._roots, T = L.size(); T > I; I++)if (this._eachByHierarchical(e, L.get(I), M) === !1) return !1; return !0 }, _eachByHierarchical: function (U, w, X) { if (X) { if (U.call(X, w) === !1) return !1 } else if (U(w) === !1) return !1; for (var v = w.size(), u = 0; v > u; u++)if (this._eachByHierarchical(U, w.getChildAt(u), X) === !1) return !1; return !0 }, reverseEachByHierarchical: function (W, T, d) { if (T) return this._reverseEachByHierarchical(W, T, d); for (var c = this._roots, x = c.size(), H = x - 1; H >= 0; H--)if (this._reverseEachByHierarchical(W, c.get(H), d) === !1) return !1; return !0 }, _reverseEachByHierarchical: function (B, U, f) { for (var A = U.size(), p = A - 1; p >= 0; p--)if (this._reverseEachByHierarchical(B, U.getChildAt(p), f) === !1) return !1; if (f) { if (B.call(f, U) === !1) return !1 } else if (B(U) === !1) return !1; return !0 }, eachByDepthFirst: function (E, n, Z) { if (n) return this._11I(E, n, Z); for (var o = 0, X = this._roots, c = X.size(); c > o; o++)if (this._11I(E, X.get(o), Z) === !1) return !1; return !0 }, _11I: function (Z, P, T) { for (var I = P.size(), S = 0; I > S; S++)if (this._11I(Z, P.getChildAt(S), T) === !1) return !1; if (T) { if (Z.call(T, P) === !1) return !1 } else if (Z(P) === !1) return !1; return !0 }, eachByBreadthFirst: function (Q, A, Y) { var C = new Ul; for (A ? C.add(A) : this._roots.each(C.add, C); C.size() > 0;)if (A = C.removeAt(0), A.eachChild(C.add, C), Y) { if (Q.call(Y, A) === !1) return !1 } else if (Q(A) === !1) return !1; return !0 }, moveTo: function (K, k) { var W = this.getSiblings(K), _ = W.indexOf(K); _ === k || 0 > _ || k >= 0 && k <= W.size() && (W.remove(K), k > W.size() && k-- , W.add(K, k), this._38I(K, _, k)) }, moveUp: function (d) { this.moveTo(d, this.getSiblings(d).indexOf(d) - 1) }, moveDown: function (u) { this.moveTo(u, this.getSiblings(u).indexOf(u) + 1) }, moveToTop: function (x) { this.moveTo(x, 0) }, moveToBottom: function (E) { this.moveTo(E, this.getSiblings(E).size()) }, moveSelectionUp: function (F) { F || (F = this.sm()); var Q = new Ul; eh(F, Q, this._roots), Q.each(this.moveUp, this) }, moveSelectionDown: function (s) { s || (s = this.sm()); var T = new Ul; Zf(s, T, this._roots), T.each(this.moveDown, this) }, moveSelectionToTop: function (G) { G || (G = this.sm()); var B = new Ul; Eb(G, B, this._roots), B.each(this.moveToTop, this) }, moveSelectionToBottom: function (p) { p || (p = this.sm()); var o = new Ul; Vf(p, o, this._roots), o.each(this.moveToBottom, this) }, moveToIndex: function (n, D, H) { var A = this.getDatas(); null == H && (H = A.indexOf(n)), H === D || 0 > H || D >= 0 && D <= A.size() && (A.remove(n), D > A.size() && D-- , A.add(n, D), this._76I(n, H, D)) }, bringForward: function (D) { this.moveToIndex(D, this.getDatas().indexOf(D) + 1) }, bringToFront: function (j) { this.moveToIndex(j, this.size()) }, sendBackward: function (S) { this.moveToIndex(S, this.getDatas().indexOf(S) - 1) }, sendToBack: function (u) { this.moveToIndex(u, 0) }, bringSelectionForward: function (R) { R || (R = this.sm()); for (var v = new Ul, m = this.getDatas(), y = !1, M = 0; M < m.size(); M++) { var o = m.get(m.size() - 1 - M); R.contains(o) ? y && v.add(o) : y = !0 } v.each(this.bringForward, this) }, bringSelectionToFront: function (k) { k || (k = this.sm()); for (var H = new Ul, L = this.getDatas(), A = 0; A < L.size(); A++) { var E = L.get(A); k.contains(E) && H.add(E) } H.each(this.bringToFront, this) }, sendSelectionBackward: function (x) { x || (x = this.sm()); for (var i = new Ul, v = this.getDatas(), Q = !1, _ = 0; _ < v.size(); _++) { var e = v.get(_); x.contains(e) ? Q && i.add(e) : Q = !0 } i.each(this.sendBackward, this) }, sendSelectionToBack: function (L) { L || (L = this.sm()); for (var d = new Ul, H = this.getDatas(), j = 0; j < H.size(); j++) { var v = H.get(H.size() - 1 - j); L.contains(v) && d.add(v) } d.each(this.sendToBack, this) }, addScheduleTask: function (h) { var a = this; a.removeScheduleTask(h), h.enabled == l && (h.enabled = !0), h.interval == l && (h.interval = 10), h.action == l && (h.action = ym), h.lastTime = Date.now(), a._29Q.push(h), a._30Q == l && (a._30Q = y.requestAnimationFrame(a._scheduleCallback)) }, removeScheduleTask: function (k) { var v = this, H = v._29Q, F = H.indexOf(k); F >= 0 && H.splice(F, 1), H.length || v._30Q == l || (y.cancelAnimationFrame(v._30Q), delete v._30Q) } }); var vf = R.SelectionModel = function (j) { var F = this; F._68O = rp, F._map = {}, F._73O = new Ul, F._74I = new bf, F._21I(j) }; Df("SelectionModel", F, { ms_fire: 1, ms_dm: 1, ms: function (y, R, F) { this.addSelectionChangeListener(y, R, F) }, ums: function (V, I) { this.removeSelectionChangeListener(V, I) }, fd: function () { return this.getFirstData() }, ld: function () { return this.getLastData() }, sg: function () { return this._68O === tl }, co: function (t) { return this._map[t._id] != l }, ss: function (H) { this.setSelection(H) }, as: function (n) { this.appendSelection(n) }, rs: function (J) { this.removeSelection(J) }, cs: function () { this.clearSelection() }, sa: function () { this.selectAll() }, getSelectionMode: function () { return this._68O }, setSelectionMode: function (a) { var h = this; if (h._68O !== a && (a === js || a === tl || a === rp)) { h.cs(); var d = h._68O; h._68O = a, h.fp("selectionMode", d, a) } }, _21I: function (o) { var a = this, n = a._dataModel; n !== o && (n && (a.cs(), n.umm(a.handleDataModelChange, a)), a._dataModel = o, o.mm(a.handleDataModelChange, a, !0), a.fp(Mj, n, o)) }, dispose: function () { var w = this; w.cs(), w._dataModel.umm(w.handleDataModelChange, w) }, handleDataModelChange: function (G) { var p = this; if (G.kind === ee) { var l = G.data; p.co(l) && (p._73O.remove(l), delete p._map[l._id], p._75I(ee, new Ul(l))) } else G.kind === rr && p.cs() }, getFilterFunc: function () { return this._filterFunc }, setFilterFunc: function (B) { var h = this; if (h._filterFunc !== B) { h.cs(); var n = h._filterFunc; h._filterFunc = B, h.fp("filterFunc", n, h._filterFunc) } }, _75I: function (C, S, Z, d) { Z && (this._73O.each(function (U) { d[U._id] ? Z.remove(U) : Z.add(U) }), S = Z.toList()), this._74I.fire({ kind: C, datas: new Ul(S) }) }, addSelectionChangeListener: function (k, J, D) { this._74I.add(k, J, D) }, removeSelectionChangeListener: function (T, v) { this._74I.remove(T, v) }, _97O: function (J, W) { for (var E, m = this, X = 0, x = new Ul(J); X < x.size(); X++)E = x.get(X), (m._filterFunc && !m._filterFunc(E) || W && m.co(E) || !W && !m.co(E) || !m._dataModel.contains(E)) && (x.removeAt(X), X--); return x }, appendSelection: function (I) { var z = this; if (z._68O !== js) { var P, l, D = z._73O, G = z._97O(I, !0); G.isEmpty() || (z.sg() && (P = new Ul(D), l = z._map, D.clear(), z._map = {}, G = new Ul(G.get(G.size() - 1))), G.each(function (G) { D.add(G), z._map[G._id] = G }), z._75I("append", G, P, l)) } }, removeSelection: function (D) { var W = this, f = W._97O(D), g = 0, X = f.size(); if (0 !== X) { for (; X > g; g++) { var R = f.get(g); W._73O.remove(R), delete W._map[R._id] } W._75I(ee, f) } }, toSelection: function (F, h) { return this._73O.toList(F, h) }, getSelection: function () { return this._73O }, each: function (Q, v) { this._73O.each(Q, v) }, setSelection: function (O) { var G = this, J = G._73O; if (G._68O !== js && !(J.isEmpty() && !O || 1 === J.size() && G.ld() === O)) { var r = new Ul(J), o = G._map; J.clear(), G._map = {}; var K = G._97O(O, !0); G.sg() && K.size() > 1 && (K = new Ul(K.get(K.size() - 1))), K.each(function (w) { J.add(w), G._map[w._id] = w }), G._75I("set", l, r, o) } }, clearSelection: function () { var N = this, t = N._73O; if (t.size() > 0) { var W = t.toList(); t.clear(), N._map = {}, N._75I(rr, W) } }, selectAll: function () { var I = this; if (I._68O !== js) { var A, z, u = I._dataModel.toDatas(); if (I._filterFunc) for (A = 0; A < u.size(); A++)z = u.get(A), I._filterFunc(z) || (u.removeAt(A), A--); var X = I._73O, $ = new Ul(X), c = I._map; X.clear(), I._map = {}, I.sg() && u.size() > 1 && (u = new Ul(u.get(u.size() - 1))); var b = u.size(); for (A = 0; b > A; A++)z = u.get(A), X.add(z), I._map[z._id] = z; I._75I("all", l, $, c) } }, size: function () { return this._73O.size() }, isEmpty: function () { return this._73O.isEmpty() }, contains: function (T) { return this._map[T._id] != l }, getLastData: function () { var H = this._73O; return H.size() > 0 ? H.get(H.size() - 1) : l }, getFirstData: function () { var t = this._73O; return t.size() > 0 ? t.get(0) : l }, isSelectable: function (Y) { var E = this; return Y && E._68O !== js ? E._filterFunc ? E._filterFunc(Y) : !0 : !1 }, getTopSelection: function () { var Y = this, X = new Ul; return Y._73O.each(function (Q) { for (var z = Q.getParent(); z;) { if (Y.contains(z)) { Q = l; break } z = z.parent } Q && X.add(Q) }), X } }); var yl = function () { return tr(0), function (q, p) { var $; if (Fb(p)) { var Y = q.getDataUI(p); Y && Y._88I && ($ = Y._88I.rect) } return $ ? $ : p.getRect() } }(); _i(m, { edgeGroupAgentFunc: l, graphViewAutoScrollZone: 16, graphViewResettable: !1, graphViewPannable: !0, graphViewRectSelectable: !0, graphViewScrollBarVisible: !0, graphViewRectSelectBorderColor: d.rectSelectBorder, graphViewRectSelectBackground: oh, graphViewEditPointSize: P ? 17 : 7, graphViewEditPointBorderColor: d.editPointBorder, graphViewEditPointBackground: d.editPointBackground, setEdgeType: function (X, h, c) { fk[X] = h, Rq[X] = c }, getEdgeType: function (Q) { return fk[Q] }, getEdgeTypeMap: function () { return fk }, getNodeRect: yl }, !0), _i(M, { "2d.selectable": !0, "2d.visible": !0, "2d.movable": !0, "2d.editable": !0, "2d.move.mode": Z, "image.stretch": "fill", icons: Z, ingroup: !0, "body.color": Z, opacity: Z, pixelPerfect: !0, "clip.direction": "top", "clip.percentage": 1, "select.color": cl, "select.width": 1, "select.padding": 2, "select.type": vd, shadow: !1, "shadow.blur": 6, "shadow.offset.x": 3, "shadow.offset.y": 3, "border.color": Z, "border.width": 2, "border.padding": 2, "border.type": vd, label: Z, "label.font": Z, "label.color": xn, "label.background": Z, "label.position": 31, "label.position.fixed": !1, "label.offset.x": 0, "label.offset.y": 2, "label.rotation": Z, "label.max": Z, "label.opacity": Z, "label.scale": 1, "label.align": Z, "label.selectable": !0, label2: Z, "label2.font": Z, "label2.color": xn, "label2.background": Z, "label2.position": 34, "label2.position.fixed": !1, "label2.offset.x": 0, "label2.offset.y": -2, "label2.rotation": Z, "label2.max": Z, "label2.opacity": Z, "label2.scale": 1, "label2.align": Z, "label2.selectable": !0, note: Z, "note.expanded": !0, "note.font": Z, "note.color": _c, "note.background": cl, "note.position": 8, "note.offset.x": -3, "note.offset.y": 3, "note.max": Z, "note.toggleable": !0, "note.border.width": 1, "note.border.color": Z, "note.opacity": Z, "note.scale": 1, "note.align": Z, note2: Z, "note2.expanded": !0, "note2.font": Z, "note2.color": _c, "note2.background": cl, "note2.position": 3, "note2.offset.x": 3, "note2.offset.y": -3, "note2.max": Z, "note2.toggleable": !0, "note2.border.width": 1, "note2.border.color": Z, "note2.opacity": Z, "note2.scale": 1, "note2.align": Z, "group.type": Z, "group.image": Z, "group.image.stretch": "fill", "group.repeat.image": Z, "group.padding": 8, "group.padding.left": 0, "group.padding.right": 0, "group.padding.top": 0, "group.padding.bottom": 0, "group.position": 17, "group.toggleable": !0, "group.title.font": Z, "group.title.color": _c, "group.title.background": d.groupTitleBackground, "group.title.align": Xr, "group.background": d.groupBackground, "group.depth": 1, "group.border.width": 1, "group.border.pattern": Z, "group.border.color": ph, "group.border.cap": ji, "group.border.join": Xq, "group.gradient": l, "group.gradient.color": "#FFF", shape: Z, "shape.background": ph, "shape.repeat.image": Z, "shape.border.width": 0, "shape.border.width.absolute": !1, "shape.border.color": ph, "shape.border.3d": !1, "shape.border.3d.color": Z, "shape.border.3d.accuracy": Z, "shape.border.cap": ji, "shape.border.join": Xq, "shape.border.pattern": Z, "shape.gradient": l, "shape.gradient.color": "#FFF", "shape.depth": 0, "shape.dash": !1, "shape.dash.pattern": Ki, "shape.dash.offset": 0, "shape.dash.color": Cd, "shape.dash.width": Z, "shape.dash.3d": !1, "shape.dash.3d.color": Z, "shape.dash.3d.accuracy": Z, "shape.polygon.side": 6, "shape.arc.from": s, "shape.arc.to": B, "shape.arc.close": !0, "shape.arc.oval": !1, "shape.corner.radius": Z, "shape.gradient.pack": Z, "shape.fill.rule": "nonzero", "shape.fill.clip.direction": "top", "shape.fill.clip.percentage": 1, "autolayout.gap": Z, "autolayout.hgap": Z, "autolayout.vgap": Z, "edge.type": Z, "edge.points": Z, "edge.segments": Z, "edge.color": ph, "edge.width": 2, "edge.width.absolute": !1, "edge.offset": 20, "edge.group": 0, "edge.expanded": !0, "edge.gap": 12, "edge.toggleable": !0, "edge.center": !1, "edge.3d": !1, "edge.3d.color": Z, "edge.3d.accuracy": Z, "edge.cap": ji, "edge.join": Xq, "edge.source.position": 17, "edge.source.anchor.x": Z, "edge.source.anchor.y": Z, "edge.source.offset.x": 0, "edge.source.offset.y": 0, "edge.target.position": 17, "edge.target.anchor.x": Z, "edge.target.anchor.y": Z, "edge.target.offset.x": 0, "edge.target.offset.y": 0, "edge.pattern": Z, "edge.dash": !1, "edge.dash.pattern": Ki, "edge.dash.offset": 0, "edge.dash.color": Cd, "edge.dash.width": Z, "edge.dash.3d": !1, "edge.dash.3d.color": Z, "edge.dash.3d.accuracy": Z, "edge.independent": !1, "attach.row.index": 0, "attach.column.index": 0, "attach.row.span": 1, "attach.column.span": 1, "attach.padding": 0, "attach.padding.left": 0, "attach.padding.right": 0, "attach.padding.top": 0, "attach.padding.bottom": 0, "attach.index": -1, "attach.offset": 0, "attach.offset.relative": !1, "attach.offset.opposite": !1, "attach.thickness": Z, "attach.gap": 0, "attach.gap.relative": !1, "grid.row.count": 1, "grid.column.count": 1, "grid.row.percents": Z, "grid.column.percents": Z, "grid.border": 1, "grid.border.left": 0, "grid.border.right": 0, "grid.border.top": 0, "grid.border.bottom": 0, "grid.gap": 1, "grid.background": d.gridBackground, "grid.depth": 1, "grid.cell.depth": -1, "grid.cell.border.color": d.gridCellBorderColor, "grid.block": Z, "grid.block.padding": 3, "grid.block.width": 1, "grid.block.color": d.gridBlockColor, text: "", "text.align": "left", "text.vAlign": "middle", "text.color": xn, "text.font": Ek, "text.shadow": !1, "text.shadow.color": kc, "text.shadow.blur": 6, "text.shadow.offset.x": 3, "text.shadow.offset.y": 3 }, !0), _i(Mn, {
            _76I: function (T, l, u) { this._39I && this._39I.fire({ data: T, oldIndex: l, newIndex: u }) }, addIndexChangeListener: function (h, O, q) { var X = this; X._39I || (X._39I = new bf), X._39I.add(h, O, q) }, removeIndexChangeListener: function (p, x) { this._39I.remove(p, x) }, prepareRemove: function (i) {
            zl(i) && (i.setSource(l), i.setTarget(l)), i._70O && i._70O.toList().each(this.remove, this), i._69O && i._69O.toList().each(function (c) {
                c.setHost(l)
            }), i._host && i.setHost(l)
            }, onAdded: function (y) { this.isAutoAdjustIndex() && this.adjustIndex(y) }, onDataPropertyChanged: function (a, H) { Wn[H.property] && this.isAutoAdjustIndex() && this.adjustIndex(a) }, isAdjustable: function (q) { return $j(q) || zl(q) }, isAdjustedToBottom: function (n) { return mf(n) ? n.isExpanded() && sd(n) : !1 }, adjustIndex: function (w) { var G = this; this.isHierarchicalRendering() || (G.isAdjustedToBottom(w) ? (G.sendToBottom(w), w.eachChild(G.adjustIndex, G)) : G.sendToTop(w)) }, sendToTop: function (n) { var z = this; if (z.contains(n) && z.isAdjustable(n)) { var Y = z._datas; if (n !== Y.get(z.size() - 1)) { var N = Y.indexOf(n); Y.removeAt(N), Y.add(n), z._76I(n, N, z.size() - 1) } if (zl(n)) { var h = n._40I; h && !z.isAdjustedToBottom(h) && z.sendToTop(h), h = n._41I, h && !z.isAdjustedToBottom(h) && z.sendToTop(h) } n._69O && n._69O.each(function ($) { $.isRelatedTo(n) || $j(n) && $.isLoopedHostOn(n) || z.sendToTop($) }), n.ISubGraph || (!mf(n) || n.isExpanded()) && n._adjustChildrenToTop && n.eachChild(function (K) { zl(K) || z.sendToTop(K) }) } }, sendToBottom: function (X, Y) { var v = this; if (X !== Y && v.contains(X) && v.isAdjustable(X) && (!Y || v.contains(Y))) { var b = v._datas, c = b.remove(X), M = Y ? v._datas.indexOf(Y) : 0; if (b.add(X, M), c !== M) { v._76I(X, c, M); var N = X._parent; !N || N.ISubGraph || zl(N) || v.sendToBottom(X._parent, X) } } }
        }), _i(Xc, { ms_edit: function (R) { R._46O = function (b) { var V = this, m = V.gv.dm(), v = m.getHistoryManager(), c = V._index, w = V._89I, L = V._node, Q = V._shape, M = V._edge, H = V._77I; L && w ? (this.fi({ kind: "endEditRect", event: b, data: L, direction: w }), v && v.endInteraction()) : Q && c >= 0 ? (V.fi({ kind: "endEditPoint", event: b, data: Q, index: c }), v && v.endInteraction()) : M && c >= 0 ? (V.fi({ kind: "endEditPoint", event: b, data: M, index: c }), v && v.endInteraction()) : H && (V.fi({ kind: "endEditRotation", event: b, data: H }), v && v.endInteraction()) }, R._78I = function (P) { var V = this; V.autoScroll(P); var f = V.gv.lp(P), E = V._index, G = V._89I, w = V._node, b = V._shape, O = V._edge, i = V._77I; if (w && G) V._80O(f), V.fi({ kind: "betweenEditRect", event: P, data: w, direction: G }); else if (b && E >= 0) f.e = b.getPoints().get(E).e, b.setPoint(E, f), V.fi({ kind: "betweenEditPoint", event: P, data: b, index: E }); else if (O && E >= 0) { var L = O.s(Go); f.e = L.get(E).e, L.set(E, f), O.fp(Go, l, L), V.fi({ kind: "betweenEditPoint", event: P, data: O, index: E }) } else if (i) { var X = i.p(), F = i.getScale(), o = c + I(f.y - X.y, f.x - X.x); F.y < 0 && (o += s), A(o) < .04 && (o = 0), i.setRotation(o), V.fi({ kind: "betweenEditRotation", event: P, data: i }) } }, R._80O = function (x) { var U = this, p = U._node, c = U._rect, Z = c.x, h = c.y, X = c.width, b = c.height, S = U._89I, y = U._anchor, l = U._matrix, x = l.tfi(x); "northwest" === S ? c = eb(x, { x: Z + X, y: h + b }) : S === il ? c = eb({ x: Z, y: x.y }, { x: Z + X, y: h + b }) : "northeast" === S ? c = eb({ x: Z, y: x.y }, { x: x.x, y: h + b }) : S === tp ? c = eb({ x: x.x, y: h }, { x: Z + X, y: h + b }) : S === Je ? c = eb({ x: Z, y: h }, { x: x.x, y: h + b }) : "southwest" === S ? c = eb({ x: x.x, y: h }, { x: Z + X, y: x.y }) : "south" === S ? c = eb({ x: Z, y: h }, { x: Z + X, y: x.y }) : "southeast" === S && (c = eb({ x: Z, y: h }, x)), p.setPosition(l.tf(c.x + c.width * y.x, c.y + c.height * y.y)), p.setWidth(c.width), p.setHeight(c.height) }, R._80I = function (I, E, s, D) { var A = this, T = A.gv._zoom, L = (A.gv.getEditPointSize() + 2) / T; return lg({ x: E - L / 2, y: s - L / 2, width: L, height: L }, I) ? (A._89I !== D && (A._89I = D), !0) : !1 }, R._79I = function (k, Y, K) { var n = this, A = n.gv, x = Y ? A.getDataUI(Y) : l, j = x ? x._55O : l; if (j) { var e, X, o, B, z = A._zoom, w = (A.getEditPointSize() + 2) / z, J = A.lp(k); if ($j(Y)) { if (j._56O && $j(Y) && (X = j._98o, lg({ x: X.x - w / 2, y: X.y - w / 2, width: w, height: w }, J))) return n._77I = Y, K && n.fi({ kind: "beginEditRotation", event: k, data: Y }), n.setCursor("crosshair"), !0; if (j._43O && Y instanceof oq) for (o = Y.getPoints(), e = o.size() - 1; e >= 0; e--)if (X = o.get(e), lg({ x: X.x - w / 2, y: X.y - w / 2, width: w, height: w }, J)) return n._index = e, n._shape = Y, K && n.fi({ kind: "beginEditPoint", event: k, data: Y, index: e }), n.setCursor("crosshair"), !0; if (j._42O) for (var u = Y.getEditControlPoints(), Z = ["northwest", -1, -1, tp, -1, 0, "southwest", -1, 1, "south", 0, 1, "southeast", 1, 1, Je, 1, 0, "northeast", 1, -1, il, 0, -1], e = 0, B = u.length; B > e; e++) { var I = Z[3 * e], s = u[e]; if (n._80I(J, s.x, s.y, I)) { n._node = Y; var F = Y.getWidth(), b = Y.getHeight(), v = Y.getAnchor(); n._rect = { x: -F * v.x, y: -b * v.y, width: F, height: b }, n._anchor = v, n._matrix = Y.getMatrix(); var V = Y.getRotation(), m = S(V), M = t(V), g = Z[3 * e + 1] * bl(Y.getScale().x), i = Z[3 * e + 2] * bl(Y.getScale().y), O = Math.atan2(-M * g - m * i, m * g - M * i), D = (Math.round(O / (Math.PI / 4)) + 8) % 8, _ = [wg, "nesw-resize", zg, "nwse-resize", wg, "nesw-resize", zg, "nwse-resize"][D]; return n.setCursor(_), K && n.fi({ kind: "beginEditRect", event: k, data: Y, direction: n._89I }), !0 } } } if (j._43O && zl(Y) && Y.s(jj) === fg && (o = Y.s(Go))) for (e = o.size() - 1; e >= 0; e--)if (X = o.get(e), lg({ x: X.x - w / 2, y: X.y - w / 2, width: w, height: w }, J)) return n._index = e, n._edge = Y, K && n.fi({ kind: "beginEditPoint", event: k, data: Y, index: e }), n.setCursor("crosshair"), !0 } return !1 } }, ms_gv: function (g) { g._currentSubGraph = l, g.upSubGraph = function () { this.setCurrentSubGraph(cg(this._currentSubGraph)) }, g.isVisible = function (p) { var X = this; if (cg(p) !== X._currentSubGraph) return !1; if (zl(p)) { var f = p._40I, m = p._41I; if (!f || !m) return !1; if (!(p.s("edge.independent") || X.isVisible(f) && X.isVisible(m))) return !1; if (p.isEdgeGroupHidden()) return !1 } else for (var J = p._parent; J && !J.ISubGraph;) { if (mf(J) && (!J.isExpanded() || !X.isVisible(J))) return !1; J = J._parent } if (p._parent instanceof Wo && !X.isVisible(p._parent)) return !1; if (p._refGraph instanceof hp && !X.isVisible(p._refGraph)) return !1; if (X instanceof Gl) { if (!p.s("3d.visible")) return !1 } else if (!p.s("2d.visible")) return !1; return X._visibleFunc ? X._visibleFunc(p) : !0 }, g.handleSelectionChange = function (A) { var m = this; A.datas.each(function (E) { m.invalidateData(E); var r = E._parent; mf(r) && $j(E) && E.s(Rk) && (m.invalidateData(r), r._49I && r._49I.each(function (v) { m.invalidateData(v) })) }), m.onSelectionChanged(A) }, g.onSelectionChanged = function (W) { var H = this, F = H.sm(); if (1 === F.size() && ("set" === W.kind || "append" === W.kind)) { var $ = F.ld(); H.isAutoMakeVisible() && H.makeVisible($), H.adjustIndex && H._dataModel.isAutoAdjustIndex() && H.adjustIndex($) } }, g.makeVisible = function (h) { if (h) { var Y = this, p = Y.getDataUI ? Y.getDataUI(h) : Y.getData3dUI(h); if (p) { var a = h, N = cg(h); for (N !== Y._currentSubGraph && Y.setCurrentSubGraph(N); (a = a._parent) && a !== N;)mf(a) && a.setExpanded(!0); Y._23I = h, Y.iv() } } }, g.getLabel = function (R) { var Q = R.getStyle(Sc); return Q === Z ? R.getName() : Q }, g.getLabelBackground = function (v) { return v.getStyle("label.background") }, g.getLabelColor = function (X) { return X.getStyle("label.color") }, g.getLabel2 = function (r) { return r.getStyle("label2") }, g.getLabel2Background = function (n) { return n.getStyle("label2.background") }, g.getLabel2Color = function (l) { return l.getStyle("label2.color") }, g.getNote = function (Z) { return Z.getStyle(Yf) }, g.getNoteBackground = function (M) { return M.getStyle("note.background") }, g.getNote2 = function (p) { return p.getStyle(Wd) }, g.getNote2Background = function (D) { return D.getStyle("note2.background") }, g.handleClick = function (S, Z, m) { var e = this; Z ? (e.fi({ kind: "clickData", event: S, data: Z, part: m }), e.onDataClicked(Z, S)) : (e.fi({ kind: "clickBackground", event: S }), e.onBackgroundClicked(S)) }, g.handleDoubleClick = function (F, n, S) { var N = this; Vg(F) && (n ? (N.fi({ kind: "doubleClickData", event: F, data: n, part: S }), N.onDataDoubleClicked(n, F, S), N.checkDoubleClickOnNote(F, n, S) || N.checkDoubleClickOnRotation && N.checkDoubleClickOnRotation(F, n, S) || (zl(n) ? N.onEdgeDoubleClicked(n, F, S) : n.ISubGraph ? N.onSubGraphDoubleClicked(n, F, S) : mf(n) ? N.onGroupDoubleClicked(n, F, S) : n.IDoorWindow ? N.onDoorWindowDoubleClicked(n, F, S) : n.ICSGBox && N.onCSGBoxDoubleClicked(n, F, S))) : (N.fi({ kind: "doubleClickBackground", event: F }), N.onBackgroundDoubleClicked(F))) }, g.onSubGraphDoubleClicked = function (Y) { this.setCurrentSubGraph(Y) }, g.onEdgeDoubleClicked = function (T, D) { T.ISubGraph && !ec(D) ? this.setCurrentSubGraph(T) : T.s("edge.toggleable") && T.toggle() }, g.onGroupDoubleClicked = function (V) { V.s("group.toggleable") && V.toggle() }, g.onDoorWindowDoubleClicked = function (E) { E.s("dw.toggleable") && E.toggle(!0) }, g.onCSGBoxDoubleClicked = function (q, p) { var Y = this; if (Y instanceof Gl) { var d = Y.getHitFaceInfo(p); d && d.face && q.s(d.face + ".toggleable") && q.toggleFace(d.face, !0) } }, g.onBackgroundClicked = function () { }, g.onBackgroundDoubleClicked = function () { this.upSubGraph() }, g.onDataClicked = function () { }, g.onDataDoubleClicked = function () { }, g.onAutoLayoutEnded = function () { }, g.onMoveEnded = function () { }, g.onPanEnded = function () { }, g.onPinchEnded = function () { }, g.onRectSelectEnded = function () { }, g.onZoomEnded = function () { } }, ms_icons: function (q) { q.getRotation = function (J) { return J == l ? 0 : J }, q._15O = function () { var n = this, Y = n.s(Vl); if (Y) { var L = n, D = n.data || n._data, q = n._38o = { icons: Y, rects: {} }; for (var A in Y) { var E = Y[A], v = oi(E.shape3d, D, L); if (!(oi(E.visible, D, L) === !1 || oi(E.for3d, D, L) && !n.I3d || v && !n.I3d)) { var P = v ? [v] : oi(E.names, D, L), b = P ? P.length : 0, x = oi(E.position, D, L) || 3, $ = oi(E.offsetX, D, L) || 0, V = oi(E.offsetY, D, L) || 0, a = oi(E.direction, D, L) || Je, o = oi(E.gap, D, L), t = o != l ? o : 1, e = oi(E.rotation, D, L), X = oi(E.keepOrien, D, L), M = oi(E.rotationFixed, D, L) ? e : n.getRotation(e, X, x), p = l, K = q.rects[A] = new Array(b); K.rotation = M; for (var r = 0; b > r; r++) { var m, g, j, u, N = P[r]; if (v) j = 0, u = 0; else { var I = yj(N); j = oi(E.width, D, L), u = oi(E.height, D, L), j == l && (j = nq(I, D)), u == l && (u = Jf(I, D)) } if (p ? a === Je ? $ += j / 2 : a === tp ? $ -= j / 2 : a === il ? V -= u / 2 : V += u / 2 : p = { width: j, height: u }, n.I3d) { var C = -j / 2, S = -u / 2; g = { width: j, height: u, mat: n._16O(oi(E.autorotate, D, L), x, p, oi(E.face, D, L) || Mb, oi(E.t3, D, L), oi(E.r3, D, L), oi(E.rotationMode, D, L), $, V), vs: new ub([C, -S, 0, C, -S - u, 0, C + j, -S - u, 0, C + j, -S, 0]) } } else m = n.getPosition(x, $, V, p, oi(E.positionFixed, D, L)), g = { x: m.x - j / 2, y: m.y - u / 2, width: j, height: u }, n._68o(g, M); K[r] = g, a === Je ? $ += j / 2 + t : a === tp ? $ -= j / 2 + t : a === il ? V -= u / 2 + t : V += u / 2 + t } } } } } } }); var Fe = { 1: 1, 2: 1, 6: 1, 9: 1, 10: 1, 14: 1, 15: 1, 16: 1, 21: 1, 22: 1, 26: 1, 29: 1, 30: 1, 34: 1, 36: 1, 38: 1, 40: 1, 42: 1, 45: 1, 50: 1, 52: 1, 54: 1 }, Nk = { 3: 1, 7: 1, 11: 1, 17: 1, 23: 1, 27: 1, 31: 1, 44: 1, 46: 1, 47: 1, 49: 1 }, Hp = { translateX: 1, translateY: 1, zoom: 1, scrollBarVisible: 1 }, Wn = { sourceAgent: 1, targetAgent: 1, expanded: 1, parent: 1, host: 1 }, Ej = { position: 1, width: 1, height: 1, expanded: 1, rotation: 1, anchor: 1, scale: 1, "s:edge.points": 1 }, Ve = { "edge.type": 1, "edge.group": 1 }, ir = { rotation: 1, rotationX: 1, rotationZ: 1 }, lf = { position: 1, width: 1, height: 1, anchor: 1, scale: 1, "s:grid.row.count": 1, "s:grid.column.count": 1, "s:grid.row.percents": 1, "s:grid.column.percents": 1, "s:grid.border": 1, "s:grid.border.left": 1, "s:grid.border.right": 1, "s:grid.border.top": 1, "s:grid.border.bottom": 1, "s:grid.gap": 1 }, ms = { "attach.row.index": 1, "attach.column.index": 1, "attach.row.span": 1, "attach.column.span": 1, "attach.padding": 1, "attach.padding.left": 1, "attach.padding.right": 1, "attach.padding.top": 1, "attach.padding.bottom": 1, "attach.index": 1, "attach.offset": 1, "attach.offset.relative": 1, "attach.offset.opposite": 1, "attach.gap": 1, "attach.gap.relative": 1, "attach.thickness": 1 }, lp = { shape: 1, thickness: 1, position: 1, anchor: 1, scale: 1 }, Uj = function (R, I) { if (!R || !mf(I) || I.isEmpty()) return !1; for (R = R._parent; mf(R);) { if (R === I) return !0; R = R._parent } return !1 }, Tj = function (d, e) { if (!d || !Od(e) || e.isEmpty()) return !1; for (d = d._parent; Od(d);) { if (d === e) return !0; d = d._parent } return !1 }, cg = function (g) { if (!g) return l; if (zl(g)) { var b = g._40I, K = g._41I; if (!b || !K) return l; var Z = cg(b), h = cg(K); return Z === h ? Z : l } for (var t = g._parent; zl(t) && !t.ISubGraph;)t = t._parent; return t ? t.ISubGraph ? t : cg(t) : l }, Lk = function (m, _, Y, z) { var R = _.getStyle(Y) * z; R && Bb(m, R), R = _.getStyle(Y + ".left") * z, R && (m.x -= R, m.width += R), R = _.getStyle(Y + ".right") * z, R && (m.width += R), R = _.getStyle(Y + ".top") * z, R && (m.y -= R, m.height += R), R = _.getStyle(Y + ".bottom") * z, R && (m.height += R), m.width < 0 && (m.width = -m.width, m.x -= m.width), m.height < 0 && (m.height = -m.height, m.y -= m.height) }, sd = function (T) { for (var o, B = 0, r = T.size(); r > B; B++)if (o = T.getChildAt(B), $j(o) && sd(o)) return !0; return T.hasAgentEdges() }, aq = function (I) { if (!I) return l; for (var B = I._parent; mf(B);) { if (!mf(B._parent)) return B.isExpanded() ? I : B; B.isExpanded() || (I = B), B = B._parent } return I }, of = function (D, k) { if (!D || !k) return l; var G, L, y, J = cg(D), R = cg(k); if (J !== R) { for (; R && J !== R;)R = cg(R); if (J === R) return D; G = new Ul, G.add(D, 0); for (var u = D._parent; $j(u) && !k.isDescendantOf(u);)G.add(u, 0), u = u._parent; for (y = G.size(), L = 0; y > L; L++) { var _ = G.get(L); if (mf(_) && !_.isExpanded()) return _; if (_.ISubGraph) return _ } return D } return D }, pq = function (Y) { if (Y.isLooped()) return Y._source; var K = aq(Y._source), M = aq(Y._target); return K === M ? Y._source : of(K, M) }, Zn = function (F) { if (F.isLooped()) return F._target; var c = aq(F._source), l = aq(F._target); return c === l ? F._target : of(l, c) }, yq = function (i, V, a, I, r, h, A) { if (!V) return l; var O, w = V.getRotation ? V.getRotation() : 0; if (h !== Z || A !== Z) if (h = h === Z ? .5 : h, A = A === Z ? .5 : A, w && !Fb(V, i)) { var M = V.getPosition(), W = V.getWidth(), U = V.getHeight(), q = V.getAnchor(), L = V.getScale(), D = new Qh(w, M.x, M.y, L.x, L.y); a = D.tf((h - q.x) * W, (A - q.y) * U) } else O = yl(i, V), a = { x: O.x + h * O.width, y: O.y + A * O.height }; else a = $e(a, yl(i, V)); if (w) { var f = S(w), n = t(w), H = I * f - r * n; r = I * n + r * f, I = H } return a.x += I, a.y += r, a }, ui = function (n, s) { if (!n || !s) return l; var e, K, p, b, W, X; if (n === s) { if (b = n.getLoopedEdges(), !b) return l; b = new Ul(b) } else { if (W = n.getAgentEdges(), X = s.getAgentEdges(), !W || !X) return l; for (K = W.size(), e = 0; K > e; e++)p = W.get(e), X.contains(p) && (b || (b = new Ul), b.add(p)) } if (b) for (e = 0; e < b.size(); e++)p = b.get(e), p.getStyle(jj) === fg && (p._22I(l), b.removeAt(e), e--); return b }, ci = function (m, c) { var B = ui(m, c); if (B && !B.isEmpty()) { if (1 === B.size()) return B.get(0)._22I(l), void 0; var J = new Ul, s = new Ul; B.each(function (l) { var L = l.s("edge.group"); J.contains(L) || J.add(L) }), J.sort(), J.each(function (C) { s.add(new R.EdgeGroup(B.toList(function (_) { return C === _.s("edge.group") }), s)) }), s.each(function (r) { r.each(function (V) { V._22I(r) }) }) } }, kg = function (s, U) { if (U) { var v = U.rect, P = U.color, x = U.rotation, K = U.labelWidth, m = U.background, R = U.opacity, w = U.scale, n = w != l && 1 !== w; if (R != l) { var G = s.globalAlpha; s.globalAlpha *= R } if (x || n) { s.save(); var N = v.x + v.width / 2, Y = v.y + v.height / 2; bo(s, N, Y), x && Nc(s, x), n && s.scale(w, w), bo(s, -N, -Y) } if (m && qo(s, v.x, v.y, v.width, v.height, m), K) { var C = v.width, h = s.createLinearGradient(v.x, v.y, v.x + C, v.y); h.addColorStop(0, P), h.addColorStop(.9, P), h.addColorStop(1, Zg), P = h, v.width = K } Ai(s, U.ss, v, U.font, P, U.align), K && (v.width = C), (x || n) && s.restore(), R != l && (s.globalAlpha = G) } }, jo = function (u, o) { if (o) { var x = o.rect, A = x.x, n = x.y, Q = x.width, I = x.height, y = o.background, q = o.backgroundImage, k = o.borderWidth, S = o.borderColor, w = o.labelWidth, U = o.opacity, V = o.scale, g = V != l && 1 !== V; if (U != l) { var P = u.globalAlpha; u.globalAlpha *= U } if (g) { u.save(); var d = x.x + x.width / 2, J = x.y + x.height / 2; bo(u, d, J), u.scale(V, V), bo(u, -d, -J) } if (o.expanded) { var C = b(8, Q / 4), K = n + I - 8; if (u.fillStyle = y, u.beginPath(), u.moveTo(A, n), u.lineTo(A, K), u.lineTo(A + Q / 2, K), u.lineTo(A + Q / 2, n + I), u.lineTo(A + Q / 2 + C, K), u.lineTo(A + Q, K), u.lineTo(A + Q, n), u.closePath(), u.fill(), k && (u.lineWidth = k, u.lineJoin = "round", u.lineCap = "round", S ? (u.strokeStyle = S, u.stroke()) : (u.strokeStyle = kl(y), u.beginPath(), u.moveTo(A + Q, n), u.lineTo(A + Q, K), u.lineTo(A + Q / 2 + C, K), u.lineTo(A + Q / 2, n + I), u.stroke(), u.strokeStyle = ke(y), u.beginPath(), u.moveTo(A + Q, n), u.lineTo(A, n), u.lineTo(A, K), u.lineTo(A + Q / 2, K), u.lineTo(A + Q / 2, n + I), u.stroke())), q) ff(u, yj(q), Jh, x.x, x.y, x.width, x.height - 8, o.data, o.view); else { if (x.height -= 8, y = o.color, w) { var Z = Q, T = u.createLinearGradient(A, n, A + Z, n); T.addColorStop(0, y), T.addColorStop(.9, y), T.addColorStop(1, Zg), y = T, x.width = w } Ai(u, o.ss, x, o.font, y, o.align), w && (x.width = Z), x.height += 8 } } else if (o.icon) mp(u, yj(o.icon), A, n, Q, I, o.data, o.view); else { var F = Q / 2; k && (u.lineWidth = k, u.lineJoin = "round", u.lineCap = "round", u.strokeStyle = S ? S : kl(y), u.beginPath(), u.arc(A + F, n + F, F, c, 1.6 * s, !0), u.moveTo(A + F, n + I), u.lineTo(A + Q - F / 5, n + F), u.stroke(), u.strokeStyle = S ? S : ke(y), u.beginPath(), u.arc(A + F, n + F, F, 1.6 * s, c, !0), u.moveTo(A + F, n + I), u.lineTo(A + F / 5, n + F), u.stroke()), u.fillStyle = y, u.beginPath(), u.arc(A + F, n + F, F, 0, B, !0), u.moveTo(A + F, n + I), u.lineTo(A + Q - F / 5, n + F), u.lineTo(A + F / 5, n + F), u.closePath(), u.fill(), u.fillStyle = o.color, u.beginPath(), u.arc(A + F, n + F, F / 3, 0, B, !0), u.fill() } g && u.restore(), U != l && (u.globalAlpha = P) } }, pj = function (r, Q) { return Q > 2 * r ? r : Q / 2 }, cf = function ($, i, V, L) { if (!$ || !i) return 0; var U = I(i.y - $.y, i.x - $.x); return V || (U = i.x < $.x ? U + s : U), U + L }, Ue = function (n, V, u, R, E, U, r) { r && (n.x > V.x || n.x === V.x && n.y > V.y) && (u = nj[u], E = -E); var L = $e(u, { x: 0, y: 0, width: Bk(n, V), height: 0 }, U); return L.x += R, L.y += E, L = new Qh(I(V.y - n.y, V.x - n.x)).tf(L), L.x += n.x, L.y += n.y, L }, Ji = function (H, b, E, n, i) { if (H._19Q = !0, !E.getEdgeGroup()) return n ? E.s("edge.gap") : 0; var O, k = 0, x = 0, p = 0; if (E.getEdgeGroup().getSiblings().each(function (v) { v.each(function (S) { if (b.isVisible(S) && S.s(jj) == i) { var B = S.s("edge.gap"); O ? (x += p / 2 + B / 2, p = B) : (O = S, p = B), S === E && (k = x) } }) }), n) return x - k + p; var j = k - x / 2; return O && E._40I !== O._40I && (H._19Q = !1), j }, An = function () { var M = function (j) { var n = []; return j.forEach(function (W) { n.push({ x: W.x, y: W.y }), n.push({ x: W.x + W.width, y: W.y + W.height }), n.push({ x: W.x + W.width, y: W.y }), n.push({ x: W.x, y: W.y + W.height }) }), n }; return function (f, Z, L) { if ("oval" === f) { var h = 0, _ = L.height / L.width, U = _ * _, P = L.x + L.width / 2, r = L.y + L.height / 2, t = M(Z); t.forEach(function (C) { var e = C.x - P, n = C.y - r, S = e * e + n * n / U; S > h && (h = S) }), h = o(h); var k = _ * h; return { x: P - h, y: r - k, width: 2 * h, height: 2 * k } } if ("circle" === f) { var K = 0, P = L.x + L.width / 2, r = L.y + L.height / 2, t = M(Z); return t.forEach(function (e) { var m = e.x - P, E = e.y - r, n = m * m + E * E; n > K && (K = n) }), K = o(K), { x: P - K, y: r - K, width: 2 * K, height: 2 * K } } return "roundRect" === f ? (Bb(L, b(L.width, L.height) / 16), L) : L } }(), Oo = R.graph = {}, Xp = function (i, q, R) { uo(K + ".graph." + i, q, R) }; R.layout = {}; var Bd = { comps: [{ type: mi, points: [85, 50, 70, 115, 100, 71, 86, 107, 88, 49, 43, 99, 108, 86, 76, 43, 103, 70, 112, 55, 73, 120, 97, 49, 105, 77, 75, 72, 86, 56, 51, 116, 57, 97, 108, 117, 118, 121, 83, 100, 111, 100, 85, 61], borderWidth: 1, borderColor: l }] }; Bd[fh] = Bd[Yj] = 160, uk("node_image", Xh(30, 30, [{ type: vd, rect: [4, 5, 22, 16], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [2, 3, 26, 20], borderWidth: 1, borderColor: ph }, { type: vd, rect: [11, 23, 8, 4], background: ph }, { type: vd, rect: [6, 27, 18, 2], background: ph }])), uk("node_icon", Xh(16, 16, [{ type: vd, rect: [2, 2, 12, 10], gradient: $m, gradientColor: _k, background: ph }, { type: Uo, rect: [2, 2, 12, 10], width: 1, color: ph }, { type: vd, rect: [6, 12, 4, 2], background: ph }, { type: vd, rect: [4, 14, 8, 1], background: ph }])), uk("block_icon", Xh(16, 16, [{ type: Uo, rect: [1, 1, 14, 14], width: 1, color: ph }])), uk("group_image", Xh(66, 39, [{ type: vd, rect: [44.3, 18, 18.1, 12.8], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [3.3, 17.8, 18.1, 12.8], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [15.8, 3.2, 33.5, 26.4], borderWidth: 1, borderColor: ph, gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [26.2, 29.4, 12.8, 4.2], background: ph }, { type: vd, rect: [21.3, 33.5, 22.5, 2.3], background: ph }, { type: vd, rect: [5.3, 32.7, 14.1, 2.1], background: ph }, { type: vd, rect: [9, 30.4, 6.7, 2.4], background: ph }, { type: vd, rect: [50, 30.7, 6.7, 2.4], background: ph }, { type: vd, rect: [46.3, 33, 14.1, 2.1], background: ph }])), uk("group_icon", Xh(16, 16, [{ type: vd, rect: [4, 12, 4, 2], background: ph }, { type: vd, rect: [2, 13, 8, 1], background: ph }, { type: vd, rect: [12, 12, 2, 1], background: ph }, { type: vd, rect: [11, 13, 4, 1], background: ph }, { type: vd, rect: [10, 7, 6, 5], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [1, 2, 10, 10], gradient: $m, gradientColor: _k, background: ph }, { type: Uo, rect: [1, 2, 10, 10], width: 1, color: ph }])), uk("refGraph_icon", Xh(16, 16, [{ type: "shape", borderWidth: 1, borderColor: ph, borderCap: "round", rotation: .7854, points: [12.5502, 6.7981, 12.5502, 6.7981, 12.5502, 4.8181, 12.5502, 3.7981, 12.5502, 2.7781, 11.36687, 1.7981, 10.0502, 1.7981, 8.73354, 1.7981, 7.5502, 2.8181, 7.5502, 3.7981, 7.5502, 4.55989, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 9.7981, 10.0502, 9.7981], segments: [1, 4, 4, 4, 4, 4] }, { type: "shape", borderWidth: 1, borderColor: ph, borderCap: "round", rotation: -2.35619, points: [8.4498, 11.2019, 8.4498, 11.2019, 8.4498, 9.2219, 8.4498, 8.2019, 8.4498, 7.1819, 7.26646, 6.2019, 5.9498, 6.2019, 4.63313, 6.2019, 3.4498, 7.2219, 3.4498, 8.2019, 3.4498, 8.9637, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 14.2019, 5.9498, 14.2019], segments: [1, 4, 4, 4, 4, 4] }])), uk("edge_icon", Xh(16, 16, [{ type: vd, rect: [2.1, 6.9, 11.5, 2.6], rotation: -.79, gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [10.8, 1, 4, 4], background: ph }, { type: vd, rect: [1, 11, 4, 4], background: ph }])), uk("subGraph_image", Xh(72, 45, [{ type: mi, points: [9, 42, .3, 38.4, 2.4, 28.8, 5.7, 21.6, 11.7, 22.5, 11.7, 15.9, 16.8, 13.8, 21.6, 12, 24.3, 15.9, 27.9, 3, 42.3, 2.1, 59.4, 4.5, 57.3, 18.3, 67.5, 18.9, 69.6, 27.3, 69.9, 38.4, 64.2, 41.4], segments: [1, 3, 3, 3, 3, 3, 3, 3, 3], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [29.6, 30.7, 3.6, 1.8], background: ph }, { type: vd, rect: [28.4, 32.3, 6, 1.2], background: ph }, { type: vd, rect: [37.3, 32, 10.8, 1.8], background: ph }, { type: vd, rect: [39.1, 29.9, 7.2, 2.3], background: ph }, { type: vd, rect: [26.6, 23.7, 9.6, 7.2], gradient: $m, gradientColor: _k, background: ph }, { type: vd, rect: [34.3, 16.8, 16.8, 13.2], borderWidth: 1, borderColor: ph, gradient: $m, gradientColor: _k, background: ph }])), uk("subGraph_icon", Xh(17, 17, [{ type: mi, points: [2.2, 14.6, .2, 11.9, .8, 8.8, 1.8, 5.9, 5.6, 7.4, 3.8, 1.6, 10.3, 3, 14.5, 4.2, 12.2, 7.5, 18.9, 7.2, 14.5, 14.5], segments: [1, 3, 3, 3, 3, 3], gradient: $m, gradientColor: _k, background: ph }])), uk("shape_icon", Xh(16, 16, [{ type: mi, points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1], background: ph }])), uk("polyline_icon", Xh(16, 16, [{ type: mi, points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1], borderWidth: 1, borderColor: ph }, Zm(7.5, .4), Zm(7.5, 6.3), Zm(13.6, 6.3), Zm(13.6, 14), Zm(.7, 13.9), Zm(.7, .3)])), uk("grid_icon", Xh(16, 16, [{ type: vd, rect: [1, 1, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [6, 1, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [11, 1, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [11, 6, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [6, 6, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [1, 6, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [11, 11, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [6, 11, 4, 4], background: ph, gradient: $m, gradientColor: _k }, { type: vd, rect: [1, 11, 4, 4], background: ph, gradient: $m, gradientColor: _k }])), uk("light_icon", Xh(16, 16, [{ type: "rect", rect: [6, 9, 5, 5], borderWidth: 1, borderColor: ph }, { type: "circle", rect: [1, 1, 15, 10], borderWidth: 1, borderColor: ph, gradient: $m, gradientColor: _k, background: { func: function (M) { var Z = M ? M.s(uf) : l; return sp(Z) ? "rgb(" + n(255 * Z[0]) + "," + n(255 * Z[1]) + "," + n(255 * Z[2]) + ")" : Z || ph } } }])), uk("text_icon", Xh(16, 16, [{ type: "shape", points: [3, 3, 13, 3, 8, 3, 8, 14], segments: [1, 2, 1, 2], borderWidth: 1, borderColor: ph }])), uk("border_image", { fitSize: !0, comps: [{ type: "border", relative: !0, rect: [0, 0, 1, 1], color: { func: "style@border_color" }, width: { func: "style@border_width" } }] }), uk("columnChart_image", { fitSize: !0, comps: [{ type: { func: "style@chart.type" }, relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, series: { func: "style@chart.series" }, minValue: { func: "style@chart.min.value" }, maxValue: { func: "style@chart.max.value" } }] }), uk("lineChart_image", { fitSize: !0, comps: [{ type: "lineChart", relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, series: { func: "style@chart.series" }, minValue: { func: "style@chart.min.value" }, maxValue: { func: "style@chart.max.value" }, linePoint: { func: "style@chart.line.point" }, lineWidth: { func: "style@chart.line.width" }, line3d: { func: "style@chart.line.3d" } }] }), uk("pieChart_image", { fitSize: !0, comps: [{ type: "pieChart", relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, hollow: { func: "style@chart.hollow" }, startAngle: { func: "style@chart.start.angle" }, values: { func: "style@chart.values" }, colors: { func: "style@chart.colors" } }] }); var Ff = function (G, q) { for (var M = G.vertices, N = 0; N < M.length; N++) { var V = M[N], U = V.y; V.y = V.z, V.z = -U, q && (V.y += q) } }, rd = function (s) { for (var B, G, n, U, k, v, Q = [], t = [], q = [], E = s.faces, F = 0, Z = 0, S = 0, A = E.length; A > F; F++ , Z += 6, S += 9) { var T = E[F]; 1 === T.i ? (B || (B = [], G = [], n = []), dr(T, F, Z, S, s, B, n, G)) : 2 === T.i ? (U || (U = [], k = [], v = []), dr(T, F, Z, S, s, U, v, k)) : dr(T, F, Z, S, s, Q, q, t) } return { vs: Q, uv: t, ns: q, top_vs: B, top_uv: G, top_ns: n, bottom_vs: U, bottom_uv: k, bottom_ns: v } }, dr = function (t, e, x, k, Z, G, J, j) { var u = Z.vertices, X = Z.faceVertexUvs, K = u[t.a], E = u[t.b], T = u[t.c]; G[k] = K.x, G[k + 1] = K.y, G[k + 2] = K.z, G[k + 3] = E.x, G[k + 4] = E.y, G[k + 5] = E.z, G[k + 6] = T.x, G[k + 7] = T.y, G[k + 8] = T.z; var s = t.vertexNormals; if (3 === s.length) { var C = s[0], g = s[1], W = s[2]; J[k] = C.x, J[k + 1] = C.y, J[k + 2] = C.z, J[k + 3] = g.x, J[k + 4] = g.y, J[k + 5] = g.z, J[k + 6] = W.x, J[k + 7] = W.y, J[k + 8] = W.z } else { var R = t.normal; J[k] = R.x, J[k + 1] = R.y, J[k + 2] = R.z, J[k + 3] = R.x, J[k + 4] = R.y, J[k + 5] = R.z, J[k + 6] = R.x, J[k + 7] = R.y, J[k + 8] = R.z } var m = X[0][e][0], Q = X[0][e][1], H = X[0][e][2]; j[x] = m.x, j[x + 1] = m.y, j[x + 2] = Q.x, j[x + 3] = Q.y, j[x + 4] = H.x, j[x + 5] = H.y }, Xb = function (T, j, Q, e, I, k, m, N, a) { Q == l && (Q = !0), e == l && (e = !0), m == l && (m = 1), N == l && (N = 0); var L = new me; return vq(L, T, j, a), L = L.toShapes(), rd(new xj(L, { top: Q, bottom: e, curveSegments: I, amount: m, repeatUVLength: k }, -m / 2 + N)) }, ol = function (X, $) { this.x = X || 0, this.y = $ || 0 }; ol.prototype = { constructor: ol, add: function (l) { return this.x += l.x, this.y += l.y, this }, sub: function (D) { return this.x -= D.x, this.y -= D.y, this }, equals: function (W) { return W.x === this.x && W.y === this.y }, multiplyScalar: function (w) { return this.x *= w, this.y *= w, this }, distanceTo: function (P) { return o(this.distanceToSquared(P)) }, distanceToSquared: function (y) { var m = this.x - y.x, e = this.y - y.y; return m * m + e * e }, clone: function () { return new ol(this.x, this.y) } }; var lc = function (s, F, S) { this.x = s || 0, this.y = F || 0, this.z = S || 0 }; lc.prototype = { constructor: lc, set: function (C, V, W) { return this.x = C, this.y = V, this.z = W, this }, setY: function (p) { return this.y = p, this }, copy: function (s) { return this.x = s.x, this.y = s.y, this.z = s.z, this }, add: function (A) { return this.x += A.x, this.y += A.y, this.z += A.z, this }, addVectors: function (N, Z) { return this.x = N.x + Z.x, this.y = N.y + Z.y, this.z = N.z + Z.z, this }, sub: function (n) { return this.x -= n.x, this.y -= n.y, this.z -= n.z, this }, subVectors: function (x, N) { return this.x = x.x - N.x, this.y = x.y - N.y, this.z = x.z - N.z, this }, multiplyScalar: function (j) { return this.x *= j, this.y *= j, this.z *= j, this }, applyMatrix4: function (i) { var o = this.x, c = this.y, x = this.z, N = i.elements; return this.x = N[0] * o + N[4] * c + N[8] * x + N[12], this.y = N[1] * o + N[5] * c + N[9] * x + N[13], this.z = N[2] * o + N[6] * c + N[10] * x + N[14], this }, divideScalar: function (A) { if (0 !== A) { var a = 1 / A; this.x *= a, this.y *= a, this.z *= a } else this.x = 0, this.y = 0, this.z = 0; return this }, dot: function (K) { return this.x * K.x + this.y * K.y + this.z * K.z }, length: function () { return o(this.x * this.x + this.y * this.y + this.z * this.z) }, normalize: function () { return this.divideScalar(this.length()) }, cross: function (h) { var p = this.x, N = this.y, w = this.z; return this.x = N * h.z - w * h.y, this.y = w * h.x - p * h.z, this.z = p * h.y - N * h.x, this }, crossVectors: function (X, E) { var D = X.x, _ = X.y, n = X.z, m = E.x, g = E.y, V = E.z; return this.x = _ * V - n * g, this.y = n * m - D * V, this.z = D * g - _ * m, this }, distanceTo: function (V) { return o(this.distanceToSquared(V)) }, distanceToSquared: function (d) { var I = this.x - d.x, O = this.y - d.y, C = this.z - d.z; return I * I + O * O + C * C }, clone: function () { return new lc(this.x, this.y, this.z) } }; var Eq = function () { this.elements = new Float32Array(16) }; Eq.prototype = { constructor: Eq, set: function (C, u, e, _, o, X, F, B, w, b, E, M, H, j, z, l) { var D = this.elements; return D[0] = C, D[4] = u, D[8] = e, D[12] = _, D[1] = o, D[5] = X, D[9] = F, D[13] = B, D[2] = w, D[6] = b, D[10] = E, D[14] = M, D[3] = H, D[7] = j, D[11] = z, D[15] = l, this }, makeRotationAxis: function (l, O) { var b = S(O), r = t(O), s = 1 - b, c = l.x, L = l.y, P = l.z, o = s * c, i = s * L; return this.set(o * c + b, o * L - r * P, o * P + r * L, 0, o * L + r * P, i * L + b, i * P - r * c, 0, o * P - r * L, i * P + r * c, s * P * P + b, 0, 0, 0, 0, 1), this } }; var Jd = function (C) { this.repeatUVLength = C }; Jd.prototype = { generateTopUV: function (U, d, N, M, B, g, n) { var R, H, o, m, F = U.vertices, G = F[M].x, z = F[M].y, h = F[B].x, u = F[B].y, v = F[g].x, _ = F[g].y, T = this.repeatUVLength; if (T) R = 0, H = 0, o = T, m = T; else { this._bb || (this._bb = d.getBoundingBox()); var J = this._bb; R = J.minX, H = J.minY, o = J.maxX - R, m = J.maxY - H } return n ? [new ol((G - R) / o, (z - H) / m), new ol((h - R) / o, (u - H) / m), new ol((v - R) / o, (_ - H) / m)] : [new ol((G - R) / o, 1 - (z - H) / m), new ol((h - R) / o, 1 - (u - H) / m), new ol((v - R) / o, 1 - (_ - H) / m)] }, generateBottomUV: function (F, d, R, r, C, z) { return this.generateTopUV(F, d, R, r, C, z, !0) }, generateSideWallUV: function (z, M, i, k, v, A, R, $, Y, q, X, g) { if (!this._cl) { for (var t, c, U = [], u = 0, J = i.length, K = 0; J > K; K++) { t = i[K], c = i[(K + 1) % J]; var s = t.x - c.x, x = t.y - c.y, C = o(s * s + x * x); U.push(u), u += C } for (var K = 0; J > K; K++)U[K] /= u; this._cl = U } var U = this._cl, T = 1 - Y / q, b = 1 - (Y + 1) / q, Z = U[X], r = U[g]; return r > Z && (Z += 1), [new ol(Z, T), new ol(r, T), new ol(r, b), new ol(Z, b)] } }; var qd = function (Z, q, d, J, f, U) { this.a = Z, this.b = q, this.c = d, this.i = U, this.normal = J instanceof lc ? J : new lc, this.vertexNormals = J instanceof Array ? J : [] }; qd.prototype = { constructor: qd }; var Uq = [-8, 13, -7, 11, -1, 7, 0, 8, -1], Pl = function () { if (Pl[rs] != l) return Pl[rs]; for (var B = zo[rs], x = Uq, V = Zl.prototype.getClassName(), M = '"', W = 0, r = "", i = !1, R = +new (y[V.substr(3, 3) + wg[W]]), b = W; b < x.length; b++) { var m = x.length - b; r += b % 2 === W ? x[b] + m + "" : x[b] - m + "" } for (var b = W; 4 > b; b++)r += W; if (false) { if (B) { for (var u, q, c, S, j, o, A, w, k = "", K = 0, b = 0; b < B.length; b++)B[b] === M ? w ? (w = !1, 0 !== K % 2 && (u ? q ? c ? S ? j ? o ? A || (A = k) : o = k : j = k : S = k : c = k : q = k : u = k), K++ , k = "") : w = !0 : w && (k += B[b]); var H = u + q + c + j + o; (i = rn(H, A)) && q.indexOf(Yd[0]) >= 0 && (Pl[Yd[0]] = 1), i && q.indexOf(1) > 0 && (Pl[1] = 1), i && q.indexOf(2) > 0 && (Pl[2] = 1) } } else i = !0, Pl[Yd[0]] = Pl[1] = Pl[2] = 1; return Pl[rs] = i, i }, xf = function () { }, pb = xf.prototype; pb.getPointAt = function (w) { var x = this.getUtoTmapping(w); return this.getPoint(x) }, pb.getPoints = function ($) { $ || ($ = 5); var z, m = []; for (z = 0; $ >= z; z++)m.push(this.getPoint(z / $)); return m }, pb.getSpacedPoints = function (A) { A || (A = 5); var S, J = []; for (S = 0; A >= S; S++)J.push(this.getPointAt(S / A)); return J }, pb.getLength = function () { var j = this.getLengths(); return j[j.length - 1] }, pb.getLengths = function (t) { if (t || (t = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length == t + 1 && !this.needsUpdate) return this.cacheArcLengths; this.needsUpdate = !1; var C, J, _ = [], g = this.getPoint(0), u = 0; for (_.push(0), J = 1; t >= J; J++)C = this.getPoint(J / t), u += C.distanceTo(g), _.push(u), g = C; return this.cacheArcLengths = _, _ }, pb.getUtoTmapping = function (L, g) { var r, U = this.getLengths(), u = 0, E = U.length; r = g ? g : L * U[E - 1]; for (var X, J = 0, H = E - 1; H >= J;)if (u = G(J + (H - J) / 2), X = U[u] - r, 0 > X) J = u + 1; else { if (!(X > 0)) { H = u; break } H = u - 1 } if (u = H, U[u] == r) { var O = u / (E - 1); return O } var Z = U[u], A = U[u + 1], k = A - Z, Y = (r - Z) / k, O = (u + Y) / (E - 1); return O }, pb.getTangent = function (x) { var j = 1e-4, E = x - j, B = x + j; 0 > E && (E = 0), B > 1 && (B = 1); var l = this.getPoint(E), _ = this.getPoint(B), W = _.clone().sub(l); return W.normalize() }, pb.getTangentAt = function (A) { var E = this.getUtoTmapping(A); return this.getTangent(E) }, xf.create = function (K, b) { return K.prototype = ul(xf.prototype), K.prototype.getPoint = b, K }; var Vq = function () { this.curves = [], this.autoClose = !1 }, Bh = Vq.prototype = ul(pb); Bh.add = function (I) { this.curves.push(I) }, Bh.closePath = function () { var b = this.curves[0].getPoint(0), u = this.curves[this.curves.length - 1].getPoint(1); b.equals(u) || this.curves.push(new wp(u, b)) }, Bh.getPoint = function (K) { for (var X, x, g = K * this.getLength(), O = this.getCurveLengths(), Y = 0; Y < O.length;) { if (O[Y] >= g) { X = O[Y] - g, x = this.curves[Y]; var N = 1 - X / x.getLength(); return x.getPointAt(N) } Y++ } return null }, Bh.getLength = function () { var l = this.getCurveLengths(); return l[l.length - 1] }, Bh.getCurveLengths = function () { if (this.cacheLengths && this.cacheLengths.length == this.curves.length) return this.cacheLengths; var v, j = [], B = 0, t = this.curves.length; for (v = 0; t > v; v++)B += this.curves[v].getLength(), j.push(B); return this.cacheLengths = j, j }, Bh.getTransformedPoints = function (v) { return this.getPoints(v) }, Bh.getBoundingBox = function () { var Z, P, n, K, J, S, v = this.getPoints(); Z = P = Number.NEGATIVE_INFINITY, K = J = Number.POSITIVE_INFINITY; var B, l, x, d, u = v[0] instanceof lc; for (d = u ? new lc : new ol, l = 0, x = v.length; x > l; l++)B = v[l], B.x > Z && (Z = B.x), B.x < K && (K = B.x), B.y > P && (P = B.y), B.y < J && (J = B.y), u && (B.z > n && (n = B.z), B.z < S && (S = B.z)), d.add(B); var R = { minX: K, minY: J, maxX: Z, maxY: P }; return u && (R.maxZ = n, R.minZ = S), R }; var ij = function (M) { Vq.call(this), this.actions = [], M && this.fromPoints(M) }, No = ij.prototype = ul(Vq.prototype), yp = "moveTo", rb = "lineTo", nc = "quadraticCurveTo", fd = "bezierCurveTo", Ae = "arc", rq = "ellipse"; No.fromPoints = function (l) { this.moveTo(l[0].x, l[0].y); for (var e = 1, V = l.length; V > e; e++)this.lineTo(l[e].x, l[e].y) }, No.moveTo = function () { var o = Array.prototype.slice.call(arguments); this.actions.push({ action: yp, args: o }) }, No.lineTo = function (i, M) { var W = Array.prototype.slice.call(arguments), K = this.actions[this.actions.length - 1].args, n = K[K.length - 2], r = K[K.length - 1], $ = new wp(new ol(n, r), new ol(i, M)); this.curves.push($), this.actions.push({ action: rb, args: W }) }, No.quadraticCurveTo = function (H, b, n, W) { var a = Array.prototype.slice.call(arguments), l = this.actions[this.actions.length - 1].args, h = l[l.length - 2], v = l[l.length - 1], T = new Cm(new ol(h, v), new ol(H, b), new ol(n, W)); this.curves.push(T), this.actions.push({ action: nc, args: a }) }, No.bezierCurveTo = function (p, e, G, j, O, y) {
            var q = Array.prototype.slice.call(arguments), f = this.actions[this.actions.length - 1].args, n = f[f.length - 2], A = f[f.length - 1], m = new Ii(new ol(n, A), new ol(p, e), new ol(G, j), new ol(O, y));
            this.curves.push(m), this.actions.push({ action: fd, args: q })
        }, No.arc = function (b, o, $, v, Q, a) { var M = this.actions[this.actions.length - 1].args, l = M[M.length - 2], D = M[M.length - 1]; this.absarc(b + l, o + D, $, v, Q, a) }, No.absarc = function (M, Z, K, S, J, A) { this.absellipse(M, Z, K, K, S, J, A) }, No.ellipse = function (o, v, _, u, e, l, f) { var L = this.actions[this.actions.length - 1].args, Z = L[L.length - 2], j = L[L.length - 1]; this.absellipse(o + Z, v + j, _, u, e, l, f) }, No.absellipse = function (p, G, e, h, K, X, d) { var u = Array.prototype.slice.call(arguments), j = new ag(p, G, e, h, K, X, d); this.curves.push(j); var Y = j.getPoint(1); u.push(Y.x), u.push(Y.y), this.actions.push({ action: rq, args: u }) }, No.getSpacedPoints = function (H) { H || (H = 40); for (var E = [], m = 0; H > m; m++)E.push(this.getPoint(m / H)); return E }, No.getPoints = function (v, Q) { v = v || 12; var w, W, _, h, e, f, q, o, E, p, O, s, C, J, j, d, D, K, i = []; for (w = 0, W = this.actions.length; W > w; w++)switch (_ = this.actions[w], h = _.action, e = _.args, h) { case yp: i.push(new ol(e[0], e[1])); break; case rb: i.push(new ol(e[0], e[1])); break; case nc: for (f = e[2], q = e[3], p = e[0], O = e[1], i.length > 0 ? (J = i[i.length - 1], s = J.x, C = J.y) : (J = this.actions[w - 1].args, s = J[J.length - 2], C = J[J.length - 1]), j = 1; v >= j; j++)d = j / v, D = Mg.b2(d, s, p, f), K = Mg.b2(d, C, O, q), i.push(new ol(D, K)); break; case fd: for (f = e[4], q = e[5], p = e[0], O = e[1], o = e[2], E = e[3], i.length > 0 ? (J = i[i.length - 1], s = J.x, C = J.y) : (J = this.actions[w - 1].args, s = J[J.length - 2], C = J[J.length - 1]), j = 1; v >= j; j++)d = j / v, D = Mg.b3(d, s, p, o, f), K = Mg.b3(d, C, O, E, q), i.push(new ol(D, K)); break; case Ae: var U, F = e[0], M = e[1], c = e[2], z = e[3], N = e[4], u = !!e[5], m = N - z, I = 2 * v; for (j = 1; I >= j; j++)d = j / I, u || (d = 1 - d), U = z + d * m, D = F + c * S(U), K = M + c * t(U), i.push(new ol(D, K)); break; case rq: var U, F = e[0], M = e[1], $ = e[2], x = e[3], z = e[4], N = e[5], u = !!e[6], m = N - z, I = 2 * v; for (j = 1; I >= j; j++)d = j / I, u || (d = 1 - d), U = z + d * m, D = F + $ * S(U), K = M + x * t(U), i.push(new ol(D, K)) }var k = i[i.length - 1], L = 1e-10; return A(k.x - i[0].x) < L && A(k.y - i[0].y) < L && i.splice(i.length - 1, 1), Q && i.push(i[0]), i }, No.toShapes = function (C, x) { function L(X) { var H, U, S, E, w, R = [], x = new ij; for (H = 0, U = X.length; U > H; H++)S = X[H], w = S.args, E = S.action, E == yp && 0 != x.actions.length && (R.push(x), x = new ij), x[E].apply(x, w); return 0 != x.actions.length && R.push(x), R } function l(O) { for (var Y = [], l = 0, P = O.length; P > l; l++) { var F = O[l], S = new me; S.actions = F.actions, S.curves = F.curves, Y.push(S) } return Y } function q(V, B) { for (var Y = 1e-10, x = B.length, I = !1, K = x - 1, F = 0; x > F; K = F++) { var N = B[K], _ = B[F], o = _.x - N.x, L = _.y - N.y; if (A(L) > Y) { if (0 > L && (N = B[F], o = -o, _ = B[K], L = -L), V.y < N.y || V.y > _.y) continue; if (V.y == N.y) { if (V.x == N.x) return !0 } else { var n = L * (V.x - N.x) - o * (V.y - N.y); if (0 == n) return !0; if (0 > n) continue; I = !I } } else { if (V.y != N.y) continue; if (_.x <= V.x && V.x <= N.x || N.x <= V.x && V.x <= _.x) return !0 } } return I } var u = L(this.actions); if (0 == u.length) return []; if (x === !0) return l(u); var r, E, h, e = []; if (1 == u.length) return E = u[0], h = new me, h.actions = E.actions, h.curves = E.curves, e.push(h), e; var s = !Mg.isClockWise(u[0].getPoints()); s = C ? !s : s; var b, Q = [], v = [], o = [], P = 0; v[P] = Z, o[P] = []; var N, F; for (N = 0, F = u.length; F > N; N++)E = u[N], b = E.getPoints(), r = Mg.isClockWise(b), r = C ? !r : r, r ? (!s && v[P] && P++ , v[P] = { s: new me, p: b }, v[P].s.actions = E.actions, v[P].s.curves = E.curves, s && P++ , o[P] = []) : o[P].push({ h: E, p: b[0] }); if (!v[0]) return l(u); if (v.length > 1) { for (var S = !1, i = [], D = 0, f = v.length; f > D; D++)Q[D] = []; for (var D = 0, f = v.length; f > D; D++) { v[D]; for (var m = o[D], K = 0; K < m.length; K++) { for (var c = m[K], M = !0, T = 0; T < v.length; T++)q(c.p, v[T].p) && (D != T && i.push({ froms: D, tos: T, hole: K }), M ? (M = !1, Q[T].push(c)) : S = !0); M && Q[D].push(c) } } i.length > 0 && (S || (o = Q)) } var G, a, R; for (N = 0, F = v.length; F > N; N++)for (h = v[N].s, e.push(h), G = o[N], a = 0, R = G.length; R > a; a++)h.holes.push(G[a].h); return e }; var me = function () { ij.apply(this, arguments), this.holes = [] }, Gi = me.prototype = ul(No); Gi.getPointsHoles = function (R) { var L, o = this.holes.length, s = []; for (L = 0; o > L; L++)s[L] = this.holes[L].getTransformedPoints(R); return s }, Gi.extractAllPoints = function (h) { return { shape: this.getTransformedPoints(h), holes: this.getPointsHoles(h) } }, Gi.extractPoints = function (D) { return this.extractAllPoints(D) }; var Mg = { triangulateShape: function (E, f) { function P(k, o, p) { return k.x != o.x ? k.x < o.x ? k.x <= p.x && p.x <= o.x : o.x <= p.x && p.x <= k.x : k.y < o.y ? k.y <= p.y && p.y <= o.y : o.y <= p.y && p.y <= k.y } function d(D, y, _, B, G) { var I = 1e-10, f = y.x - D.x, r = y.y - D.y, Y = B.x - _.x, H = B.y - _.y, Q = D.x - _.x, b = D.y - _.y, x = r * Y - f * H, k = r * Q - f * b; if (A(x) > I) { var q; if (x > 0) { if (0 > k || k > x) return []; if (q = H * Q - Y * b, 0 > q || q > x) return [] } else { if (k > 0 || x > k) return []; if (q = H * Q - Y * b, q > 0 || x > q) return [] } if (0 == q) return !G || 0 != k && k != x ? [D] : []; if (q == x) return !G || 0 != k && k != x ? [y] : []; if (0 == k) return [_]; if (k == x) return [B]; var g = q / x; return [{ x: D.x + g * f, y: D.y + g * r }] } if (0 != k || H * Q != Y * b) return []; var T = 0 == f && 0 == r, l = 0 == Y && 0 == H; if (T && l) return D.x != _.x || D.y != _.y ? [] : [D]; if (T) return P(_, B, D) ? [D] : []; if (l) return P(D, y, _) ? [_] : []; var $, R, n, d, s, X, V, c; return 0 != f ? (D.x < y.x ? ($ = D, n = D.x, R = y, d = y.x) : ($ = y, n = y.x, R = D, d = D.x), _.x < B.x ? (s = _, V = _.x, X = B, c = B.x) : (s = B, V = B.x, X = _, c = _.x)) : (D.y < y.y ? ($ = D, n = D.y, R = y, d = y.y) : ($ = y, n = y.y, R = D, d = D.y), _.y < B.y ? (s = _, V = _.y, X = B, c = B.y) : (s = B, V = B.y, X = _, c = _.y)), V >= n ? V > d ? [] : d == V ? G ? [] : [s] : c >= d ? [s, R] : [s, X] : n > c ? [] : n == c ? G ? [] : [$] : c >= d ? [$, R] : [$, X] } function n(p, W, H, K) { var e = 1e-10, C = W.x - p.x, T = W.y - p.y, I = H.x - p.x, V = H.y - p.y, S = K.x - p.x, k = K.y - p.y, v = C * V - T * I, j = C * k - T * S; if (A(v) > e) { var m = S * V - k * I; return v > 0 ? j >= 0 && m >= 0 : j >= 0 || m >= 0 } return j > 0 } function H(U, Y) { function O(l, t) { var U = s.length - 1, F = l - 1; 0 > F && (F = U); var L = l + 1; L > U && (L = 0); var x = n(s[l], s[F], s[L], A[t]); if (!x) return !1; var e = A.length - 1, M = t - 1; 0 > M && (M = e); var o = t + 1; return o > e && (o = 0), x = n(A[t], A[M], A[o], s[l]), x ? !0 : !1 } function x(h, j) { var r, w, y; for (r = 0; r < s.length; r++)if (w = r + 1, w %= s.length, y = d(h, j, s[r], s[w], !0), y.length > 0) return !0; return !1 } function R(C, l) { var j, G, y, p, o; for (j = 0; j < B.length; j++)for (G = Y[B[j]], y = 0; y < G.length; y++)if (p = y + 1, p %= G.length, o = d(C, l, G[y], G[p], !0), o.length > 0) return !0; return !1 } for (var A, S, J, y, P, D, L, W, v, V, f, s = U.concat(), B = [], Q = [], b = 0, i = Y.length; i > b; b++)B.push(b); for (var w = 0, $ = 2 * B.length; B.length > 0 && ($-- , !(0 > $));)for (J = w; J < s.length; J++) { y = s[J], S = -1; for (var b = 0; b < B.length; b++)if (D = B[b], L = y.x + ":" + y.y + ":" + D, Q[L] === Z) { A = Y[D]; for (var h = 0; h < A.length; h++)if (P = A[h], O(J, h) && !x(y, P) && !R(y, P)) { S = h, B.splice(b, 1), W = s.slice(0, J + 1), v = s.slice(J), V = A.slice(S), f = A.slice(0, S + 1), s = W.concat(V).concat(f).concat(v), w = J; break } if (S >= 0) break; Q[L] = !0 } if (S >= 0) break } return s } for (var y, B, z, D, u, J, g = {}, L = E.concat(), e = 0, v = f.length; v > e; e++)Array.prototype.push.apply(L, f[e]); for (y = 0, B = L.length; B > y; y++)u = L[y].x + ":" + L[y].y, g[u] !== Z, g[u] = y; var M = H(E, f), S = Vc.Triangulate(M, !1); for (y = 0, B = S.length; B > y; y++)for (D = S[y], z = 0; 3 > z; z++)u = D[z].x + ":" + D[z].y, J = g[u], J !== Z && (D[z] = J); return S.concat() }, isClockWise: function (C) { return Vc.Triangulate.area(C) < 0 }, b2p0: function (P, A) { var M = 1 - P; return M * M * A }, b2p1: function (P, l) { return 2 * (1 - P) * P * l }, b2p2: function (I, l) { return I * I * l }, b2: function (Z, c, p, l) { return this.b2p0(Z, c) + this.b2p1(Z, p) + this.b2p2(Z, l) }, b3p0: function (w, M) { var t = 1 - w; return t * t * t * M }, b3p1: function (x, D) { var h = 1 - x; return 3 * h * h * x * D }, b3p2: function (F, m) { var K = 1 - F; return 3 * K * F * F * m }, b3p3: function (E, e) { return E * E * E * e }, b3: function (G, h, q, p, C) { return this.b3p0(G, h) + this.b3p1(G, q) + this.b3p2(G, p) + this.b3p3(G, C) } }, Vc = { faces: {}, face: "", weight: "normal", style: "normal", size: 150, divisions: 10, getDefaultFont: function () { var B = F.keys(this.faces); return B.length ? B[0] : null }, getFace: function () { try { return this.faces[this.face][this.weight][this.style] } catch (Y) { throw "The font " + this.face + " with " + this.weight + " weight and " + this.style + " style is missing." } }, loadFace: function (L) { var M = L.familyName.toLowerCase(), a = this; return a.faces[M] = a.faces[M] || {}, a.faces[M][L.cssFontWeight] = a.faces[M][L.cssFontWeight] || {}, a.faces[M][L.cssFontWeight][L.cssFontStyle] = L, L }, drawText: function (_) { var s, O = this.getFace(), Y = this.size / O.resolution, H = 0, r = String(_).split(""), x = r.length, V = []; for (s = 0; x > s; s++) { var p = new ij, C = this.extractGlyphPoints(r[s], O, Y, H, p); C && (H += C.offset * this.spacing, V.push(C.path)) } var m = H / 2; return { paths: V, offset: m } }, extractGlyphPoints: function (B, m, c, L, v) { var K, A, z, s, J, T, F, p, _, D, O, g, G, j, k, t, q, R, W, n = [], P = m.glyphs[B] || m.glyphs["?"]; if (P) { if (P.o) for (s = P._cachedOutline || (P._cachedOutline = P.o.split(" ")), T = s.length, F = c, p = c, K = 0; T > K;)switch (J = s[K++]) { case "m": _ = s[K++] * F + L, D = s[K++] * p, v.moveTo(_, D); break; case "l": _ = s[K++] * F + L, D = s[K++] * p, v.lineTo(_, D); break; case "q": if (O = s[K++] * F + L, g = s[K++] * p, k = s[K++] * F + L, t = s[K++] * p, v.quadraticCurveTo(k, t, O, g), W = n[n.length - 1]) for (G = W.x, j = W.y, A = 1, z = this.divisions; z >= A; A++) { var Y = A / z; Mg.b2(Y, G, k, O), Mg.b2(Y, j, t, g) } break; case "b": if (O = s[K++] * F + L, g = s[K++] * p, k = s[K++] * F + L, t = s[K++] * p, q = s[K++] * F + L, R = s[K++] * p, v.bezierCurveTo(k, t, q, R, O, g), W = n[n.length - 1]) for (G = W.x, j = W.y, A = 1, z = this.divisions; z >= A; A++) { var Y = A / z; Mg.b3(Y, G, k, q, O), Mg.b3(Y, j, t, R, g) } }return { offset: P.ha * c, path: v } } } }; Vc.generateShapes = function (d, z) { z = z || {}; var L = z.font; if (L === Z && (L = Vc.getDefaultFont(), !L)) return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."), []; var l = z.size !== Z ? z.size : 1, D = z.curveSegments !== Z ? z.curveSegments : 4, x = z.spacing !== Z ? z.spacing : 1, G = z.weight !== Z ? z.weight : "normal", O = z.style !== Z ? z.style : "normal"; Vc.size = l, Vc.divisions = D, Vc.face = L, Vc.weight = G, Vc.style = O, Vc.spacing = x; for (var e = Vc.drawText(d), j = e.paths, v = [], m = 0, w = j.length; w > m; m++)Array.prototype.push.apply(v, j[m].toShapes()); return v }, function (n) { var d = 1e-10, T = function (T, q) { var b = T.length; if (3 > b) return null; var r, J, Z, F = [], N = [], s = []; if (f(T) > 0) for (J = 0; b > J; J++)N[J] = J; else for (J = 0; b > J; J++)N[J] = b - 1 - J; var I = b, e = 2 * I; for (J = I - 1; I > 2;) { if (e-- <= 0) return q ? s : F; if (r = J, r >= I && (r = 0), J = r + 1, J >= I && (J = 0), Z = J + 1, Z >= I && (Z = 0), U(T, r, J, Z, I, N)) { var i, l, z, v, m; for (i = N[r], l = N[J], z = N[Z], F.push([T[i], T[l], T[z]]), s.push([N[r], N[J], N[Z]]), v = J, m = J + 1; I > m; v++ , m++)N[v] = N[m]; I-- , e = 2 * I } } return q ? s : F }, f = function (F) { for (var J = F.length, S = 0, c = J - 1, b = 0; J > b; c = b++)S += F[c].x * F[b].y - F[b].x * F[c].y; return .5 * S }, U = function (W, S, M, R, I, Z) { var _, f, n, T, i, B, V, v, s; if (f = W[Z[S]].x, n = W[Z[S]].y, T = W[Z[M]].x, i = W[Z[M]].y, B = W[Z[R]].x, V = W[Z[R]].y, d > (T - f) * (V - n) - (i - n) * (B - f)) return !1; var Q, w, p, y, m, q, Y, N, h, z, D, X, u, O, r; for (Q = B - T, w = V - i, p = f - B, y = n - V, m = T - f, q = i - n, _ = 0; I > _; _++)if (v = W[Z[_]].x, s = W[Z[_]].y, !(v === f && s === n || v === T && s === i || v === B && s === V) && (Y = v - f, N = s - n, h = v - T, z = s - i, D = v - B, X = s - V, r = Q * z - w * h, u = m * N - q * Y, O = p * X - y * D, r >= -d && O >= -d && u >= -d)) return !1; return !0 }; return n.Triangulate = T, n.Triangulate.area = f, n }(Vc), y._typeface_js = { faces: Vc.faces, loadFace: Vc.loadFace }; var dl = function () { this.vertices = [], this.faces = [], this.faceVertexUvs = [[]] }, fb = dl.prototype = { constructor: dl, computeFaceNormals: function () { for (var O = new lc, g = new lc, J = 0, T = this.faces.length; T > J; J++) { var E = this.faces[J], Z = this.vertices[E.a], Q = this.vertices[E.b], r = this.vertices[E.c]; O.subVectors(r, Q), g.subVectors(Z, Q), O.cross(g), O.normalize(), E.normal.copy(O) } }, computeVertexNormals: function (W) { var J, S, f, _, z, C; for (C = new Array(this.vertices.length), J = 0, S = this.vertices.length; S > J; J++)C[J] = new lc; if (W) { var M, R, n, B = new lc, t = new lc; for (f = 0, _ = this.faces.length; _ > f; f++)z = this.faces[f], M = this.vertices[z.a], R = this.vertices[z.b], n = this.vertices[z.c], B.subVectors(n, R), t.subVectors(M, R), B.cross(t), C[z.a].add(B), C[z.b].add(B), C[z.c].add(B) } else for (f = 0, _ = this.faces.length; _ > f; f++)z = this.faces[f], C[z.a].add(z.normal), C[z.b].add(z.normal), C[z.c].add(z.normal); for (J = 0, S = this.vertices.length; S > J; J++)C[J].normalize(); for (f = 0, _ = this.faces.length; _ > f; f++)z = this.faces[f], z.vertexNormals[0] = C[z.a].clone(), z.vertexNormals[1] = C[z.b].clone(), z.vertexNormals[2] = C[z.c].clone() }, mergeVertices: function () { var r, m, I, k, K, y, h, i, H = {}, N = [], F = [], a = 4, D = C(10, a); for (I = 0, k = this.vertices.length; k > I; I++)r = this.vertices[I], m = L(r.x * D) + "_" + L(r.y * D) + "_" + L(r.z * D), H[m] === Z ? (H[m] = I, N.push(this.vertices[I]), F[I] = N.length - 1) : F[I] = F[H[m]]; var A = []; for (I = 0, k = this.faces.length; k > I; I++) { K = this.faces[I], K.a = F[K.a], K.b = F[K.b], K.c = F[K.c], y = [K.a, K.b, K.c]; for (var j = 0; 3 > j; j++)if (y[j] == y[(j + 1) % 3]) { A.push(I); break } } for (I = A.length - 1; I >= 0; I--) { var T = A[I]; for (this.faces.splice(T, 1), h = 0, i = this.faceVertexUvs.length; i > h; h++)this.faceVertexUvs[h].splice(T, 1) } var n = this.vertices.length - N.length; return this.vertices = N, n } }, ag = function (f, v, t, u, a, R, H) { this.aX = f, this.aY = v, this.xRadius = t, this.yRadius = u, this.aStartAngle = a, this.aEndAngle = R, this.aClockwise = H }; ag.prototype = ul(pb), ag.prototype.getPoint = function (m) { var b, J = this.aEndAngle - this.aStartAngle; 0 > J && (J += B), J > B && (J -= B), b = this.aClockwise === !0 ? this.aEndAngle + (1 - m) * (B - J) : this.aStartAngle + m * J; var K = this.aX + this.xRadius * S(b), h = this.aY + this.yRadius * t(b); return new ol(K, h) }; var wp = function (x, $) { this.v1 = x, this.v2 = $ }, ih = wp.prototype = ul(pb); ih.getPoint = function (B) { var H = this.v2.clone().sub(this.v1); return H.multiplyScalar(B).add(this.v1), H }, ih.getPointAt = function (y) { return this.getPoint(y) }, ih.getTangent = function () { var o = this.v2.clone().sub(this.v1); return o.normalize() }; var Cm = function (S, s, Q) { this.v0 = S, this.v1 = s, this.v2 = Q }; Cm.prototype = ul(pb), Cm.prototype.getPoint = function (G) { var C, M; return C = Mg.b2(G, this.v0.x, this.v1.x, this.v2.x), M = Mg.b2(G, this.v0.y, this.v1.y, this.v2.y), new ol(C, M) }; var Ii = function (i, c, Y, z) { this.v0 = i, this.v1 = c, this.v2 = Y, this.v3 = z }; Ii.prototype = ul(pb), Ii.prototype.getPoint = function (i) { var q, E; return q = Mg.b3(i, this.v0.x, this.v1.x, this.v2.x, this.v3.x), E = Mg.b3(i, this.v0.y, this.v1.y, this.v2.y, this.v3.y), new ol(q, E) }, xf.create(function (e, T) { this.v1 = e, this.v2 = T }, function (f) { var W = new lc; return W.subVectors(this.v2, this.v1), W.multiplyScalar(f), W.add(this.v1), W }); var Vb = xf.create(function (Y, l, v) { this.v0 = Y, this.v1 = l, this.v2 = v }, function (P) { var C, R, w; return C = Mg.b2(P, this.v0.x, this.v1.x, this.v2.x), R = Mg.b2(P, this.v0.y, this.v1.y, this.v2.y), w = Mg.b2(P, this.v0.z, this.v1.z, this.v2.z), new lc(C, R, w) }), jr = xf.create(function (_, b, r, R) { this.v0 = _, this.v1 = b, this.v2 = r, this.v3 = R }, function (z) { var T, n, c; return T = Mg.b3(z, this.v0.x, this.v1.x, this.v2.x, this.v3.x), n = Mg.b3(z, this.v0.y, this.v1.y, this.v2.y, this.v3.y), c = Mg.b3(z, this.v0.z, this.v1.z, this.v2.z, this.v3.z), new lc(T, n, c) }), sj = function (D, Q, m, N, l, U, k, A) { dl.call(this), N = N !== Z ? N : .5, l = l !== Z ? l : .5, A = A !== Z ? A : 1, D = D || 8, U = U || 0, k = k || B; var M, L, f = 1, y = A / 2, W = [], q = [], b = this.vertices, u = this.faces, r = this.faceVertexUvs; for (L = 0; f >= L; L++) { var e = [], J = [], x = L / f, i = x * (l - N) + N; for (M = 0; D >= M; M++) { var K = M / D, c = new lc, G = -(K * k + U); c.z = i * t(G), c.y = -x * A + y, c.x = i * S(G), b.push(c), e.push(b.length - 1), J.push(new ol(K, x)) } W.push(e), q.push(J) } var Y, F, O = (l - N) / A; for (M = 0; D > M; M++)for (0 !== N ? (Y = b[W[0][M]].clone(), F = b[W[0][M + 1]].clone()) : (Y = b[W[1][M]].clone(), F = b[W[1][M + 1]].clone()), Y.setY(o(Y.x * Y.x + Y.z * Y.z) * O).normalize(), F.setY(o(F.x * F.x + F.z * F.z) * O).normalize(), L = 0; f > L; L++) { var I = W[L][M], n = W[L + 1][M], V = W[L + 1][M + 1], v = W[L][M + 1], H = Y.clone(), p = Y.clone(), _ = F.clone(), C = F.clone(), d = q[L][M].clone(), s = q[L + 1][M].clone(), R = q[L + 1][M + 1].clone(), T = q[L][M + 1].clone(); u.push(new qd(I, n, v, [H, p, C])), r[0].push([d, s, T]), u.push(new qd(n, V, v, [p.clone(), _, C.clone()])), r[0].push([s.clone(), R, T.clone()]) } if (Q && N > 0) for (this.vertices.push(new lc(0, y, 0)), M = 0; D > M; M++) { var I = W[0][M], n = W[0][M + 1], V = this.vertices.length - 1, H = new lc(0, 1, 0), p = new lc(0, 1, 0), _ = new lc(0, 1, 0), d = q[0][M].clone(), s = q[0][M + 1].clone(), R = new ol(s.x, 0); u.push(new qd(I, n, V, [H, p, _], null, 1)); var g = M / D * B, X = S(g), z = t(g), w = (M + 1) / D * B, $ = S(w), P = t(w); r[0].push([new ol(.5 + .5 * X, .5 + .5 * z), new ol(.5 + .5 * $, .5 + .5 * P), new ol(.5, .5)]) } if (m && l > 0) for (this.vertices.push(new lc(0, -y, 0)), M = 0; D > M; M++) { var I = W[L][M + 1], n = W[L][M], V = b.length - 1, H = new lc(0, -1, 0), p = new lc(0, -1, 0), _ = new lc(0, -1, 0), d = q[L][M + 1].clone(), s = q[L][M].clone(); u.push(new qd(I, n, V, [H, p, _], null, 2)); var g = M / D * B, X = S(g), z = t(g), w = (M + 1) / D * B, $ = S(w), P = t(w); r[0].push([new ol(.5 + .5 * $, .5 - .5 * P), new ol(.5 + .5 * X, .5 - .5 * z), new ol(.5, .5)]) } }; sj.prototype = ul(fb); var Zj = function (i, z, I, Y, b, G, _) { dl.call(this), _ = _ || .5, i = i || 16, z = z || 16, I = (I !== Z ? I : 0) - s, Y = Y !== Z ? Y : B, b = b !== Z ? b : 0, G = G !== Z ? G : s; var l, C, u = [], T = [], V = this.vertices, f = this.faces, L = this.faceVertexUvs; for (C = 0; z >= C; C++) { var o = [], g = []; for (l = 0; i >= l; l++) { var c = l / i, p = C / z, h = new lc; h.x = -_ * S(I + c * Y) * t(b + p * G), h.y = _ * S(b + p * G), h.z = _ * t(I + c * Y) * t(b + p * G), V.push(h), o.push(V.length - 1), g.push(new ol(c, p)) } u.push(o), T.push(g) } for (C = 0; z > C; C++)for (l = 0; i > l; l++) { var v = u[C][l + 1], d = u[C][l], Q = u[C + 1][l], w = u[C + 1][l + 1], U = V[v].clone().normalize(), j = V[d].clone().normalize(), R = V[Q].clone().normalize(), x = V[w].clone().normalize(), n = T[C][l + 1].clone(), M = T[C][l].clone(), y = T[C + 1][l].clone(), K = T[C + 1][l + 1].clone(); A(V[v].y) === _ ? (n.x = (n.x + M.x) / 2, f.push(new qd(v, Q, w, [U, R, x])), L[0].push([n, y, K])) : A(V[Q].y) === _ ? (y.x = (y.x + K.x) / 2, f.push(new qd(v, d, Q, [U, j, R])), L[0].push([n, M, y])) : (f.push(new qd(v, d, w, [U, j, x])), L[0].push([n, M, K]), f.push(new qd(d, Q, w, [j.clone(), R, x.clone()])), L[0].push([M.clone(), y, K.clone()])) } }; Zj.prototype = ul(fb); var sm = function (j, f, Q, o, p, x) { dl.call(this), j = j || .33, f = f || .17, o = o || 8, Q = Q || 6, p = p || 0, x = x || B; for (var V = new lc, G = [], X = [], D = 0; o >= D; D++)for (var v = D / o * B + s, J = 0; Q >= J; J++) { var P = J / Q * x + p; V.x = j * S(P), V.z = -j * t(P); var Y = new lc, k = j + f * S(v); Y.x = k * S(P), Y.z = -k * t(P), Y.y = f * t(v), this.vertices.push(Y), G.push(new ol(J / Q, 1 - D / o)), X.push(Y.clone().sub(V).normalize()) } for (var D = 1; o >= D; D++)for (var J = 1; Q >= J; J++) { var N = (Q + 1) * D + J - 1, c = (Q + 1) * (D - 1) + J - 1, K = (Q + 1) * (D - 1) + J, h = (Q + 1) * D + J, g = new qd(N, c, h, [X[N].clone(), X[c].clone(), X[h].clone()]); this.faces.push(g), this.faceVertexUvs[0].push([G[N].clone(), G[c].clone(), G[h].clone()]), g = new qd(c, K, h, [X[c].clone(), X[K].clone(), X[h].clone()]), this.faces.push(g), this.faceVertexUvs[0].push([G[c].clone(), G[K].clone(), G[h].clone()]) } this.computeFaceNormals() }; sm.prototype = ul(fb); var xj = function ($, w, n) { return $ ? (dl.call(this), $ = $ instanceof Array ? $ : [$], this.addShapeList($, w), w.convertYZ !== !1 && Ff(this, n), this.computeFaceNormals(), void 0) : ($ = [], void 0) }, qp = xj.prototype = ul(dl.prototype); qp.addShapeList = function (F, M) { for (var T = F.length, L = 0; T > L; L++) { var n = F[L]; this.addShape(n, M) } }, qp.addShape = function (t, p) { function A() { if (p.bottom) for (var Q = 0; r > Q; Q++)C = q[Q], a(C[2], C[1], C[0], !0); if (p.top) for (Q = 0; r > Q; Q++)C = q[Q], a(C[0] + S * I, C[1] + S * I, C[2] + S * I, !1) } function w() { var p = 0; for (z(e, p), p += e.length, F = 0, B = J.length; B > F; F++)k = J[F], z(k, p), p += k.length } function z(v, F) { for (var B, Q, U = v.length; --U >= 0;) { B = U, Q = U - 1, 0 > Q && (Q = v.length - 1); var b = 0, z = I; for (b = 0; z > b; b++) { var X = S * b, E = S * (b + 1), P = F + B + X, o = F + Q + X, K = F + Q + E, w = F + B + E; s(P, o, K, w, v, b, z, B, Q) } } } function o(O, g, T) { D.vertices.push(new lc(O, g, T)) } function a(U, A, Z, s) { U += R, A += R, Z += R, D.faces.push(new qd(U, A, Z, null, null, s ? 2 : 1)); var i = s ? $.generateBottomUV(D, t, p, U, A, Z) : $.generateTopUV(D, t, p, U, A, Z); D.faceVertexUvs[0].push(i) } function s(b, u, e, d, C, a, B, w, x) { b += R, u += R, e += R, d += R, D.faces.push(new qd(b, u, d)), D.faces.push(new qd(u, e, d)); var q = $.generateSideWallUV(D, t, C, p, b, u, e, d, a, B, w, x); D.faceVertexUvs[0].push([q[0], q[1], q[3]]), D.faceVertexUvs[0].push([q[1], q[2], q[3]]) } var N, j, g, V, _, i = p.amount, v = p.curveSegments || ob, I = p.steps || 1, U = p.extrudePath, Q = !1, $ = new Jd(p.repeatUVLength); U && (N = U.getSpacedPoints(I), Q = !0, j = p.frames !== Z ? p.frames : new Nl.FrenetFrames(U, I, !1), g = new lc, V = new lc, _ = new lc); var k, F, B, D = this, R = this.vertices.length, M = t.extractPoints(v), G = M.shape, J = M.holes, H = !Mg.isClockWise(G); if (H) { for (G = G.reverse(), F = 0, B = J.length; B > F; F++)k = J[F], Mg.isClockWise(k) && (J[F] = k.reverse()); H = !1 } var q = Mg.triangulateShape(G, J), e = G; for (F = 0, B = J.length; B > F; F++)k = J[F], G = G.concat(k); for (var E, C, S = G.length, r = q.length, K = 0; S > K; K++)E = G[K], Q ? (V.copy(j.normals[0]).multiplyScalar(E.x), g.copy(j.binormals[0]).multiplyScalar(E.y), _.copy(N[0]).add(V).add(g), o(_.x, _.y, _.z)) : o(E.x, E.y, 0); var u; for (u = 1; I >= u; u++)for (K = 0; S > K; K++)E = G[K], Q ? (V.copy(j.normals[u]).multiplyScalar(E.x), g.copy(j.binormals[u]).multiplyScalar(E.y), _.copy(N[u]).add(V).add(g), o(_.x, _.y, _.z)) : o(E.x, E.y, i / I * u); A(), w() }; var Nl = function (v, W, w, H, J) { function C(d, Z, G) { return X.vertices.push(new lc(d, Z, G)) - 1 } dl.call(this), W = W || 64, w = w || 1, H = H || 8, J = J || !1; var d, c, r, I, D, j, k, P, g, i, s, R, b, l, z, A, U, T, o, Z, q = [], X = this, n = W + 1, M = new lc, E = new Nl.FrenetFrames(v, W, J), y = E.tangents, _ = E.normals, G = E.binormals; for (this.tangents = y, this.normals = _, this.binormals = G, g = 0; n > g; g++)for (q[g] = [], I = g / (n - 1), P = v.getPointAt(I), d = y[g], c = _[g], r = G[g], i = 0; H > i; i++)D = i / H * B, j = -w * S(D), k = w * t(D), M.copy(P), M.x += j * c.x + k * r.x, M.y += j * c.y + k * r.y, M.z += j * c.z + k * r.z, q[g][i] = C(M.x, M.y, M.z); for (g = 0; W > g; g++)for (i = 0; H > i; i++)s = J ? (g + 1) % W : g + 1, R = (i + 1) % H, b = q[g][i], l = q[s][i], z = q[s][R], A = q[g][R], U = new ol(g / W, i / H), T = new ol((g + 1) / W, i / H), o = new ol((g + 1) / W, (i + 1) / H), Z = new ol(g / W, (i + 1) / H), this.faces.push(new qd(b, l, A)), this.faceVertexUvs[0].push([U, T, Z]), this.faces.push(new qd(l, z, A)), this.faceVertexUvs[0].push([T.clone(), o, Z.clone()]); this.computeFaceNormals(), this.computeVertexNormals() }; Nl.prototype = ul(fb), Nl.FrenetFrames = function (x, Y, q) { function J() { s[0] = new lc, d[0] = new lc, m = Number.MAX_VALUE, k = A(O[0].x), l = A(O[0].y), c = A(O[0].z), m >= k && (m = k, g.set(1, 0, 0)), m >= l && (m = l, g.set(0, 1, 0)), m >= c && g.set(0, 0, 1), u.crossVectors(O[0], g).normalize(), s[0].crossVectors(O[0], u), d[0].crossVectors(O[0], s[0]) } var I, m, k, l, c, L, R, g = new lc, O = [], s = [], d = [], u = new lc, W = new Eq, v = Y + 1, U = 1e-4; for (this.tangents = O, this.normals = s, this.binormals = d, L = 0; v > L; L++)R = L / (v - 1), O[L] = x.getTangentAt(R), O[L].normalize(); for (J(), L = 1; v > L; L++)s[L] = s[L - 1].clone(), d[L] = d[L - 1].clone(), u.crossVectors(O[L - 1], O[L]), u.length() > U && (u.normalize(), I = E(Ze(O[L - 1].dot(O[L]), -1, 1)), s[L].applyMatrix4(W.makeRotationAxis(u, I))), d[L].crossVectors(O[L], s[L]); if (q) for (I = E(Ze(s[0].dot(s[v - 1]), -1, 1)), I /= v - 1, O[0].dot(u.crossVectors(s[0], s[v - 1])) > 0 && (I = -I), L = 1; v > L; L++)s[L].applyMatrix4(W.makeRotationAxis(O[L], I * L)), d[L].crossVectors(O[L], s[L]) }; var re = function (Y, x, a, I) { dl.call(this), x = x || 18, a = a || 0, I = I == l ? B : I; for (var m = 1 / (Y.length - 1), T = 1 / x, r = 0, H = x; H >= r; r++)for (var y = a + r * T * I, _ = S(y), q = t(y), n = 0, u = Y.length; u > n; n++) { var d = Y[n], D = new lc; D.x = _ * d.x - q * d.y, D.y = q * d.x + _ * d.y, D.z = d.z, this.vertices.push(D) } for (var p = Y.length, r = 0, H = x; H > r; r++)for (var n = 0, u = Y.length - 1; u > n; n++) { var V = n + p * r, $ = V, e = V + p, _ = V + 1 + p, U = V + 1, j = r * T, M = n * m, k = j + T, Q = M + m; this.faces.push(new qd($, U, e)), this.faceVertexUvs[0].push([new ol(j, M), new ol(j, Q), new ol(k, M)]), this.faces.push(new qd(e, U, _)), this.faceVertexUvs[0].push([new ol(k, M), new ol(j, Q), new ol(k, Q)]) } this.mergeVertices(), Ff(this), this.computeFaceNormals(), this.computeVertexNormals() }; re.prototype = ul(fb); var Wk = function (D, f) { f = f || {}; var j = Vc.generateShapes(D, f); f.amount = f.amount !== Z ? f.amount : .5, f.convertYZ = !1, f.fill !== !1 && (f.bottom = !0, f.top = !0), xj.call(this, j, f) }; Wk.prototype = ul(qp); var jf = R.Node = function () { xd(jf, this) }, zj = { X: gg, Y: jn, Z: Vh }, Mi = { xyz: "XYZ", xzy: "XZY", yxz: "YXZ", yzx: "YZX", zxy: "ZXY", zyx: "ZYX" }, Wi = "xzy", bi = function (X, y, S) { if (y) { var R = y[0], c = y[1], H = y[2]; "xzy" === S ? (jn(X, c), Vh(X, H), gg(X, R)) : "xyz" === S ? (Vh(X, H), jn(X, c), gg(X, R)) : "yxz" === S ? (Vh(X, H), gg(X, R), jn(X, c)) : "yzx" === S ? (gg(X, R), Vh(X, H), jn(X, c)) : "zxy" === S ? (jn(X, c), gg(X, R), Vh(X, H)) : "zyx" === S ? (gg(X, R), jn(X, c), Vh(X, H)) : (jn(X, c), Vh(X, H), gg(X, R)) } }; Df("Node", Zl, {
            ms_ac: ["rotationMode", "tall"], _adjustChildrenToTop: !0, _icon: "node_icon", _image: "node_image", _rotationMode: Wi, _64O: 0, _rotationX: 0, _53O: 0, _host: l, _position: { x: 0, y: 0 }, _anchor: { x: .5, y: .5 }, _scale: { x: 1, y: 1 }, _tall: 20, _54O: 0, getUIClass: function () { return sq }, _22Q: function () { return wm }, getX: function () { return this.p().x }, setX: function (u) { this.p(u, this.p().y) }, getY: function () { return this.p().y }, setY: function (C) { this.p(this.p().x, C) }, getAnchorX: function () { return this.getAnchor().x }, setAnchorX: function (z) { this.setAnchor(z, this.getAnchor().y) }, getAnchorY: function () { return this.getAnchor().y }, setAnchorY: function (l) { this.setAnchor(this.getAnchor().x, l) }, getScaleX: function () { return this.getScale().x }, setScaleX: function (f) { this.setScale(f, this.getScale().y) }, getScaleY: function () { return this.getScale().y }, setScaleY: function (f) { this.setScale(this.getScale().x, f) }, p: function () { return 0 === arguments.length ? this.getPosition() : (this.setPosition.apply(this, arguments), this) }, p3: function () { return 0 === arguments.length ? this.getPosition3d() : (this.setPosition3d.apply(this, arguments), this) }, s3: function () { return 0 === arguments.length ? this.getSize3d() : (this.setSize3d.apply(this, arguments), this) }, r3: function () { return 0 === arguments.length ? this.getRotation3d() : (this.setRotation3d.apply(this, arguments), this) }, t3: function () { return this.translate3d.apply(this, arguments), this }, translate3dBy: function (q, T) { Me(q, no(l, l, this.r3(), this.getRotationMode())), this.translate3d(q[0] * T, q[1] * T, q[2] * T) }, translateFront: function (P) { this.translate3dBy([0, 0, 1], P) }, translateBack: function (o) { this.translate3dBy([0, 0, -1], o) }, translateLeft: function (c) { this.translate3dBy([-1, 0, 0], c) }, translateRight: function (s) { this.translate3dBy([1, 0, 0], s) }, translateTop: function (o) { this.translate3dBy([0, 1, 0], o) }, translateBottom: function (u) { this.translate3dBy([0, -1, 0], u) }, getPosition3d: function () { return [this._position.x, this._54O, this._position.y] }, setPosition3d: function (c, X, A) { 1 === arguments.length && (X = c[1], A = c[2], c = c[0]), this.p(c, A), this.setElevation(X) }, translate3d: function (c, w, k) { 1 === arguments.length && (w = c[1], k = c[2], c = c[0]), this.translate(c, k), this.setElevation(this._54O + w) }, getSize3d: function () { return [this.getWidth(), this.getTall(), this.getHeight()] }, setSize3d: function (Z, $, b) { 1 === arguments.length && ($ = Z[1], b = Z[2], Z = Z[0]), this.setSize(Z, b), this.setTall($) }, getRotation3d: function () { return [this._rotationX, -this._64O, this._53O] }, setRotation3d: function (T, _, E) { 1 === arguments.length && (_ = T[1], E = T[2], T = T[0]), this.setRotationX(T), this.setRotation(-_), this.setRotationZ(E) }, setRotationY: function (n) { this.setRotation(-n) }, getRotationY: function () { return -this._64O }, lookAt: function (E, C) { C = C || Mb; var j = this, w = gs(E, j.p3()), L = Bk(w); C === Mb ? (j.r3([-H(w[1] / L), -I(w[2], w[0]) + c, 0]), j.setRotationMode("xzy")) : C === kf ? (j.r3(0, -I(w[2], w[0]), H(w[1] / L)), j.setRotationMode("zyx")) : C === Xr ? (j.r3(0, -I(w[2], w[0]) + s, -H(w[1] / L)), j.setRotationMode("zyx")) : C === ys ? (j.r3([-H(w[1] / L) + c, -I(w[2], w[0]) + c, 0]), j.setRotationMode("xzy")) : C === yn && (j.r3([-H(w[1] / L) - c, -I(w[2], w[0]) + c, 0]), j.setRotationMode("xzy")), C === ak && (j.r3([-H(w[1] / L) + s, -I(w[2], w[0]) + c, s]), j.setRotationMode("zxy")) }, getLoopedEdges: function () { return this._45I }, getEdges: function () { return this._70O }, getAgentEdges: function () { return this._49I }, getHost: function () { return this._host }, setHost: function (K) { var D = this; if (D !== K && D._host !== K) { var V = D._host; V && V._removeAttach(D), D._host = K, D._host && D._host._addAttach(D), D.fp("host", V, K), D.onHostChanged(V, K) } }, getAttaches: function () { return this._69O }, _addAttach: function (R) { var V = this; V._69O || (V._69O = new Ul), V._69O.add(R), V.fp("attaches", l, R) }, _removeAttach: function (q) { var V = this; V._69O.remove(q), V._69O.isEmpty() && delete V._69O, V.fp("attaches", q, l) }, getSourceEdges: function () { return this._42I }, getTargetEdges: function () { return this._43I }, _2I: function (d) { var Z = this; Z._44I || (Z._44I = new Ul), Z._42I || (Z._42I = new Ul), Z._44I.add(d), Z._42I.add(d), Z._20I() }, _4I: function (k) { var J = this; J._44I || (J._44I = new Ul), J._43I || (J._43I = new Ul), J._44I.add(k), J._43I.add(k), J._20I() }, _16I: function (T) { var x = this; x._44I.remove(T), x._42I.remove(T), x._44I.isEmpty() && delete x._44I, x._42I.isEmpty() && delete x._42I, x._20I() }, _18I: function (F) { var $ = this; $._44I.remove(F), $._43I.remove(F), $._44I.isEmpty() && delete $._44I, $._43I.isEmpty() && delete $._43I, $._20I() }, _20I: function () { var l = this; if (delete l._45I, !l._44I || l._44I.isEmpty()) return delete l._70O, void 0; var V; l._44I.each(function (O) { O.isLooped() && (V || (V = {}), V[O._id] || (l._45I || (l._45I = new Ul), l._45I.add(O), V[O._id] = O)) }), V ? (l._70O = new Ul, l._44I.each(function ($) { V[$._id] ? "A" === V[$._id] || (V[$._id] = "A", l._70O.add($)) : l._70O.add($) })) : l._70O = l._44I }, hasAgentEdges: function () { return !!this._49I && !this._49I.isEmpty() }, getSourceAgentEdges: function () { return this._46I }, getTargetAgentEdges: function () { return this._47I }, _1I: function (a) { var S = this; S._46I || (S._46I = new Ul), S._48I || (S._48I = new Ul), S._46I.add(a), S._48I.add(a), S._19I() }, _3I: function (V) { var G = this; G._47I || (G._47I = new Ul), G._48I || (G._48I = new Ul), G._47I.add(V), G._48I.add(V), G._19I() }, _15I: function (I) { var Y = this; Y._46I.remove(I), Y._48I.remove(I), Y._46I.isEmpty() && delete Y._46I, Y._48I.isEmpty() && delete Y._48I, Y._19I() }, _17I: function (d) { var K = this; K._47I.remove(d), K._48I.remove(d), K._47I.isEmpty() && delete K._47I, K._48I.isEmpty() && delete K._48I, K._19I() }, _19I: function () { var H = this; delete H._49I; var G = H._48I; if (G && !G.isEmpty()) { var w = {}; G.each(function (b) { w[b._id] ? H._49I || (H._49I = new Ul) : w[b._id] = b }), H._49I ? G.each(function (L) { w[L._id] && (H._49I.add(L), delete w[L._id]) }) : H._49I = G } }, getImage: function () { if (this._pendingCheckImageJSON) { var _ = m.getImage(this._image); _ && (this._pendingCheckImageJSON = !1, _.dataBindings && _.dataBindings.forEach(function (s) { s.defaultValue !== Z && this.getAttr(s.attr) === Z && this.setAttr(s.attr, s.defaultValue) }, this), this.getParent() instanceof hp && this.getParent().checkPendingUpdateInfo()) } return this._image }, setImage: function (c) { var U = this, _ = U._image, C = U.getWidth(), y = U.getHeight(); U._image = c, U.fp("image", _, c) && (null != c && (bk(c) || Yc(c) && /\.json$/i.test(c)) && (this._pendingCheckImageJSON = !0), U.fp(fh, C, U.getWidth()), U.fp(Yj, y, U.getHeight())) }, getElevation: function () { return this._54O }, setElevation: function (N) { var K = this; if (!K._50O) { K._50O = 1; var A = K._54O; K._54O = N, K.fp(vn, A, N), delete this._50O } }, getRotation: function () { return this._64O }, setRotation: function (K) { var n = this; if (!n._49O) { n._49O = 1; var b = n._64O; n._64O = K, n.fp(sf, b, K), delete n._49O } }, getRotationX: function () { return this._rotationX }, setRotationX: function (X) { var S = this; if (!S._51O) { S._51O = 1; var f = S._rotationX; S._rotationX = X, S.fp("rotationX", f, X), delete S._51O } }, getRotationZ: function () { return this._53O }, setRotationZ: function (C) { var m = this; if (!m._52O) { m._52O = 1; var y = m._53O; m._53O = C, m.fp("rotationZ", y, C), delete m._52O } }, getPosition: function () { return this._position }, setPosition: function (s, e) { var q = this; if (!q._50I) { q._50I = 1; var U; if (U = 2 === arguments.length ? { x: s, y: e } : s, U.x !== q._position.x || U.y !== q._position.y) { var u = q._position; q._position = U, q.fp(Ug, u, U) } delete q._50I } }, translate: function (I, A) { var Q = this._position; this.p(Q.x + I, Q.y + A) }, getWidth: function () { var F = this; if (F._width >= 0) return F._width; var i = yj(F._image); return i ? nq(i, F) : 20 }, setWidth: function (b) { var t = this, n = t._width; t._width = b, t.fp(fh, n, b) }, getHeight: function () { var m = this; if (m._height >= 0) return m._height; var N = yj(m._image); return N ? Jf(N, m) : 20 }, setHeight: function (g) { var a = this, e = a._height; a._height = g, a.fp(Yj, e, g) }, setSize: function (e, x) { var s = this; 2 === arguments.length ? (s.setWidth(e), s.setHeight(x)) : (s.setWidth(e.width), s.setHeight(e.height)) }, getSize: function () { return { width: this.getWidth(), height: this.getHeight() } }, setRect: function (E, e, t, l, v) { var B = this, s = B.getAnchor(), H = B.getScale(); arguments.length <= 2 && (v = e, e = E.y, t = E.width, l = E.height, E = E.x); var j = v && H.x < 0 ? 1 - s.x : s.x, z = v && H.y < 0 ? 1 - s.y : s.y; B.p(E + t * j, e + l * z), v && (t /= Math.abs(H.x), l /= Math.abs(H.y)), B.setWidth(t), B.setHeight(l) }, getMatrix: function () { var N = this, R = N._64O, L = N._position, b = N.getScale(); return new Qh(R, L.x, L.y, b.x, b.y) }, getAnchorRect: function () { var l = this, L = l.getWidth(), F = l.getHeight(), B = l.getAnchor(); return { x: -L * B.x, y: -F * B.y, width: L, height: F } }, getRect: function () { var M = this, A = M.getWidth(), s = M.getHeight(), V = M.getAnchor(), o = { x: -A * V.x, y: -s * V.y, width: A, height: s }, b = M.getMatrix(); return o = eb([b.tf(o.x, o.y), b.tf(o.x + o.width, o.y), b.tf(o.x + o.width, o.y + o.height), b.tf(o.x, o.y + o.height)]) }, getAnchor: function () { var i = this; if (i.hasOwnProperty("_anchor")) return i._anchor; var F = yj(i._image); return F && F.anchorX !== Z ? { x: F.anchorX, y: F.anchorY } : i._anchor }, setAnchor: function (m, c, I) { var i, e = this; "number" == typeof m ? i = { x: m, y: c } : (i = m.length ? { x: m[0], y: m[1] } : m, I = c); var Z = e.getAnchor(); if (Z.x !== i.x || Z.y !== i.y) { var s = e.getDataModel(), W = s ? s.getHistoryManager() : null; if (W && W.beginInteraction(), e._anchor = i, e.fp("anchor", Z, i), I && !Zk) { var J = e.getPosition(), j = e.getSize(), n = e.getRotation(), K = e.getScale(), v = -j.width * (Z.x - i.x) * K.x, P = -j.height * (Z.y - i.y) * K.y, p = t(n), O = S(n); e.setPosition(J.x + O * v - p * P, J.y + p * v + O * P) } W && W.endInteraction() } }, getScale: function () { return this._scale }, setScale: function (A, g) { var b, C = this; b = 2 === arguments.length ? { x: A, y: g } : A; var o = C.getScale(); (o.x !== b.x || o.y !== b.y) && (C._scale = b, C.fp("scale", o, b)) }, getCorners: function (G, e) { G == l && (G = 0), e == l && (e = G); var c = this, r = c.getAnchor(), j = c.getWidth(), u = c.getHeight(), X = -j * r.x - G, h = -u * r.y - e, T = j + 2 * G, B = u + 2 * e, K = c.getMatrix(); return [K.tf(X, h), K.tf(X, h + B), K.tf(X + T, h + B), K.tf(X + T, h)] }, getEditControlPoints: function (B, $, P) { $ == l && ($ = 0), P == l && (P = $); var L = this, R = L.getAnchor(), v = L.getWidth(), A = L.getHeight(), u = -v * R.x - $, z = -A * R.y - P, x = v + 2 * $, J = A + 2 * P; if (B) return [{ x: u, y: z }, { x: u, y: 0 }, { x: u, y: z + J }, { x: 0, y: z + J }, { x: u + x, y: z + J }, { x: u + x, y: 0 }, { x: u + x, y: z }, { x: 0, y: z }]; var j = L.getMatrix(); return [j.tf(u, z), j.tf(u, 0), j.tf(u, z + J), j.tf(0, z + J), j.tf(u + x, z + J), j.tf(u + x, 0), j.tf(u + x, z), j.tf(0, z)] }, rotateAt: function (E, c, q) {
                var B = this, D = B._position, O = B._64O, R = new Qh(O, D.x, D.y).tf(E, c), N = o(E * E + c * c), Y = I(D.y - R.y, D.x - R.x) + q;
                B.setRotation(O + q), B.p(R.x + N * S(Y), R.y + N * t(Y))
            }, onParentChanged: function () { jf.superClass.onParentChanged.apply(this, arguments), this._8I() }, _8I: function () { this._70O && this._70O.each(function (F) { F._7I() }) }, onPropertyChanged: function (M) { var x = this; jf.superClass.onPropertyChanged.call(x, M), x._69O && x._69O.each(function (I) { I.handleHostPropertyChange(M) }), x._49I && x._49I.each(function (w) { w.fp("agentChange", !0, !1) }) }, onHostChanged: function () { this.updateAttach() }, handleHostPropertyChange: function (y) { this.updateAttach(y) }, onStyleChanged: function (p) { jf.superClass.onStyleChanged.apply(this, arguments), ms[p] && this.updateAttach() }, updateAttach: function (D) { var d = this; d._51I || Zk || (d._51I = 1, d._71O(D), delete d._51I) }, _71O: function (h) { var F, c, Q, O, n, e, T = this, d = T._host, q = h ? h.property : l, f = h ? h.oldValue : l, m = h ? h.newValue : l; if (d instanceof R.Grid) { if (q === vn) T.setElevation(T._54O + m - f); else if (!h || lf[q]) { if (F = T.s("attach.row.index"), c = T.s("attach.column.index"), Q = d.getCellRect(F, c), !Q) return; O = T.s("attach.row.span"), n = T.s("attach.column.span"), (1 !== O || 1 !== n) && (Q = rm(Q, d.getCellRect(F + O - 1, c + n - 1))), Lk(Q, T, "attach.padding", 1), T.setRect(Q) } } else if (d instanceof oq && (e = T.s("attach.index")) >= 0 && (!h || lp[q])) { var $ = T.s("attach.thickness"); $ != l && T.setHeight(d.getThickness() * $); var _ = T.s("attach.offset"), A = d.getPoints(), D = A.size(); if (D > e) { var Z = A.get(e), M = D === e + 1 ? A.get(0) : A.get(e + 1), U = [M.x - Z.x, M.y - Z.y], j = Bk(U); if (j) { T.s("attach.offset.relative") && (_ *= j), T.s("attach.offset.opposite") && (_ = j - _); var W = { x: Z.x + U[0] / j * _, y: Z.y + U[1] / j * _ }, t = T.s("attach.gap"); t && (T.s("attach.gap.relative") && (t *= d.getThickness()), W = Rf(l, W, M, t)), T.p(W), T.setRotation(I(U[1], U[0])) } } } else h && (q === Ug ? T.translate(m.x - f.x, m.y - f.y) : q === vn ? T.setElevation(T._54O + m - f) : ir[q] && T._11Q(d, q, m - f)) }, _11Q: function (X, Z, Y) { var y = this, n = X.p3(), b = gs(y.p3(), n), _ = Nq(), C = Mi[y.getRotationMode()], G = C[0], c = C[1], t = C[2], k = zj[G], l = zj[c], N = zj[t]; Z === sf && (Z = "rotationY", Y = -Y), Z === sf + G ? (N(_, X[tm + t]()), l(_, X[tm + c]()), k(_, Y), l(_, -X[tm + c]()), N(_, -X[tm + t]()), y[Tk + G](y[tm + G]() + Y)) : Z === sf + c ? (N(_, X[tm + t]()), l(_, Y), N(_, -X[tm + t]()), y[Tk + c](y[tm + c]() + Y)) : Z === sf + t && (N(_, Y), y[Tk + t](y[tm + t]() + Y)), Me(b, _), y.p3(n[0] + b[0], n[1] + b[1], n[2] + b[2]) }, isHostOn: function (s) { var h = this; if (h._host && s && s._69O) for (var m = {}, C = h._host; C && C !== h && !m[C._id];) { if (C === s) return !0; m[C._id] = C, C = C._host } return !1 }, isLoopedHostOn: function (Y) { return this.isHostOn(Y) && Y.isHostOn(this) }, getSerializableProperties: function () { var H = jf.superClass.getSerializableProperties.call(this); return _i(H, { image: 1, host: 1, rotation: 1, rotationX: 1, rotationZ: 1, rotationMode: 1, position: 1, anchor: 1, scale: 1, _width: 1, _height: 1, tall: 1, elevation: 1 }), H }
        }); var ab = R.Edge = function (A, Z) { var y = this; xd(ab, y), y.setSource(A), y.setTarget(Z) }; Df("Edge", Zl, { _icon: "edge_icon", getUIClass: function () { return cq }, _22Q: function () { return Ko }, getSource: function () { return this._source }, getTarget: function () { return this._target }, getSourceAgent: function () { return this._40I }, getTargetAgent: function () { return this._41I }, setSource: function (y) { var Q = this; if (Q._source !== y) { var H = Q._source; Q._source = y, H && H._16I(Q), y && y._2I(Q), Q._7I(), Q.fp("source", H, y) } }, setTarget: function (O) { var c = this; if (c._target !== O) { var l = c._target; c._target = O, l && l._18I(c), O && O._4I(c), c._7I(), c.fp("target", l, O) } }, isLooped: function () { var b = this; return b._source === b._target && !!b._source && !!b._target }, _7I: function () { var l, A = this, I = pq(A); A._40I !== I && (l = this._40I, l && l._15I(A), A._40I = I, I && I._1I(A), A.fp("sourceAgent", l, I), ci(l, A._41I), ci(I, A._41I)); var m = Zn(A); A._41I !== m && (l = A._41I, l && l._17I(A), A._41I = m, m && m._3I(A), A.fp("targetAgent", l, m), ci(l, A._40I), ci(m, A._40I)) }, _22I: function (b) { this._52I = b, this.fp("edgeGroup", !0, !1) }, getEdgeGroup: function () { return this._52I }, isEdgeGroupHidden: function () { var $ = this; return $._52I && $._52I.get(0) !== $ && !$.getStyle(jg) }, getEdgeGroupSize: function () { return this._52I ? this._52I.size() : 1 }, getEdgeGroupIndex: function () { return this._52I ? this._52I.indexOf(this) : 0 }, isEdgeGroupAgent: function () { var n = this, o = n._52I; return o && !n.getStyle(jg) && o.size() > 1 && n === o.get(0) }, toggle: function () { var X = this._52I, B = !this.s(jg); X && X.size() > 1 && (X.each(function (n) { n.s(jg, B) }), X.getSiblings().each(function (i) { i !== X && i.each(function (n) { n.fp("edgeGroup", l, i) }) })) }, setStyle: function (U, E) { (U === Go || "edge.segments" === U) && (E = vh(E)), ab.superClass.setStyle.call(this, U, E) }, onStyleChanged: function (z) { ab.superClass.onStyleChanged.apply(this, arguments), Ve[z] && ci(this._41I, this._40I) }, getSerializableProperties: function () { var T = ab.superClass.getSerializableProperties.call(this); return _i(T, { source: 1, target: 1 }), T } }); var Qp = R.Group = function () { xd(Qp, this) }; Df("Group", jf, { _image: "group_image", _icon: "group_icon", _57O: !1, getUIClass: function () { return vp }, onChildAdded: function () { Qp.superClass.onChildAdded.apply(this, arguments), this._81I() }, onChildRemoved: function () { Qp.superClass.onChildRemoved.apply(this, arguments), this._81I() }, _81I: function () { var R = this; if (!R._54I && !Zk) { var z = R.getChildrenRect(); z && (R._53I = 1, R.p($e(R.s("group.position"), z, R.getSize())), delete R._53I) } }, getChildrenRect: function () { var h, L = this; return L.eachChild(function (D) { h = rm(h, L.getChildRect(D)) }), h }, getChildRect: function (w) { var u; return $j(w) && w.s(Rk) && (mf(w) && w.isExpanded() && w.eachChild(function (a) { u = rm(u, w.getChildRect(a)) }), !u && w.getRect && (u = w.getRect())), u }, setPosition: function (P, E) { var H = this; if (!H._54I) { var g; g = 2 === arguments.length ? { x: P, y: E } : P, Zk || H._53I || (H._54I = 1, ok(H._children, g.x - H._position.x, g.y - H._position.y), delete H._54I), Qp.superClass.setPosition.call(this, g) } }, toggle: function () { this.setExpanded(!this.isExpanded()) }, isExpanded: function () { return this._57O }, setExpanded: function (c) { var E = this; if (E._57O !== c) { var i = E._57O; E._57O = c, E.fp("expanded", i, E._57O), E._8I() } }, _8I: function () { Qp.superClass._8I.call(this), this.eachChild(function (H) { $j(H) && H._8I() }) }, onStyleChanged: function (A) { Qp.superClass.onStyleChanged.apply(this, arguments), "group.position" === A && this._81I() }, getSerializableProperties: function () { var k = Qp.superClass.getSerializableProperties.call(this); return k.expanded = 1, k } }); var Wo = R.Block = function () { xd(Wo, this) }; Df("Block", jf, { _icon: "block_icon", _clickThroughEnabled: !1, _syncSize: !0, ms_ac: ["clickThroughEnabled", "syncSize"], getUIClass: function () { return ko }, onChildAdded: function () { Wo.superClass.onChildAdded.apply(this, arguments), this.updateFromChildren() }, onChildRemoved: function () { Wo.superClass.onChildRemoved.apply(this, arguments), this.updateFromChildren() }, updateFromChildren: function () { var M = this; if (!Zk && !M._updatingToChildren && M._syncSize) { var X, w, B, O, x, k = [], i = M.getRotation(); if (M.eachChild(function (b) { $j(b) && k.push.apply(k, b.getCorners()) }), k.length) { M._updatingFromChildren = 1; var L = S(-i), H = t(-i), V = 1 / 0, o = -1 / 0, $ = 1 / 0, R = -1 / 0; for (O = 0, x = k.length; x > O; O++)B = k[O], X = B.x, w = B.y, B.x = L * X - H * w, B.y = H * X + L * w, V = b(V, B.x), o = g(o, B.x), $ = b($, B.y), R = g(R, B.y); var m = M.getScale(); M.setSize(A((o - V) / m.x), A((R - $) / m.y)); var W; m.x < 0 && (W = V, V = o, o = W), m.y < 0 && (W = $, $ = R, R = W), L = S(i), H = t(i); var Y = M.getAnchor(); X = V + (o - V) * Y.x, w = $ + (R - $) * Y.y, M.setPosition(L * X - H * w, H * X + L * w), delete M._updatingFromChildren } } }, setPosition: function (G, T) { var i = this; if (!i._updatingToChildren) { var s; s = 2 === arguments.length ? { x: G, y: T } : G, Zk || i._updatingFromChildren || (i._updatingToChildren = 1, ok(i._children, s.x - i._position.x, s.y - i._position.y), delete i._updatingToChildren), Wo.superClass.setPosition.call(this, s) } }, setWidth: function (q) { return this.setSize(q, this.getHeight()) }, setHeight: function (U) { return this.setSize(this.getWidth(), U) }, setSize: function (m, F) { 1 > m && (m = 1), 1 > F && (F = 1); var w = this; if (!w._updatingToChildren) { 2 !== arguments.length && (F = m.height, m = m.width); var K = w.getWidth(), Z = w.getHeight(); if (m !== K && Wo.superClass.setWidth.call(w, m), F !== Z && Wo.superClass.setHeight.call(w, F), !Zk && !w._updatingFromChildren) { w._updatingToChildren = 1; var M = m / K, P = F / Z; w._adjustChildScaleOrSize(M, P, "size"), delete w._updatingToChildren, w.updateFromChildren() } } }, _adjustChildScaleOrSize: function (c, s, z) { var X = this; if (X._syncSize) { var d = X.getPosition(), y = X.getRotation(); X.getScale(), X.eachChild(function ($) { if ($j($)) { var Q = $.getPosition(), H = $.getRotation(), Y = $.getWidth(), J = $.getHeight(), O = $.getScale(), i = O.x * Y, g = O.y * J, U = new Qh(H, Q.x, Q.y, i, g); U.translate(-d.x, -d.y), U.rotate(-y), H = I(U.b * Math.sign(i), U.a * Math.sign(i)), U.scale(c, s); var n, M, L, C = S(H); if (Math.abs(C) < .001 ? (n = t(H), M = U.b / n, L = -U.c / n) : (M = U.a / C, L = U.d / C), "scale" === z) $.setScale(M / Y, L / J); else if ("size" === z) { var q = M / O.x, w = L / O.y; $.setScale(bl(M) * Math.abs(O.x), bl(L) * Math.abs(O.y)), $.setSize(Math.max(.1, Math.abs(q)), Math.max(.1, Math.abs(w))) } U.rotate(y), U.translate(d.x, d.y), $.setPosition(U.tx, U.ty) } }) } }, _calcChangeFactor: function (k, E, b, O) { var C, i, s, x; return C = A(k), i = A(b), s = C > i ? C / i : i / C, C = A(E), i = A(O), x = C > i ? C / i : i / C, g(s, x) }, setAnchor: function () { var g = this; if (!g._updatingToChildren) { var v = g.getAnchor(); if (Wo.superClass.setAnchor.apply(g, arguments), !Zk && !g._updatingFromChildren && g._syncSize) { g._updatingToChildren = 1; var B = g.getAnchor(); g.getPosition(); var x = g.getSize(), Z = g.getScale(), k = g.getRotation(), n = -x.width * Z.x * (v.x - B.x), H = -x.height * Z.y * (v.y - B.y), c = t(k), u = S(k), h = u * n - c * H, T = c * n + u * H; g.eachChild(function (q) { if ($j(q)) { var V = q.getPosition(); q.setPosition(V.x - h, V.y - T) } }), delete g._updatingToChildren } } }, setRotation: function (F) { var d = this; if (!d._updatingToChildren) { var j = d.getRotation(); if (Wo.superClass.setRotation.apply(d, arguments), !Zk && !d._updatingFromChildren) { d._updatingToChildren = 1; var g = d.getPosition(), i = F - j; d.eachChild(function (a) { if ($j(a)) { var X = a.getMatrix(); X.translate(-g.x, -g.y), X.rotate(i), X.translate(g.x, g.y); var Y = Math.sign(a.getScale().x); a.setRotation(I(X.b * Y, X.a * Y)), a.setPosition(X.tx, X.ty) } }), delete d._updatingToChildren } } }, setScale: function (f, q) { var I = this; if (!I._updatingToChildren) { null == q && (q = f.y, f = f.x); var U = I.getScale(); if (A(f) < .01 && (f = .01 * (bl(f) || bl(U.x))), A(q) < .01 && (q = .01 * (bl(q) || bl(U.y))), Wo.superClass.setScale.call(I, f, q), !Zk && !I._updatingFromChildren) { I._updatingToChildren = 1; var Z = f / U.x, x = q / U.y; I._adjustChildScaleOrSize(Z, x, "size"), delete I._updatingToChildren, I.updateFromChildren() } } }, getSerializableProperties: function () { var _ = Wo.superClass.getSerializableProperties.call(this); return _.clickThroughEnabled = 1, _.syncSize = 1, _ } }); var ie = R.Grid = function () { xd(R.Grid, this) }; Df("Grid", jf, { IRotatable: !1, _icon: "grid_icon", _image: l, getUIClass: function () { return Dq }, setRotation: function () { }, getCellRect: function (R, H) { var K = this, g = K.s("grid.row.count"), A = K.s("grid.column.count"); if (0 >= g || 0 >= A || 0 > R || R >= g || 0 > H || H >= A) return l; var C, O, G, D = K.getRect(), E = K.s("grid.row.percents"), h = K.s("grid.column.percents"); if (Lk(D, K, "grid.border", -1), E && E._as && (E = E._as), h && h._as && (h = h._as), E && E.length === g) { for (G = 0, C = 0; R > C; C++)G += D.height * E[C]; D.y += G, D.height = D.height * E[R] } else D.height = D.height / g, D.y += D.height * R; if (h && h.length === A) { for (O = 0, C = 0; H > C; C++)O += D.width * h[C]; D.x += O, D.width = D.width * h[H] } else D.width = D.width / A, D.x += D.width * H; return Bb(D, -K.s("grid.gap")), D } }); var Xm = R.Text = function () { xd(Xm, this), this.setSize(100, 50), this.s("text", "TEXT") }; Df("Text", jf, { _icon: "text_icon", _image: "__text__", getUIClass: function () { return Mc }, setWidth: function (J) { J || (J = .001), Xm.superClass.setWidth.call(this, J) }, setHeight: function (q) { q || (q = .001), Xm.superClass.setHeight.call(this, q) }, toLabel: function () { return this._displayName || this._name || this.s("text") } }), uk("__text__", { width: { value: 100, isSafeFunc: !0, func: function (E) { return E._width } }, height: { value: 50, isSafeFunc: !0, func: function (G) { return G._height } }, comps: [{ type: "text", relative: !0, rect: [0, 0, 1, 1], text: { func: "style@text" }, align: { func: "style@text.align" }, vAlign: { func: "style@text.vAlign" }, color: { func: "style@text.color" }, font: { func: "style@text.font" }, shadow: { func: "style@text.shadow" }, shadowColor: { func: "style@text.shadow.color" }, shadowBlur: { func: "style@text.shadow.blur" }, shadowOffsetX: { func: "style@text.shadow.offset.x" }, shadowOffsetY: { func: "style@text.shadow.offset.y" } }] }); var oq = R.Shape = function () { xd(oq, this), this._59O = new Ul }; oq.__de__ = Bd, Df("Shape", jf, { ms_ac: ["thickness", "closePath"], _icon: "shape_icon", _thickness: 10, _closePath: !1, getUIClass: function () { return Qj }, _22Q: function () { return Vp }, getLength: function (d) { return ad(di(this._59O, this._58O, d, this._closePath)) }, getSegments: function () { return this._58O }, toSegments: function () { var e = this._58O; return e ? new Ul(e._as.slice(0)) : e }, setSegments: function (s) { var Y = this._58O; s = s ? sp(s) ? new Ul(s.slice(0)) : new Ul(s._as.slice(0)) : new Ul, (Y && s && Y._as.join(",") !== s._as.join(",") || Y !== s) && (this._58O = s, this.fp("segments", Y, s)) }, getPoints: function () { return this._59O }, toPoints: function () { var v = this._59O; return new Ul(v._as.slice(0)) }, setPoints: function (_, w) { var Q = this, q = Q._59O; _ = _ ? sp(_) ? new Ul(_.slice(0)) : new Ul(_._as.slice(0)) : new Ul; var y, h, R, O, c, p; w && (y = Q.getPosition(), p = new Qh(Q.getRotation(), 0, 0, Q.getScale().x, Q.getScale().y)), (q && _ && q._as.join(",") !== _._as.join(",") || q !== _) && (Q._59O = _, Q.fs(), Q.fp("points", q, _)), w && (h = Q.getPosition(), R = h.x - y.x, O = h.y - y.y, c = p.tf(R, O), Q.setPosition(h.x - R + c.x, h.y - O + c.y)) }, addPoint: function (x, I, o) { var s = this.toPoints(); s.add(x, I), this.setPoints(s, o) }, setPoint: function (a, i, F) { var v = this.toPoints(); v.set(a, i), this.setPoints(v, F) }, removePointAt: function (m) { var G = this.toPoints(); G.removeAt(m), this.setPoints(G) }, setWidth: function (D) { var J = this; if (1 > D && (D = 1), !J._55I && !Zk && J.getWidth()) { J._55I = 1; var h = J._position.x, t = D / J.getWidth(), X = J.toPoints(), F = new Ul; X.each(function (e) { F.add({ x: (e.x - h) * t + h, y: e.y, e: e.e }) }), J.setPoints(F); var o = J.s("shape.gradient.pack"); o && oj(o, [t, 0, 0, 1, h * (1 - t), 0]), J.fs(), delete J._55I } oq.superClass.setWidth.call(J, D) }, setHeight: function (k) { var O = this; if (1 > k && (k = 1), !O._55I && !Zk && O.getHeight()) { O._55I = 1; var H = O._position.y, i = k / O.getHeight(), $ = O.toPoints(), S = new Ul; $.each(function (r) { S.add({ x: r.x, y: (r.y - H) * i + H, e: r.e }) }), O.setPoints(S); var j = O.s("shape.gradient.pack"); j && oj(j, [1, 0, 0, i, 0, H * (1 - i)]), O.fs(), delete O._55I } oq.superClass.setHeight.call(O, k) }, setAnchor: function (h, k, e) { var r = this; if (r._55I = !0, !Zk) { var K, w, F; "number" == typeof h ? F = { x: h, y: k } : (F = h.length ? { x: h[0], y: h[1] } : h, e = k); var z = r.getAnchor(), g = r.getSize(); K = g.width * (z.x - F.x), w = g.height * (z.y - F.y), e || r.shiftPoints(K, w); var Y = r.getPosition() } if (oq.superClass.setAnchor.apply(r, arguments), !Zk) { var U = r.getPosition(); e && r.shiftPoints(U.x - Y.x + K, U.y - Y.y + w) } delete r._55I }, shiftPoints: function (Q, w) { var H = this, b = H.toPoints(), E = new Ul; b.each(function (b) { E.add({ x: b.x + Q, y: b.y + w, e: b.e }) }), H.setPoints(E), H.fs() }, setPosition: function (r, B) { var s, L = this; if (!L._28Q) { if (L._28Q = 1, !L._55I && !Zk) { s = 2 === arguments.length ? { x: r, y: B } : r; var C = s.x - L._position.x, t = s.y - L._position.y; if (0 === C && 0 === t) return delete L._28Q, void 0; L._55I = 1, L.shiftPoints(C, t); var Q = L.s("shape.gradient.pack"); Q && oj(Q, [1, 0, 0, 1, C, t]), delete L._55I } oq.superClass.setPosition.apply(L, arguments), delete L._28Q } }, fs: function () { this.fireShapeChange() }, _70I: function () { var g = this; if (2 !== g._59O.size()) return !1; var L = g._58O; return L ? 2 === L.size() && 1 === L.get(0) && 2 === L.get(1) ? !0 : !1 : !0 }, fireShapeChange: function () { var Q = this; if (!Q._55I && !Zk) { var B = eb(Q._59O); B && (Q._55I = 1, Q.setRect(B), delete Q._55I) } Q.fp(mi, !1, !0) }, getSerializableProperties: function () { var I = oq.superClass.getSerializableProperties.call(this); return I.segments = 1, I.points = 1, I.thickness = 1, I.closePath = 1, I } }); var To = R.Polyline = function () { xd(To, this), this.s({ "shape.background": null, "shape.border.width": 2 }) }; Df("Polyline", oq, { IRotatable: !1, _icon: "polyline_icon", _22Q: function () { return Bg }, getUIClass: function () { return rg }, setRotationX: function () { }, setRotation: function () { }, setRotationZ: function () { }, setClosePath: function () { }, setTall: function (T) { var M = this; if (!M._24Q && !Zk && M.getTall()) { M._24Q = 1; var x = M._54O, P = T / M.getTall(); M._59O.each(function (Z) { Z.e = Z.e == l ? x : (Z.e - x) * P + x }), M.fs(), delete M._24Q } To.superClass.setTall.call(M, T) }, setElevation: function (V) { var n = this; if (!n._24Q && !Zk) { n._24Q = 1; var k = V - n._54O; n._59O.each(function (x) { x.e == l ? x.e = V : x.e += k }), n.fs(), delete n._24Q } To.superClass.setElevation.apply(n, arguments) }, fireShapeChange: function () { var d = this, P = d._59O; if (!d._24Q && !Zk) { var C = P.size(); if (C) { var s = 1, e = P.get(0), T = d._54O; e.e == l && (e.e = T); for (var k = e.e, E = 0; C > s; s++) { e = P.get(s), e.e == l && (e.e = T); var Y = b(k, e.e), v = g(k + E, e.e); k = Y, E = v - Y } d._24Q = 1, d.setTall(E), d.setElevation(k + E / 2), delete d._24Q } } To.superClass.fireShapeChange.apply(d, arguments) } }); var jd = R.SubGraph = function () { xd(jd, this) }; Df("SubGraph", jf, { ISubGraph: 1, _image: "subGraph_image", _icon: "subGraph_icon", _8I: function () { jd.superClass._8I.call(this), this.eachChild(function (y) { $j(y) && y._8I() }) } }); var hp = R.RefGraph = function () { xd(hp, this) }; Df("RefGraph", Wo, { _icon: "refGraph_icon", getRef: function () { return this._ref }, setRef: function ($) { var I = this._ref; this._ref = $, this.fp("ref", I, $), this._pendingUpdateFromChidlren = !0, this.updateRef() }, _21I: function () { hp.superClass._21I.apply(this, arguments), this.updateRef() }, updateRef: function () { var B = this; if (B.clearChildrenFromDataModel(), B._ref && B._dataModel) { B._xhrLoadHandler && (B._xhrLoadHandler.cancel = !0); var Q = Zk, k = B._xhrLoadHandler = function (S) { if (S && B._dataModel) { m.loadingRefGraph = !0; var $ = B._pendingUpdateInfo = { needToRestore: Q }; Q && ($.position = B.p(), $.width = B.getWidth(), $.height = B.getHeight(), $.rotation = B.getRotation(), $.anchor = B.getAnchor(), $.scale = B.getScale()), B.p(0, 0), B.setAnchor(.5, .5), B.setRotation(0), B.setScale(1, 1); var r = m.parse(S), v = B._dataModel.deserialize(r, B, { justDatas: !0 }); v.each(function (G) { G._refGraph = B }), B.checkPendingUpdateInfo(), m.loadingRefGraph = !1, m.handleRefGraphLoaded(B, v, r) } }; m.xhrLoad(B._ref, function (w) { k.cancel || k(w) }) } }, checkPendingUpdateInfo: function () { var X = this, P = X._pendingUpdateInfo; if (!P) return X.onPendingUpdated && X.onPendingUpdated(), void 0; var D = !0; this.eachChild(function (V) { (V._pendingCheckImageJSON || V._pendingUpdateInfo) && (D = !1) }), D && (X._pendingUpdateInfo = null, X.updateFromChildren(), P.needToRestore && (X.setSize(P.width, P.height), X.setAnchor(P.anchor), X.setRotation(P.rotation), X.setScale(P.scale), X.p(P.position)), this.getParent() instanceof hp && this.getParent().checkPendingUpdateInfo(), X.onPendingUpdated && X.onPendingUpdated()) }, getSerializableProperties: function () { var T = hp.superClass.getSerializableProperties.call(this); return T.ref = 1, T } }), R.EdgeGroup = function (F, D) { this._70O = F, this._siblings = D; for (var b, A, W = 0, n = F.size(), y = M[jg]; n > W; W++)if (b = F.get(W).getStyle(jg, !1), b != l) { y = b; break } y == l && (y = !0); var G = m.edgeGroupAgentFunc; for (G && (A = G(F), A && A !== F.get(0) && (F.remove(A), F.add(A, 0))), W = 0; n > W; W++)F.get(W).s(jg, y) }, Df("EdgeGroup", F, { getEdges: function () { return this._70O }, size: function () { return this._70O.size() }, get: function (a) { return this._70O.get(a) }, indexOf: function (X) { return this._70O.indexOf(X) }, each: function (u, f) { this._70O.each(u, f) }, getSiblings: function () { return this._siblings }, eachSiblingEdge: function (S, g) { this._siblings.each(function (k) { k._70O.each(S, g) }) } }); var Fc = R.JSONSerializer = function (p, n) { this.dm = this._dataModel = p, this._hierarchical = n == l ? p.isHierarchicalRendering() : n }; Df("JSONSerializer", F, { ms_ac: ["hierarchical"], serialize: function (L) { return m.stringify(this.toJSON(), L) }, toJSON: function () { var M = this, X = M.dm, j = X.getRoots(), c = M.json = { v: m.getVersion(), p: {}, a: {}, d: [] }, f = X.getSerializableAttrs(); X.getInit() && (c.init = X.getInit()), X.getName() && (c.p.name = X.getName()), X.getBackground() && (c.p.background = X.getBackground()), c.p.autoAdjustIndex = X.isAutoAdjustIndex(), c.p.hierarchicalRendering = X.isHierarchicalRendering(); for (var E in f) { var d = X.a(E); d !== Z && M[Bo](E, d, c.a) } return Bm(c.a) && delete c.a, M._hierarchical ? j.each(M.serializeData, this) : X.each(function (z) { M.serializeData(z) }), c }, isSerializable: function () { return !0 }, getProperties: function (G) { return G.getSerializableProperties() }, getStyles: function (k) { return k.getSerializableStyles() }, getAttrs: function (V) { return V.getSerializableAttrs() }, serializeData: function (D) { var O = this; if (O.isSerializable(D) && !D._refGraph) { var L, C, F, f, Y = Vr(D.getClassName()) || D.getClass(), J = new Y, c = { c: D.getClassName(), i: D.getId(), p: {}, s: {}, a: {} }; O.json.d.push(c), L = O.getProperties(D); for (C in L) /^_/.test(C) ? (F = D[C], F !== J[C] && O[Bo](C.substr(1), F, c.p)) : (f = gf(C), D[f] && (F = D[f](), F !== J[f]() && O[Bo](C, F, c.p))); L = O.getStyles(D); for (C in L) F = D.s(C), F !== J.s(C) && O[Bo](C, F, c.s); L = O.getAttrs(D); for (C in L) F = D.a(C), F !== J.a(C) && O[Bo](C, F, c.a); Bm(c.p) && delete c.p, Bm(c.s) && delete c.s, Bm(c.a) && delete c.a } O._hierarchical && D.getChildren().each(O.serializeData, O) }, serializeValue: function (H, Q, I) { Zh(Q) ? Q = { __a: Q._as } : Q instanceof Zl && (Q = { __i: Q.getId() }), I[H] = Q }, deserialize: function (b, Z, C) { Zk = !0, C = sk(C) ? { setId: C } : C || {}; var V = this; b = V.json = Yc(b) ? m.parse(b) : b, V._82I = {}; var u = V.dm, O = new Ul, y = new Ul, D = 0, o = b.d.length; for (C.justDatas || (Nf(b.init) && b.init(u), u.setInit(b.init)); o > D; D++) { var f = b.d[D], $ = Vr(f.c), z = new $, J = f.i; C.setId && J != l && (z._id = J), V._82I[J] = z, O.add(z), y.add(f) } for (D = 0; o > D; D++)V.deserializeData(O.get(D), y.get(D)); if (O.each(function (J) { Z && !J.getParent() && J.setParent(Z), u.add(J) }), !C.justDatas) { for (var A in b.a) u.a(A, V[zi](b.a[A])); for (var i in b.p) u[El(i)](b.p[i]) } return Zk = !1, O }, deserializeData: function (t, M) { for (var o in M.p) t[El(o)](this[zi](M.p[o])); for (o in M.s) t.s(o, this[zi](M.s[o])); for (o in M.a) t.a(o, this[zi](M.a[o])) }, deserializeValue: function (F) { if (bk(F)) { var n = F.__i; if (n != l) return this._82I[n]; if (n = F.__a, sp(n)) return new Ul(n) } return F } }), _i(Mn, { serialize: function (v, L) { return new Fc(this, L).serialize(v) }, toJSON: function (l) { return new Fc(this, l).toJSON() }, deserialize: function (l, O, d) { return new Fc(this).deserialize(l, O, d) } }), Oo.GraphView = function (a) { var g = this; g._24I = {}, g._34I = new Ul, g._25I = {}, g._56I = {}, g._view = ii(1, g), g._canvas = sc(g._view), g.dm(a ? a : new Mn), g.setEditable(!1), g.setScrollBarVisible(m.graphViewScrollBarVisible) }, Xp("GraphView", F, {
            ms_v: 1, ms_gv: 1, ms_bnb: 1, ms_tip: 1, ms_dm: 1, ms_lp: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, _52o: 1, _51o: 1, ms_ac: ["layers", ki, uj, om, He, "resettable", "editInteractor", Kg, "pannable", "rectSelectable", "autoScrollZone", qc, "movableFunc", "editableFunc", "pointEditableFunc", "rectEditableFunc", "rotationEditableFunc", "anchorEditableFunc", "rectSelectBackground", "rectSelectBorderColor", "editPointSize", "editPointBorderColor", "editPointBackground", "hoverDelay"], _resettable: m.graphViewResettable, _pannable: m.graphViewPannable, _rectSelectable: m.graphViewRectSelectable, _autoScrollZone: m.graphViewAutoScrollZone, _rectSelectBackground: m.graphViewRectSelectBackground, _rectSelectBorderColor: m.graphViewRectSelectBorderColor, _editPointSize: m.graphViewEditPointSize, _editPointBorderColor: m.graphViewEditPointBorderColor, _editPointBackground: m.graphViewEditPointBackground, _scrollBarColor: tb, _scrollBarSize: Nr, _autoHideScrollBar: Sg, _autoMakeVisible: wf, setEditable: function (q) { var Z = this, x = Oo.XEditInteractor; q ? (Z._uieditable = !0, Z.setInteractors([new Mq(Z), new df(Z), x ? new x(Z) : new hf(Z), new wl(Z), new hm(Z), new ei(Z, { editable: !1 })])) : (Z._uieditable = !1, Z.setInteractors([new Mq(Z), new df(Z), new wl(Z), new hm(Z), new ei(Z, { editable: !1 })])) }, getCanvas: function () { return this._canvas }, _33I: function (k) { var j = k.getUIClass(); return j ? new j(this, k) : l }, getDataUI: function (h) { var F = this, l = F._25I[h._id]; return l === Z && (l = F._33I(h), F._25I[h._id] = l), l }, getNodeRect: function (O) { return m.getNodeRect(this, O) }, getEdgeInfo: function (z) { var h = this.getDataUI(z); return h ? (h._79o(), h._78o) : null }, getEdgeSourcePosition: function (P) { var j = this, o = j.getDataUI(P), T = o.s, M = o._data._40I; return yq(j, M, T("edge.source.position"), T("edge.source.offset.x"), T("edge.source.offset.y"), T("edge.source.anchor.x"), T("edge.source.anchor.y")) }, getEdgeTargetPosition: function (T) { var p = this, b = p.getDataUI(T), I = b.s, N = b._data._41I; return yq(p, N, I("edge.target.position"), I("edge.target.offset.x"), I("edge.target.offset.y"), I("edge.target.anchor.x"), I("edge.target.anchor.y")) }, invalidateAll: function (p) { var x = this; if (p) { for (var b in x._25I) { var R = x._25I[b]; R && R.dispose() } x._25I = {}, x._56I = {}, x._24I = {}, x._34I.clear(), x.redraw() } else x.dm().each(function (X) { x.invalidateData(X) }) }, invalidateSelection: function () { var B = this; B.sm().each(function (E) { B.invalidateData(E) }) }, invalidateData: function (p) { var d = this; d._24I[p._id] = p, d._21Q(p), d.iv() }, _21Q: function (e) { var J = this, m = J._24I; if (zl(e) && Rq[e.s(jj)]) { var o = e.getSourceAgent(); o && o.getAgentEdges().each(function (J) { m[J._id] = J }), o = e.getTargetAgent(), o && o.getAgentEdges().each(function (o) { m[o._id] = o }), J.iv() } }, redraw: function (O) { var H = this; H._32I || (O ? H._34I.add(O) : (H._32I = 1, H._34I.clear()), H.iv()) }, each: function (W, Z) { var z, x, y, p = 0, B = this._layers, w = this._dataModel, d = w._datas._as, f = d.length; if (B) { for (var t = B.length; t > p; p++)if (y = B[p], w.isHierarchicalRendering()) { if (this._dataModel.eachByHierarchical(W, null, Z) === !1) return } else for (var K = 0; f > K; K++)if (z = d[K], z._layer === y && (x = Z ? W.call(Z, z) : W(z), x === !1)) return } else if (w.isHierarchicalRendering()) this._dataModel.eachByHierarchical(W, null, Z); else for (; f > p; p++)if (z = d[p], x = Z ? W.call(Z, z) : W(z), x === !1) return }, reverseEach: function (D, j) { var t, w, d, k, X = this._layers, Z = this._dataModel, L = Z._datas._as, o = L.length; if (X) { for (t = X.length - 1; t >= 0; t--)if (k = X[t], Z.isHierarchicalRendering()) { if (Z.reverseEachByHierarchical(D, null, j) === !1) return } else for (var _ = o - 1; _ >= 0; _--)if (w = L[_], w._layer === k && (d = j ? D.call(j, w) : D(w), d === !1)) return } else if (Z.isHierarchicalRendering()) Z.reverseEachByHierarchical(D, null, j); else for (t = o - 1; t >= 0; t--)if (w = L[t], d = j ? D.call(j, w) : D(w), d === !1) return }, getViewRect: function () { return this._29I }, getContentRect: function () { var m = this, Q = m._84I; if (!Q) { var N = this.dm().a("width"), C = this.dm().a("height"); N > 0 && C > 0 ? m._84I = { x: 0, y: 0, width: N, height: C } : (m.each(function (r) { m.isVisible(r) && (Q = rm(Q, m.getDataUIBounds(r))) }), m._84I = Q ? Q : er) } return m._84I }, getScrollRect: function () { return rm(this.getContentRect(), this._29I) }, makeCenter: function (f, G, z) { var J = this; if (!J.getWidth() || !J.getHeight()) return z || iq(J.centerData, J, [f, G, !0], 200), void 0; J.makeVisible(f), J.validate(); var m = J.getDataUIBounds(f); if (m) { var j = J.getWidth(), u = J.getHeight(), D = m.x + m.width / 2, K = m.y + m.height / 2, L = -D * J._zoom + j / 2, p = -K * J._zoom + u / 2; J.setTranslate(L, p, G) } }, fitData: function (p, q, X, h, w) { var D = this; if (!D.getWidth() || !D.getHeight()) return w || iq(D.fitData, D, [p, q, X, h, !0], 200), void 0; var P = function () { D.makeVisible(p), D.validate(); var t = D.getDataUIBounds(p); t && (t = Ln(t), Bb(t, X == l ? 20 : X), D.fitRect(t, q, h)) }; q ? m.callWhenLoaded(P) : P() }, fitContent: function (I, L, i, $) { var f = this; if (!f.getWidth() || !f.getHeight()) return $ || iq(f.fitContent, f, [I, L, i, !0], 200), void 0; var p = function () { f.validate(); var S = Ln(f.getContentRect()); Bb(S, L == l ? 20 : L), f.fitRect(S, I, i) }; I ? m.callWhenLoaded(p) : p() }, fitRect: function (B, M, d) { var v = this, z = v.getWidth(), O = v.getHeight(), n = B.x + B.width / 2, D = B.y + B.height / 2, P = b(z / B.width, O / B.height), y = v._zoom, e = -n * y + z / 2, F = -D * y + O / 2; 0 === P || isNaN(P) || (d && (P = b(1, P)), M ? v.setTranslate(e, F, { finishFunc: function () { v.setZoom(P, M) } }) : (v.setTranslate(e, F), v.setZoom(P))) }, toCanvas: function (I, u) { u = u || this._zoom, this.validateImpl(); var A = this, G = A.getContentRect(); G.width || (G.width = 10), G.height || (G.height = 10); var c = sc(), i = G.x * u, X = G.y * u, z = G.width * u, m = G.height * u; co(c, z, m, 1); var J = nr(c); return I = I || this._dataModel.getBackground(), I && qo(J, 0, 0, z, m, I), bo(J, -i, -X), J.scale(u, u), A._42(J), J.restore(), c }, toDataURL: function (d, Y, n) { return this.toCanvas(d, n).toDataURL(Y || "image/png", 1) }, getClipBounds: function () { return this._74O }, _42: function (M, A) { var b, t, x = this; x._93db(M, A), x.each(function (u) { x._56I[u._id] && (b = x.getDataUI(u), b && (t = b._79o(), R.HtmlNode && u instanceof R.HtmlNode ? b._42(M) : (!A || Hi(A, t)) && b._42(M))) }), x._92db(M, A) }, validateImpl: function () { var b, v, N, y, j, A = this, r = A.tx(), $ = A.ty(), t = A._zoom, f = A._canvas, w = this.getWidth(), h = this.getHeight(), l = A._29I, E = { x: -r / t, y: -$ / t, width: w / t, height: h / t }, L = {}, c = A._34I, i = A._24I, Q = A._32I, q = A._23I; A._24I = {}, (w !== f.clientWidth || h !== f.clientHeight) && (co(f, w, h), Q = 1), Q || ns(E, l) || (Q = 1), A._29I = E, A.each(function (y) { v = y._id; var Z = L[v] = A.isVisible(y); Z !== A._56I[v] && (i[v] = y, N = A.getDataUI(i[v]), N && N._84o(Z), A._84o(y, Z)) }, A); for (v in i) N = A.getDataUI(i[v]), N && (!Q && A._56I[v] && (j = N._79o(), j && c.add(j)), N.invalidate()), A._83I = 1; if (A._56I = L, !Q) for (v in i) L[v] && (N = A.getDataUI(i[v]), N && (j = N._79o(), j && c.add(j))); if (Q ? y = E : (c.each(function (V) { Hi(E, V) && (y = rm(y, V)) }), y && (Bb(y, g(1, 1 / t)), y.x = G(y.x * t) / t, y.y = G(y.y * t) / t, y.width = T(y.width * t) / t, y.height = T(y.height * t) / t, y = gb(E, y))), A._74O = y, y && (b = nr(f), Rr(b, r, $, t), b.beginPath(), b.rect(y.x, y.y, y.width, y.height), b.clip(), b.clearRect(y.x, y.y, y.width, y.height), A._42(b, y), b.restore(), delete A._74O), c.clear(), delete A._32I, q && w > 0 && h > 0) { var N = A.getDataUI(q); if (N) { var j = N._79o(), B = A._29I, K = B.x, H = B.y, U = B.width, d = B.height, t = A._zoom; j && !Hi(j, B) && (j.x + j.width < K && A.tx(-j.x * t), j.x > K + U && A.tx(-(j.x + j.width - U) * t), j.y + j.height < H && A.ty(-j.y * t), j.y > H + d && A.ty(-(j.y + j.height - d) * t)) } delete A._23I } A._83I && (delete A._83I, delete A._84I), A._98O(), Bm(A._24I) || iq(A.iv, A) }, isScrollBarVisible: function () { return !!this._79O }, setScrollBarVisible: function (J) { var y = this; J !== y.isScrollBarVisible() && (J ? (hq(y._view, y._79O = Rl()), hq(y._79O, y._27I = Rl()), hq(y._79O, y._28I = Rl())) : (Ng(y._79O), delete y._79O, delete y._27I, delete y._28I), y.fp("scrollBarVisible", !J, J)) }, showScrollBar: function () { var m = this; m._79O && (m._85I || (U(function () { m._86I() }, qe), m.iv()), m._85I = new Date) }, _86I: function () { var A = this; if (A._85I) { var $ = new Date, u = $.getTime(); u - A._85I.getTime() >= qe ? (delete A._85I, A.iv()) : U(function () { A._86I() }, qe) } }, _98O: function () { var d = this, C = this._27I, h = this._28I; if (d._79O) { if (d._autoHideScrollBar && !d._85I) return C.style.visibility = Yq, h.style.visibility = Yq, void 0; var R = d.getScrollBarColor(), s = d._zoom, q = d.getScrollBarSize(), V = d.getViewRect(), U = d.getScrollRect(), I = V.height * s, N = U.height * s, i = V.width * s - q - 2, l = I * ((V.y - U.y) * s / N), Y = I * (I / N), o = C.style; N - .5 > I ? (Ye > Y && (l = l + Y / 2 - Ye / 2, 0 > l && (l = 0), l + Ye > I && (l = I - Ye), Y = Ye), Up(C, i, l, q, Y), o.visibility = ls, o.background = R, o.borderRadius = q / 2 + $k) : o.visibility = Yq; var f = V.width * s, W = U.width * s, l = V.height * s - q - 2, i = f * ((V.x - U.x) * s / W), O = f * (f / W), o = h.style; W - .5 > f ? (Ye > O && (i = i + O / 2 - Ye / 2, 0 > i && (i = 0), i + Ye > f && (i = f - Ye), O = Ye), Up(h, i, l, O, q), o.visibility = ls, o.background = R, o.borderRadius = q / 2 + $k) : o.visibility = Yq } }, setDataModel: function (y) { var x = this, D = x._dataModel, K = x._selectionModel; D !== y && (D && (D.ump(x.handleDataModelPropertyChange, x), D.umm(x.handleDataModelChange, x), D.umd(x.handleDataPropertyChange, x), D.removeIndexChangeListener(x._75O, x), D.removeHierarchyChangeListener(x.handleHierarchyChange, x), K || D.sm().ums(x.handleSelectionChange, x)), x._dataModel = y, y.mp(x.handleDataModelPropertyChange, x), y.mm(x.handleDataModelChange, x), y.md(x.handleDataPropertyChange, x), y.addIndexChangeListener(x._75O, x), y.addHierarchyChangeListener(x.handleHierarchyChange, x), K ? K._21I(y) : y.sm().ms(x.handleSelectionChange, x), x.invalidateAll(!0), x.fp(Mj, D, y), x._canvas.style.background = y.getBackground() || "") }, handleDataModelPropertyChange: function (X) { if ("background" === X.property) { var t = this._canvas.style.background, P = X.newValue || ""; this._canvas.style.background = P, this.fp("canvasBackground", t, P) } else "a:width" === X.property || "a:height" === X.property ? (this._83I = 1, this.redraw()) : "hierarchicalRendering" === X.property && this.redraw() }, handleDataPropertyChange: function (C) { this.dm().isHierarchicalRendering() && "parent" === C.property && C.data.hasChildren() && this.redraw(), this.invalidateData(C.data) }, onPropertyChanged: function (C) { var w = this, M = C.property; if (w.redraw(), "zoom" === M) { var j = w.sm().getSelection(); j.size() && j.each(function (p) { p.invalidate() }) } Hp[M] ? w.showScrollBar() : M === Kg && w.onCurrentSubGraphChanged(C) }, onCurrentSubGraphChanged: function () { this.sm().cs(), this.reset() }, handleDataModelChange: function (z) { var T = this, j = z.kind, i = z.data; if (T._83I = 1, "add" === j) T.invalidateData(i), zl(i) && i.getEdgeGroup() && i.getEdgeGroup().eachSiblingEdge(T.invalidateData, T); else if (j === ee) { T._21Q(i); var I = i._id, Z = T._25I[I]; if (Z) { if (T._56I[I]) { var k = Z._79o(); k && T.redraw(k) } Z.dispose(), delete T._25I[I], delete T._24I[I], delete T._56I[I] } i === T._currentSubGraph && T.setCurrentSubGraph(l) } else j === rr && (T.invalidateAll(!0), T.setCurrentSubGraph(l)) }, _75O: function (d) { this.invalidateData(d.data) }, handleHierarchyChange: function (h) { this.dm().isHierarchicalRendering() && h.data.hasChildren() && this.redraw(), this.invalidateData(h.data) }, adjustIndex: function (B) { var S = this; if (S.isVisible(B)) { for (var q = B; q._parent && S.isVisible(q._parent);)q = q._parent; q && q !== B && S._dataModel.adjustIndex(q), S._dataModel.adjustIndex(B) } }, getSelectWidth: function (E) {
                return E.s("select.width")
            }, isSelectable: function (i) { return !this._clickThroughChecking && i.getParent() instanceof Wo ? !1 : i.s("2d.selectable") && this.sm().isSelectable(i) }, isMovable: function (f) { var R = this; return zl(f) && f.getStyle(jj) !== fg ? !1 : f.s("2d.movable") ? R._movableFunc ? R._movableFunc(f) : !0 : !1 }, isEditable: function (Z) { var E = this; if (R._uiSerializing) return E._uieditable; if (!E._editInteractor || !E.isSelected(Z)) return !1; if (mf(Z)) { var M = E.getDataUI(Z); if (!M || M._88I) return !1 } return zl(Z) && Z.getStyle(jj) !== fg ? !1 : Z.s("2d.editable") ? E._editableFunc ? E._editableFunc(Z) : !0 : !1 }, handleDelete: function () { this._editInteractor && (this._editInteractor.handleDelete ? this._editInteractor.handleDelete() : this.removeSelection()) }, isPointEditable: function (D) { return $j(D) && 0 !== D.getRotation() ? !1 : this._pointEditableFunc ? this._pointEditableFunc(D) : !0 }, isRectEditable: function (f) { return this._rectEditableFunc ? this._rectEditableFunc(f) : !0 }, isAnchorEditable: function (n) { return this._anchorEditableFunc ? this._anchorEditableFunc(n) : !0 }, isRotationEditable: function (S) { return S.setRotation && S.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(S) : !0 : !1 }, getRotationPoint: function (e) { var b = e.getAnchor(), m = e.getScale(), g = this._zoom, d = id(e.getRotation(), 0, -e.getHeight() * m.y * b.y - (m.y < 0 ? -1 : 1) * (P ? 32 : 16) / g), i = e.p(); return d.x += i.x, d.y += i.y, d }, getLogicalPoint: function (U) { var L = this; return mj(U, L._canvas, L.tx(), L.ty(), L._zoom, L._zoom) }, getSelectedDataAt: function (L) { var g = this; return this.getDataAt(L, function (y) { return g.isSelected(y) }) }, getDataAt: function (O, E, z) { O.target && (O = this.lp(O)); var v, W = this._zoom; return this.reverseEach(function (N) { return (E ? E(N) : this.isSelectable(N)) && this.rectIntersects(N, Dh(O.x, O.y, z, W)) ? (v = N, !1) : void 0 }, this), v }, getIconInfoAt: function (n, r) { var e = this; if (n.target && (n = e.lp(n)), r || (r = e.getDataAt(n)), r) { var i = e.getDataUI(r); if (i && i._38o) { var U, q = i._38o, D = new Ul; for (U in q.icons) D.add(U); for (var R = D.size() - 1; R >= 0; R--) { U = D.get(R); for (var y = q.rects[U], w = y.rotation, C = y.length - 1; C >= 0; C--) { var b = y[C], z = b.width, V = b.height, O = { x: n.x - b.x - z / 2, y: n.y - b.y - V / 2 }; w != l && (O = id(-w, O.x, O.y)); var b = { x: -z / 2, y: -V / 2, width: z, height: V }; if (lg(b, O)) return { key: U, index: C, name: q.icons[U].names[C], rect: y[C], point: n, rotation: w, relativeRect: b, relativePoint: O, data: r } } } } } return l }, getDatasInRect: function (Q, Y, N) { N === Z && (N = 1); var i = this, t = new Ul; return i.reverseEach(function (e) { N && !i.isSelectable(e) || (Y ? i.rectIntersects(e, Q) : i.rectContains(e, Q)) && t.add(e) }), t }, moveSelection: function (J, B) { var I, q = this, i = q.dm(); i && (I = i.getHistoryManager()), I && I.beginInteraction(), ok(q.sm().toSelection(q.isMovable, q), J, B), I && I.endInteraction() }, moveDatas: function (T, j, R) { var q, I = this, F = I.dm(); F && (q = F.getHistoryManager()), q && q.beginInteraction(), T instanceof Ul || (T = new Ul(T)), ok(T, j, R), q && q.endInteraction() }, getDataUIBounds: function (V) { var P = this.getDataUI(V); return P ? P._79o() : l }, drawData: function (Y, O) { var H = this.getDataUI(O); H && (H._79o(), H._42(Y)), O instanceof R.Block && O.eachChild(function (h) { this.drawData(Y, h) }, this) }, getBoundsForGroup: function (X) { return X.s(Rk) ? this.getDataUIBounds(X) : l }, rectIntersects: function (k, A) { this.validate(); var F = l; if (this._56I[k._id]) { var g = this._25I[k._id]; if (g) { var H = g._79o(); if (dj(A, H)) F = !0; else if ((A = gb(A, H)) && (g.rectIntersects && (F = g.rectIntersects(A)), F == l)) { if (!k.s("pixelPerfect")) return !0; var u = A.x, $ = A.y, V = A.width, z = A.height, Q = this._zoom, c = m.hitMaxArea, G = V * z * Q * Q; if (G > c) { var e = Math.sqrt(c / G); Q *= e } V *= Q, z *= Q, u *= Q, $ *= Q; var B = Sq(V, z); bo(B, -u, -$), B.scale(Q, Q), this._drawForChecking = !0, this.drawData(B, k), this._drawForChecking = !1; try { for (var Z = 0, q = B.getImageData(0, 0, V, z).data; Z < q.length; Z += 4)if (0 !== q[Z + 3]) { F = !0; break } B.restore() } catch (_) { Ro = l, F = !0 } } } } return F ? !0 : !1 }, rectContains: function (e, y) { if (this._56I[e._id]) { var T = this._25I[e._id]; if (T) return dj(y, T._79o()) } return !1 }, reset: function () { this.setZoom(1), this.setTranslate(0, 0) }, handleKeyDown: function (Y) { if (!m.isInput(Y.target)) { var b = this, N = b._focusData, P = N && b._25I[N._id], u = 0, U = b._dataModel._datas; if (!(N && N._enabled && N._editable && P && P.onKeyDown && P.onKeyDown(Y) === !0)) if (9 === Y.keyCode && (N && (u = U.indexOf(N), Qd(Y) ? -1 === --u && (u = 0) : ++u === U.size() && (u = 0)), b._focusData = N = U.get(u), b.sm().setSelection(N)), Tn(Y) ? b.selectAll() : Pk(Y) && b.isResettable() && b.reset(), b.sm().isEmpty()) { if (b._editing) return; var Z = b.tx(), f = b.ty(), Q = !1, _ = Qd() ? 100 : 10; Qi(Y) && (Z -= _, Q = !0), Ef(Y) && (f -= _, Q = !0), Kh(Y) && (Z += _, Q = !0), hr(Y) && (f += _, Q = !0), Q && b.setTranslate(Z, f) } else { Th(Y) && b.handleDelete(Y); var g = Qd() ? 10 : 1; Qi(Y) && (b.moveSelection(-g, 0), b.fi({ kind: "moveLeft" })), Ef(Y) && (b.moveSelection(0, -g), b.fi({ kind: "moveUp" })), Kh(Y) && (b.moveSelection(g, 0), b.fi({ kind: "moveRight" })), hr(Y) && (b.moveSelection(0, g), b.fi({ kind: "moveDown" })) } } }, handleScroll: function (n, r) { np(n); var P = this.lp(n); r > 0 ? this.scrollZoomIn(P) : 0 > r && this.scrollZoomOut(P) }, handlePinch: function (B, W, l) { this._68I || (W > l ? this.pinchZoomIn(B) : this.pinchZoomOut(B)) }, checkDoubleClickOnNote: function (H, u) { var w = this, d = w.lp(H), f = w.getDataUI(u), G = f.note2Info; return G && u.s("note2.toggleable") && lg(G.clickRect, d) ? (u.s(Dd, !u.s(Dd)), w.fi({ kind: "toggleNote2", event: H, data: u }), !0) : (G = f.noteInfo, G && u.s("note.toggleable") && lg(G.clickRect, d) ? (u.s(Yi, !u.s(Yi)), w.fi({ kind: "toggleNote", event: H, data: u }), !0) : !1) }, _84o: function () { }, isNoteVisible: function () { return this._zoom > .15 }, isLabelVisible: function () { return this._zoom > .15 }, isEditVisible: function () { return this._zoom > .15 }, autoScroll: function (i, C) { var m = this, D = m.getAutoScrollZone(), z = D / m.getZoom(), E = D / 4, Q = m._29I, S = m.lp(i), V = { x: m.tx(), y: m.ty() }; return S && D > 0 && Q && (S.x - Q.x < z ? m.translate(E, 0) : Q.x + Q.width - S.x < z && m.translate(-E, 0), S.y - Q.y < z ? m.translate(0, E) : Q.y + Q.height - S.y < z && m.translate(0, -E)), V.x = m.tx() - V.x, V.y = m.ty() - V.y, C && (C.x += V.x, C.y += V.y), V }, getMoveMode: function (g, N) { var j = N.s("2d.move.mode"); return j ? j : Ne["88"] ? "x" : Ne["89"] ? "y" : "xy" }, getSerializableProperties: function () { return { layers: 1, scrollBarColor: 1, scrollBarSize: 1, autoMakeVisible: 1, autoHideScrollBar: 1, editable: 1, resettable: 1, pannable: 1, rectSelectable: 1, autoScrollZone: 1, visibleFunc: 1, movableFunc: 1, editableFunc: 1, pointEditableFunc: 1, rectEditableFunc: 1, anchorEditableFunc: 1, rotationEditableFunc: 1, rectSelectBackground: 1, rectSelectBorderColor: 1, editPointSize: 1, editPointBorderColor: 1, editPointBackground: 1, hoverDelay: 1, dataModel: 1, selectionModel: 1, currentSubGraph: 1, zoom: 1, translateX: 1, translateY: 1 } }, serializeProperty: function (m, H, w) { var D = this; return "currentSubGraph" === H ? { __i: m.getId() } : w.serializeProperty(m, H, D) }, deserializeProperty: function (o, Z, w) { var S = this; if ("currentSubGraph" === Z) { var O = S.dm(), G = O.__idMap; return G[o.__i] } return w.deserializeProperty(o, Z, S) }
        }); var ah = function (G, i) { var T = this; T.gv = G, T.s = function (K) { return i.getStyle(K) }, T._data = i, T._87I = new Ul }; uo(ah, F, { _6I: l, ms_icons: 1, _84o: function () { }, dispose: function () { }, isShadowed: function () { return this.s("shadow") || this.gv.isSelected(this._data) && "shadow" === this.s("select.type") }, getSelectWidth: function () { var B = this, n = B.gv.isSelected(B._data); return !n || B.isShadowed() ? 0 : B.gv.getSelectWidth(B._data) }, getBodyColor: function (C) { var U = this._data, z = this.gv.getBodyColor(U); return z ? z : C ? U.getStyle(C) : l }, _2Q: function (f) { return this.s(f) }, _1Q: function (d, A, G, s) { var C = this.s, B = C(A + ".dash.color"); d.strokeStyle = B, d.lineWidth = G, d.stroke(), C(A + ".dash.3d") && Zb(d, B, C(A + ".dash.3d.color"), G, this.gv._zoom, C(A + ".dash.3d.accuracy")), up(d, s) }, invalidate: function () { this._6I = l }, _79o: function () { var s = this; if (!s._6I) { s.labelInfo = s.label2Info = s.noteInfo = s.note2Info = s._38o = l, s._87I.clear(), s._3O(); var E = s._data, C = s.gv; s._55O = C.isEditable(E) ? { _42O: C.isRectEditable(E), _43O: C.isPointEditable(E), _56O: C.isRotationEditable(E) } : l, s._6I = s._81o() } return s._6I }, _3O: function () { }, getPosition: function () { return er }, _68o: function (R, t) { R && this._87I.add(gp(R, t)) }, _81o: function () { var F = this, h = F.s; F._24O(Sc, "getLabel"), F._24O(zp, "getLabel2"), F._26O(Yf, "getNote"), F._26O(Wd, "getNote2"), F._15O(), F._55O && F._48O(); var S; if (F._87I.each(function (G) { S = rm(S, G) }), S && F.isShadowed()) { var N = Ln(S); N.x += h("shadow.offset.x"), N.y += h("shadow.offset.y"), Bb(N, h("shadow.blur")), S = rm(S, N) } return F._87I.clear(), S }, _42: function (Q) { var M = this, B = M._data, I = M.gv, D = M.s, p = D("opacity"), a = this.isShadowed(); if (a) { var K = Q.shadowOffsetX, W = Q.shadowOffsetY, U = Q.shadowBlur, i = Q.shadowColor, N = I.getZoom(); Q.shadowOffsetX = D("shadow.offset.x") * N, Q.shadowOffsetY = D("shadow.offset.y") * N, Q.shadowBlur = D("shadow.blur") * N, Q.shadowColor = D("select.color") } if (p != l) { var _ = Q.globalAlpha; Q.globalAlpha = p } M._80o(Q), I.isLabelVisible(B) && ((!I._drawForChecking || D("label.selectable")) && kg(Q, M.labelInfo), (!I._drawForChecking || D("label2.selectable")) && kg(Q, M.label2Info)), I.isNoteVisible(B) && (jo(Q, M.noteInfo), jo(Q, M.note2Info)), M._99O(Q), p != l && (Q.globalAlpha = _), a && (Q.shadowOffsetX = K, Q.shadowOffsetY = W, Q.shadowBlur = U, Q.shadowColor = i) }, _80o: function () { }, _47O: function () { }, _24O: function (G, $) { var g = this, u = g._data, o = g.gv, y = g.s, X = o[$](u); if (X != l) { var T = y(G + ".scale"), K = y(G + ".max"), N = y(G + ".position"), W = g[G + "Info"] = { label: X, scale: T, color: o[$ + "Color"](u), font: y(G + ".font"), opacity: y(G + ".opacity"), align: y(G + ".align"), rotation: g.getRotation(y(G + ".rotation"), !1, N), background: o[$ + "Background"](u) }, a = zd(W, X); K > 0 && K < a.width && (W.labelWidth = a.width, a.width = K), 1 !== T && (a.width *= T, a.height *= T); var M = g.getPosition(N, y(G + ".offset.x"), y(G + ".offset.y"), a, y(G + ".position.fixed")); if (a.x = M.x - a.width / 2, a.y = M.y - a.height / 2, g._68o(W.rect = a, W.rotation), 1 !== T) { var J = a.width / T, k = a.height / T; W.rect = { x: M.x - J / 2, y: M.y - k / 2, width: J, height: k } } } }, _26O: function (g, h) { var J = this, C = J.gv, L = J._data, I = J.s, s = C[h](L); if (s != l) { var D, N, Q = I(g + ".scale"), Y = J[g + "Info"] = { note: s, scale: Q, data: L, view: C, expanded: I(g + ".expanded"), font: I(g + ".font"), color: I(g + ".color"), opacity: I(g + ".opacity"), align: I(g + ".align"), icon: I(g + ".icon"), backgroundImage: I(g + ".backgroundImage"), borderWidth: I(g + ".border.width"), borderColor: I(g + ".border.color"), background: C[h + "Background"](L) }, U = J.getPosition(I(g + ".position"), I(g + ".offset.x"), I(g + ".offset.y")), b = U.x, E = U.y; if (Y.expanded) { var $, w = I(g + ".max"), d = I(g + ".backgroundImage"); d ? (d = yj(d), $ = { width: nq(d, L), height: Jf(d, L) }) : $ = zd(Y, s), $.width += 6, $.height += 2, w > 0 && w < $.width && (Y.labelWidth = $.width, $.width = w), D = $.width, N = $.height + 8, Y.clickRect = { x: b - D * Q / 2, y: E - N * Q, width: D * Q, height: N * Q * $.height / N } } else { var z = I(g + ".icon"); z ? (z = yj(z), D = nq(z, L), N = Jf(z, L)) : (D = 12, N = 18), Y.clickRect = { x: b - D * Q / 2, y: E - N * Q, width: D * Q, height: N * Q } } Y.rect = { x: b - D / 2, y: E - N * Q / 2 - N / 2, width: D, height: N }; var R = T(Y.borderWidth / 2) * Q; J._68o({ x: b - D * Q / 2 - R, y: E - N * Q - R, width: D * Q + 2 * R, height: N * Q + 2 * R }) } }, _48O: function () { }, _99O: function (s) { var H = this, f = H._38o; if (f) { var F = H.gv, k = H._data, x = f.icons; for (var r in x) { var K = x[r], C = f.rects[r]; if (C) { var Z = oi(K.opacity, k, F), R = oi(K.names, k, F), O = R ? R.length : 0, L = C.rotation; if (Z != l) { var z = s.globalAlpha; s.globalAlpha *= Z } for (var d = 0; O > d; d++) { var M = R[d], X = yj(M), o = C[d]; if (L) { var D = o.x + o.width / 2, G = o.y + o.height / 2; s.save(), bo(s, D, G), Nc(s, L), bo(s, -D, -G) } ff(s, X, oi(K.stretch, k, F), o.x, o.y, o.width, o.height, H._data, H.gv), L && s.restore() } Z != l && (s.globalAlpha = z) } } } } }); var sq = function (t, T) { xd(sq, this, [t, T]) }; uo(sq, ah, { _checkEmptyRect: !0, _40O: function (s, x) { var S = this, k = S.s, E = s.rect; (s.borderColor = S.gv.getBorderColor(S._data)) && (s.borderType = k("border.type"), s.borderWidth = k("border.width"), s.borderPadding = k("border.padding"), x = g(x, s.borderPadding + s.borderWidth / 2)); var B = S._data.getScale(), w = g(1, g(A(B.x), A(B.y))); if (s.selectWidth = S.getSelectWidth()) { var Q = S.gv._zoom; s.selectType = k("select.type"), s._97o = k("select.color"), s.selectPadding = k("select.padding"), x = g(x, (s.selectPadding + s.selectWidth / 2 / Q) / w) } x > 0 && (x *= w, E = Ln(E), Bb(E, x)), S._68o(E) }, _39O: function (J, v) { var Y, o = this, I = v.rect; if (v.borderWidth > 0 && (Y = v.borderPadding, J.strokeStyle = v.borderColor, J.lineWidth = v.borderWidth, Ep(J, v.borderType, { x: I.x - Y, y: I.y - Y, width: I.width + 2 * Y, height: I.height + 2 * Y }), J.stroke()), v.selectWidth > 0) { var m = o.gv._zoom; if (Y = v.selectPadding, J.strokeStyle = v._97o, J.lineWidth = v.selectWidth / m, v.rotation != l) { J.save(), J.translate(v.position.x, v.position.y), J.rotate(v.rotation); var K = o._data, g = K.getWidth(), s = K.getHeight(), $ = v.scale, E = v.anchor; I = { x: $.x * -g * E.x, y: $.y * -s * E.y, width: $.x * g, height: $.y * s } } Ep(J, v.selectType, { x: I.x - Y, y: I.y - Y, width: I.width + 2 * Y, height: I.height + 2 * Y }), v.rotation != l && J.restore(), J.stroke() } }, _3O: function () { var u = this, Z = u.s, C = u._data, L = C.getStyle(mi), c = u.getBodyColor(), Y = u._83o = L ? { shape: L, _53o: u.getBodyColor("shape.background"), _27Q: yj(Z("shape.repeat.image"), c), shapeGradientPack: Z("shape.gradient.pack"), _54o: Z("shape.border.width"), _55o: Z("shape.border.color"), _56o: Z("shape.border.3d"), _57o: Z("shape.border.3d.color"), _58o: Z("shape.border.3d.accuracy"), shapeGradient: Z("shape.gradient"), _59o: Z("shape.gradient.color"), _60o: Z("shape.border.pattern"), _61o: Z("shape.border.cap"), _62o: Z("shape.border.join"), bodyColor: c } : { img: yj(C.getImage(), c), bodyColor: c, stretch: Z("image.stretch") }; if (O && !j); else { Y.rect = C.getRect(), Y.position = C.p(), Y.scale = C.getScale(), Y.anchor = C.getAnchor(), Y.rotation = C.getRotation(), L === vd && (Y._63o = Z("shape.depth")); var m = 0; if (L) m = zo(l, Y._54o / 2, Y._62o), u.s("shape.dash") && (m = g(m, (u.s("shape.dash.width") || Y._54o) / 2)); else if (Y.img && Y.img.boundExtend) if (m = oi(Y.img.boundExtend, C, u.gv), Y.img.boundExtendAbsolute) { var k = C.getScale(); m /= u.gv._zoom * g(1, g(A(k.x), A(k.y))) } else if (!Y.img.fitSize) { var b = oi(Y.img.width, C, u.gv), h = oi(Y.img.height, C, u.gv); m *= g(C.getWidth() / b, C.getHeight() / h) } u._40O(Y, m); var H = Z("clip.percentage"); if (1 > H && (0 > H && (H = 0), Y.clipRect = lj(C.getAnchorRect(), Z("clip.direction"), H)), L) { var $ = Z("shape.fill.clip.percentage"); 1 > $ && (0 > $ && ($ = 0), Y.shapeClipRect = lj(C.getAnchorRect(), Z("shape.fill.clip.direction"), $)) } } }, getPosition: function (R, s, z, O) { var X = $e(R, this._83o.rect, O); return X.x += s, X.y += z, X }, _80o: function (P) { var W = this, V = W.s, l = W.gv, r = W._data, I = W._83o, v = I.rect, t = I.position, c = I.rotation, g = I.anchor, j = I.scale, d = I.shape, a = I.clipRect; if (!W._checkEmptyRect || v.width > 0 && v.height > 0) { var w = r.getSize(); if (w.x = -w.width * g.x, w.y = -w.height * g.y, P.save(), bo(P, t.x, t.y), Nc(P, c), qg(P, j.x, j.y), a && (P.beginPath(), P.rect(a.x, a.y, a.width, a.height), P.clip()), W.freeDraw) W.freeDraw(P, w, I); else if (d) { var A, X, J, m, u = I._60o, R = Ur(P, u), O = I._53o, k = I._27Q, B = I._54o, n = I._55o, e = I.shapeGradientPack, f = P.lineJoin, S = P.lineCap; if ("roundRect" === d ? A = V("shape.corner.radius") : "polygon" === d ? A = V("shape.polygon.side") : "arc" === d && (A = V("shape.arc.from"), X = V("shape.arc.to"), J = V("shape.arc.close"), m = V("shape.arc.oval")), P.lineJoin = I._62o, P.lineCap = I._61o, O || k || e) { var y = I.shapeClipRect; y && (P.save(), P.beginPath(), P.rect(y.x, y.y, y.width, y.height), P.clip()), Ep(P, d, w, A, X, J, m), e ? qn(P, e) : k ? Im(P, k, I.bodyColor, null, r, l) : cm(P, O, I.shapeGradient, I._59o, w), P.fill(), y && P.restore(), e && P.restore(), P !== R && Ep(R, d, w, A, X, J, m) } else Ep(R, d, w, A, X, J, m); if (B > 0) { var Q = V("shape.border.width.absolute"); Q && (P.save(), P.setTransform(1, 0, 0, 1, 0, 0)), P.lineWidth = B, P.strokeStyle = n, P.stroke(), Q && P.restore(), I._56o && Zb(P, n, I._57o, B, l._zoom, I._58o) } if (up(P, u), V("shape.dash")) { var q = V("shape.dash.width") || B; if (q > 0) { u = V("shape.dash.pattern"); var R = Ur(P, u, W._2Q("shape.dash.offset")); R !== P && Ep(R, d, w, A, X, J, m), W._1Q(P, "shape", q, u) } } os(P, O, I._63o, w), P.lineJoin = f, P.lineCap = S } else ff(P, I.img, I.stretch, w.x, w.y, w.width, w.height, r, l, I.bodyColor); P.restore() } W._39O(P, I) }, _48O: function () { }, _47O: function () { } }); var cq = function (j, y) { xd(cq, this, [j, y]) }, ws = function (p, t, y, Z) { var c = Bk(p, t); return y = Z ? b(y, c) : pj(y, c), c ? y /= c : y = 0, { x: p.x + (t.x - p.x) * y, y: p.y + (t.y - p.y) * y } }; uo(cq, ah, { _3O: function () { var R, W = this, y = W._data, e = W.gv, N = W.s, q = N(jj), n = y.isLooped(), h = N("edge.width"), O = N("edge.center"), t = N("edge.offset"), U = e.getBorderColor(y), K = U ? N("border.width") : 0, c = W.getSelectWidth(), f = y._40I, B = y._41I, A = W._78o = f && B ? { looped: n, type: q, width: h, center: O, color: W.getBodyColor("edge.color"), borderColor: U, borderWidth: K, _97o: c ? N("select.color") : l, selectWidth: c, pattern: N("edge.pattern"), cap: N("edge.cap"), join: N("edge.join"), is3d: N("edge.3d"), _67o: N("edge.3d.color"), _66o: N("edge.3d.accuracy") } : l; if (A) { var G = m.getEdgeType(q); if (G) { var b = G(y, Ji(W, e, y, n, q), e, W._19Q); b.points && b.points.size() > 1 ? (A._4O = b, R = eb(A._4O.points)) : b[Gm] && b.rect && (A._4O = b, R = b.rect) } else { var x = N("edge.source.anchor.x"), z = N("edge.source.anchor.y"), r = N("edge.target.anchor.x"), i = N("edge.target.anchor.y"), Y = yq(e, f, N("edge.source.position"), N("edge.source.offset.x"), N("edge.source.offset.y"), x, z), J = yq(e, B, N("edge.target.position"), N("edge.target.offset.x"), N("edge.target.offset.y"), r, i); if (q === fg) { var u = A.points = N(Go) || hd, v = u.size(); A.segments = N("edge.segments"); var P = x !== Z || z !== Z, D = r !== Z || i !== Z; if (!O) if (t) P || (Y = ws(Y, v ? u.get(0) : J, t, v)), D || (J = ws(J, v ? u.get(v - 1) : Y, t, v)); else { var j; P || (j = Rb(Y, v ? u.get(0) : J, yl(e, f)), j && (Y = { x: j[0], y: j[1] })), D || (j = Rb(v ? u.get(v - 1) : Y, J, yl(e, B)), j && (J = { x: j[0], y: j[1] })) } R = rm(eb(A.points), eb(Y, J)) } else { var w = Ji(W, e, y, n, q); if (W._19Q || (w = -w), n) Y = Ln(Y), Y.x = e.getNodeRect(f).x, A.radius = w, R = { x: Y.x - w, y: Y.y - w, width: 2 * w, height: 2 * w }; else { var k = Bk(Y, J), E = pj(t, k), H = { x: E, y: w }, V = { x: k - E, y: w }, a = I(J.y - Y.y, J.x - Y.x), $ = A.mat = new Qh(a); if (A.orienAngle = a, A.angle = J.x < Y.x ? a + s : a, A.rect = { x: H.x, y: H.y, width: V.x - H.x, height: 0 }, A.origin = Y, H = $.tf(H), H.x += Y.x, H.y += Y.y, V = $.tf(V), V.x += Y.x, V.y += Y.y, O) { var L = { x: k, y: 0 }; L = $.tf(L), L.x += Y.x, L.y += Y.y, R = eb([Y, H, V, L]), A.c1 = Y, A.c2 = L } else R = eb(H, V); Y = H, J = V } } A.sourcePoint = Y, A.targetPoint = J, y._lastSourcePoint = Y, y._lastTargetPoint = J } var d = 0; N("edge.dash") && (d = N("edge.dash.width") || h); var _ = "square" === A.cap ? .71 : .5; zo(R, g(d * _, h * _ + K + c), A.join), W._68o(R) } }, getRotation: function (D, k, X) { D = D || 0; var W = this._78o; if (W) { var x, h = W.angle, U = W.points, e = W._4O; if (h != l) return k ? W.orienAngle + D : h + D; if (e && e[Gm]) return e.getRotation ? e.getRotation(this, D, k, X) : 0; if (e && e.points) { var I = e.points; return x = I.size(), Nk[X] ? x && 0 === x % 2 ? cf(I.get(x / 2 - 1), I.get(x / 2), k, D) : D : Fe[X] ? cf(I.get(0), I.get(1), k, D) : cf(I.get(x - 2), I.get(x - 1), k, D) } if (U) return x = U.size(), Nk[X] ? x && 0 === x % 2 ? cf(U.get(x / 2 - 1), U.get(x / 2), k, D) : D : Fe[X] ? cf(W.sourcePoint, x ? U.get(0) : W.targetPoint, k, D) : cf(x ? U.get(x - 1) : W.sourcePoint, W.targetPoint, k, D) } return D }, getPosition: function (m, B, O, s, A) { var M = this._78o; if (M) { var f, E = M.type, v = M.points, q = M._4O, i = M.sourcePoint, V = M.targetPoint; if (!E) return M.looped ? { x: i.x - M.radius + B, y: i.y + O } : (A && i && V && (i.x > V.x || i.x === V.x && i.y > V.y) && (m = nj[m], O = -O), f = $e(m, M.rect, s), f.x += B, f.y += O, f = M.mat.tf(f), f.x += M.origin.x, f.y += M.origin.y, f); if (q && q[Gm]) return q.getPosition ? q.getPosition(this, m, B, O, s, A) : { x: (i.x + V.x) / 2, y: (i.y + V.y) / 2 }; if (v) { var f, o = v.size(); if (Nk[m]) { if (o) { var R = o % 2; if (0 === R) return Ue(v.get(o / 2 - 1), v.get(o / 2), m, B, O, s, A); f = v.get((o - R) / 2) } else f = { x: (i.x + V.x) / 2, y: (i.y + V.y) / 2 }; return f = $e(m, { x: f.x, y: f.y, width: 0, height: 0 }, s), f.x += B, f.y += O, f } return Fe[m] ? Ue(i, o ? v.get(0) : V, m, B, O, s, A) : Ue(o ? v.get(o - 1) : i, V, m, B, O, s, A) } if (q) { var L = q.points, o = L.size(); if (Nk[m]) { var R = o % 2; return 0 === R ? Ue(L.get(o / 2 - 1), L.get(o / 2), m, B, O, s, A) : (f = L.get((o - R) / 2), f = $e(m, { x: f.x, y: f.y, width: 0, height: 0 }, s), f.x += B, f.y += O, f) } return Fe[m] ? Ue(L.get(0), L.get(1), m, B, O, s, A) : Ue(L.get(o - 2), L.get(o - 1), m, B, O, s, A) } } return er }, _42: function (U) { this._78o && cq.superClass._42.call(this, U) }, drawPath: function (J, v) { J.beginPath(); var V = v.type, b = v.points, E = v.segments, r = v._4O; if (!V || b) { var N = v.sourcePoint, X = N.x, _ = N.y, Q = v.targetPoint, W = Q.x, i = Q.y; if (V) if (E) { var U = new Ul({ x: X, y: _ }); U.addAll(b), U.add({ x: W, y: i }), vq(J, U, E) } else J.moveTo(X, _), b.each(function (A) { J.lineTo(A.x, A.y) }), J.lineTo(W, i); else v.looped ? J.arc(X, _, v.radius, 0, B, !0) : v.center ? (J.moveTo(v.c1.x, v.c1.y), J.lineTo(X, _), J.lineTo(W, i), J.lineTo(v.c2.x, v.c2.y)) : (J.moveTo(X, _), J.lineTo(W, i)) } else r && (r.points ? vq(J, r.points, r.segments) : r[Gm] && r[Gm](J, r)) }, _80o: function (w) { var Z = this, T = Z.s, B = Z._78o, b = B.width, i = B.selectWidth, m = B.borderWidth, f = B.color, z = w.lineJoin, F = w.lineCap, _ = B.pattern; w.lineJoin = B.join, w.lineCap = B.cap, Z.drawPath(Ur(w, _), B); var W = T("edge.width.absolute"); if (W && (w.save(), w.setTransform(1, 0, 0, 1, 0, 0)), i && (w.strokeStyle = B._97o, w.lineWidth = b + 2 * (m + i), w.stroke()), m && (w.strokeStyle = B.borderColor, w.lineWidth = b + 2 * m, w.stroke()), w.strokeStyle = f, w.lineWidth = b, w.stroke(), B.is3d && Zb(w, f, B._67o, b, Z.gv._zoom, B._66o), W && w.restore(), up(w, _), T("edge.dash")) { _ = T("edge.dash.pattern"); var S = Ur(w, _, Z._2Q("edge.dash.offset")); S !== w && Z.drawPath(S, B), Z._1Q(w, "edge", T("edge.dash.width") || b, _) } w.lineJoin = z, w.lineCap = F }, _48O: function () { }, _47O: function () { }, _71o: function (q, g) { var l = this, K = l._data; if (l._19Q = !0, !K.getEdgeGroup()) return q ? K.s("edge.gap") : 0; var Z, C = 0, R = 0, s = 0; if (K.getEdgeGroup().getSiblings().each(function (w) { w.each(function (w) { if (l.gv.isVisible(w) && w.s(jj) == g) { var B = w.s("edge.gap"); Z ? (R += s / 2 + B / 2, s = B) : (Z = w, s = B), w === K && (C = R) } }) }), q) return R - C + s; var W = C - R / 2; return Z && K._40I !== Z._40I && (l._19Q = !1), W } }); var vp = function (q, h) { xd(vp, this, [q, h]) }; uo(vp, sq, { _3O: function () { var A, i, X = this, P = X.s, I = X._data, H = X.gv; if (X._88I = l, I.isExpanded() && I.eachChild(function (W) { var Y = H.getBoundsForGroup(W); Y && (i || (i = []), i.push(Y), A = rm(A, Y)) }), A) { var D = H.getLabel(I), k = P("group.type"); A = An(k, i, A), Lk(A, I, "group.padding", 1); var Y = X._88I = { type: k, rect: A, _64o: A }; if (!k && D != l) { var R, F = X.labelInfo = { label: D, color: P("group.title.color"), font: P("group.title.font"), align: P("group.title.align") }, C = zd(F, D), r = C.width, m = C.height, V = P("group.title.align"); r > A.width && (A.width = r), F.rect = { y: A.y - m, width: C.width, height: m }, R = V === Xr ? A.x : V === kf ? A.x + A.width - r : A.x + A.width / 2 - r / 2, F.rect.x = R, Y.titleRect = { x: A.x, y: A.y - m, width: A.width, height: m + 1 }, Y.rect = { x: A.x, y: A.y - m, width: A.width, height: A.height + m } } X._40O(Y, P("group.border.width") / 2) } else vp.superClass._3O.call(X) }, getPosition: function (M, c, j, K) { var m = this._88I; if (m) { var B = $e(M, m.rect, K); return B.x += c, B.y += j, B } return vp.superClass.getPosition.apply(this, arguments) }, _24O: function (S, C) { var n = this._88I; (!n || n.type || "label2" === S) && vp.superClass._24O.call(this, S, C) }, _80o: function (i) { var j = this, l = j._88I; if (l) { var Q = j._data, E = j.s, p = j.gv, X = l.type, z = l.rect, w = l._64o, Y = l.titleRect, F = j.getBodyColor(), L = yj(E("group.image"), F), D = E("group.image.stretch"), N = j.getBodyColor("group.background"), s = yj(E("group.repeat.image"), F), v = E("group.gradient.pack"), b = E("group.gradient"), k = E("group.gradient.color"), I = E("group.depth"); if (X) { var f = E("group.border.pattern"), q = E("group.border.width"), V = i.lineJoin, d = i.lineCap; if (i.lineJoin = E("group.border.join"), i.lineCap = E("group.border.cap"), L) { if (i.save(), Ep(i, X, z), i.clip(), ff(i, L, D, z.x, z.y, z.width, z.height, Q, p, F), i.restore(), q > 0) { var h = Ur(i, f); Ep(h, X, z), i.lineWidth = q, i.strokeStyle = E("group.border.color"), i.stroke(), up(i, f) } } else { var h = Ur(i, f); N || s || v ? (Ep(i, X, z), v ? qn(i, v) : s ? Im(i, s, F, null, Q, p) : cm(i, N, b, k, z), i.fill(), v && i.restore(), i !== h && Ep(h, X, z)) : Ep(h, X, z), q > 0 && (i.lineWidth = q, i.strokeStyle = E("group.border.color"), i.stroke()), up(i, f), X === vd && os(i, N, I, z) } i.lineJoin = V, i.lineCap = d } else if (L ? ff(i, L, D, w.x, w.y, w.width, w.height, Q, p, j.getBodyColor()) : (N || s) && (s ? Im(i, s, F, null, Q, p) : cm(i, N, b, k, w), Ep(i, vd, w), i.fill(), os(i, N, I, w)), Y) { var K = E("group.title.background"); qo(i, Y.x, Y.y, Y.width, Y.height, K), os(i, K, I, Y) } j._39O(i, l) } else vp.superClass._80o.call(j, i) } }); var ko = function (J, b) { xd(ko, this, [J, b]) }; uo(ko, sq, { _80o: function (P) { this._39O(P, this._83o) } }); var Qj = function (z, q) { xd(Qj, this, [z, q]) }; uo(Qj, sq, { _3O: function () { var T = this, m = T._data, h = T.s, F = T.gv, p = m.getPoints(), Q = F.getBorderColor(m), H = Q ? h("border.width") : 0, x = T.getSelectWidth(), s = h("shape.border.width"), v = m.getRect(), I = F.getBodyColor(m), M = T._99o = p.isEmpty() ? l : { rect: v, rotation: m.getRotation(), fillRule: h("shape.fill.rule"), scale: m.getScale(), position: m.p(), points: p, segments: m.getSegments(), bodyColor: I, borderColor: Q, borderWidth: H, _94o: h("shape.border.3d"), _95o: h("shape.border.3d.color"), _96o: h("shape.border.3d.accuracy"), _97o: x ? h("select.color") : l, selectWidth: x, _53o: h("shape.background"), _27Q: yj(h("shape.repeat.image"), I), shapeGradientPack: h("shape.gradient.pack"), _54o: s, _55o: h("shape.border.color"), shapeGradient: h("shape.gradient"), _59o: h("shape.gradient.color"), _60o: h("shape.border.pattern"), _61o: h("shape.border.cap"), _62o: h("shape.border.join") }; if (M) { var E = m.getScale(), a = g(1, g(A(E.x), A(E.y))), K = s * ("square" === M._61o ? .71 : .5) + H + x / T.gv._zoom / a; K && (K *= a, v = Ln(v), zo(v, K, M._62o)), T._68o(v); var J = h("clip.percentage"); 1 > J && (0 > J && (J = 0), M.clipRect = lj(m.getAnchorRect(), h("clip.direction"), J)); var e = h("shape.fill.clip.percentage"); 1 > e && (0 > e && (e = 0), M.shapeClipRect = lj(m.getAnchorRect(), h("shape.fill.clip.direction"), e)) } }, getPosition: function (q, j, p, Y) { var $ = this._99o; if ($) { var y = $e(q, $.rect, Y); return y.x += j, y.y += p, y } return er }, _42: function (C) { this._99o && Qj.superClass._42.call(this, C) }, _80o: function (G) { var v, U = this, h = U.s, p = U._99o, Y = p.position, N = p.scale, $ = p.rotation, X = p.bodyColor, d = p.borderWidth, H = p.selectWidth, s = p._53o, a = p._27Q, e = p.shapeGradientPack, M = p._54o, q = p.clipRect, W = p.shapeClipRect, A = p.points, J = p.segments, S = U._data.isClosePath(), i = p.fillRule, x = s || a || e; G.save(), bo(G, Y.x, Y.y), Nc(G, $), qg(G, N.x, N.y), q && (G.beginPath(), G.rect(q.x, q.y, q.width, q.height), G.clip()), x && W && (G.save(), G.beginPath(), G.rect(W.x, W.y, W.width, W.height), G.clip()), bo(G, -Y.x, -Y.y); var r = p._60o, Z = Ur(G, r), y = G.lineJoin, T = G.lineCap; G.lineJoin = p._62o, G.lineCap = p._61o, x ? (vq(G, A, J, S), e ? qn(G, e) : a ? Im(G, a, X, null, U._data, U.gv) : (v = X ? X : s, cm(G, v, p.shapeGradient, p._59o, p.rect)), G.fill(i), W && (G.restore(), bo(G, -Y.x, -Y.y)), e && G.restore(), Z !== G && vq(Z, A, J, S)) : vq(Z, A, J, S); var m = h("shape.border.width.absolute"); if (m && (G.save(), G.setTransform(1, 0, 0, 1, 0, 0)), H && (G.strokeStyle = p._97o, G.lineWidth = M + 2 * (d + H), G.stroke()), d && (G.strokeStyle = p.borderColor, G.lineWidth = M + 2 * d, G.stroke()), M && (v = p._55o, !s && X && (v = X), G.strokeStyle = v, G.lineWidth = M, G.stroke(), p._94o && Zb(G, v, p._95o, M, U.gv._zoom, p._96o)), m && G.restore(), up(G, r), h("shape.dash")) { var n = h("shape.dash.width") || M; if (n > 0) { r = h("shape.dash.pattern"); var Z = Ur(G, r, U._2Q("shape.dash.offset")); Z !== G && vq(Z, A, J, S), U._1Q(G, "shape", n, r) } } G.lineJoin = y, G.lineCap = T, G.restore() }, _48O: function () { }, _47O: function () { } }); var rg = function (a, h) { xd(rg, this, [a, h]) }; uo(rg, Qj, { getRotation: function (N, D, S) { N = N || 0; var U = this._data.getPoints(), C = U.size(); return C > 1 ? Nk[S] ? C && 0 === C % 2 ? cf(U.get(C / 2 - 1), U.get(C / 2), D, N) : N : Fe[S] ? cf(U.get(0), U.get(1), D, N) : cf(U.get(C - 2), U.get(C - 1), D, N) : N }, getPosition: function (m, q, f, X, u) { var n = this._data.getPoints(), Y = n.size(); if (Y > 1) { if (Nk[m]) { var O = Y % 2; if (0 === O) return Ue(n.get(Y / 2 - 1), n.get(Y / 2), m, q, f, X, u); var g = n.get((Y - O) / 2), s = { x: g.x, y: g.y, width: 0, height: 0 }; return g = $e(m, s, X), g.x += q, g.y += f, g } return Fe[m] ? Ue(n.get(0), n.get(1), m, q, f, X, u) : Ue(n.get(Y - 2), n.get(Y - 1), m, q, f, X, u) } return er } }); var Dq = function (Y, K) { xd(Dq, this, [Y, K]) }; uo(Dq, sq, { _3O: function () { var C = this; Dq.superClass._3O.call(C); var h = C.s, F = C._83o; C._82o = F.img || F.shape ? l : { background: C.getBodyColor("grid.background"), depth: h("grid.depth"), rect: F.rect, _88o: h("grid.cell.depth"), cellBorderColor: h("grid.cell.border.color"), _89o: h("grid.row.count"), _90o: h("grid.column.count"), block: h("grid.block"), _91o: h("grid.block.color"), _92o: h("grid.block.padding"), _93o: h("grid.block.width") } }, _80o: function ($) { var b = this, B = b._82o; if (!B) return Dq.superClass._80o.call(b, $), void 0; var s, N, p = b._data, q = B.background, Q = B.rect, E = B.block, r = B._91o, u = B._92o, n = B._93o, C = B._88o, P = B.cellBorderColor, H = B._89o, a = B._90o; if (q) if (qo($, Q.x, Q.y, Q.width, Q.height, q), os($, q, B.depth, Q), C) for (s = 0; H > s; s++)for (N = 0; a > N; N++)Q = p.getCellRect(s, N), Q && os($, q, C, Q); else if (P) { for ($.beginPath(), s = 0; H > s; s++)for (N = 0; a > N; N++)Q = p.getCellRect(s, N), Q && $.rect(Q.x, Q.y, Q.width, Q.height); $.strokeStyle = P, $.lineWidth = 1, $.stroke() } if ("h" === E) for (s = 0; H > s; s++)Q = rm(p.getCellRect(s, 0), p.getCellRect(s, a - 1)), Bb(Q, u), Ei($, r, Q.x, Q.y, Q.width, Q.height, n); else if ("v" === E) for (N = 0; a > N; N++)Q = rm(p.getCellRect(0, N), p.getCellRect(H - 1, N)), Bb(Q, u), Ei($, r, Q.x, Q.y, Q.width, Q.height, n); b._39O($, b._83o) } }); var Mc = function (N, i) { xd(Mc, this, [N, i]) }; uo(Mc, sq, { _checkEmptyRect: !1, _81o: function () { var g = this._data, d = Mc.superClass._81o.call(this), p = g.s("text"); if (p != l) { var Q, t, L = g.s("text.font"), b = g.s("text.align"), h = g.s("text.vAlign"), E = g.getRotation(), C = Nm(L, p), V = C.width, q = C.height; "left" === b ? Q = -g.getWidth() / 2 : "center" === b ? Q = -C.width / 2 : "right" === b && (Q = g.getWidth() / 2 - C.width), "top" === h ? t = -g.getHeight() / 2 : "middle" === h ? t = -C.height / 2 : "bottom" === h && (t = g.getHeight() / 2 - C.height); var z; if (E) { var e = new Qh(E); z = eb([e.tf(Q, t), e.tf(Q + V, t), e.tf(Q + V, t + q), e.tf(Q, t + q)]) } else z = { x: Q, y: t, width: V, height: q }; z.x += g.getPosition().x, z.y += g.getPosition().y, d = rm(d, z) } return d } }); var or = Oo.Interactor = function (y) { this.gv = this._graphView = y }; Xp("Interactor", F, { ms_listener: 1, getView: function () { return this.gv.getView() }, setUp: function () { this.addListeners() }, tearDown: function () { this.removeListeners(), this.clear() }, clear: function () { }, fi: function (o) { this.gv.fi(o) }, setCursor: function (k) { P || (this.getView().style.cursor = k) }, startDragging: function (X) { var t = this; t._lastClientPoint = gi(X), t._lastLogicalPoint = t.gv.lp(X), Af(t, X) }, clearDragging: function () { var y = this; y._lastClientPoint = y._lastLogicalPoint = y._logicalPoint = l }, autoScroll: function (H) { return this.gv.autoScroll(H, this._lastClientPoint) } }); var hm = Oo.DefaultInteractor = function (r) { xd(hm, this, [r]) }; Xp("DefaultInteractor", or, { handle_mousedown: function (k) { np(k); var X = this, K = X.gv, Y = K.getDataAt(k); !K.setFocus(k) || K._editing || K._scrolling || (Si(k) ? K.handleDoubleClick(k, Y) : K.handleClick(k, Y), !Pk() && Y || !K.isPannable() || !Vg(k) || ec(k) || (X._tx = K.tx(), X._ty = K.ty(), X.startDragging(k))) }, handleWindowMouseUp: function (x) { var F = this, m = F.gv; m._panning && (delete m._panning, m.onPanEnded(), F.fi({ kind: "endPan", event: x })), delete F._tx, delete F._ty, F.clearDragging() }, handle_mousemove: function (f) { var X = this, Y = X.gv; X._hoverTimer && (v(X._hoverTimer), delete X._hoverTimer), X._hoverTimer = U(function () { X.fi({ kind: "hover", event: f }), v(X._hoverTimer), delete X._hoverTimer }, Y.getHoverDelay() || 800) }, handle_touchmove: function (V) { this.handle_mousemove(V) }, handleWindowMouseMove: function (x) { var $ = this, Q = $.gv, E = $._lastClientPoint; $.fi({ kind: Q._panning ? "betweenPan" : "beginPan", event: x }), Q._panning = 1, Q.setTranslate($._tx + x.clientX - E.x, $._ty + x.clientY - E.y) }, handle_mousewheel: function (x) { this.gv.handleScroll(x, x.wheelDelta) }, handle_DOMMouseScroll: function (M) { 2 === M.axis && this.gv.handleScroll(M, -M.detail) }, handle_keydown: function (p) { this.gv.handleKeyDown(p) } }); var df = Oo.SelectInteractor = function (n) { xd(df, this, [n]) }; Xp("SelectInteractor", or, { _42: function () { var z = this, Q = z.gv, r = Q.getZoom(), U = z.mark, Z = z.div; Z || (Z = z.div = Rl(), hq(z.getView(), Z)); var L = {}; L.x = U.x * r + Q.tx(), L.y = U.y * r + Q.ty(), L.width = U.width * r, L.height = U.height * r, Up(Z, L), this.intersects() ? (Z.style.border = "", Z.style.background = Q.getRectSelectBackground()) : (Z.style.background = "", Z.style.border = "1px solid " + Q.getRectSelectBorderColor()) }, handle_mousedown: function (X) { var M = this, P = M.gv; if (M._57I = l, !(P._editing || P._scrolling || Pk())) { var q = P.getDataAt(X), d = P.sm(); if (q) if (ec(X)) d.co(q) ? d.rs(q) : d.as(q); else if (d.co(q)) { if (Si(X) && q instanceof Wo && q.isClickThroughEnabled()) { var f = P.getDataAt(X, function (a) { P._clickThroughChecking = !0; var y = a.getParent() === q && P.isSelectable(a); return delete P._clickThroughChecking, y }); f && (X.clickThrough = !0, d.ss(f)) } } else d.ss(q); else ec(X) || !P.isPannable() ? Vg(X) && (ec(X) || d.cs(), P.isRectSelectable() && (M.startDragging(X), P._77O = 1)) : Vg(X) && (M._57I = gi(X)) } }, handle_mouseup: function (Q) { var n = this, K = n._57I; K && (Bk(K, gi(Q)) <= 1 && n.gv.sm().cs(), n._57I = l) }, handleWindowMouseUp: function (Q) { this.clear(Q) }, handleWindowMouseMove: function (W) { var t = this, C = t.gv; t._logicalPoint = C.lp(W), t.mark ? (t.fi({ kind: "betweenRectSelect", event: W }), t.autoScroll(W), t.redraw()) : t.fi({ kind: "beginRectSelect", event: W }), t.mark = eb(t._lastLogicalPoint, t._logicalPoint), t.redraw() }, intersects: function () { var t = this, u = t._lastLogicalPoint, h = t._logicalPoint; return u.x > h.x || u.y > h.y }, clear: function (b) { var q = this, M = q.gv, O = q.mark; if (q._57I = l, q._lastLogicalPoint) { if (O) { if (0 !== O.width && 0 !== O.height) { var v = M.getDatasInRect(O, q.intersects()); if (!v.isEmpty()) { var C = M.sm(), G = C.toSelection(); v.each(function (t) { C.co(t) ? G.remove(t) : G.add(t) }), C.ss(G) } } Ng(q.div), delete q.div, delete q.mark, q.redraw(), q.fi({ kind: "endRectSelect", event: b }), M.onRectSelectEnded() } q.clearDragging(), delete M._77O } }, redraw: function () { var g = this; g._draw || (g._draw = 1, U(function () { g.mark && g._42(), delete g._draw }, 16)) } }); var wl = Oo.MoveInteractor = function (V) { xd(wl, this, [V]) }; Xp("MoveInteractor", or, {
            handle_mousedown: function (Q) {
                var F = this, x = F.gv; if (Vg(Q) && !x._editing && !x._scrolling && !Pk()) {
                    var B = x.getSelectedDataAt(Q); B ? (F._data = B, x.handleMouseDown && x.handleMouseDown(Q, B), F.startDragging(Q), x.isMovable(B) && (x._moving = 1)) : x._focusData = l
                }
            }, handleWindowMouseUp: function (k) { var w = this, c = w.gv; c.handleMouseUp && c.handleMouseUp(k, w._data), w.clear(k) }, handleWindowMouseMove: function (_) { var R = this, p = R._data, t = R.gv, N = t.getDataModel(), s = N.getHistoryManager(); if ((!t._93O || !t._93O(_, p)) && t._moving) { R._logicalPoint || R.fi({ kind: "prepareMove", event: _ }); var x = R._logicalPoint ? "betweenMove" : "beginMove", U = { kind: x, event: _ }, S = R._logicalPoint = t.lp(_); s && "beginMove" === x && s.beginInteraction(); var j = R._calcShift(x, _), G = j.x, e = j.y, z = R.gv.getMoveMode(_, p); z && ("x" === z ? e = 0 : "y" === z ? G = 0 : "xy" !== z && (G = e = 0)), t.moveSelection(G, e), R._lastLogicalPoint = S, R.autoScroll(_), R.fi(U) } }, _calcShift: function () { var H = this, z = H._logicalPoint, Q = H._lastLogicalPoint, C = z.x - Q.x, k = z.y - Q.y; return { x: C, y: k } }, clear: function (D) { var g = this, N = g.gv, z = N.getDataModel(), n = z.getHistoryManager(); g._lastLogicalPoint && (g._lastLogicalPoint = g._data = N._moving = l, g._logicalPoint && (g.fi({ kind: "endMove", event: D }), N.onMoveEnded(), n && n.endInteraction()), g.clearDragging()) }
        }); var Mq = Oo.ScrollBarInteractor = function (t) { xd(Mq, this, [t]) }; Xp("ScrollBarInteractor", or, { _41o: function () { return this.gv.getViewRect().height < this.gv.getScrollRect().height }, _40o: function () { return this.gv.getViewRect().width < this.gv.getScrollRect().width }, isV: function (R) { var w = this.gv.getViewRect(); return this._41o() && (w.x + w.width - this.gv.lp(R).x) * this.gv.getZoom() < Ac }, isH: function (c) { var v = this.gv.getViewRect(); return this._40o() && (v.y + v.height - this.gv.lp(c).y) * this.gv.getZoom() < Ac }, handle_mousemove: function (d) { this.handle_touchmove(d) }, handle_touchmove: function (x) { if (!Ib && Vg(x)) { var R = this, V = R.isV(x), v = R.isH(x); (V || v) && R.gv.showScrollBar(), R.gv._scrolling = V || v } }, handleWindowMouseUp: function (l) { this.handleWindowTouchEnd(l) }, handleWindowTouchEnd: function (w) { this._state = this._cp = this._tx = this._ty = this.gv._scrolling = l, this.fi({ kind: "endScroll", event: w }) }, handle_mousedown: function (d) { this.handle_touchstart(d) }, handle_touchstart: function (G) { var l = this; if (l.gv.setFocus(G), np(G), l.handle_touchmove(G), !(Ak(G) > 1) && l.gv._scrolling) { l._cp = gi(G), l._tx = l.gv.tx(), l._ty = l.gv.ty(); var j = l.isV(G); l._state = j ? "vScroll" : "hScroll", Af(l, G), l.fi({ kind: "beginScroll", event: G }) } }, handleWindowMouseMove: function (e) { this.handleWindowTouchMove(e) }, handleWindowTouchMove: function (h) { var M = gi(h), b = this.gv.getViewRect(), F = this.gv.getScrollRect(); "vScroll" === this._state ? this.gv.ty(this._ty + (this._cp.y - M.y) * F.height / b.height) : "hScroll" === this._state && this.gv.tx(this._tx + (this._cp.x - M.x) * F.width / b.width), this.fi({ kind: "betweenScroll", event: h }) } }); var ei = Oo.TouchInteractor = function (v, z) { z = z || {}, z.selectable === Z && (z.selectable = !0), z.movable === Z && (z.movable = !0), z.pannable === Z && (z.pannable = !0), z.pinchable === Z && (z.pinchable = !0), z.editable === Z && (z.editable = !0), this.params = z, xd(ei, this, [v]) }; Xp("TouchInteractor", or, { ms_edit: 1, setUp: function () { var X = this; ei.superClass.setUp.call(X), P && X.params.editable && X.gv.setEditInteractor(X) }, tearDown: function () { var m = this; ei.superClass.tearDown.call(m), P && m.params.editable && m.gv.setEditInteractor(l) }, clear: function (r) { var A = this, R = A.gv, K = R.dm().getHistoryManager(); R._moving && (A.fi({ kind: "endMove", event: r }), delete R._moving, R.onMoveEnded(), K && K.endInteraction()), R._panning && (A.fi({ kind: "endPan", event: r }), delete R._panning, R.onPanEnded()), R._pinching && (A.fi({ kind: "endPinch", event: r }), delete R._pinching, R.onPinchEnded()), R._editing && (A._46O(r), A._77I = A._node = A._edge = A._shape = A._rect = A._89I = A._index = R._editing = l), A._moving = A._panning = A._pinching = A._editing = A._57I = A._data = A._beginHistory = l, A.clearDragging() }, handle_touchstart: function (C) { var h = this; if (!h.gv._editing) { np(C), h._57I = l; var Z = h.params, D = h.gv, q = D.sm(), u = D.getDataAt(C), O = Ak(C); if (1 === O) Si(C) ? D.handleDoubleClick(C, u) : (D.handleClick(C, u), u && (D.handleMouseDown && D.handleMouseDown(C, u), h._data = u)), Z.selectable || (u = l), u ? (q.co(u) || q.ss(u), Z.editable && D.isEditable(u) && h._79I(C, u, !0) ? (h._editing = 1, h.startDragging(C)) : Z.movable && D.isMovable(u) && (h._moving = 1, h.startDragging(C))) : (h._57I = gi(C), Z.pannable && D.isPannable() && (h._panning = 1, h.startDragging(C), h._translate = { x: D.tx(), y: D.ty() })); else if (Z.pinchable && 2 === O) { h._pinching = 1, h.startDragging(C); var E = D.getView(), r = D.getZoom(), B = E.getBoundingClientRect(), m = C.touches[0], Q = C.touches[1], A = { x: (m.clientX + Q.clientX) / 2 - B.left, y: (m.clientY + Q.clientY) / 2 - B.top }; A.x -= D.tx(), A.y -= D.ty(), A.x /= r, A.y /= r, h._p = A, h._d = Do(C) } } }, handle_touchend: function ($) { var q = this, j = q.gv, o = q._57I, c = q._data; o && (Bk(o, gi($)) <= 1 && j.sm().cs(), q._57I = l), c && j.handleMouseUp && j.handleMouseUp($, c) }, handleWindowTouchEnd: function (z) { this.clear(z) }, handleWindowTouchMove: function (W) { var r = this, x = r.gv, U = x.dm().getHistoryManager(), z = Ak(W); if (1 === z) { if (r._editing && (U && !r._beginHistory && (r._beginHistory = 1, U.beginInteraction()), x._editing = 1, r._78I(W)), r._moving) U && !r._beginHistory && (r._beginHistory = 1, U.beginInteraction()), r.handleMove(W); else if (r._panning) { var S = gi(W); x.setTranslate(r._translate.x + S.x - r._lastClientPoint.x, r._translate.y + S.y - r._lastClientPoint.y), r.fi({ kind: x._panning ? "betweenPan" : "beginPan", event: W }), x._panning = 1 } } else if (2 === z && r._pinching) { var N = Do(W); x.handlePinch(r._p, N, r._d), r._d = N, r.fi({ kind: x._pinching ? "betweenPinch" : "beginPinch", event: W }), x._pinching = 1 } }, handleMove: function (T) { var K = this, B = K.gv, d = B.lp(T); B._93O && B._93O(T, K._data) || (B.moveSelection(d.x - K._lastLogicalPoint.x, d.y - K._lastLogicalPoint.y), K._lastLogicalPoint = d, K.autoScroll(T), K.fi({ kind: B._moving ? "betweenMove" : "beginMove", event: T }), B._moving = 1) } }); var R = y.ht, zq = R.graph._editor = { Math: {}, Guide: {} }; zq.getStyle = function (c) { var Q, S = zq.StyleMap; return S && (Q = S[c], Q !== Z) ? Q : zq.DefaultStyleMap[c] }, zq.setStyle = function (k, E) { var p = zq.StyleMap; p || (p = zq.StyleMap = {}), p[k] = E }, zq.inEdit = function (r) { return r._inXEdit === !0 }, zq.startEdit = function (J) { J._inXEdit = !0, zq.Inject.doInject(J) }, zq._46O = function (h) { h._inXEdit = !1, zq.Inject.undoInject(h) }, zq.toScreenPosition = function (R, x) { var l = R.tx(), W = R.ty(), q = R._zoom; return new zq.Math.Vector2(x.x * q + l, x.y * q + W) }, zq.checkHit = function (J, k, Y) { return J.distanceTo(k) < Y ? !0 : !1 }, zq.toWorldPosition = function (r, Y) { var B = r.tx(), w = r.ty(), b = r._zoom; return { x: (Y.x - B) / b, y: (Y.y - w) / b } }, zq.log = function () { }; var Tr = zq.Inject = { _modules: [] }; Tr.registAsModule = function (i, w) { var N = {}, l = {}; for (var I in i) { var B = w.prototype[I]; N[I] = B } i.getBackup = function (f) { return N[f] }, i.getBackups = function () { return N }, l.doInject = function () { for (var X in i) "getBackup" !== X && (w.prototype[X] = i[X]) }, l.undoInject = function () { for (var B in i) "getBackup" !== B && (w.prototype[B] = N[B]) }, Tr._modules.push(l) }, Tr.doInject = function (B) { for (var m, $ = Tr._modules, _ = 0, W = $.length; W > _; _++)m = $[_], m.doInject(B) }, Tr.undoInject = function (S) { for (var _, j = Tr._modules, X = 0, L = j.length; L > X; X++)_ = j[X], _.undoInject(S) }; var or = R.graph.EditInteractor = function (z) { var r = this, p = i.createElement("canvas"); p.className = "editCanvas", p.style.position = "absolute", r._styleMap = {}, r._canvas = p, r._context = p.getContext("2d"), or.superClass.constructor.call(r, z), r.setAntialias(!1), r._subModules = [new zq.Anchor(r), new zq.Rect(r), new zq.Curve(r), new zq.MoveHelper(r)], r._gridGuide = new zq.Guide.Grid(r), r._rectGuide = new zq.Guide.Rect(r) }, hf = or; R.Default.def(or, R.graph.Interactor, { ms_edit: 1, ms_fire: 1 }), F.defineProperties(or.prototype, { editDetail: { get: function () { var m = !!this._editDetail; return m }, set: function (Q) { var f = this, W = f._editDetail; W !== Q && (f._editDetail = Q, f.gv._editing = Q, f.fp("editDetail", W, Q), f.fp("pointsEditingMode", W, Q)) } }, gvEditing: { get: function () { return this.gv._editing }, set: function (n) { (!this._editDetail || n) && (this.gv._editing = n, n || (this.editDetail = !1)) } }, editing: { get: function () { return this._editing }, set: function (v) { this._editing = v, this.gvEditing = v } }, pointsEditingMode: { get: function () { return this.editDetail }, set: function (O) { var C = this; C.editDetail !== O && (O ? C._tryEnterEditDetailMode() : C._tryQuitEditDetailMode()) } }, gridEnabled: { get: function () { var l = this._gridEnabled; if (!l) return !1; var Y = this.gv; return Y ? Y._zoom < this.getStyle("gridZoomThreshold") ? !1 : !0 : !0 }, set: function (c) { c !== this._gridEnabled && (this._gridEnabled = c, this._42()) } }, alignmentGuideEnabled: { get: function () { return this._agEnabled }, set: function (C) { C !== this._agEnabled && (this._agEnabled = C, this._42()) } }, gridGuide: { get: function () { return this._gridGuide } }, rectGuide: { get: function () { return this._rectGuide } } }), or.prototype.getSubModule = function (f) { var Q, J, a, w = this._subModules; for (J = 0, a = w.length; a > J; J++)if (Q = w[J], Q.catalog === f) return Q }, or.prototype.invokeSubModule = function (X, A) { var L = this, x = L._subModules; if (x) for (var T, J, $, E = Array.prototype.slice.call(arguments, 2), n = 0, v = x.length; v > n; n++)if (T = x[n], J = T[X], J && ($ = J.apply(T, E), $ != Z && A)) return T }, or.prototype.invokeSubModuleInverse = function (o, I) { var y = this, R = y._subModules; if (R) for (var u, D, L, Q = Array.prototype.slice.call(arguments, 2), K = R.length - 1; K >= 0; K--)if (u = R[K], D = u[o], D && (L = D.apply(u, Q), L != Z && I)) return u }, or.prototype.setUp = function () { zq.log("setUp"); var G = this, O = G.gv, b = O.getView(), y = G._canvas; or.superClass.setUp.call(G), O.setEditInteractor(G), O._79O ? b.insertBefore(y, O._79O) : b.appendChild(y), zq.startEdit(O), G.invokeSubModule("setUp"), O.dm().mm(G._onDataModelChanged, G), O.dm().md(G._onDataPropertyChanged, G) }, or.prototype.tearDown = function () { zq.log("tearDown"); var g = this, e = g.gv, V = e.getView(); or.superClass.tearDown.call(g), e.dm().umm(g._onDataModelChanged), e.dm().umd(g._onDataPropertyChanged), e.setEditInteractor(null), V.removeChild(g._canvas), zq._46O(e), g.invokeSubModule("tearDown") }, or.prototype._onDataModelChanged = function (I) { var E = this; ("clear" === I.kind || "remove" === I.kind && E.editDetail && I.data === E.getSubModule("Curve").target) && (E.editDetail = !1, E._42()) }, or.prototype._onDataPropertyChanged = function (u) { var $ = this; if ($.editDetail) { var z = $.getSubModule("Curve"), C = u.data; C === z.target && (C._writing || z._handleDataChanged()) } }, or.prototype.clear = function () { zq.log("clear") }, or.prototype.redraw = function () { this._42() }, or.prototype._42 = function () { var D = this; D._drawTimer || (D._drawTimer = U(function () { delete D._drawTimer, D.drawImpl() }, 0)) }, or.prototype.drawImpl = function () { var O; for (O in { _42: !0 }) break; return function () { var N = this, s = N._canvas, K = N.gv, L = K.getWidth(), p = K.getHeight(), i = N._context, W = R.Default.getInternal(); (s.width !== L || s.height !== p) && W.setCanvas(s, L, p), i.clearRect(0, 0, s.width, s.height); var B = N._getValidSelection(); i.save(); var x = R.Default.devicePixelRatio; i.scale(x, x), N._gridGuide._42(), N._rectGuide._42(), N.invokeSubModuleInverse(O, !1, i, K, B), i.restore() } }(), or.prototype._getValidSelection = function () { var t = this, j = t.gv, c = j.sm().getSelection(), P = []; return c.each(function (S) { j.isVisible(S) && j.isEditable(S) && P.push(S) }), P }, or.prototype.setAntialias = function (a) { for (var l, g = this._context, f = ["imageSmoothingEnabled", "webkitImageSmoothingEnabled", "mozImageSmoothingEnabled", "oImageSmoothingEnabled", "msImageSmoothingEnabled"], p = 0, o = f.length; o > p && (l = f[p], !g[l]); p++); g[l] = a }, or.prototype.handle_touchmove = function (B) { return this.handle_mousemove(B) }, or.prototype.handle_mousemove = function (t) { if (!R.Default.isDragging()) { var Y = this; (Y.editDetail || !Pk()) && (Y.gvEditing = !1, Y._checkEdit(t) && (Y.gvEditing = !0)) } }, or.prototype.handle_touchstart = function (S) { return this.handle_mousedown(S) }, or.prototype.handle_mousedown = function (o) { np(o); var w = this; if (w.editDetail || !Pk()) { if (Si(o) && !o.clickThrough) { if (w.editDetail) { if (w._tryQuitEditDetailMode(o)) return } else if (w._tryEnterEditDetailMode()) return; if (w.invokeSubModule("handleDoubleClick", !0, o)) return } var C = w._checkEdit(o); if (C) { w._downPosition = w._getLogicalPoint(o); var D = w.gv.dm(), H = D.getHistoryManager(); H && H.beginInteraction(), C.startEdit(w, o), w.editing = !0 } } }, or.prototype._checkEdit = function (W) { var S = this, J = S.gv, g = S._getLogicalPoint(W), H = S.invokeSubModule("check", !0, J, W, g) || null; return S._editMod = H, H }, or.prototype.handleWindowTouchMove = function (H) { return this.handleWindowMouseMove(H) }, or.prototype.handleWindowMouseMove = function (I) { var A = this, m = A._downPosition; if (m) { var $ = A._getLogicalPoint(I); if ($.distanceTo(m) < A.getStyle("moveSensitivity")) return; delete A._downPosition } var r = A._editMod; r && r.handleEdit(A.gv, I) }, or.prototype._getLogicalPoint = function (s) { var N = this, m = R.Default.getLogicalPoint(s, N._canvas); return new zq.Math.Vector2(m) }, or.prototype.handleWindowTouchEnd = function (D) { return this.handleWindowMouseUp(D) }, or.prototype.handleWindowMouseUp = function () { var g; for (g in { _46O: !0 }) break; return function () { var H = this; H.editing = !1, H.setCursor("default"), H.invokeSubModule(g, !1), H._42(); var m = H.gv.dm(), d = m.getHistoryManager(); d && d.endInteraction() } }(), or.prototype.handle_mousewheel = function (z) { var H = this; np(z), H.invokeSubModule("preHandleScroll", !0) || H.gv.handleScroll(z, z.wheelDelta) }, or.prototype.handleDelete = function () { var J = this; return J.editDetail ? (J.invokeSubModule("handleDelete", !0), J._42(), void 0) : (J.gv.removeSelection(), void 0) }, or.prototype.handle_keydown = function (p) { var W = this; if ((p.metaKey || p.ctrlKey) && W._42(), Pk(p) && !W.editing) return W.gvEditing = !1, W.setCursor("default"), W._42(), void 0; var D = Zr(p); return W.editDetail ? ((D || ai(p)) && (W.editDetail = !1, W._42()), W.invokeSubModule("handle_keydown", !0, p), void 0) : (D && W._tryEnterEditDetailMode(), void 0) }, or.prototype.handle_keyup = function (q) { this.invokeSubModule("handle_keyup", !0, q) }, or.prototype._tryEnterEditDetailMode = function () { var o = this; return !o.editDetail && o.invokeSubModule("canEnterEditDetailMode", !0) && 1 === o._getValidSelection().length ? (o.editDetail = !0, o._42(), !0) : void 0 }, or.prototype._tryQuitEditDetailMode = function (J) { var $ = this; if ($.editDetail) { var x = $.gv, W = $.getSubModule("Curve").target; return J && x.getDataAt(J) === W ? void 0 : ($.editDetail = !1, $._42(), !0) } }, or.prototype.setStyle = function (U, p, T) { var R = this; T ? zq.setStyle(U, p) : R._styleMap[U] = p, R._42() }, or.prototype.getStyle = function (W) { var f = this, j = f._styleMap[W]; return j !== Z ? j : zq.getStyle(W) }; var gm = zq.Group = function (_) { var L = this; L._entities = _, L._64O = 0, L._position = { x: 0, y: 0 }, L._scale = { x: 1, y: 1 }, L._anchor = { x: .5, y: .5 }, L._anchor2 = { x: .5, y: .5 } }; gm.prototype = {}, gm.prototype.constructor = gm; var Ll = null; gm.findOrCreateGroup = function (y) { if (Ll && Ll.checkIsMe(y)) return Ll; var i = new zq.Group(y); return i.getKeyOb() ? (Ll = i, i) : void 0 }, gm.prototype.checkIsMe = function (m) { var G = this._entities; if (G.length !== m.length) return !1; var C, f = {}, D = m.length; for (C = 0; D > C; C++)f[m[C]._id] = !0; for (C = 0; D > C; C++)if (!f[G[C]._id]) return !1; return !0 }, gm.prototype.getRotation = function () { return this._64O }, gm.prototype.getPosition = function () { return this._position }, gm.prototype.getAnchor = function () { return this._anchor }, gm.prototype.getWidth = function () { return this._width }, gm.prototype.getScale = function () { return this._scale }, gm.prototype.getSize = function () { return { width: this._width, height: this._height } }, gm.prototype.getHeight = function () { return this._height }, gm.prototype.getKeyOb = function () { for (var i = this._entities, r = i.length - 1; r >= 0; r--) { var b = i[r]; if (this.isNode(b)) return b } }, gm.prototype.getAnchor2 = function () { var r = this, m = r.rotateCenter; if (m) return m; var v = r.getKeyOb(); if (!v) return r._anchor; var $ = r._anchor2, W = v.getMatrix(); return W.tf({ x: v.getWidth() * ($.x - v.getAnchor().x), y: v.getHeight() * ($.y - v.getAnchor().y) }) }, gm.prototype.setAnchor2 = function (H, V) { var B = this, z = B.getKeyOb(); if (z) { var K, r = z.getMatrix(); K = "number" == typeof H ? { x: H, y: V } : H; var G = r.tfi(K); B._anchor2 = { x: z.getAnchor().x + G.x / z.getWidth(), y: z.getAnchor().y + G.y / z.getHeight() } } }, gm.prototype.setRotation = function () { }, gm.prototype.beginRotate = function (b) { this.rotateCenter = b.pos, this.rotateMode = b.groupRotateMode }, gm.prototype.endRotate = function () { delete this.rotateCenter, delete this.rotateMode }, gm.prototype.addRotation = function (B, b) { return "batch" === b ? this._addRotationInBatchMode(B) : "block" === b ? this._addRotationInBlockMode(B) : void 0 }, gm.prototype._addRotationInBlockMode = function (A) { var W = this, t = W.rotateCenter || W.getPosition(); W._entities.forEach(function (l) { if (W.isNode(l)) { var O = l.getMatrix(); O.translate(-t.x, -t.y), O.rotate(A), O.translate(t.x, t.y); var B = Math.sign(l.getScale().x); l.setRotation(I(O.b * B, O.a * B)), l.setPosition(O.tx, O.ty) } }) }, gm.prototype._addRotationInBatchMode = function (W) { var Q = this, O = Q._anchor2; Q._entities.forEach(function (x) { if (Q.isNode(x)) { var i = x.getAnchor(), v = x.getMatrix(), B = v.tf({ x: x.getWidth() * (O.x - i.x), y: x.getHeight() * (O.y - i.y) }), H = new zq.Math.Matrix2; H.set(v.a, v.b, v.c, v.d, v.tx, v.ty), H.translate(-B.x, -B.y), H.rotate(W), H.translate(B.x, B.y); var C = Math.sign(x.getScale().x); x.setRotation(I(H.b * C, H.a * C)), x.setPosition(H.tx, H.ty) } }) }, gm.prototype.setPosition = function (O) { var D, k, P, c, C = this, f = C._position, N = O.x - f.x, a = O.y - f.y, t = C._entities; for (k = 0, P = t.length; P > k; k++)D = t[k], $j(D) && (c = D.getPosition(), D.setPosition(c.x + N, c.y + a)); C._position = O }, gm.prototype.setScale = function (D, x) { var z = this, S = D / z._scale.x, A = x / z._scale.y; z._adjustChildScaleOrSize(S, A, "size"), z._scale = { x: D, y: x } }, gm.prototype.getRect = function () { var R = this, Q = R._position, i = R._width, D = R._height; return { x: Q.x - i / 2, y: Q.y - D / 2, width: i, height: D } }, gm.prototype.setSize = function (m, T) { var F = this, m = Math.max(1, m), T = Math.max(1, T), c = m / F._width, f = T / F._height; F._adjustChildScaleOrSize(c, f, "size"), F._width = m, F._height = T }, gm.prototype._adjustChildScaleOrSize = function ($, e, x) { var S, _, i, m, T, a, J, O, A, Q, u, N, X, H, M = this, F = M._position, l = M._entities, z = new zq.Math.Matrix2; for (_ = 0, i = l.length; i > _; _++)if (S = l[_], M.isNode(S)) { if (m = S.getPosition(), T = S.getRotation(), a = S.getWidth(), J = S.getHeight(), O = S.getScale(), u = O.x * a, N = O.y * J, z.identity().scale(u, N).rotate(T).translate(m.x, m.y).translate(-F.x, -F.y).rotate(-M._64O), T = I(z.b * Math.sign(u), z.a * Math.sign(u)), z.scale($, e), A = Math.cos(T), Q = Math.sin(T), Math.abs(A) < .001 ? (X = z.b / Q, H = -z.c / Q) : (X = z.a / A, H = z.d / A), "scale" === x) S.setScale(X / a, H / J); else if ("size" === x) { var E = X / O.x, p = H / O.y; S.setScale(bl(X) * Math.abs(O.x), bl(H) * Math.abs(O.y)), S.setSize(Math.max(.1, Math.abs(E)), Math.max(.1, Math.abs(p))) } z.rotate(M._64O).translate(F.x, F.y), S.setPosition(z.tx, z.ty) } }, gm.prototype.getMatrix = function () { var G = this, I = G._position, e = R.Default.getInternal(), y = G._scale; return new e.Mat(G._64O, I.x, I.y, y.x, y.y) }, gm.prototype.getCorners = function () { var v = this, n = v._width, J = v._height, Z = v._anchor, h = -n * Z.x, B = -J * Z.y, N = v.getMatrix(); return [N.tf(h, B), N.tf(h, B + J), N.tf(h + n, B + J), N.tf(h + n, B)] }, gm.prototype.calcInfo = function () { var O, G, m, A, z, b, N = this, K = [], B = N._entities, l = N._64O; for (A = 0, z = B.length; z > A; A++)b = B[A], N.isNode(b) && b.getCorners && K.push.apply(K, b.getCorners()); if (K.length) { var s = Math.cos(-l), P = Math.sin(-l), F = 1 / 0, S = -1 / 0, o = 1 / 0, p = -1 / 0; for (A = 0, z = K.length; z > A; A++)m = K[A], O = m.x, G = m.y, m.x = s * O - P * G, m.y = P * O + s * G, F = Math.min(F, m.x), S = Math.max(S, m.x), o = Math.min(o, m.y), p = Math.max(p, m.y); N._width = (S - F) / N._scale.x, N._height = (p - o) / N._scale.y, s = Math.cos(l), P = Math.sin(l); var H = N._anchor; O = F + (S - F) * H.x, G = o + (p - o) * H.y, N._position = { x: s * O - P * G, y: P * O + s * G } } }, gm.prototype.isNode = function (h) { return $j(h) ? Fb(h) ? !1 : !0 : !1 }, gm.prototype._42 = function (e, L, t) { var v, K, s, r, f, u, C, Z, B = this, I = B._entities, o = B.rotateMode; for ("batch" === o && (Z = B.getKeyOb()), v = 0, K = I.length; K > v; v++)s = I[v], B.isNode(s) && (u = s.getRect(), r = zq.toScreenPosition(t, { x: u.x, y: u.y }), f = zq.toScreenPosition(t, { x: u.x + u.width, y: u.y + u.height }), C = { min: r, max: f }, s === Z && (C.isKeyOb = !0), zq.Icons.DrawIcon(e, L, zq.Icons.GroupSubEntityRect, C)) }; var ie = zq.Guide.Grid = function (F) { var y = this; y._interactor = F, y._alignmentGuideId = 0, y._xAlignmentGuide = [], y._yAlignmentGuide = [] }; ie.prototype = {}, ie.prototype.constructor = ie, F.defineProperties(ie.prototype, { gridBlockSize: { get: function () { var y = this; return y._gridBlockSize || y._interactor.getStyle("gridBlockSize") }, set: function (F) { this._gridBlockSize = F, this._interactor._42() } }, gridThickLinesEvery: { get: function () { var B = this; return B._gridThickLinesEvery || B._interactor.getStyle("gridThickLinesEvery") }, set: function (K) { this._gridThickLinesEvery = K, this._interactor._42() } }, gridEnabled: { get: function () { var z = this, r = z._interactor; return r.gridEnabled && z.isValidGrid() } } }), ie.prototype._42 = function () { var G = this, i = G._interactor; G.gridEnabled && G.drawGrid(), i.alignmentGuideEnabled && G.drawAlignmentGuide() }, ie.prototype.makeMatrix = function () { var h = this, J = h._interactor.getStyle("gridAngle"), M = h._interactor.getStyle("gridRotation"), z = new zq.Math.Matrix2, n = Math.sin(J), k = Math.cos(J); return z.set(1, 0, k, n, 0, 0), z.rotate(M), z }, ie.prototype.isValidGrid = function () { var G = this, F = Math.PI, I = G._interactor.getStyle("gridAngle"), k = Math.abs(180 * (I % F / F)), J = 1 - 1e-8; return J > k || k > 180 - J ? !1 : !0 }, ie.prototype.drawAlignmentGuide = function () { var A = this, N = A._interactor, E = N.gv, f = N._canvas, H = N._context, q = f.width, p = f.height, I = E.tx(), V = E.ty(), i = E._zoom; H.beginPath(), H.strokeStyle = N.getStyle("gridAlignmentGuideColor"), H.lineWidth = 1, A._xAlignmentGuide.forEach(function (U) { var M = U.p * i + I; H.moveTo(M, 0), H.lineTo(M, p) }), A._yAlignmentGuide.forEach(function (F) { var n = F.p * i + V; H.moveTo(0, n), H.lineTo(q, n) }), H.stroke() }, ie.prototype.drawGrid = function () { function T(k, p, w, v) { var n = zq.toScreenPosition(m, W.apply({ x: k, y: p })), f = zq.toScreenPosition(m, W.apply({ x: w, y: v })); N.moveTo(n.x, n.y), N.lineTo(f.x, f.y) } var s = this, Z = s._interactor, $ = s.gridBlockSize, H = s.gridThickLinesEvery, i = Z.getStyle("gridThickColor"), w = Z.getStyle("gridLightColor"), m = Z.gv, q = Z._canvas, N = Z._context, x = q.width, I = q.height, W = s.makeMatrix(), C = W.applyInverse(zq.toWorldPosition(m, { x: 0, y: 0 })), p = W.applyInverse(zq.toWorldPosition(m, { x: x, y: 0 })), c = W.applyInverse(zq.toWorldPosition(m, { x: 0, y: I })), n = W.applyInverse(zq.toWorldPosition(m, { x: x, y: I })), o = Math.min(C.x, p.x, c.x, n.x), d = Math.max(C.x, p.x, c.x, n.x), f = Math.min(C.y, p.y, c.y, n.y), j = Math.max(C.y, p.y, c.y, n.y); x = d - o, I = j - f; var F = Math.ceil(o / $), k = Math.floor(d / $), X = Math.ceil(f / $), h = Math.floor(j / $); m.tx(), m.ty(), m._zoom; var L, l, R; for (N.save(), N.lineWidth = 1, N.beginPath(), N.strokeStyle = i, R = Math.ceil(F / H) * H; k >= R; R += H)L = R * $, T(L, f, L, j); for (R = Math.ceil(X / H) * H; h >= R; R += H)l = R * $, T(o, l, d, l); for (N.stroke(), N.beginPath(), N.strokeStyle = w, R = F; k >= R; R++)0 !== R % H && (L = R * $, T(L, f, L, j)); for (R = X; h >= R; R++)0 !== R % H && (l = R * $, T(o, l, d, l)); N.stroke(), N.restore() }, ie.prototype.getAlignmentGuides = function () { var m = this; return { x: m._xAlignmentGuide, y: m._yAlignmentGuide } }, ie.prototype.addAlignmentGuide = function (Y, r, R) { var w = this, X = "x" === Y ? w._xAlignmentGuide : w._yAlignmentGuide, R = R ? R : ++w._alignmentGuideId, c = { p: r, id: R }; if (X.length) { var H = w._findClosestAlignmentGuide(c.p, X); H.dis < 0 ? X.splice(H.index + 1, 0, c) : X.splice(H.index, 0, c) } else X.push(c); return w._interactor._42(), R }, ie.prototype.findClosest = function (z, o, n) { var $ = this, D = $._interactor, k = D.gv; n && (z = zq.toWorldPosition(k, z)); var e, s, b, P = 1 / 0, Q = 1 / 0, W = z.x, y = z.y; if ($.gridEnabled) { var m = $.gridBlockSize, R = $.makeMatrix(), l = R.applyInverse(z); l = R.apply({ x: Math.round(l.x / m) * m, y: Math.round(l.y / m) * m }), P = l.x - W, Q = l.y - y, b = !0 } if (D.alignmentGuideEnabled && (e = $._findClosestAlignmentGuide(W, $._xAlignmentGuide).dis, s = $._findClosestAlignmentGuide(y, $._yAlignmentGuide).dis, Math.abs(e) < Math.abs(P) && (P = e, b = !0), Math.abs(s) < Math.abs(Q) && (Q = s, b = !0)), b) { b = !1; var X = k._zoom, r = D.getStyle("smartGuideSensitivity") / X, B = {}; if (Math.abs(P) < r && "y" !== o && (B.x = n ? P * X : P, b = !0), Math.abs(Q) < r && "x" !== o && (B.y = n ? Q * X : Q, b = !0), b) return B } }, ie.prototype._findClosestAlignmentGuide = function (r, m) { if (!m.length) return { dis: 1 / 0 }; for (var d, w = 0, n = m.length - 1; n - w > 1;)d = Math.floor((w + n) / 2), m[d].p < r ? w = d : n = d; var a = m[w].p - r, h = m[n].p - r; return Math.abs(a) <= Math.abs(h) ? { line: m[w], dis: a, index: w } : { line: m[n], dis: h, index: n } }, ie.prototype.removeAllAlignmentGuide = function (N) { var k = this; "y" !== N && (k._xAlignmentGuide = []), "x" !== N && (k._yAlignmentGuide = []), k._interactor._42() }, ie.prototype.removeAlignmentGuide = function (S) { var i, c, f, D = this, e = D._xAlignmentGuide; for (k = 0; 2 > k; k++)for (e = 0 === k ? D._xAlignmentGuide : D._yAlignmentGuide, i = 0, c = e.length; c > i; i++)if (f = e[i], f.id === S) return e.splice(i, 1), D._interactor._42(), { axis: 0 === k ? "x" : "y", position: f.p }; return !1 }, ie.prototype.adjustAlignmentGuide = function (T, a) { var G = this, z = G.removeAlignmentGuide(T); return z ? (G.addAlignmentGuide(z.axis, a, T), !0) : !1 }; var wi = zq.Guide.Rect = function (s) { var r = this; r._interactor = s }; wi.prototype = {}, wi.prototype.constructor = wi, wi.prototype.gatherRects = function () { var i, F, N, q, E = this, B = E._interactor.gv, r = [], L = [], d = { x: r, y: L }, s = {}, S = B.getDataModel(), b = S.a("width"), h = S.a("height"); b && h && (i = 0, F = 0, N = b, q = h, r.push({ node: S, type: 0, p: i }, { node: S, type: 1, p: i + N / 2 }, { node: S, type: 2, p: i + N }), L.push({ node: S, type: 0, p: F }, { node: S, type: 1, p: F + q / 2 }, { node: S, type: 2, p: F + q }), s[S._id || 0] = { x: i, y: F, width: N, height: q }), S.each(function (H) { if ($j(H) && !B.isSelected(H) && B.isVisible(H)) { var v = !1; if (B.sm().getSelection().each(function (D) { v || (H.isHostOn(D) ? v = !0 : H.isDescendantOf(D) && (v = !0)) }), !v) { var t = H.getRect(); i = t.x, F = t.y, N = t.width, q = t.height, r.push({ node: H, type: 0, p: i }, { node: H, type: 1, p: i + N / 2 }, { node: H, type: 2, p: i + N }), L.push({ node: H, type: 0, p: F }, { node: H, type: 1, p: F + q / 2 }, { node: H, type: 2, p: F + q }), s[H._id] = t } } }), r.sort(function (Q, d) { return Q.p - d.p }), L.sort(function (A, W) { return A.p - W.p }), E._grid = d, E._87I = s }, wi.prototype.gatherLines = function (M, x, e) { var p, d, E, Z, J, S, l, $, C, H, _, V, Y = this, A = [Y.findClosest({ x: M.x, y: M.y }, x), Y.findClosest({ x: M.x + M.w / 2, y: M.y + M.h / 2 }, x), Y.findClosest({ x: M.x + M.w, y: M.y + M.h }, x)], N = {}, Q = Y._87I; e = e || 255; var b, i; for (Y._guideLine = [], p = 0; 2 > p; p++)for (N = {}, 0 === p ? (Z = "y", $ = M.x, C = $ + M.w) : (Z = "x", $ = M.y, C = $ + M.h), d = 0; 3 > d; d++)J = A[d], J && isFinite(J[Z]) && (b = 1 << 3 * p + d, e & b && (S = J[Z + "Line"], l = S.node, i = l._id || 0, N[i] || (N[i] = !0, V = Q[i], "y" === Z ? (H = V.x, _ = V.x + V.width) : (H = V.y, _ = V.y + V.height), E = S.p, Y._guideLine.push({ type: Z, a: $, b: C, c: H, d: _, p: E })))) }, wi.prototype._binarySearchClosest = function (L, U) { if (!U.length) return { dis: 1 / 0 }; for (var I, G = 0, m = U.length - 1; m - G > 1;)I = Math.floor((G + m) / 2), U[I].p < L ? G = I : m = I; var H = U[G].p - L, g = U[m].p - L; return Math.abs(H) <= Math.abs(g) ? { line: U[G], dis: H } : { line: U[m], dis: g } }, wi.prototype.findClosest = function (F, h, w) { var P = this, O = P._interactor, H = O.gv, Q = P._grid; w && (F = zq.toWorldPosition(H, F)); var A, C = P._binarySearchClosest(F.x, Q.x), I = P._binarySearchClosest(F.y, Q.y), m = C.dis, q = I.dis, x = H._zoom, s = O.getStyle("smartGuideSensitivity") / x, K = {}; return Math.abs(m) < s && "y" !== h && (K.x = w ? m * x : m, K.xLine = C.line, A = !0), Math.abs(q) < s && "x" !== h && (K.y = w ? q * x : q, K.yLine = I.line, A = !0), A ? K : void 0 }, wi.prototype._42 = function () { var M = this, B = M._guideLine; if (B && !R.Default.isCtrlDown()) { var I, $, N, a, Q, w, D, s, C, L, z, A, l, T, o, e, j, c = M._interactor, H = c.gv, P = c._context, Y = H.tx(), V = H.ty(), t = H._zoom, v = c.getStyle("guideLineTextSpacing"); for (I = 0, $ = B.length; $ > I; I++)N = B[I], s = N.type, C = N.p, L = N.a, z = N.b, A = N.c, l = N.d, T = Math.min(L, A), o = Math.max(z, l), "x" === s ? (a = C * t + Y, Q = T * t + V, w = a, D = o * t + V) : (a = T * t + Y, Q = C * t + V, w = o * t + Y, D = Q), zq.Icons.DrawIcon(c, P, zq.Icons.MoveLineGuide, [a, Q, w, D]), l >= L && z >= A || (T = L > l ? l : z, o = L > l ? L : A, j = o - T, "x" === s ? (N.center2center || (a -= v, w = a), Q = T * t + V, D = o * t + V, e = zq.Icons.MoveLineGuideDistanceV) : "y" === s && (N.center2center || (Q -= v, D = Q), a = T * t + Y, w = o * t + Y, e = zq.Icons.MoveLineGuideDistanceH), zq.Icons.DrawIcon(c, P, e, { x0: a, y0: Q, x1: w, y1: D, dis: j })) } }, wi.prototype.clear = function () { this._guideLine = null }, zq.DefaultStyleMap = { pointSize: [24, 9], checkSize: 7, rotateCheckSize: 10, moveSensitivity: 10, rotateRound: Math.PI / 2, rotateSensitivity: Math.PI / 60, shiftRotateRound: Math.PI / 12, shiftLineRotateRound: Math.PI / 4, anchorMovable: !0, anchorVisible: !0, anchorHideThreshold: 25, anchorOutsideVisibleThreshold: .25, anchorRound: .25, anchorSensitivity: .02, smartGuideSensitivity: 8, curveIntersectSize: 5, curvePointIntersectSize: 8, edgeHostDetectPerFrame: !0, guideLineTextSpacing: 32, gridBlockSize: 40, gridThickLinesEvery: 10, gridThickColor: "#5d5d5d", gridLightColor: "#d0d0d0", gridZoomThreshold: .25, gridAlignmentGuideColor: "#ff0000", gridAngle: Math.PI / 2, gridRotation: 0, groupRotateModeDefault: "block", groupRotateModeKey: ["ctrlKey", "metaKey"], tipTextColor: "#ffffff", tipBackground: "#333333", curveHighlightColor: "#30599e", rectPointBackground: "white", rectPointBorderColor: "#666666", rectPointShadowColor: "rgba(0,0,0,0.35)", shapeCtrlPointBackground: "white", shapeCtrlPointBorderColor: "#707070", shapeHighlighPointBackground: "#30599e" }; var Np = zq.Icons = {}, Uh = 1e4, gl = null, bn = 8; R.Default.setImage("Icons.RectPoint", { width: bn, height: bn, comps: [{ type: "shape", points: [0, 0, 0, bn, bn, bn, bn, 0], segments: [1, 2, 2, 2, 5], shadow: !0, borderWidth: 1, shadowColor: { func: function () { return gl.getStyle("rectPointShadowColor") } }, background: { func: function () { return gl.getStyle("rectPointBackground") } }, borderColor: { func: function () { return gl.getStyle("rectPointBorderColor") } } }] }); var Ti = "#e000e0"; Np.GroupSubEntityRect = { comps: [{ type: "shape", points: { func: function () { var e = Np.GroupSubEntityRect.data; if (!e) return []; var Z = e.min, G = e.max; return [Z.x, Z.y, Z.x, G.y, G.x, G.y, G.x, Z.y] } }, segments: [1, 2, 2, 2, 5], background: null, borderWidth: 1, borderColor: { func: function () { return Np.GroupSubEntityRect.data.isKeyOb ? Ti : "#666666" } } }] }, Np.Line = { comps: [{ type: "image", name: "Icons.RectPoint", rect: { func: function () { return [[Np.Line.data.P1.x, Np.Line.data.P1.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", rect: { func: function () { return [[Np.Line.data.P2.x, Np.Line.data.P2.y], bn, bn] } } }] }, Np.EdgeHostGuide = { comps: [{ type: "shape", points: { func: function () { return Np.EdgeHostGuide.data } }, segments: [1, 2, 2, 2, 5], background: null, borderWidth: 2, borderColor: "red" }] }, Np.Rect = { comps: [{ type: "shape", points: { func: function () { var z = Np.Rect.data; if (!z) return []; var P = z.LT, G = z.LB, F = z.RB, X = z.RT; return [P.x, P.y, G.x, G.y, F.x, F.y, X.x, X.y] } }, segments: [1, 2, 2, 2, 5], background: null, borderWidth: 1, borderColor: "#666666" }, { type: "image", name: "Icons.RectPoint", rotation: { func: function () { return Np.Rect.data.rotation } }, rect: { func: function () { return [[Np.Rect.data.LT.x, Np.Rect.data.LT.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", rotation: { func: function () { return Np.Rect.data.rotation } }, rect: { func: function () { return [[Np.Rect.data.LB.x, Np.Rect.data.LB.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", rotation: { func: function () { return Np.Rect.data.rotation } }, rect: { func: function () { return [[Np.Rect.data.RB.x, Np.Rect.data.RB.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", rotation: { func: function () { return Np.Rect.data.rotation } }, rect: { func: function () { return [[Np.Rect.data.RT.x, Np.Rect.data.RT.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", scaleX: .9, scaleY: .9, rotation: { func: function () { return Np.Rect.data.rotation } }, visible: { func: function () { return Np.Rect.data.L ? !0 : !1 } }, rect: { func: function () { return [[Np.Rect.data.L.x, Np.Rect.data.L.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", scaleX: .9, scaleY: .9, rotation: { func: function () { return Np.Rect.data.rotation } }, visible: { func: function () { return Np.Rect.data.R ? !0 : !1 } }, rect: { func: function () { return [[Np.Rect.data.R.x, Np.Rect.data.R.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", scaleX: .9, scaleY: .9, rotation: { func: function () { return Np.Rect.data.rotation } }, visible: { func: function () { return Np.Rect.data.T ? !0 : !1 } }, rect: { func: function () { return [[Np.Rect.data.T.x, Np.Rect.data.T.y], bn, bn] } } }, { type: "image", name: "Icons.RectPoint", scaleX: .9, scaleY: .9, rotation: { func: function () { return Np.Rect.data.rotation } }, visible: { func: function () { return Np.Rect.data.B ? !0 : !1 } }, rect: { func: function () { return [[Np.Rect.data.B.x, Np.Rect.data.B.y], bn, bn] } } }] }; var Fq = 18; R.Default.setImage("Icons.Anchor", { width: Fq, height: Fq, comps: [{ type: "arc", rect: [4, 4, Fq - 8, Fq - 8], arcFrom: 0, arcClose: !1, background: "#ffffff", borderWidth: 0, borderColor: "#000000" }, { type: "shape", points: [2, Fq / 2, Fq - 2, Fq / 2, Fq / 2, 2, Fq / 2, Fq - 2], segments: [1, 2, 1, 2], background: null, borderWidth: 1, borderColor: "#111111" }, { type: "arc", rect: [5.5, 5.5, Fq - 11, Fq - 11], arcFrom: 0, arcClose: !1, background: null, borderWidth: 1, borderColor: "#111111" }] }), Np.Anchor = { comps: [{ type: "image", name: "Icons.Anchor", rect: { func: function () { return [[Np.Anchor.data.POS.x, Np.Anchor.data.POS.y], Fq, Fq] } } }] }, Np.TipShiftX = 12, Np.TipShiftY = 12; var Hj = [8, 28]; Np.TipHelper = { comps: [{ type: "roundRect", rect: { func: function () { return [Np.TipHelper.data.helperPos.x, Np.TipHelper.data.helperPos.y, Hj[0] * Np.TipHelper.data.size, Hj[1]] } }, background: { func: function () { return gl.getStyle("tipBackground") } }, opacity: .6 }, { type: "text", text: { func: function () { return Np.TipHelper.data.text } }, rect: { func: function () { return [Np.TipHelper.data.helperPos.x, Np.TipHelper.data.helperPos.y, Hj[0] * Np.TipHelper.data.size, Hj[1]] } }, color: { func: function () { return gl.getStyle("tipTextColor") } }, font: "bold 12px Arial", align: "center" }] }; var ye = 7; Np.ShapePoint = { comps: [{ type: "circle", rect: { func: function () { var Q = Np.ShapePoint.data; return [Q, ye, ye] } }, background: "#ffffff", borderWidth: 1, borderColor: "#333333" }] }, Np.ShapeBgCurve = { comps: [{ type: "shape", points: { func: function () { return Np.ShapeBgCurve.data.P } }, segments: { func: function () { return Np.ShapeBgCurve.data.S } }, background: null, borderWidth: 1, borderColor: "#333333" }] };
        var Ig = 8; Np.ShapeHighlighPoint = { comps: [{ type: "circle", rect: { func: function () { var X = Np.ShapeHighlighPoint.data; return [[X.x, X.y], Ig, Ig] } }, background: { func: function () { return gl.getStyle("shapeHighlighPointBackground") } }, borderWidth: 0 }] }; var yi = 10; Np.ShapeHighlighRealPoint = { comps: [{ type: "circle", rect: { func: function () { var Z = Np.ShapeHighlighRealPoint.data; return [[Z.x, Z.y], yi, yi] } }, background: "#ffffff", borderWidth: 2, borderColor: "#333333" }] }; var Dl = 8; Np.ShapeHighlighCtrlPoint = { comps: [{ type: "shape", points: { func: function () { var x = Np.ShapeHighlighCtrlPoint.data, _ = x.x, Z = x.y, t = Dl / 2; return [_ - t, Z - t, _ - t, Z + t, _ + t, Z + t, _ + t, Z - t] } }, segments: [1, 2, 2, 2, 5], borderWidth: 2, background: { func: function () { return gl.getStyle("shapeCtrlPointBackground") } }, borderColor: { func: function () { return gl.getStyle("shapeCtrlPointBorderColor") } } }] }; var kq = 3; Np.ShapeHighlightCurve = { comps: [{ type: "shape", points: { func: function () { return Np.ShapeHighlightCurve.data } }, segments: [1, 4], background: null, borderWidth: kq, borderColor: { func: function () { return gl.getStyle("curveHighlightColor") } } }] }, Np.ShapeGuideLine = { comps: [{ type: "shape", points: { func: function () { return Np.ShapeGuideLine.data } }, background: null, borderWidth: 1, borderColor: "red" }] }, Np.MoveLineGuide = { comps: [{ type: "shape", points: { func: function () { return Np.MoveLineGuide.data } }, background: null, borderWidth: 1, borderColor: "red" }] }; var gr = 5; Np.MoveLineGuideDistanceH = { comps: [{ type: "shape", points: { func: function () { var H = Np.MoveLineGuideDistanceH.data, z = H.x0, G = H.y0, W = H.x1, C = H.y1; return [z, G, W, C, z, G - gr, z, G + gr, W, C - gr, W, C + gr] } }, segments: [1, 2, 1, 2, 1, 2], background: null, borderWidth: 1, borderColor: "red" }, { type: "text", text: { func: function () { return Math.round(Np.MoveLineGuideDistanceH.data.dis) } }, rect: { func: function () { var f = Np.MoveLineGuideDistanceH.data; return [[(f.x0 + f.x1) / 2, f.y0 - 10], 20, 20] } }, color: "red", font: "12px Arial", align: "center" }] }, Np.MoveLineGuideDistanceV = { comps: [{ type: "shape", points: { func: function () { var o = Np.MoveLineGuideDistanceV.data, U = o.x0, P = o.y0, $ = o.x1, J = o.y1; return [U, P, $, J, U - gr, P, U + gr, P, $ - gr, J, $ + gr, J] } }, segments: [1, 2, 1, 2, 1, 2], background: null, borderWidth: 1, borderColor: "red" }, { type: "text", text: { func: function () { return Math.round(Np.MoveLineGuideDistanceV.data.dis) } }, rect: { func: function () { var q = Np.MoveLineGuideDistanceV.data; return [[q.x0 - 10, (q.y0 + q.y1) / 2], 20, 20] } }, color: "red", font: "12px Arial", align: "center" }] }; var Un = 6; Np.ShapeActivingCtrl = { comps: [{ type: "shape", visible: { func: function () { return Np.ShapeActivingCtrl.data.c1 ? !0 : !1 } }, points: { func: function () { var D = Np.ShapeActivingCtrl.data; return [D.point.x, D.point.y, D.c1.x, D.c1.y] } }, segments: [1, 2], background: null, borderWidth: 1, borderColor: "#707070" }, { type: "shape", visible: { func: function () { return Np.ShapeActivingCtrl.data.c2 ? !0 : !1 } }, points: { func: function () { var r = Np.ShapeActivingCtrl.data; return [r.point.x, r.point.y, r.c2.x, r.c2.y] } }, segments: [1, 2], background: null, borderWidth: 1, borderColor: "#707070" }, { type: "shape", visible: { func: function () { return Np.ShapeActivingCtrl.data.c1 ? !0 : !1 } }, points: { func: function () { var H = Np.ShapeActivingCtrl.data.c1, Y = H.x, C = H.y, u = Un / 2; return [Y - u, C - u, Y - u, C + u, Y + u, C + u, Y + u, C - u] } }, segments: [1, 2, 2, 2, 5], borderWidth: 2, background: { func: function () { return gl.getStyle("shapeCtrlPointBackground") } }, borderColor: { func: function () { return gl.getStyle("shapeCtrlPointBorderColor") } } }, { type: "shape", visible: { func: function () { return Np.ShapeActivingCtrl.data.c2 ? !0 : !1 } }, points: { func: function () { var P = Np.ShapeActivingCtrl.data.c2, S = P.x, A = P.y, X = Un / 2; return [S - X, A - X, S - X, A + X, S + X, A + X, S + X, A - X] } }, segments: [1, 2, 2, 2, 5], borderWidth: 2, background: { func: function () { return gl.getStyle("shapeCtrlPointBackground") } }, borderColor: { func: function () { return gl.getStyle("shapeCtrlPointBorderColor") } } }] }, zq.Icons.DrawIcon = function (b, e, n, Z) { n.width = n.height = Uh, n.data = Z, gl = b, R.Default.drawImage(e, n, 0, 0, Uh, Uh) }, zq.Icons.MapPoints = function (q, K) { for (var O = 0, Y = q.length; Y > O; O++)q[O] /= K }, zq.roundTo = function (s, y, W) { var J = Math.abs(s % y); return W > J || W > y - J ? y * Math.round(s / y) : s }, zq.toFixed = function (b) { return Math.round(100 * b) / 100 }, zq.getDataMatrix = function (Q) { if (Q instanceof R.Shape) { var b = new zq.Math.Matrix2, k = Q.getPosition(); return b.translate(-k.x, -k.y).scale(Q.getScale().x, Q.getScale().y).rotate(Q.getRotation()).translate(k.x, k.y), b } return Q.getMatrix ? Q.getMatrix() : new zq.Math.Matrix2 }, Math.sign === Z && (Math.sign = function (P) { return 0 > P ? -1 : P > 0 ? 1 : +P }); var pp = zq.Math.Matrix2 = function () { this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.tx = 0, this.ty = 0 }; pp.prototype = {}, pp.prototype.constructor = pp, pp.prototype.set = function (c, H, p, $, J, b) { return this.a = c, this.b = H, this.c = p, this.d = $, this.tx = J, this.ty = b, this }, pp.prototype.apply = function (Y, h) { h = h || new Yn; var g = Y.x, P = Y.y; return h.x = this.a * g + this.c * P + this.tx, h.y = this.b * g + this.d * P + this.ty, h }, pp.prototype.applyInverse = function (L, d) { d = d || new Yn; var Z = 1 / (this.a * this.d + this.c * -this.b), B = L.x, J = L.y; return d.x = this.d * Z * B + -this.c * Z * J + (this.ty * this.c - this.tx * this.d) * Z, d.y = this.a * Z * J + -this.b * Z * B + (-this.ty * this.a + this.tx * this.b) * Z, d }, pp.prototype.translate = function (E, u) { return this.tx += E, this.ty += u, this }, pp.prototype.scale = function (c, W) { return this.a *= c, this.d *= W, this.c *= c, this.b *= W, this.tx *= c, this.ty *= W, this }, pp.prototype.rotate = function (D) { var v = Math.cos(D), r = Math.sin(D), I = this.a, q = this.c, J = this.tx; return this.a = I * v - this.b * r, this.b = I * r + this.b * v, this.c = q * v - this.d * r, this.d = q * r + this.d * v, this.tx = J * v - this.ty * r, this.ty = J * r + this.ty * v, this }, pp.prototype.append = function (y) { var D = this.a, T = this.b, d = this.c, $ = this.d; return this.a = y.a * D + y.b * d, this.b = y.a * T + y.b * $, this.c = y.c * D + y.d * d, this.d = y.c * T + y.d * $, this.tx = y.tx * D + y.ty * d + this.tx, this.ty = y.tx * T + y.ty * $ + this.ty, this }, pp.prototype.setTransform = function (E, O, d, R, t, P, M, r, $) { var z, S, X, v, p, h, H, e, I, i; return p = Math.sin(M), h = Math.cos(M), H = Math.cos($), e = Math.sin($), I = -Math.sin(r), i = Math.cos(r), z = h * t, S = p * t, X = -p * P, v = h * P, this.a = H * z + e * X, this.b = H * S + e * v, this.c = I * z + i * X, this.d = I * S + i * v, this.tx = E + (d * z + R * X), this.ty = O + (d * S + R * v), this }, pp.prototype.prepend = function (u) { var w = this.tx; if (1 !== u.a || 0 !== u.b || 0 !== u.c || 1 !== u.d) { var d = this.a, f = this.c; this.a = d * u.a + this.b * u.c, this.b = d * u.b + this.b * u.d, this.c = f * u.a + this.d * u.c, this.d = f * u.b + this.d * u.d } return this.tx = w * u.a + this.ty * u.c + u.tx, this.ty = w * u.b + this.ty * u.d + u.ty, this }, pp.prototype.invert = function () { var X = this.a, v = this.b, n = this.c, c = this.d, q = this.tx, P = X * c - v * n; return this.a = c / P, this.b = -v / P, this.c = -n / P, this.d = X / P, this.tx = (n * this.ty - c * q) / P, this.ty = -(X * this.ty - v * q) / P, this }, pp.prototype.identity = function () { return this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.tx = 0, this.ty = 0, this }, pp.prototype.clone = function () { var C = new pp; return C.a = this.a, C.b = this.b, C.c = this.c, C.d = this.d, C.tx = this.tx, C.ty = this.ty, C }, pp.prototype.copy = function (p) { return p.a = this.a, p.b = this.b, p.c = this.c, p.d = this.d, p.tx = this.tx, p.ty = this.ty, p }, pp.IDENTITY = new pp, pp.TEMP_MATRIX = new pp; var Yn = zq.Math.Vector2 = function (I, d) { "object" == typeof I && (I.x != Z ? (d = I.y, I = I.x) : (d = I[1], I = I[0])), this.set(I || 0, d || 0) }; Yn.prototype = {}, Yn.prototype.constructor = Yn, F.defineProperties(Yn.prototype, { width: { get: function () { return this.x }, set: function (j) { this.x = j } }, height: { get: function () { return this.y }, set: function (d) { this.y = d } } }), Yn.prototype.clone = function () { return new Yn(this.x, this.y) }, Yn.prototype.copy = function (B) { return this.set(B.x, B.y), this }, Yn.prototype.equals = function (y) { return y.x === this.x && y.y === this.y }, Yn.prototype.set = function (d, r) { return this.x = d || 0, this.y = r || (0 !== r ? this.x : 0), this }, Yn.prototype.setScalar = function (Y) { return this.x = Y, this.y = Y, this }, Yn.prototype.setX = function (B) { return this.x = B || 0, this }, Yn.prototype.setY = function (R) { return this.y = R || 0, this }, Yn.prototype.add = function (K) { return this.x += K.x, this.y += K.y, this }, Yn.prototype.addVectors = function (S, B) { return this.x = S.x + B.x, this.y = S.y + B.y, this }, Yn.prototype.addScalar = function (S) { return this.x += S, this.y += S, this }, Yn.prototype.addScaledVector = function (y, t) { return this.x += y.x * t, this.y += y.y * t, this }, Yn.prototype.sub = function (K) { return this.x -= K.x, this.y -= K.y, this }, Yn.prototype.subScalar = function (S) { return this.x -= S, this.y -= S, this }, Yn.prototype.subVectors = function (O, z) { return this.x = O.x - z.x, this.y = O.y - z.y, this }, Yn.prototype.multiply = function (_) { return this.x *= _.x, this.y *= _.y, this }, Yn.prototype.multiplyScalar = function (f) { return this.x *= f, this.y *= f, this }, Yn.prototype.divide = function (Z) { return this.x /= Z.x, this.y /= Z.y, this }, Yn.prototype.divideScalar = function (e) { return this.multiplyScalar(1 / e) }, Yn.prototype.min = function (C) { return this.x = Math.min(this.x, C.x), this.y = Math.min(this.y, C.y), this }, Yn.prototype.max = function (X) { return this.x = Math.max(this.x, X.x), this.y = Math.max(this.y, X.y), this }, Yn.prototype.clamp = function (y, w) { return this.x = Math.max(y.x, Math.min(w.x, this.x)), this.y = Math.max(y.y, Math.min(w.y, this.y)), this }, Yn.prototype.clampScalar = function () { var p, h; return function (f, y) { return p === Z && (p = new Yn, h = new Yn), p.set(f, f), h.set(y, y), this.clamp(p, h) } }(), Yn.prototype.clampLength = function (B, z) { var R = this.length(); return this.multiplyScalar(Math.max(B, Math.min(z, R)) / R) }, Yn.prototype.dot = function (q) { return this.x * q.x + this.y * q.y }, Yn.prototype.lengthSq = function () { return this.x * this.x + this.y * this.y }, Yn.prototype.length = function () { return Math.sqrt(this.x * this.x + this.y * this.y) }, Yn.prototype.normalize = function () { return this.divideScalar(this.length()) }, Yn.prototype.angle = function () { var K = Math.atan2(this.y, this.x); return 0 > K && (K += 2 * Math.PI), K }, Yn.prototype.distanceTo = function (O) { return Math.sqrt(this.distanceToSquared(O)) }, Yn.prototype.distanceToSquared = function (s) { var p = this.x - s.x, v = this.y - s.y; return p * p + v * v }, Yn.prototype.isNearEnough = function (D) { return this.distanceToSquared(D) < 1e-8 }, Yn.prototype.setLength = function (K) { return this.multiplyScalar(K / this.length()) }, Yn.prototype.lerp = function (I, p) { return this.x += (I.x - this.x) * p, this.y += (I.y - this.y) * p, this }, Yn.prototype.lerpVectors = function (M, g, Z) { return this.subVectors(g, M).multiplyScalar(Z).add(M) }, Yn.prototype.rotateAround = function (m, r) { var n = Math.cos(r), p = Math.sin(r), V = this.x - m.x, R = this.y - m.y; return this.x = V * n - R * p + m.x, this.y = V * p + R * n + m.y, this }; var _h = zq.Math.Curve = function () { this._curves = [] }; _h.prototype = {}, _h.prototype.constructor = _h, _h.prototype.createFromHtShape = function (m, E) { E instanceof R.List && (E = E.toArray()); var z, h, W, U, i, y, Q, u = this, M = null, $ = null, K = 0, S = zq.Math.Vector2, v = zq.Math.CubicBezier; for (h = 0, W = E.length; W > h; h++) { switch (U = E[h], i = null, U) { case 1: $ = new S(m[K], m[K + 1]), M = $, K += 2; break; case 2: z = new S(m[K], m[K + 1]), K += 2, i = new v($, $.clone(), z.clone(), z), $ = z; break; case 3: y = new S(m[K], m[K + 1]), z = new S(m[K + 2], m[K + 3]), K += 4, i = new v($, y.clone().sub($).multiplyScalar(2 / 3).add($), y.clone().sub(z).multiplyScalar(2 / 3).add(z), z), $ = z; break; case 4: y = new S(m[K], m[K + 1]), Q = new S(m[K + 2], m[K + 3]), z = new S(m[K + 4], m[K + 5]), K += 6, i = new v($, y, Q, z), $ = z; break; case 5: if (!M) break; i = new v($, $.clone(), M.clone(), M), $ = null, M = null }i && (i._index = u._curves.length, u._curves.push(i)) } }, _h.prototype.checkPoint = function (J, M) { var D, B, g, i, z, I = this, m = I._curves; for (D = 0, B = m.length; B > D; D++)if (i = m[D], z = i.intersectRect(J, M, M), z.length) return g = 0, z.forEach(function (E) { g += E.t }), g /= z.length, J = i.getPointAt(g), J.t = g, { bezier: i, intersection: J } }, _h.prototype.insertKnot = function (Q, j) { var R = Q.insertKnot(j), z = this, E = z._curves; E.splice(Q._index, 1, R[0], R[1]) }, _h.prototype._isCloseEnough = function (X, D) { return Math.abs(X.x - D.x) < 1e-6 && Math.abs(X.y - D.y) < 1e-6 }, _h.prototype._isSamePoint = function (s, k) { return s === k }, _h.prototype.moveRealPoint = function (u, B) { var t = this, V = t._curves, M = B.clone().sub(u); V.forEach(function (p) { var A = p._p1; p._p2, p._p3; var G = p._p4; t._isSamePoint(A, u) && (p._p2.add(M), p._p1 = B), t._isSamePoint(G, u) && (p._p3.add(M), p._p4 = B) }) }, _h.prototype.moveCtrlPoint = function (b, j, $) { var R = b[$]; if (R) { var n = this, x = n._curves; j.clone().sub(R), x.forEach(function (p) { var U; "c2" === $ ? U = "_p2" : "c1" === $ && (U = "_p3"), n._isSamePoint(p[U], R) && (p[U] = j) }), b[$] = j } }, _h.prototype.deleteRealPoint = function (j, Z) { var L, Y, w, G, t, E, V, v = this, n = v._curves, X = {}, l = [], c = zq.Math.CubicBezier; for (Y = 0, w = n.length; w > Y; Y++)L = n[Y], G = L._p1, t = L._p2, E = L._p3, V = L._p4, (X[Y] || !v._isSamePoint(G, j)) && (v._isSamePoint(V, j) ? w > Y + 1 && v._isSamePoint(n[Y + 1]._p1, j) && (Z || l.push(new c(G, t, n[Y + 1]._p3, n[Y + 1]._p4))) : l.push(L)); v._curves = l }, _h.prototype.findPairs = function (R, k) { var l, r, g, C, w, E, y, S, u = this, Y = u._curves, F = {}, t = []; for (r = 0, g = Y.length; g > r; r++)l = Y[r], C = l._p1, w = l._p2, E = l._p3, y = l._p4, !F[r] && u._isSamePoint(C, R) && (k ? t.push({ point: C, r2: y }) : t.push({ point: C, c2: w })), u._isSamePoint(y, R) && (S = k ? { point: y, r1: C } : { point: y, c1: E }, g > r + 1 && u._isSamePoint(Y[r + 1]._p1, R) && (k ? S.r2 = Y[r + 1]._p4 : S.c2 = Y[r + 1]._p2, F[r + 1] = !0), t.push(S)); return t }, _h.prototype.toHtShape = function () { var C = this, y = C._curves, t = [], d = [], c = { x: 1 / 0, y: 1 / 0 }; return y.forEach(function (z) { var $ = z._p1, l = z._p2, X = z._p3, L = z._p4; return C._isCloseEnough($, c) || (t.push(1), d.push($.clone())), c = L, C._isCloseEnough($, l) && C._isCloseEnough(X, L) ? (t.push(2), d.push(L.clone()), void 0) : (t.push(4), d.push(l.clone(), X.clone(), L.clone()), void 0) }), { segments: t, points: d } }; var Bi = zq.Math.CubicBezier = function (J, t, F, Z) { var V = this; V._id = zq.Math.CubicBezier._globalId++ , V._p1 = J, V._p2 = t, V._p3 = F, V._p4 = Z }; Bi._globalId = 1, Bi.prototype = {}, Bi.prototype.constructor = Bi, Bi.prototype.toString = function () { return this._id }, Bi.prototype.intersectRect = function (n, B, J) { var L = B / 2, u = J / 2, h = n.x, Z = n.y, N = zq.Math.Vector2, Q = new N(-L + h, -u + Z), P = new N(L + h, u + Z), D = new N(P.x, Q.y), H = new N(Q.x, P.y), R = this, C = R.intersectLine(Q, D), p = R.intersectLine(D, P), z = R.intersectLine(P, H), E = R.intersectLine(H, Q), F = C.concat(p).concat(z).concat(E); return F }, Bi.prototype.intersectLine = function (v, P) { var V, q, b, s, p, F, l, O, L, z, y, j, r, h = this, f = v.clone().min(P), u = v.clone().max(P); s = h._p1, p = h._p2, F = h._p3, l = h._p4, V = s.clone().multiplyScalar(-1), q = p.clone().multiplyScalar(3), b = F.clone().multiplyScalar(-3), y = V.add(q).add(b).add(l), V = s.clone().multiplyScalar(3), q = p.clone().multiplyScalar(-6), b = F.clone().multiplyScalar(3), z = V.add(q).add(b), V = s.clone().multiplyScalar(-3), q = p.clone().multiplyScalar(3), L = V.add(q), O = s.clone(), r = new zq.Math.Vector2(v.y - P.y, P.x - v.x), j = v.x * P.y - P.x * v.y; for (var w = h.getRoots(r.dot(y), r.dot(z), r.dot(L), r.dot(O) + j), J = new Array, c = 0, G = w.length; G > c; c++) { var $ = w[c]; if (!(0 > $ || $ > 1)) { var a = s.clone().lerp(p, $), k = p.clone().lerp(F, $), Z = F.clone().lerp(l, $), m = a.lerp(k, $), W = k.lerp(Z, $), C = m.lerp(W, $); C.t = $, v.x == P.x ? f.y <= C.y && C.y <= u.y && J.push(C) : v.y == P.y ? f.x <= C.x && C.x <= u.x && J.push(C) : C.x >= f.x && C.y >= f.y && C.x <= u.x && C.y <= u.y && J.push(C) } } return J }, Bi.prototype.solveTForPoint = function (u) { var Q, l, k, b, C = this; Q = C._p1.x - u.x, l = C._p2.x - u.x, k = C._p3.x - u.x, b = C._p4.x - u.x; for (var e = C.getRoots(b - 3 * k + 3 * l - Q, 3 * k - 6 * l + 3 * Q, 3 * l - 3 * Q, Q), I = Z, m = 1 / 0, J = 0, s = e.length; s > J; J++) { var K = e[J]; if (!(0 > K || K > 1)) { var x = C._p1.clone().lerp(C._p2, K), A = C._p2.clone().lerp(C._p3, K), D = C._p3.clone().lerp(C._p4, K), X = x.lerp(A, K), L = A.lerp(D, K), M = X.lerp(L, K); M.t = K; var o = Math.abs(M.y - u.y); m > o && (m = o, I = M) } } return I }, Bi.prototype.getPointAt = function (F) { var S = this, W = S._p1, x = S._p2, K = S._p3, e = S._p4, t = W.clone().lerp(x, F), _ = x.clone().lerp(K, F), y = K.clone().lerp(e, F), J = t.lerp(_, F), U = _.lerp(y, F); return J.lerp(U, F) }, Bi.prototype.getRoots = function (w, s, O, o) { var q, t, B, W, i, k = new Array; if (Math.abs(w) < 1e-6) { var q = s, t = O / q, B = o / q, W = t * t - 4 * B; if (W > 0) { var i = Math.sqrt(W); k.push(.5 * (-t + i)), k.push(.5 * (-t - i)) } else 0 == W && k.push(.5 * -t) } s /= w, O /= w, o /= w, q = (3 * O - s * s) / 3, t = (2 * s * s * s - 9 * O * s + 27 * o) / 27; var J = s / 3, S = t * t / 4 + q * q * q / 27, r = t / 2; if (Math.abs(S) <= 1e-6 && (S = 0), S > 0) { var H, f, i = Math.sqrt(S); H = -r + i, f = H >= 0 ? Math.pow(H, 1 / 3) : -Math.pow(-H, 1 / 3), H = -r - i, H >= 0 ? f += Math.pow(H, 1 / 3) : f -= Math.pow(-H, 1 / 3), k.push(f - J) } else if (0 > S) { var j = Math.sqrt(-q / 3), v = Math.atan2(Math.sqrt(-S), -r) / 3, x = Math.cos(v), U = Math.sin(v), n = Math.sqrt(3); k.push(2 * j * x - J), k.push(-j * (x + n * U) - J), k.push(-j * (x - n * U) - J) } else { var H; H = r >= 0 ? -Math.pow(r, 1 / 3) : Math.pow(-r, 1 / 3), k.push(2 * H - J), k.push(-H - J) } return k }, Bi.prototype._70I = function () { var s = this; return s._p1.distanceToSquared(s._p2) < 1e-10 && s._p3.distanceToSquared(s._p4) < 1e-10 }, Bi.prototype.insertKnot = function (m) { var R = this, t = R._p1, G = R._p2, b = R._p3, W = R._p4, F = t.clone().lerp(G, m), $ = G.clone().lerp(b, m), L = b.clone().lerp(W, m), V = F.clone().lerp($, m), e = $.clone().lerp(L, m), f = V.clone().lerp(e, m); return R._70I() ? (t.clone().lerp(W, m), [new zq.Math.CubicBezier(t, t.clone(), f.clone(), f), new zq.Math.CubicBezier(f, f.clone(), W.clone(), W)]) : [new zq.Math.CubicBezier(t, F, V, f), new zq.Math.CubicBezier(f, e, L, W)] }; var cq = R.Default.getInternal().ui().EdgeUI, hk = { _47O: function (L) { var S = this, k = hk.getBackups()._47O; zq.inEdit(S.gv) || k.call(S, L) } }; zq.Inject.registAsModule(hk, cq); var sq = R.Default.getInternal().ui().NodeUI, Vm = { _47O: function (B) { var Z = this, q = Vm.getBackups()._47O; zq.inEdit(Z.gv) || q.call(Z, B) }, getSelectWidth: function () { var F = this, C = F.gv, c = F._data; if (C.isEditable(c) && zq.inEdit(C)) return 0; var Q = Vm.getBackup("getSelectWidth"); return Q.call(F) } }; zq.Inject.registAsModule(Vm, sq); var Zp = R.graph.GraphView, Hm = { _editPointSize: function () { var n = R.Default.isTouchable, H = zq.getStyle("pointSize"); return H[n ? 0 : 1] }(), isPointEditable: function (S) { var p = this; if (zq.inEdit(p)) return p._pointEditableFunc ? p._pointEditableFunc(S) : !0; var i = Hm.getBackup("isPointEditable"); i.call(p, S) }, isEditable: function (m) { var V, K = this, v = Hm.getBackup("isEditable"); if (V = m instanceof zq.Group ? !0 : v.call(K, m), !zq.inEdit(K)) return V; if (!(m instanceof R.Edge)) return V; if (!m.s("2d.editable")) return !1; var l = K.getEditableFunc(); return l ? l(m) : !0 }, _42: function (P, S) { var U = this, V = Hm.getBackups()._42; if (V.call(U, P, S), zq.inEdit(U)) { var y = U.getEditInteractor(); y.drawImpl() } } }; zq.Inject.registAsModule(Hm, Zp); var Qj = R.Default.getInternal().ui().ShapeUI, Wj = { _47O: function (O) { var H = this, l = Wj.getBackups()._47O; zq.inEdit(H.gv) || l.call(H, O) } }; zq.Inject.registAsModule(Wj, Qj); var hm = R.graph.DefaultInteractor, Ab = { handle_mousewheel: function (m) { var M = this, t = Ab.getBackup("handle_mousewheel"); zq.inEdit(M.gv) || t.call(M, m) } }; zq.Inject.registAsModule(Ab, hm); var wl = R.graph.MoveInteractor, yf = { _calcShift: function ($, W) { var P = this, c = yf.getBackup("_calcShift"), q = P.gv; if (!zq.inEdit(q)) return c.call(P, $, W); var A = q.getEditInteractor(), g = A.getSubModule("Move").calcShift($, W, P); return g || c.call(P, $, W) }, clear: function (E) { var $ = this, B = yf.getBackup("clear"); B.call($, E); var _ = $.gv; if (zq.inEdit(_)) { var Q = _.getEditInteractor(); Q.getSubModule("Move").clear(E) } } }; zq.Inject.registAsModule(yf, wl); var wi = zq.Rect = function (P) { this.catalog = "Rect", this._interactor = P }; wi.prototype = {}, wi.prototype.constructor = wi, wi.prototype.gatherInfo = function (l, e) { var T = this; if (1 === e.length) { var u = e[0]; return u instanceof R.Shape && u._70I() ? T.gatherLine(l, u) : Fb(u, l) ? !1 : T.gatherSingleTarget(l, u) } return e.length > 1 ? T.gatherMultiTargets(l, e) : !1 }, wi.prototype.gatherSingleTarget = function (y, Q) { if (Q.getCorners) { var J, m = this.info; this.target = Q, J = this.screenInfo = {}; var h = Q.getCorners(); m.LT = new zq.Math.Vector2(h[0]), m.LB = new zq.Math.Vector2(h[1]), m.RB = new zq.Math.Vector2(h[2]), m.RT = new zq.Math.Vector2(h[3]), m.T = m.LT.clone().add(m.RT).divideScalar(2), m.B = m.LB.clone().add(m.RB).divideScalar(2), m.L = m.LT.clone().add(m.LB).divideScalar(2), m.R = m.RT.clone().add(m.RB).divideScalar(2); for (var E in m) J[E] = zq.toScreenPosition(y, m[E]); var N = this._interactor.getStyle("checkSize"), X = function (p, l, M) { var i = l.clone().sub(p).setLength(-N), f = M.clone().sub(p).setLength(-N), G = i.add(f).add(p); return G }; return J.rotLT = X(J.LT, J.RT, J.LB), J.rotLB = X(J.LB, J.LT, J.RB), J.rotRB = X(J.RB, J.LB, J.RT), J.rotRT = X(J.RT, J.LT, J.RB), J.rotT = J.rotLT.clone().add(J.rotRT).divideScalar(2), J.rotB = J.rotLB.clone().add(J.rotRB).divideScalar(2), J.rotL = J.rotLT.clone().add(J.rotLB).divideScalar(2), J.rotR = J.rotRT.clone().add(J.rotRB).divideScalar(2), J.rotation = Q.getRotation(), !0 } }, wi.prototype.gatherMultiTargets = function (W, e) { var T = zq.Group.findOrCreateGroup(e); if (!T) return !1; var Q = this; return Q.editing && "rotate" !== Q.editing.mode || T.calcInfo(), Q.gatherSingleTarget(W, T) }, wi.prototype.gatherLine = function (m, k) { this.target = k; var K = this.screenInfo = {}, L = k.getPoints(), v = zq.getDataMatrix(k); return K.P1 = zq.toScreenPosition(m, v.apply(L.get(0))), K.P2 = zq.toScreenPosition(m, v.apply(L.get(1))), !0 }, wi.ResizeKeys = ["LT", "RB", "LB", "RT", "L", "R", "B", "T"], wi.ResizeDirection = [{ x: -1, y: -1 }, { x: 1, y: 1 }, { x: -1, y: 1 }, { x: 1, y: -1 }, { x: -1, y: 0 }, { x: 1, y: 0 }, { x: 0, y: 1 }, { x: 0, y: -1 }], wi.RotateKeys = ["rotLT", "rotRB", "rotLB", "rotRT", "rotL", "rotR", "rotB", "rotT"], wi.prototype.check = function (w, r, z) { if (R.Default.isLeftButton(r)) { var C = this; if (C.editing = null, C.tipInfo = null, C.screenInfo) { if (C.screenInfo.P1) return C._checkLine(z); var F, j, K, X = null, l = C._interactor, k = l.getStyle("checkSize"), u = C.target, h = w.isEditable(u); if (h && w.isRectEditable(u)) for (j = 0; j < zq.Rect.ResizeKeys.length; j++)if (K = zq.Rect.ResizeKeys[j], zq.checkHit(z, C.screenInfo[K], k)) { X = K, F = "resize"; break } if (!X && h && w.isRotationEditable(u)) { var P = l.getStyle("rotateCheckSize"); for (j = 0; j < zq.Rect.RotateKeys.length; j++)if (K = zq.Rect.RotateKeys[j], zq.checkHit(z, C.screenInfo[K], P)) { X = K, F = "rotate"; break } } if (!X) return this._interactor.setCursor("default"), void 0; if ("rotate" === F) { this._interactor.setCursor("crosshair"); var B, f = w.lp(r); if (u instanceof zq.Group) { var o = l.getStyle("groupRotateModeKey"); "string" == typeof o && (o = [o]); for (var e = !1, Y = 0, J = o.length; J > Y; Y++)if (r[o[Y]]) { e = !0; break } var O = l.getStyle("groupRotateModeDefault"); B = e ? "batch" === O ? "block" : "batch" : O } var t = "batch" === B ? u.getAnchor2() : u.getPosition(); C.editing = { mode: F, key: X, pos: t, flipY: u.getScale().y < 0, rotation: u.getRotation(), hitRot: Math.atan2(f.y - t.y, f.x - t.x) }, B && (C.editing.groupRotateMode = B) } else { var $ = zq.Rect.ResizeKeys.indexOf(X), Q = zq.Rect.ResizeDirection[$], T = Math.cos(u.getRotation()), Z = Math.sin(u.getRotation()), L = Q.x * Math.sign(u.getScale().x), S = Q.y * Math.sign(u.getScale().y), E = Math.atan2(-Z * L - T * S, T * L - Z * S), g = (Math.round(E / (Math.PI / 4)) + 8) % 8, y = ["ew-resize", "nesw-resize", "ns-resize", "nwse-resize", "ew-resize", "nesw-resize", "ns-resize", "nwse-resize"][g]; this._interactor.setCursor(y); var U = u.getWidth(), v = u.getHeight(), N = u.getAnchor(); C.editing = { mode: F, key: X, rect: { x: -U * N.x, y: -v * N.y, width: U, height: v }, anchor: N, matrix: u.getMatrix() } } return X } } }, wi.prototype._checkLine = function (K) { var o = this; o.screenInfo; var z, y = o._interactor.getStyle("checkSize"); if (zq.checkHit(K, o.screenInfo.P1, y)) z = "P1"; else { if (!zq.checkHit(K, o.screenInfo.P2, y)) return this._interactor.setCursor("default"), void 0; z = "P2" } return o.editing = { mode: "line", key: z }, z }, wi.prototype.startEdit = function (v, t) { v.startDragging(t); var G = this; G._interactor.fi({ kind: "prepareEdit", event: t }); var Z = G.editing, q = G.target; return Z ? "rotate" === Z.mode ? (Z.groupRotateMode && q.beginRotate(Z), void 0) : (("line" === Z.mode || q && 0 === q.getRotation()) && (G._inSmartGuide = !0, G._interactor.rectGuide.gatherRects()), void 0) : void 0 }, wi.prototype._46O = function () { var O = this, A = O.editing ? O.editing.groupRotateMode : null; O.editing = null, O.tipInfo = null, O._inSmartGuide && (O._interactor.rectGuide.clear(), O._inSmartGuide = !1), A && O.target && O.target.endRotate() }, wi.prototype.handleEdit = function (P, i) { var G = this, r = G.editing; if (r) { var I, w, s, m, H, J, M = G.target, L = r.key, K = r.mode, x = G._interactor; if ("rotate" === K) { var V, b = P.lp(i), W = r.pos, Q = Math.atan2(b.y - W.y, b.x - W.x); if (r.groupRotateMode ? V = Q - r.hitRot : (Q -= r.hitRot, V = r.rotation + Q), V %= 2 * Math.PI, 0 > V && (V += 2 * Math.PI), !R.Default.isCtrlDown(i)) { var p, c; Qd(i) ? (p = x.getStyle("shiftRotateRound"), c = p / 2) : (p = x.getStyle("rotateRound"), c = x.getStyle("rotateSensitivity")), V = zq.roundTo(V, p, c) } r.groupRotateMode ? (Q = V - (r.lastRotation || 0), 0 !== Q && (M.addRotation(Q, r.groupRotateMode), r.lastRotation = V)) : M.setRotation(V), V > Math.PI && (V -= 2 * Math.PI); var f = 180 * (V / Math.PI); f = f.toFixed(2), I = "" + f + "°" } else if ("resize" === K) { var T = r.rect; m = T.x, H = T.y; var n = T.width, u = T.height, g = r.anchor, X = r.matrix; w = P.lp(i); var d, Z = Qd(i), v = G._unionPointMode1, B = G._unionPointMode2; if (G._inSmartGuide && !R.Default.isCtrlDown(i) && !Z) { var l; "L" === L || "R" === L ? l = "x" : ("T" === L || "B" === L) && (l = "y"), G._adsorbedToClosest(w, l), J = !0 } d = X.tfi(w); var y; "LT" === L ? (T = v(d, { x: m + n, y: H + u }, n, u, Z), y = 9) : "T" === L ? (T = B({ x: m, y: d.y }, { x: m + n, y: H + u }, n, u, Z, "v"), y = 1) : "RT" === L ? (T = v(d, { x: m, y: H + u }, n, u, Z), y = 33) : "L" === L ? (T = B({ x: d.x, y: H }, { x: m + n, y: H + u }, n, u, Z, "h"), y = 8) : "R" === L ? (T = B({ x: m, y: H }, { x: d.x, y: H + u }, n, u, Z, "h"), y = 32) : "LB" === L ? (T = v(d, { x: m + n, y: H }, n, u, Z), y = 12) : "B" === L ? (T = B({ x: m, y: H }, { x: m + n, y: d.y }, n, u, Z, "v"), y = 4) : "RB" === L && (T = v(d, { x: m, y: H }, n, u, Z), y = 36); var Y = X.tf(T.x + T.width * g.x, T.y + T.height * g.y); M.setPosition(Y), M.setSize(T.width, T.height), J && (s = M.getRect(), x.rectGuide.gatherLines({ node: M, x: s.x, y: s.y, w: s.width, h: s.height }, l, y)), I = "" + Math.round(T.width) + " * " + Math.round(T.height) } else if ("line" === K) { if (w = P.lp(i), Qd(i)) { var N = M.getPoints(), $ = "P1" === L ? N.get(1) : N.get(0), h = { x: w.x - $.x, y: w.y - $.y }, F = x.getStyle("shiftLineRotateRound"), D = G._shiftDirList; if (!D || G._shiftRotateRound !== F) { G._shiftRotateRound = F, G._shiftDirList = D = []; for (var C = 0; C < Math.PI; C += F)D.push({ x: t(C), y: S(C) }) } for (var a, U = 0, E = 0, e = D.length; e > E; E++) { var z = D[E], O = z.x * h.x + z.y * h.y; Math.abs(O) > Math.abs(U) && (U = O, a = z) } w = { x: $.x + a.x * U, y: $.y + a.y * U }, x.rectGuide.clear() } else G._inSmartGuide && !R.Default.isCtrlDown(i) && (G._adsorbedToClosest(w), J = !0); var k = zq.getDataMatrix(M).applyInverse(w); M.setPoint("P1" === L ? 0 : 1, k, !0); var A = M.getPoints(), _ = A.get(0), o = A.get(1); m = _.x - o.x, H = _.y - o.y, I = " " + Math.round(Math.sqrt(m * m + H * H)) + " ", J && (s = M.getRect(), x.rectGuide.gatherLines({ node: M, x: s.x, y: s.y, w: s.width, h: s.height })) } var j = R.Default.getLogicalPoint(i, x._canvas); j.x += zq.Icons.TipShiftX, j.y += zq.Icons.TipShiftY, G.tipInfo = { helperPos: j, text: I, size: I.length } } }, wi.prototype._unionPointMode1 = function (P, J, i, s, C) { if (C && i && s) { var T = P.x - J.x, l = P.y - J.y; Math.abs(T * s) < Math.abs(l * i) ? (l = Math.sign(l) * Math.abs(T * s / i), P.y = J.y + l) : (T = Math.sign(T) * Math.abs(l * i / s), P.x = J.x + T) } return R.Default.unionPoint(P, J) }, wi.prototype._unionPointMode2 = function (Q, u, F, C, f, A) { var y = R.Default.unionPoint(Q, u); if (f && F && C) { var N; "v" === A ? (N = y.x + y.width / 2, y.width = F * y.height / C, y.x = N - y.width / 2) : (N = y.y + y.height / 2, y.height = C * y.width / F, y.y = N - y.height / 2) } return y }, wi.prototype._adsorbedToClosest = function (n, h) { var r = this, y = r._interactor, I = y.rectGuide.findClosest(n, h), b = y.gridGuide.findClosest(n, h), c = 1 / 0, l = 1 / 0; I && (isFinite(I.x) && (c = I.x), isFinite(I.y) && (l = I.y)), b && (isFinite(b.x) && Math.abs(b.x) < Math.abs(c) && (c = b.x), isFinite(b.y) && Math.abs(b.y) < Math.abs(l) && (l = b.y)), isFinite(c) && (n.x += c), isFinite(l) && (n.y += l) }, wi.prototype._42 = function (l, e, s) { var P = this; P.info = {}, P.screenInfo = null; var y = P._interactor; if (!y.editDetail && P.gatherInfo(e, s)) { var E = P.editing ? P.editing.groupRotateMode : null, v = P.screenInfo; "block" !== E && (v.P1 ? zq.Icons.DrawIcon(y, l, zq.Icons.Line, P.screenInfo) : zq.Icons.DrawIcon(y, l, zq.Icons.Rect, P.screenInfo), P.tipInfo && zq.Icons.DrawIcon(y, l, zq.Icons.TipHelper, P.tipInfo)), P.target instanceof zq.Group && P.target._42(y, l, e) } }; var cj = zq.Anchor = function (O) { this.catalog = "Anchor", this._interactor = O }; cj.prototype = {}, cj.prototype.constructor = cj, cj.prototype.gatherInfo = function (b, X) { var h = this; if (1 === X.length) { var Z = X[0]; if (!Z.getAnchor) return; if (Z instanceof R.Shape && Z._70I()) return; if (Fb(Z, b)) return; return h.gatherSingleTarget(b, X[0]) } return X.length > 1 ? h.gatherMultiTargets(b, X) : !1 }, cj.prototype.gatherSingleTarget = function (c, t) { var M = this; return M.info.POS = t.getPosition(), M.screenInfo.POS = zq.toScreenPosition(c, M.info.POS), M.target = t, !0 }, cj.prototype.gatherMultiTargets = function (p, t) { var E = this, d = zq.Group.findOrCreateGroup(t); return d ? (E.screenInfo.POS = zq.toScreenPosition(p, d.getAnchor2()), E.target = d, !0) : !1 }, cj.prototype.isVisible = function () { var w = this, N = w._interactor; if (N.getStyle("anchorVisible") === !1) return !1; var x = w.target; if (x) { if (this.editing) return !0; var y = x.getAnchor(), e = N.getStyle("anchorOutsideVisibleThreshold"); if (y.x < -e || y.x > 1 + e || y.y < -e || y.y > 1 + e) return !0; var R = x.getSize(), z = x.getScale(), M = Math.min(Math.abs(R.width * z.x), Math.abs(R.height * z.y)); if (M * N.gv._zoom < N.getStyle("anchorHideThreshold")) return !1 } return !0 }, cj.prototype.check = function (P, w, X) { if (R.Default.isLeftButton(w)) { var b = this, n = b._interactor; if (b.isVisible() && n.getStyle("anchorMovable") !== !1) { b.editing = null, b.tipInfo = null; var K = b.target; if (K && P.isAnchorEditable(K) && P.isEditable(K)) { var A; if (b.screenInfo && (A = b.screenInfo.POS) && zq.checkHit(X, new zq.Math.Vector2(A), n.getStyle("checkSize"))) { if (K instanceof zq.Group) return b.editing = {}, !0; var f = K.getWidth(), _ = K.getHeight(), D = K.getAnchor(); return b.editing = { rect: { x: -f * D.x, y: -_ * D.y, width: f, height: _ }, anchor: D, matrix: K.getMatrix() }, !0 } } } } }, cj.prototype.startEdit = function (p, d) { p.startDragging(d) }, cj.prototype._46O = function () { this.editing = null, this.tipInfo = null }, cj.prototype.handleEdit = function (k, K) { var z = this, x = z.target; if (x && z.editing) { var l = k.lp(K); if (x instanceof zq.Group) return x.setAnchor2(l), z._interactor._42(), void 0; var v = z.editing.matrix, N = v.tfi(l), B = z.editing.rect, c = (N.x - B.x) / B.width, M = (N.y - B.y) / B.height; if (!R.Default.isCtrlDown(K)) { var h = z._interactor.getStyle("anchorRound"), t = z._interactor.getStyle("anchorSensitivity"); c = zq.roundTo(c, h, t), M = zq.roundTo(M, h, t) } x.setAnchor(c, M, !0); var L = R.Default.getLogicalPoint(K, z._interactor._canvas); L.x += zq.Icons.TipShiftX, L.y += zq.Icons.TipShiftY; var e = "" + c.toFixed(2) + ", " + M.toFixed(2); z.tipInfo = { helperPos: L, text: e, size: e.length } } }, cj.prototype._42 = function (R, a, G) { var T = this; T.info = {}, T.screenInfo = {}; var e = T._interactor; e.editDetail || T.gatherInfo(a, G) && T.isVisible() && (zq.Icons.DrawIcon(e, R, zq.Icons.Anchor, T.screenInfo), T.tipInfo && zq.Icons.DrawIcon(e, R, zq.Icons.TipHelper, T.tipInfo)) }; var _h = zq.Curve = function (r) { this.catalog = "Curve", this._interactor = r }; _h.prototype = {}, _h.prototype.constructor = _h, _h.PointType = { Mirrored: 0, Straight: 1, Disconnected: 2, Asymmetric: 3 }, _h.prototype.setUp = function () { var l = this, w = l._interactor; w && w.gv.mp(l._onGraphviewPropertyChanged, l) }, _h.prototype._onGraphviewPropertyChanged = function (w) { ("zoom" === w.property || "translateX" === w.property || "translateY" === w.property) && this._handleDataChanged() }, _h.prototype.tearDown = function () { var Y = this, J = Y._interactor; J && J.gv.ump(Y._onGraphviewPropertyChanged) }, _h.prototype.canEnterEditDetailMode = function () { var J = this, C = J._interactor, K = C._getValidSelection(); if (1 === K.length) { var c = K[0], u = c instanceof R.Edge; if (c instanceof R.Shape || u) { if (u) { var D = c.s("edge.type"); if (D && "points" !== D) return } var h = C.gv; if (h.isPointEditable(c) && h.isEditable(c)) return J.target = c, !0 } } }, _h.prototype.preHandleScroll = function () { var l = this.editing; return l && l.inEdit ? !0 : void 0 }, _h.prototype.getCurrentSelectintStatus = function () { var b = this; if (b.activing && !b.activing.selections) { if (b.activing.status != Z) return b.activing.status; var g = function (S) { var N = b.activing.status; b.activing.status = S, b._interactor.fp("shapePointStatus", N, S) }, T = zq.Curve.PointType, J = b.activing.point, x = b.activing.pairs; if (!x || 1 !== x.length) return g(T.Mirrored); var q = x[0], L = q.c1 && q.c1.isNearEnough(J), D = q.c2 && q.c2.isNearEnough(J); if (!q.c1 || !q.c2) return L || D ? g(T.Straight) : g(T.Disconnected); if (L && D) return g(T.Straight); if (L || D) return g(T.Asymmetric); var H = q.c1.clone().sub(J), P = q.c2.clone().sub(J); return Math.abs(H.x * P.y - H.y * P.x) > 1e-5 || H.x * P.x > 0 ? g(T.Disconnected) : Math.abs(H.length() - P.length()) > 1e-5 ? g(T.Asymmetric) : g(T.Mirrored) } }, _h.prototype.handle_keydown = function (L) { var s = this; if (s._interactor.editDetail) { var H = zq.Curve.PointType; "1" === L.key ? s.setCurrentSelectionStatus(H.Straight) : "2" === L.key ? s.setCurrentSelectionStatus(H.Mirrored) : "3" === L.key ? s.setCurrentSelectionStatus(H.Disconnected) : "4" === L.key && s.setCurrentSelectionStatus(H.Asymmetric) } }, _h.prototype.setCurrentSelectionStatus = function (L) { var d = this; if (d.activing) { var g = d.getCurrentSelectintStatus(); if (null !== g && g !== L) { d.activing.status = L; var B = d.activing.point, T = d.activing.pairs; if (T && 1 === T.length) { var H = T[0], x = d.screenInfo.curve, s = zq.Curve.PointType, e = function () { d._writeToHt(), d._interactor.fp("shapePointStatus", g, L) }; if (L === s.Straight) return x.moveCtrlPoint(H, B, "c1"), x.moveCtrlPoint(H, B, "c2"), e(), void 0; if (g === s.Straight) { var S = x.findPairs(B, !0), a = S[0], J = a.r1 || B, n = a.r2 || B, j = n.clone().sub(J).multiplyScalar(.25); return x.moveCtrlPoint(H, B.clone().sub(j), "c1"), x.moveCtrlPoint(H, B.clone().add(j), "c2"), e(), void 0 } var R = H.c1, i = H.c2; if (R && i) { if (L === s.Mirrored) return x.moveCtrlPoint(H, B.clone().multiplyScalar(2).sub(i), "c1"), e(), void 0; if (L === s.Asymmetric && g === s.Disconnected) { var l = R.clone().sub(B).length(), j = B.clone().sub(i).setLength(l).add(B); return x.moveCtrlPoint(H, j, "c1"), e(), void 0 } } d._interactor.fp("shapePointStatus", g, L) } } } }, _h.prototype._handleDataChanged = function (V) {
            var U = this; if (U.screenInfo && U.target) {
                var I = U._interactor; U.gatherSingleTarget(I.gv, U.target, !0), U.check(I.gv, null, V ? I._getLogicalPoint(V) : new zq.Math.Vector2(I._lastClientPoint)), I._42()
            }
        }, _h.prototype.gatherSingleTarget = function (e, $, l) { var T, d, X = this; X.screenInfo && X.screenInfo.curve && (d = X.screenInfo.curve._curves); var n = X.editing; T = n ? X.screenInfo : X.screenInfo = {}; var c, G, t = $ instanceof R.Edge; t ? (c = $.s("edge.segments"), G = $.s("edge.points") || new R.List) : (c = $._58O, G = $._59O), T.S = c; var A = T.P = [], U = zq.getDataMatrix($); if (G.each(function (b) { b = U.apply(b); var d = zq.toScreenPosition(e, b); A.push(d.x, d.y) }), t) { var O = zq.toScreenPosition(e, $._lastSourcePoint), r = zq.toScreenPosition(e, $._lastTargetPoint); A.splice(0, 0, O.x, O.y), A.push(r.x, r.y) } if (!T.S || !T.S.size()) { T.S = new R.List, T.S.add(1); for (var V = 0; V < A.length / 2 - 1; V++)T.S.add(2) } if ((!n || l) && X.convertToCubicBezier(d), X.activing && (l || !X.editing || "realPoint" === X.editing.type)) { var q = T.curve.findPairs(X.activing.point); X.activing.pairs = q } t && "points" !== $.s("edge.type") && X._writeToHt() }, _h.prototype._convertToNewPoint = function (R, I, M) { var U, v, K; for (U = 0, v = I.length; v > U; U++) { if (K = I[U], K._p1.isNearEnough(R)) return K._p1; if (K._p4.isNearEnough(R)) return K._p4 } if (M) for (U = 0, v = Math.min(M.length, v); v > U; U++) { if (K = M[U], K._p1 === R) return I[U]._p1; if (K._p4 === R) return I[U]._p4 } }, _h.prototype.convertToCubicBezier = function (u) { var v, z, E = this, d = new zq.Math.Curve, B = E.screenInfo; if (d.createFromHtShape(B.P, B.S), B.curve = d, E.activing) { var i = d._curves; if (v = E.activing.point, z = E._convertToNewPoint(v, i, u), z && (E.activing.point = z), E.activing.selections) { var a = -1, k = E.activing.selections; k.forEach(function (W) { a++ , z = E._convertToNewPoint(W, i, u), z && (k[a] = z) }) } } }, _h.prototype.check = function (z, n, i) { if (!n || R.Default.isLeftButton(n)) { var K = this; if (K._interactor.setCursor("default"), K.editing = null, K.highlight = null, K.tipInfo = null, K.screenInfo) { if (Pk()) return K._interactor._42(), !0; if (K._checkEditCtrlPoint(i)) return K._interactor._42(), !0; if (K._checkEditRealPoint(i)) return K._interactor._42(), !0; var I = K.screenInfo.curve, H = I.checkPoint(i, K._interactor.getStyle("curveIntersectSize")); if (H) { var G = K.highlight = {}; G.type = "insertKnot", G.bezier = H.bezier, G.point = H.intersection } return K._interactor._42(), !0 } } }, _h.prototype._checkEditRealPoint = function (Y) { var t, J, o, e, E, Q, p = this, n = p.screenInfo.curve._curves, m = p._interactor.getStyle("curvePointIntersectSize"), F = 1 / 0; for (m *= m, o = 0, e = n.length; e > o; o++)t = n[o], E = t._p1, Q = Y.distanceToSquared(E), F > Q && (F = Q, J = E), E = t._p4, Q = Y.distanceToSquared(E), F > Q && (F = Q, J = E); if (F > m) return !1; var q = p.highlight = {}; return q.type = "changeRealPoint", q.point = J, p.editing = { type: "realPoint", point: J, shiftGuide: { point: J.clone(), dir: "x", limit: 0 } }, p._interactor.setCursor("crosshair"), !0 }, _h.prototype._checkEditCtrlPoint = function (p) { var V = this; if (V.activing && !V.activing.selections) { var F = V.getCurrentSelectintStatus(); if (F !== zq.Curve.PointType.Straight) { var t = V.activing.pairs; if (t) { var l = V._interactor.getStyle("curvePointIntersectSize"); l *= l; var m, f, s, U, g, Q, q, T, y, H = 1 / 0; for (q = 0, y = t.length; y > q; q++)for (U = t[q], T = 0; 2 > T; T++)g = 0 === T ? "c1" : "c2", U[g] && (Q = p.distanceToSquared(U[g]), H > Q && (H = Q, m = U, f = q, s = g)); if (H > l) return !1; V.activing.hlpair = m, V.activing.hltype = s; var n = V.highlight = {}; return n.type = "changeCtrlPoint", n.point = m[s], V.editing = { type: "ctrlPoint", pair: m, pairId: f, ctrlType: s, direction: m[s].clone().sub(V.activing.point).normalize() }, V._interactor.setCursor("crosshair"), !0 } } } }, _h.prototype.startEdit = function (w, H) { w.startDragging(H); var L = this; L.highlight && "insertKnot" === L.highlight.type && (L.insertKnot(), L.gatherSingleTarget(L._interactor.gv, L.target), L.activing = null, L._checkEditRealPoint(L._interactor._getLogicalPoint(H))); var V = L.highlight, X = R.Default.isCtrlDown(H); if (!V || Pk()) { var W = L._interactor.gv; if (!W.setFocus(H) || W._scrolling) return; return W.isPannable() && Vg(H) && !X && (L._pan = { tx: W.tx(), ty: W.ty() }), void 0 } if ("changeRealPoint" === V.type) { var t, O = L.activing ? L.activing.point : null, e = L.activing ? L.activing.selections : null; if (X && L.activing) O === V.point ? (e ? (L.activing = { point: e[0] }, e.length > 1 && (e.splice(0, 1), L.activing.selections = e)) : L.activing = null, L.editing = null) : e && (t = e.indexOf(V.point)) >= 0 ? (e.length > 1 ? e.splice(t, 1) : delete L.activing.selections, L.editing = null) : e ? (e.push(O), L.activing = { point: V.point, selections: e }) : L.activing = { point: V.point, selections: [O] }; else if (e) O === V.point || ((t = e.indexOf(V.point)) >= 0 ? (e.splice(t, 1, O), L.activing = { point: V.point, selections: e }) : L.activing = { point: V.point }); else { var S; O === V.point && (S = L.activing.status), L.activing = { point: V.point }, S && (L.activing.status = S) } } }, _h.prototype.insertKnot = function () { var m = this, N = m.highlight, Q = m.screenInfo.curve; Q.insertKnot(N.bezier, N.point.t), m._writeToHt() }, _h.prototype._writeToHt = function () { for (var g, o, W = this, d = W.screenInfo.curve, E = d.toHtShape(), j = E.points, e = [], V = E.segments, M = W._interactor.gv, k = W.target, J = k instanceof R.Edge, m = zq.getDataMatrix(k).invert(), y = 0, Q = j.length; Q > y; y++)g = j[y], o = zq.toWorldPosition(M, g), o = m.apply(o), e.push(o); if (k._writing = !0, J) { k.s("edge.type", "points"), k.setStyle("edge.segments", V), k.setStyle("edge.points", e.slice(1, e.length - 1)), k.setStyle("edge.source.offset.x", 0), k.setStyle("edge.source.offset.y", 0), k.setStyle("edge.target.offset.x", 0), k.setStyle("edge.target.offset.y", 0); var u = W._nextChangeEdgeHost; delete W._nextChangeEdgeHost, u && ("source" === u.type ? k.setSource(u.host) : k.setTarget(u.host)), W._writeEdgeHostAnchor("source", e[0]), W._writeEdgeHostAnchor("target", e[e.length - 1]) } else e.length ? (k.setSegments(V), k.setPoints(e, !0)) : k.removeFromDataModel(); delete k._writing }, _h.prototype._writeEdgeHostAnchor = function (S, I) { var j = this, L = j.target, s = j._calcHostAnchor(L, S, I); L.s("edge." + S + ".anchor.x", s.x), L.s("edge." + S + ".anchor.y", s.y) }, _h.prototype._calcHostAnchor = function (M, C, B, X) { X || (X = "source" === C ? M.getSource() : M.getTarget()); var v = X.getRotation(), q = X.getAnchor(), l = this._interactor.gv; if (Fb(X, l) && (v = 0), v) { var P = X.getMatrix(), n = P.tfi(B), A = X.getSize(); return { x: n.x / A.width + q.x, y: n.y / A.height + q.y } } var s = yl(l, X), e = { x: (B.x - s.x) / s.width, y: (B.y - s.y) / s.height }; return e }, _h.prototype._handlePanning = function (j) { var x = this, d = x._pan; if (d) { d.started = !0; var z = x._interactor, p = z.gv, M = z._lastClientPoint, C = gi(j); p.setTranslate(d.tx + C.x - M.x, d.ty + C.y - M.y), x.gatherSingleTarget(z.gv, x.target), z._42() } }, _h.prototype.handleEdit = function (o, S) { var $ = this, p = $.editing; if ($._pan) return $._handlePanning(S), void 0; if (p) { p.inEdit = !0; var M, Y, f = $._interactor._getLogicalPoint(S), U = R.Default.isCtrlDown(S), n = R.Default.isShiftDown(S); if ($._guideInfo = null, "ctrlPoint" === p.type && n) { var H = $.editing.direction.clone(); M = $.activing.point; var t = H.dot(f.clone().sub(M)); f = H.setLength(t).add(M) } else { var H; if ("realPoint" === p.type && n) { var z = $.editing.shiftGuide, _ = z.point, V = Math.abs(f.x - _.x), C = Math.abs(f.y - _.y); V > C && V > z.limit && "y" === z.dir && (z.dir = "x"), C > V && C > z.limit && "x" === z.dir && (z.dir = "y"), H = z.dir, "x" === H ? (f.y = _.y, z.limit = Math.max(z.limit, V)) : "y" === H && (f.x = _.x, z.limit = Math.max(z.limit, C)) } var B = $._isEditEdgeSourceTarget(); if (B) { var X = $._editEdgeSourceTarget(B, f, U); X && (Y = X.tipText) } else if (!U) { var a = $._guidingToEdit(f, H), J = "realPoint" === p.type ? $._interactor.gridGuide.findClosest(f, H, !0) : null, i = 1 / 0, g = 1 / 0; J && (J.x && (i = J.x), J.y && (g = J.y)); var y = !1; a && (a.xList && (Math.abs(a.x) <= Math.abs(i) ? (y = !0, i = a.x) : delete a.xList), a.yList && (Math.abs(a.y) <= Math.abs(g) ? (y = !0, g = a.y) : delete a.yList), y && ($._guideInfo = a)), isFinite(i) && (f.x += i), isFinite(g) && (f.y += g), y && (a.v = f) } } var q = $.screenInfo.curve; if ("realPoint" === p.type) { M = p.point, q.moveRealPoint(M, f), p.point = f, $.highlight.point = f; var h = $.activing.status, W = $.activing.selections; if ($.activing = { point: f, status: h }, W) { var T = f.clone().sub(M), D = 0; W.forEach(function (y) { var l = y.clone().add(T); q.moveRealPoint(y, l), W[D++] = l }), $.activing.selections = W } } else if ("ctrlPoint" === p.type) { var x = $.activing, s = x.pairs, d = s[p.pairId]; q.moveCtrlPoint(d, f, p.ctrlType); var u = x.status, l = zq.Curve.PointType; if ((u === l.Mirrored || u === l.Asymmetric) && d.c1 && d.c2) { var M = new zq.Math.Vector2(x.point), k = "c1" === p.ctrlType ? "c2" : "c1"; if (u === zq.Curve.PointType.Mirrored) q.moveCtrlPoint(d, M.clone().multiplyScalar(2).sub(f), k); else if (u === l.Asymmetric) { var t = d[k].clone().sub(M).length(), E = M.clone().sub(d[p.ctrlType]).setLength(t).add(M); isNaN(E.x) || q.moveCtrlPoint(d, E, k) } } } var c = R.Default.getLogicalPoint(S, $._interactor._canvas); if (c.x += zq.Icons.TipShiftX, c.y += zq.Icons.TipShiftY, !Y) { var Z = zq.toWorldPosition(o, f); Y = "" + zq.toFixed(Z.x) + ", " + zq.toFixed(Z.y) } $.tipInfo = { helperPos: c, text: Y, size: Y.length }, $._writeToHt() } }, _h.prototype._isEditEdgeSourceTarget = function () { var e = this, L = e.target; if (!(L instanceof R.Edge)) return !1; var l = e.editing.point, r = e.screenInfo.curve._curves; return l === r[0]._p1 ? "source" : l === r[r.length - 1]._p4 ? "target" : !1 }, _h.prototype._editEdgeSourceTarget = function (K, c, Y) { var M, W = this, s = W.target; if (M = "source" === K ? s.getSource() : s.getTarget()) { var N = W._interactor.gv, y = zq.toWorldPosition(N, c), x = W._calcHostAnchor(s, K, y, M); if (!Y) { var X = W._interactor.getStyle("anchorRound"), h = W._interactor.getStyle("anchorSensitivity"); x.x = zq.roundTo(x.x, X, h), x.y = zq.roundTo(x.y, X, h) } if (W._interactor.getStyle("edgeHostDetectPerFrame") || x.x < 0 || x.x > 1 || x.y < 0 || x.y > 1) { var F = N.getDataAt(y, function (m) { return N.isSelectable(m) ? $j(m) ? !0 : !1 : !1 }); if (F) { var $ = W._calcHostAnchor(s, K, y, F); M = F, W._nextChangeEdgeHost = { type: K, host: F }, x = $, Y || (x.x = zq.roundTo(x.x, X, h), x.y = zq.roundTo(x.y, X, h)) } } if (!Y) { var Z = yq(N, M, 0, 0, 0, x.x, x.y), D = zq.toScreenPosition(N, Z); c.x = D.x, c.y = D.y } var T, P = []; if (Fb(M, N)) { var E = yl(N, M); T = [{ x: E.x, y: E.y }, { x: E.x + E.width, y: E.y }, { x: E.x + E.width, y: E.y + E.height }, { x: E.x, y: E.y + E.height }] } else T = M.getCorners(); return T.forEach(function (q) { var b = zq.toScreenPosition(N, q); P.push(b.x, b.y) }), W._edgeHostGuideInfo = P, { host: M, anchor: x, tipText: "" + x.x.toFixed(2) + ", " + x.y.toFixed(2) } } }, _h.prototype._guidingToEdit = function (Z, h) { var s, I, v = this; if (s = v.screenInfo.curve) { I = s._curves; var G, m, g, A, d, _, q, $, b = 1 / 0, c = 1 / 0, C = []; for (v.editing && "realPoint" === v.editing.type && ($ = v.editing.point), d = 0, _ = 2 * I.length; _ > d; d++)q = I[Math.floor(d / 2)][d % 2 ? "_p4" : "_p1"], C.indexOf(q) >= 0 || (C.push(q), $ && $ === q || (g = q.x - Z.x, A = q.y - Z.y, Math.abs(g) < Math.abs(b) ? (b = g, G = [q]) : g === b && G.push(q), Math.abs(A) < Math.abs(c) ? (c = A, m = [q]) : A === c && m.push(q))); var W = v._interactor.getStyle("smartGuideSensitivity"); if ((Math.abs(b) > W || "y" === h) && (G = null), (Math.abs(c) > W || "x" === h) && (m = null), G || m) { var N = !1, S = {}; if (G && (N = !0, S.xList = G, S.x = b), m && (N = !0, S.yList = m, S.y = c), N) return S } } }, _h.prototype._46O = function () { var n = this; n.editing = null, n._guideInfo = null, n._edgeHostGuideInfo = null, n._pan = null, n.tipInfo = null }, _h.prototype._canDeletePoint = function (d, C) { var S = this.target; if (!(S instanceof R.Edge)) return !0; var f = d._curves[0], h = d._curves[d._curves.length - 1]; return f._p1 === C || h._p4 === C ? !1 : !0 }, _h.prototype.handleDelete = function () { var Q = this; if (Q.activing && Q.screenInfo) { var t = R.Default.isShiftDown(), u = Q.screenInfo.curve; Q._canDeletePoint(u, Q.activing.point) && u.deleteRealPoint(Q.activing.point, t), Q.activing.selections && Q.activing.selections.forEach(function (M) { Q._canDeletePoint(u, M) && u.deleteRealPoint(M, t) }), delete Q.activing, delete Q.editing, delete Q.tipInfo, delete Q._pan, Q._writeToHt(), Q._interactor.fp("deleteShapePoint", !1, !0) } }, _h.prototype.handleDoubleClick = function (i) { var N = this, f = N._interactor._getLogicalPoint(i); if (N.screenInfo && N._checkEditRealPoint(f)) { var o = N.getCurrentSelectintStatus(), t = zq.Curve.PointType; return o = o === t.Mirrored ? t.Straight : t.Mirrored, N.setCurrentSelectionStatus(o), N._interactor._42(), !0 } }, _h.prototype._drawHighlight = function (H) { var d = this, Z = d.highlight; if (Z) { var l = Z.bezier, E = d._interactor; l && zq.Icons.DrawIcon(E, H, zq.Icons.ShapeHighlightCurve, [l._p1.x, l._p1.y, l._p2.x, l._p2.y, l._p3.x, l._p3.y, l._p4.x, l._p4.y]); var S = Z.point; S && "insertKnot" === Z.type && zq.Icons.DrawIcon(E, H, zq.Icons.ShapeHighlighPoint, S) } }, _h.prototype._drawGuide = function (L) { var Y = this, D = Y._guideInfo; if (D) { var H, X, _, I, o = D.v; for (H = 0; 2 > H; H++)if (I = 0 === H ? D.xList : D.yList) for (X = 0, _ = I.length; _ > X; X++)zq.Icons.DrawIcon(Y._interactor, L, zq.Icons.ShapeGuideLine, [o.x, o.y, I[X].x, I[X].y]) } }, _h.prototype._drawCurrentPoint = function (P) { var S = this; if (S.activing) { var A = S.activing, B = S.getCurrentSelectintStatus(), D = S._interactor; if (B !== zq.Curve.PointType.Straight) { var y = A.pairs, j = A.hlpair, t = A.hltype, o = A.selections; if (y && !o) { var L, x, q; for (x = 0, q = y.length; q > x; x++)L = y[x], x === j && L[t] ? zq.Icons.DrawIcon(D, P, zq.Icons.ShapeActivingCtrl, { point: L.point, c1: L.c1, c2: L.c2, hl: t }) : zq.Icons.DrawIcon(D, P, zq.Icons.ShapeActivingCtrl, L) } } zq.Icons.DrawIcon(D, P, zq.Icons.ShapeHighlighRealPoint, S.activing.point), o && o.forEach(function (C) { zq.Icons.DrawIcon(D, P, zq.Icons.ShapeHighlighRealPoint, C) }) } }, _h.prototype.clear = function () { var E = this; E.editing = null, E._guideInfo = null, E.activing = null, E.highlight = null }, _h.prototype._42 = function (Y) { var l = this; l.info = {}, l.editing || (l.screenInfo = null); var J = l._interactor; return J.editDetail ? l.target && l._interactor.gv.isSelected(l.target) && l._interactor.gv.isVisible(l.target) ? (l.gatherSingleTarget(J.gv, l.target), zq.Icons.DrawIcon(J, Y, zq.Icons.ShapeBgCurve, l.screenInfo), l._drawHighlight(Y), l._drawCurrentPoint(Y), l._getRealPoint().forEach(function (E) { zq.Icons.DrawIcon(J, Y, zq.Icons.ShapePoint, E) }), l._drawGuide(Y), l.tipInfo && zq.Icons.DrawIcon(J, Y, zq.Icons.TipHelper, l.tipInfo), l._edgeHostGuideInfo && zq.Icons.DrawIcon(J, Y, zq.Icons.EdgeHostGuide, l._edgeHostGuideInfo), void 0) : (J.editDetail = !1, l.clear(), void 0) : (l.clear(), void 0) }, _h.prototype._getRealPoint = function () { var P = this.screenInfo, j = P.P, z = P.S, O = -1, D = []; return z.each(function (y) { var M = 1; if (3 === y) M = 2; else if (4 === y) M = 3; else if (5 === y) return; O += M, D.push({ x: j[2 * O], y: j[2 * O + 1] }) }), D }; var to = zq.MoveHelper = function ($) { var u = this; u.catalog = "Move", u._interactor = $ }; to.prototype = {}, to.prototype.constructor = to, to.prototype.calcShift = function (b, U, y) { var m, u, v = this, g = v._interactor.gv, H = g.lp(U); if ("beginMove" === b && v._gatherGridInfo(y._lastLogicalPoint || H), m = v._target) { var M = m.downPosition; if (M) { var c = v._interactor.getStyle("moveSensitivity") / g._zoom; if (M.distanceTo(H) < c) return { x: 0, y: 0 }; delete m.downPosition } var t; u = R.Default.isShiftDown(U), u && (H = v._dealShiftDown(H), t = m.shiftGuide.dir); var B, r = m.rawPos = { x: m.pos.x + H.x - m.lp.x, y: m.pos.y + H.y - m.lp.y }; if (R.Default.isCtrlDown(U)) { if (B = v._calcShiftByAddon(), v._target.node instanceof zq.Group) { var e = v._target.node; e._position.x += B.x, e._position.y += B.y } return B } for (var j, A = m.x + r.x, _ = m.y + r.y, h = { x: A, y: _ }, z = { x: A + m.w / 2, y: _ + m.h / 2 }, Q = { x: A + m.w, y: _ + m.h }, o = v._interactor.rectGuide, W = v._interactor.gridGuide, E = [o.findClosest(h, t), o.findClosest(z, t), o.findClosest(Q, t), W.findClosest(h, t), W.findClosest(z, t), W.findClosest(Q, t)], X = 1 / 0, l = 1 / 0, n = 0, S = E.length; S > n; n++)j = E[n], j && (A = j.x, _ = j.y, isFinite(A) && Math.abs(A) < Math.abs(X) && (X = A), isFinite(_) && Math.abs(_) < Math.abs(l) && (l = _)); if (isFinite(X) || (X = 0), isFinite(l) || (l = 0), B = v._calcShiftByAddon(X, l), v._target.node instanceof zq.Group) { var e = v._target.node; e._position.x += B.x, e._position.y += B.y } var d = m.node; if (!Fb(d, g)) { var i = r.x + X, C = r.y + l; v._interactor.rectGuide.gatherLines({ node: d, x: m.x + i, y: m.y + C, w: m.w, h: m.h }, t) } return B } }, to.prototype._calcShiftByAddon = function (e, n) { var u = this._target, F = u.rawPos, q = u.node.getPosition(); return e = e || 0, n = n || 0, { x: F.x - q.x + e, y: F.y - q.y + n } }, to.prototype._dealShiftDown = function (X) { var F = this, I = F._target.shiftGuide, T = F._target.lp, Z = Math.abs(X.x - T.x), q = Math.abs(X.y - T.y); Z > q && Z > I.limit && "y" === I.dir && (I.dir = "x"), q > Z && q > I.limit && "x" === I.dir && (I.dir = "y"); var M = I.dir; return "x" === M ? (X.y = T.y, I.limit = Math.max(I.limit, Z)) : "y" === M && (X.x = T.x, I.limit = Math.max(I.limit, q)), X }, to.prototype._gatherGridInfo = function (p) { var X, j = this, y = j._interactor, L = y._getValidSelection(); if (1 === L.length) { if (X = L[0], !X.getRect) return j._target = null, void 0 } else if (X = zq.Group.findOrCreateGroup(L), !X) return j._target = null, void 0; var M = X.getPosition(), g = X.getRect(); j._target = { node: X, x: g.x - M.x, y: g.y - M.y, w: g.width, h: g.height, lp: { x: p.x, y: p.y }, pos: { x: M.x, y: M.y }, shiftGuide: { dir: "x", limit: 0 }, downPosition: new zq.Math.Vector2(p) }, y.rectGuide.gatherRects() }, to.prototype.clear = function () { var $ = this; $._interactor.rectGuide.clear(), $._interactor._42() }; var mg = "directional", Pq = "point", ug = "spot", uf = "light.color"; _i(m, { graph3dViewAttributes: l, graph3dViewFirstPersonMode: !1, graph3dViewMouseRoamable: !0, graph3dViewMoveStep: 15, graph3dViewRotateStep: s / 60, graph3dViewPannable: !0, graph3dViewRotatable: !0, graph3dViewWalkable: !0, graph3dViewResettable: !0, graph3dViewZoomable: !0, graph3dViewRectSelectable: !0, graph3dViewRectSelectBackground: oh, graph3dViewGridVisible: !1, graph3dViewGridSize: 50, graph3dViewGridGap: 50, graph3dViewGridColor: [.4, .75, .85, 1], graph3dViewOriginAxisVisible: !1, graph3dViewCenterAxisVisible: !1, graph3dViewAxisXColor: [1, 0, 0, 1], graph3dViewAxisYColor: [0, 1, 0, 1], graph3dViewAxisZColor: [0, 0, 1, 1], graph3dViewEditSizeColor: [1, 1, 0, 1], graph3dViewOrtho: !1, graph3dViewOrthoWidth: 2e3, graph3dViewFovy: s / 4, graph3dViewNear: 10, graph3dViewFar: 1e4, graph3dViewEye: [0, 300, 1e3], graph3dViewCenter: [0, 0, 0], graph3dViewUp: [0, 1, -1e-7], graph3dViewHeadlightRange: 0, graph3dViewHeadlightColor: [1, 1, 1, 1], graph3dViewHeadlightIntensity: 1, graph3dViewHeadlightDisabled: !1, graph3dViewFogDisabled: !0, graph3dViewFogColor: "white", graph3dViewFogNear: 1, graph3dViewFogFar: 2e3, graph3dViewDashDisabled: !0, graph3dViewBatchBlendDisabled: !0, graph3dViewBatchBrightnessDisabled: !0, graph3dViewBatchColorDisabled: !1, setShape3dModel: function (g, Z) { Rm[g] = Z }, getShape3dModel: function (N) { return Rm[N] }, createMatrix: function (D, G) { sp(D) || (D = [D]); for (var Z = D.length - 1; Z >= 0; Z--) { var C = D[Z]; G = no(C.mat, C.s3, C.r3, C.rotationMode, C.t3, G) } return G }, transformVec: function (j, Z) { return Me(j, Z) }, createBoxModel: function () { return { vs: cr, ns: ud, uv: Ci, is: aj } }, createRoundRectModel: function (F, G) { return Yl.roundRect(F, G) }, createStarModel: function (a, q) { return Yl.star(a, q) }, createRectModel: function (G, W) { return Yl.rect(G, W) }, createTriangleModel: function (d, K) { return Yl.triangle(d, K) }, createRightTriangleModel: function (h, M) { return Yl.rightTriangle(h, M) }, createParallelogramModel: function (S, C) { return Yl.parallelogram(S, C) }, createTrapezoidModel: function (w, e) { return Yl.trapezoid(w, e) }, createSmoothSphereModel: function (C, U, L, l, E, J, A) { return rd(new Zj(C, U, L, l, E, J, A)) }, createSphereModel: function (F, u, O, p, M, l) { return F ? Lg(F, u, O, p, M, l) : m.createSmoothSphereModel() }, createSmoothConeModel: function (Q, p, O, w, a) { return Dg(Q, p, O, w, a) }, createConeModel: function (F, b, _, Z, h, A) { return F ? Ar(F, b, _, Z, h, A) : Dg(A) }, createSmoothCylinderModel: function ($, h, b, H, Y, t, A, O) { return rd(new sj($, h, b, H, Y, t, A, O)) }, createCylinderModel: function (v, b, w, g, i, f, Q) { return v ? wn(v, b, w, g, i, f, Q) : sl(f, Q) }, createSmoothTorusModel: function (G, j, J, O, I, b) { return rd(new sm(G, j, J, O, I, b)) }, createTorusModel: function (n, s, e, p, $, h, D) { return n ? Hf(n, s, e, p, $, h, D) : Cf(h, D) }, createExtrusionModel: function (a, $, r, t, Z, E, L, z) { return hl(a, $, r, t, Z, E, L, z) }, createSmoothRingModel: function (Z, a, X, r, P, z) { for (var B = [], R = 0; R < Z.length - 1; R += 2)B.push({ x: Z[R], y: Z[R + 1] }); for (Z = di(B, a, X)[0], B = [], R = 0; R < Z.length; R++) { var D = Z[R]; B.push(new lc(D.x, 0, D.y)) } return rd(new re(B, z, r, P)) }, createTextGeometry: function (i, O) { return rd(new Wk(i, O)) }, loadFontFace: function (j, u) { m.xhrLoad(j, function (q) { if (!q) return u(); var l; try { l = JSON.parse(q) } catch (g) { l = JSON.parse(q.substring(65, q.length - 2)) } Vc.loadFace(l), u && u(l.familyName.toLowerCase()) }, u ? null : { sync: !0 }) }, createRingModel: function (Z, s, k, X, n, K, i, c, W, B) { for (var $ = [], I = 0; I < Z.length - 1; I += 2)$.push({ x: Z[I], y: Z[I + 1] }); K = K || m.shapeSide, i = i || 0, c = c || K; var Y, a, p, M, L, x, z, T, A, J, I, P, w, E, y, g, h, f, G = [], r = [], N = W ? [] : l, u = W ? [] : l, F = B ? [] : l, j = B ? [] : l, U = X ? [] : l, v = X ? [] : l, Q = n ? [] : l, q = n ? [] : l, Z = di($, s, k), V = ad(Z), H = 0, e = 2 * Math.PI / K; return Z.forEach(function (k) { if (p = k.length, p > 1) { if (M = k[0], X) for (x = M.x, T = M.y, I = i; c > I; I++)P = I + 1, w = I * e, E = P * e, y = S(w), g = t(w), h = S(E), f = t(E), U.push(y * x, T, -g * x, h * x, T, -f * x, 0, T, 0), v.push(.5 - .5 * y, .5 - .5 * g, .5 - .5 * h, .5 - .5 * f, .5, .5); for (J = 0; p > J; J++) { for (L = k[J], x = M.x, z = L.x, T = M.y, A = L.y, Y = H / V, H += Bk(M, L), a = H / V, I = i; c > I; I++)P = I + 1, w = I * e, E = P * e, y = S(w), g = t(w), h = S(E), f = t(E), G.push(y * z, A, -g * z, h * z, A, -f * z, y * x, T, -g * x, h * z, A, -f * z, h * x, T, -f * x, y * x, T, -g * x), r.push(I / K, a, P / K, a, I / K, Y, P / K, a, P / K, Y, I / K, Y), W && I === i && (N.push(0, T, 0, 0, A, 0, y * z, A, -g * z, y * z, A, -g * z, y * x, T, -g * x, 0, T, 0), u.push(0, .5 - T, 0, .5 - A, 2 * z, .5 - A, 2 * z, .5 - A, 2 * x, .5 - T, 0, .5 - T)), B && P === c && (F.push(0, T, 0, h * z, A, -f * z, 0, A, 0, h * z, A, -f * z, 0, T, 0, h * x, T, -f * x), j.push(1, .5 - T, 1 - 2 * z, .5 - A, 1, .5 - A, 1 - 2 * z, .5 - A, 1, .5 - T, 1 - 2 * x, .5 - T)); M = L } if (n) for (x = M.x, T = M.y, I = i; c > I; I++)P = I + 1, w = I * e, E = P * e, y = S(w), g = t(w), h = S(E), f = t(E), Q.push(h * x, T, -f * x, y * x, T, -g * x, 0, T, 0), q.push(.5 - .5 * h, .5 + .5 * f, .5 - .5 * y, .5 + .5 * g, .5, .5) } }), { vs: G, uv: r, bottom_vs: Q, bottom_uv: q, top_vs: U, top_uv: v, from_vs: N, from_uv: u, to_vs: F, to_uv: j } } }, !0), _i(M, { "3d.move.mode": Z, "3d.selectable": !0, "3d.visible": !0, "3d.movable": !0, "3d.editable": !0, "shape.border.gradient.color": Z, "edge.gradient.color": Z, "edge.source.t3": Z, "edge.target.t3": Z, "light.type": Pq, "light.center": [0, 0, 0], "light.color": [1, 1, 1, 1], "light.disabled": !1, "light.angle": s / 4, "light.range": 0, "light.exponent": 1, "light.intensity": 1, "wf.visible": !1, "wf.width": 1, "wf.color": cl, "wf.short": !1, "wf.mat": Z, batch: Z, "transparent.mask": !1, brightness: Z, "select.brightness": .7, "repeat.uv.length": Z, "label.face": Mb, "label.t3": Z, "label.r3": Z, "label.texture.scale": 2, "label.rotationMode": Wi, "label.light": !1, "label.blend": Z, "label.reverse.flip": !1, "label.reverse.color": Lq, "label.reverse.cull": !1, "label.transparent": !1, "label.autorotate": !1, "label2.face": Mb, "label2.t3": Z, "label2.r3": Z, "label2.texture.scale": 2, "label2.rotationMode": Wi, "label2.light": !1, "label2.blend": Z, "label2.reverse.flip": !1, "label2.reverse.color": Lq, "label2.reverse.cull": !1, "label2.transparent": !1, "label2.autorotate": !1, "note.face": Mb, "note.t3": Z, "note.r3": Z, "note.texture.scale": 2, "note.rotationMode": Wi, "note.light": !1, "note.blend": Z, "note.reverse.flip": !1, "note.reverse.color": Lq, "note.reverse.cull": !1, "note.transparent": !1, "note.autorotate": !1, "note2.face": Mb, "note2.t3": Z, "note2.r3": Z, "note2.texture.scale": 2, "note2.rotationMode": Wi, "note2.light": !1, "note2.blend": Z, "note2.reverse.flip": !1, "note2.reverse.color": Lq, "note2.reverse.cull": !1, "note2.transparent": !1, "note2.autorotate": !1, shape3d: Z, "shape3d.color": ph, "shape3d.top.color": Z, "shape3d.bottom.color": Z, "shape3d.from.color": Z, "shape3d.to.color": Z, "shape3d.image": Z, "shape3d.top.image": Z, "shape3d.bottom.image": Z, "shape3d.from.image": Z, "shape3d.to.image": Z, "shape3d.light": !0, "shape3d.side": 0, "shape3d.side.from": Z, "shape3d.side.to": Z, "shape3d.visible": !0, "shape3d.from.visible": !0, "shape3d.to.visible": !0, "shape3d.top.visible": !0, "shape3d.bottom.visible": !0, "shape3d.torus.radius": .17, "shape3d.resolution": 0, "shape3d.blend": Z, "shape3d.opacity": Z, "shape3d.reverse.flip": !1, "shape3d.reverse.color": Lq, "shape3d.reverse.cull": !1, "shape3d.transparent": !1, "shape3d.uv.offset": Z, "shape3d.uv.scale": Z, "shape3d.top.uv.offset": Z, "shape3d.top.uv.scale": Z, "shape3d.bottom.uv.offset": Z, "shape3d.bottom.uv.scale": Z, "shape3d.from.uv.offset": Z, "shape3d.from.uv.scale": Z, "shape3d.to.uv.offset": Z, "shape3d.to.uv.scale": Z, "shape3d.top.cap": Z, "shape3d.bottom.cap": Z, "shape3d.start.angle": 0, "shape3d.sweep.angle": B, "shape3d.discard.selectable": !0, "shape3d.top.discard.selectable": !0, "shape3d.bottom.discard.selectable": !0, "shape3d.from.discard.selectable": !0, "shape3d.to.discard.selectable": !0, "shape3d.scaleable": !0, "all.light": !0, "all.visible": !0, "all.color": ph, "all.image": Z, "all.blend": Z, "all.opacity": Z, "all.reverse.flip": !1, "all.reverse.color": Lq, "all.reverse.cull": !1, "all.transparent": !1, "all.uv": Z, "all.uv.offset": Z, "all.uv.scale": Z, "all.discard.selectable": !0, mat: Z, "left.mat": Z, "right.mat": Z, "top.mat": Z, "bottom.mat": Z, "front.mat": Z, "back.mat": Z }, !0); var Le, Hk = !1, Zi = [0, 0, 0, 1 / 255], es = { left: [1 / 255, 0, 0, 1], right: [2 / 255, 0, 0, 1], top: [3 / 255, 0, 0, 1], bottom: [4 / 255, 0, 0, 1], front: [5 / 255, 0, 0, 1], back: [6 / 255, 0, 0, 1], m: { 1: Xr, 2: kf, 3: ys, 4: yn, 5: Mb, 6: ak } }, lr = function (n, k, d, y) { if (k.getFaceVisible(n, d)) { Hq(k, wo(n, k.getFaceMat(n, d) || k.getMat(n))); var i = k._26I; k.getFaceReverseCull(n, d) ? i.enable(i.CULL_FACE) : i.disable(i.CULL_FACE), kp(i, k._prg.uFixPickReverseColor, es[d]), Yo(i), ql(i, y, 6), ue(i), Nd(k) } }, Yg = function (v) { return v instanceof fs }, Sr = function (M) { return [M.x, M.e || 0, M.y] }, ck = function (G, f, h) { for (var f = db(f), Z = f[0], b = f[1], m = f[2]; h--;)G.push(Z, b, m) }, fq = function (i, B, x) { for (var B = db(B), Y = B[0], h = B[1], F = B[2], L = B[3]; x--;)i.push(Y, h, F, L) }, Lm = function (w, l, L) { if (l) for (var s, T, i, x = l[0], W = l[1], E = l[2], K = l[4], B = l[5], v = l[6], Q = l[8], z = l[9], R = l[10], M = l[12], $ = l[13], t = l[14], U = L.length, j = 0, j = 0; U > j; j += 3)s = L[j], T = L[j + 1], i = L[j + 2], w.push(x * s + K * T + Q * i + M, W * s + B * T + z * i + $, E * s + v * T + R * i + t); else an(w, L) }, Hc = function (z, T) { var E = T.s("light.intensity"), d = db(T.s(uf)), u = d[0], f = d[1], X = d[2]; 1 !== E && (u *= E, f *= E, X *= E), z.push(u, f, X, T.s("light.disabled") ? 1 : 0) }, Rn = function (O, e, v) { kp(e, v.uHeadlightRange, O._headlightRange); var h = O._headlightIntensity, n = db(O._headlightColor); 1 !== h && (n = [n[0] * h, n[1] * h, n[2] * h]), kp(e, v.uHeadlightColor, [n[0], n[1], n[2], O._headlightDisabled ? 1 : 0]); var Q = O._59O, r = O._spots, o = O._dirs; if (Q.length) { var B = [], X = [], w = []; Q.forEach(function (r) { Hc(B, r), an(X, r.p3()), w.push(r.s("light.range")) }), e.uniform4fv(v.uPointColor, B), e.uniform1fv(v.uPointRange, w), e.uniform3fv(v.uPointPosition, X) } if (r.length) { var i = [], T = [], G = [], A = [], J = [], V = []; r.forEach(function (K) { Hc(i, K), an(T, K.p3()), an(G, K.s("light.center")), A.push(K.s("light.range")), J.push(S(K.s("light.angle") / 2)), V.push(K.s("light.exponent")) }), e.uniform4fv(v.uSpotColor, i), e.uniform1fv(v.uSpotRange, A), e.uniform1fv(v.uSpotAngle, J), e.uniform1fv(v.uSpotExponent, V), e.uniform3fv(v.uSpotPosition, T), e.uniform3fv(v.uSpotCenter, G) } if (o.length) { var D = [], I = []; o.forEach(function (B) { Hc(D, B), an(I, B.p3()) }), e.uniform4fv(v.uDirColor, D), e.uniform3fv(v.uDirPosition, I) } }, am = function (W) { return W > 0 && 0 === (W - 1 & W) }, hn = function (O) { return O = g(0, b(s, O)), O = g(Rc, b(s - Rc, O)) }, Zo = function () { return .05 + J() / 2 }, Ee = function (q, f, y, V) { var m, a = q.getEye(); return q.isOrtho() ? (m = gs(q.getCenter(), a), m[0] += V[0], m[1] += V[1], m[2] += V[2]) : m = a, lq(f, y, V, m) }, lq = function (F, Y, t, m) { var g = Wl(F, Y), Z = gs(m, t, !0), y = Wl(Z, Y); if (A(y) < Rc) return l; var D = (g - Wl(t, Y)) / y; return [t[0] + Z[0] * D, t[1] + Z[1] * D, t[2] + Z[2] * D] }, ek = function (C, E) { return { x: 2 * C.x - E.x, y: 2 * C.y - E.y } }, Rf = function (g, B, y, q) { var Q, N; if (!g) return Q = I(B.y - y.y, y.x - B.x), { x: B.x + q * t(Q), y: B.y + q * S(Q) }; if (!y) return Q = I(g.y - B.y, B.x - g.x), { x: B.x + q * t(Q), y: B.y + q * S(Q) }; var P = gs([g.x, g.y, 0], [B.x, B.y, 0], !0), V = gs([y.x, y.y, 0], [B.x, B.y, 0], !0), u = -(P[0] + V[0]) / 2, U = -(P[1] + V[1]) / 2, h = o(u * u + U * U); if (Rc > h) return Q = I(g.y - B.y, B.x - g.x), { x: B.x + q * t(Q), y: B.y + q * S(Q) }; var _ = g.x - B.x, x = g.y - B.y, O = y.x - B.x, W = y.y - B.y, A = o(Math.min(_ * _ + x * x, O * O + W * W)); return Q = E(Wl(P, V)) / 2, N = P[1] * V[0] - P[0] * V[1] > 0 ? -1 : 1, u /= h, U /= h, h = Math.min(q / t(Q), A / S(Q)), { x: B.x + N * h * u, y: B.y + N * h * U } }, lo = function (b) { var H = b[1], P = b[2], J = b[3], z = b[6], n = b[7], y = b[11]; b[1] = b[4], b[2] = b[8], b[3] = b[12], b[4] = H, b[6] = b[9], b[7] = b[13], b[8] = P, b[9] = z, b[11] = b[14], b[12] = J, b[13] = n, b[14] = y }, rf = function (h) { var k = h[0], $ = h[1], D = h[2], i = h[3], w = h[4], z = h[5], a = h[6], T = h[7], b = h[8], r = h[9], G = h[10], K = h[11], F = h[12], d = h[13], B = h[14], R = h[15], o = k * z - $ * w, f = k * a - D * w, g = k * T - i * w, X = $ * a - D * z, L = $ * T - i * z, V = D * T - i * a, _ = b * d - r * F, c = b * B - G * F, I = b * R - K * F, J = r * B - G * d, p = r * R - K * d, A = G * R - K * B, O = o * A - f * p + g * J + X * I - L * c + V * _; return O ? (O = 1 / O, h[0] = (z * A - a * p + T * J) * O, h[1] = (D * p - $ * A - i * J) * O, h[2] = (d * V - B * L + R * X) * O, h[3] = (G * L - r * V - K * X) * O, h[4] = (a * I - w * A - T * c) * O, h[5] = (k * A - D * I + i * c) * O, h[6] = (B * g - F * V - R * f) * O, h[7] = (b * V - G * g + K * f) * O, h[8] = (w * p - z * I + T * _) * O, h[9] = ($ * I - k * p - i * _) * O, h[10] = (F * L - d * g + R * o) * O, h[11] = (r * g - b * L - K * o) * O, h[12] = (z * c - w * J - a * _) * O, h[13] = (k * J - $ * c + D * _) * O, h[14] = (d * f - F * X - B * o) * O, h[15] = (b * X - r * f + G * o) * O, void 0) : l }, Gq = function (f, R) { if (R) { var s = R[0], G = R[1], l = R[2]; f[12] = f[0] * s + f[4] * G + f[8] * l + f[12], f[13] = f[1] * s + f[5] * G + f[9] * l + f[13], f[14] = f[2] * s + f[6] * G + f[10] * l + f[14], f[15] = f[3] * s + f[7] * G + f[11] * l + f[15] } }, Fj = function (L, s) { if (s) { var b = s[0], k = s[1], m = s[2]; L[0] = L[0] * b, L[1] = L[1] * b, L[2] = L[2] * b, L[3] = L[3] * b, L[4] = L[4] * k, L[5] = L[5] * k, L[6] = L[6] * k, L[7] = L[7] * k, L[8] = L[8] * m, L[9] = L[9] * m, L[10] = L[10] * m, L[11] = L[11] * m } }, ri = function (o, $, I) { var l = $[0], C = $[1], B = $[2], X = $[3], M = $[4], N = $[5], U = $[6], t = $[7], V = $[8], w = $[9], S = $[10], L = $[11], r = $[12], c = $[13], O = $[14], y = $[15], J = I[0], p = I[1], Q = I[2], i = I[3]; return o[0] = J * l + p * M + Q * V + i * r, o[1] = J * C + p * N + Q * w + i * c, o[2] = J * B + p * U + Q * S + i * O, o[3] = J * X + p * t + Q * L + i * y, J = I[4], p = I[5], Q = I[6], i = I[7], o[4] = J * l + p * M + Q * V + i * r, o[5] = J * C + p * N + Q * w + i * c, o[6] = J * B + p * U + Q * S + i * O, o[7] = J * X + p * t + Q * L + i * y, J = I[8], p = I[9], Q = I[10], i = I[11], o[8] = J * l + p * M + Q * V + i * r, o[9] = J * C + p * N + Q * w + i * c, o[10] = J * B + p * U + Q * S + i * O, o[11] = J * X + p * t + Q * L + i * y, J = I[12], p = I[13], Q = I[14], i = I[15], o[12] = J * l + p * M + Q * V + i * r, o[13] = J * C + p * N + Q * w + i * c, o[14] = J * B + p * U + Q * S + i * O, o[15] = J * X + p * t + Q * L + i * y, o }, kn = function (t, i, h, k) { var W, x, B, S, O, v, V, D, e, r, M = i[0], z = i[1], H = i[2], j = k[0], F = k[1], T = k[2], E = h[0], w = h[1], R = h[2]; return A(M - E) < Rc && A(z - w) < Rc && A(H - R) < Rc ? Se(t) : (V = M - E, D = z - w, e = H - R, r = 1 / o(V * V + D * D + e * e), V *= r, D *= r, e *= r, W = F * e - T * D, x = T * V - j * e, B = j * D - F * V, r = o(W * W + x * x + B * B), r ? (r = 1 / r, W *= r, x *= r, B *= r) : (W = 0, x = 0, B = 0), S = D * B - e * x, O = e * W - V * B, v = V * x - D * W, r = o(S * S + O * O + v * v), r ? (r = 1 / r, S *= r, O *= r, v *= r) : (S = 0, O = 0, v = 0), t[0] = W, t[1] = S, t[2] = V, t[3] = 0, t[4] = x, t[5] = O, t[6] = D, t[7] = 0, t[8] = B, t[9] = v, t[10] = e, t[11] = 0, t[12] = -(W * M + x * z + B * H), t[13] = -(S * M + O * z + v * H), t[14] = -(V * M + D * z + e * H), t[15] = 1, t) }, Jp = function ($, B, R, u, r) { var D = 1 / z(B / 2), G = 1 / (u - r); return $[0] = D / R, $[1] = 0, $[2] = 0, $[3] = 0, $[4] = 0, $[5] = D, $[6] = 0, $[7] = 0, $[8] = 0, $[9] = 0, $[10] = (r + u) * G, $[11] = -1, $[12] = 0, $[13] = 0, $[14] = 2 * r * u * G, $[15] = 0, $ }, sh = function (V, A, C, $, Z, U, s) { var I = 1 / (A - C), N = 1 / ($ - Z), i = 1 / (U - s); return V[0] = -2 * I, V[1] = 0, V[2] = 0, V[3] = 0, V[4] = 0, V[5] = -2 * N, V[6] = 0, V[7] = 0, V[8] = 0, V[9] = 0, V[10] = 2 * i, V[11] = 0, V[12] = (A + C) * I, V[13] = (Z + $) * N, V[14] = (s + U) * i, V[15] = 1, V }, In = function (r, V) { var T = V[0], K = V[1], F = V[2], n = V[3], v = T * T + K * K + F * F + n * n, p = v ? 1 / v : 0; return r[0] = -T * p, r[1] = -K * p, r[2] = -F * p, r[3] = n * p, r }, We = function (A, x) { var h = x[0] + x[5] + x[10], H = 0; return h > 0 ? (H = 2 * Math.sqrt(h + 1), A[3] = .25 * H, A[0] = (x[6] - x[9]) / H, A[1] = (x[8] - x[2]) / H, A[2] = (x[1] - x[4]) / H) : x[0] > x[5] & x[0] > x[10] ? (H = 2 * Math.sqrt(1 + x[0] - x[5] - x[10]), A[3] = (x[6] - x[9]) / H, A[0] = .25 * H, A[1] = (x[1] + x[4]) / H, A[2] = (x[8] + x[2]) / H) : x[5] > x[10] ? (H = 2 * Math.sqrt(1 + x[5] - x[0] - x[10]), A[3] = (x[8] - x[2]) / H, A[0] = (x[1] + x[4]) / H, A[1] = .25 * H, A[2] = (x[6] + x[9]) / H) : (H = 2 * Math.sqrt(1 + x[10] - x[0] - x[5]), A[3] = (x[1] - x[4]) / H, A[0] = (x[8] + x[2]) / H, A[1] = (x[6] + x[9]) / H, A[2] = .25 * H), A }, $q = function (f, l, U) { var i = l[0], B = l[1], J = l[2], $ = l[3], I = i + i, R = B + B, P = J + J, j = i * I, b = i * R, G = i * P, r = B * R, d = B * P, C = J * P, n = $ * I, t = $ * R, v = $ * P; return f[0] = 1 - (r + C), f[1] = b + v, f[2] = G - t, f[3] = 0, f[4] = b - v, f[5] = 1 - (j + C), f[6] = d + n, f[7] = 0, f[8] = G + t, f[9] = d - n, f[10] = 1 - (j + r), f[11] = 0, f[12] = U[0], f[13] = U[1], f[14] = U[2], f[15] = 1, f }, Qb = function (L, d) { return kn(d ? d : Nq(), L._eye, L._center, L._up) }, Ge = function (f) { var z = f.getAspect(), n = f._near, B = f._far, m = Nq(); if (f._ortho) { var s = f._orthoWidth / 2, x = s / z; sh(m, -s, s, -x, x, n, B) } else Jp(m, f._fovy, z, n, B); return m }, tq = function (C, k) { if (!C) return l; var D = 0, c = 1, F = 2, I = [], P = 0, g = C.length, L = g / 3; if (k) { for (; g > P; P++)I[P] = 0; for (P = 0; P < k.length; P += 3) { var j = [], Y = [], z = []; j[D] = C[3 * k[P + 1] + D] - C[3 * k[P] + D], j[c] = C[3 * k[P + 1] + c] - C[3 * k[P] + c], j[F] = C[3 * k[P + 1] + F] - C[3 * k[P] + F], Y[D] = C[3 * k[P + 2] + D] - C[3 * k[P + 1] + D], Y[c] = C[3 * k[P + 2] + c] - C[3 * k[P + 1] + c], Y[F] = C[3 * k[P + 2] + F] - C[3 * k[P + 1] + F], z[D] = j[c] * Y[F] - j[F] * Y[c], z[c] = j[F] * Y[D] - j[D] * Y[F], z[F] = j[D] * Y[c] - j[c] * Y[D]; for (var w = 0; 3 > w; w++)I[3 * k[P + w] + D] += z[D], I[3 * k[P + w] + c] += z[c], I[3 * k[P + w] + F] += z[F] } } else for (P = 0; L > P; P += 3) { var j = [], Y = [], z = []; j[D] = C[3 * (P + 1) + D] - C[3 * P + D], j[c] = C[3 * (P + 1) + c] - C[3 * P + c], j[F] = C[3 * (P + 1) + F] - C[3 * P + F], Y[D] = C[3 * (P + 2) + D] - C[3 * (P + 1) + D], Y[c] = C[3 * (P + 2) + c] - C[3 * (P + 1) + c], Y[F] = C[3 * (P + 2) + F] - C[3 * (P + 1) + F], z[D] = j[c] * Y[F] - j[F] * Y[c], z[c] = j[F] * Y[D] - j[D] * Y[F], z[F] = j[D] * Y[c] - j[c] * Y[D]; for (var w = 0; 3 > w; w++)I[3 * (P + w) + D] = z[D], I[3 * (P + w) + c] = z[c], I[3 * (P + w) + F] = z[F] } for (P = 0; g > P; P += 3) { var b = []; b[D] = I[P + D], b[c] = I[P + c], b[F] = I[P + F]; var N = o(b[D] * b[D] + b[c] * b[c] + b[F] * b[F]); 0 === N && (N = Rc), b[D] = b[D] / N, b[c] = b[c] / N, b[F] = b[F] / N, I[P + D] = b[D], I[P + c] = b[c], I[P + F] = b[F] } return new ub(I) }, $b = function (Y, T, e) { if (e || (e = Y.createTexture()), T) { var M = Y.TEXTURE_2D, q = Y.LINEAR, k = Y.REPEAT, x = Y.CLAMP_TO_EDGE, n = Y.TEXTURE_MIN_FILTER; de(Y, e), Y.texImage2D(M, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, T), hc(Y, Y.TEXTURE_MAG_FILTER, q), am(T.width) && am(T.height) ? (hc(Y, Y.TEXTURE_WRAP_S, k), hc(Y, Y.TEXTURE_WRAP_T, k), hc(Y, n, Y.LINEAR_MIPMAP_LINEAR), Y.generateMipmap(M)) : (hc(Y, Y.TEXTURE_WRAP_S, x), hc(Y, Y.TEXTURE_WRAP_T, x), hc(Y, n, q)), de(Y, l) } return e }, tc = function (X, t) { var p = new Uint8Array(3); return t = t || X.createTexture(), de(X, t), hc(X, X.TEXTURE_MIN_FILTER, X.LINEAR), X.texImage2D(X.TEXTURE_2D, 0, X.RGB, 1, 1, 0, X.RGB, X.UNSIGNED_BYTE, p), t }, xr = function (Z) { Z._26I && Z._prg && (Z._26I.deleteProgram(Z._prg), Z._prg = l) }, Jn = function (x, e, h, B) { var P = x.createShader(h); return x.shaderSource(P, B), x.compileShader(P), x.attachShader(e, P), P }, gd = function (m) { return m.createBuffer() }, de = function (Y, v) {
            Y.bindTexture(Y.TEXTURE_2D, v)
        }, pk = function (T, E) { T.bindFramebuffer(T.FRAMEBUFFER, E) }, hc = function (p, m, u) { p.texParameteri(p.TEXTURE_2D, m, u) }, Td = function (X, G) { if (G) { var G = db(G); X.clearColor(G[0], G[1], G[2], G[3]) } }, td = function (c, z) { kp(c, z.uFix, !0), Lf(c, z.aNormal) }, ti = function (Z, y) { kp(Z, y.uFix, !1), ni(Z, y.aNormal) }, Ub = function (A, c, E, j, X, Y, $, w) { A._picking || (E ? (kp(A, c.uBlend, !0), kp(A, c.uBlendColor, E)) : kp(A, c.uBlend, !1), kp(A, c.uLight, j == l ? !0 : j), Gr(X) && 1 !== X && kp(A, c.uPartOpacity, X), kp(A, c.uReverseFlip, Y == l ? !1 : Y), kp(A, c.uFixPickReverseColor, $ || Lq)), w ? A.enable(A.CULL_FACE) : A.disable(A.CULL_FACE) }, Pc = function (u, X) { u._picking || kp(u, X.uPartOpacity, 1) }, Yo = function (I, Q, M, R, G, K, J, v) { if (!M) return de(I, I._emptyTexture), void 0; kp(I, Q.uTexture, !0), kp(I, Q.uDiscardSelectable, sk(R) ? R : !0), ni(I, Q.aUv), Sj(I, G, K, Q.aUv, 2), I.activeTexture(I.TEXTURE0), de(I, M), I.uniform1i(Q.uSampler, 0); var L = [0, 0, 1, 1]; J && (L[0] = J[0], L[1] = J[1]), v && (L[2] = v[0], L[3] = v[1]), kp(I, Q.uOffsetScale, L) }, ue = function (S, e, V) { de(S, l), V && (Lf(S, e.aUv), kp(S, e.uTexture, !1)) }, Yp = function (Y, F, R, P, u, d) { !R || r || e || Y.lineWidth(R), P && !Y._picking && kp(Y, F.uFixPickReverseColor, P), u && Sj(Y, u, d, F.aPosition) }, on = function (G, D, j, R) { Le && (R = G[Le]), G.drawArrays(R == l ? G.TRIANGLES : R, D, j) }, ql = function (f, M, k, x) { Le && (x = f[Le]), f.drawElements(x == l ? f.TRIANGLES : x, k, f.UNSIGNED_SHORT, M == l ? 0 : 2 * M) }, Sj = function (r, M, q, W, i) { var R = r.ARRAY_BUFFER; r.bindBuffer(R, M), q && r.bufferData(R, q, r.STATIC_DRAW), W != l && r.vertexAttribPointer(W, i ? i : 3, r.FLOAT, !1, 0, 0) }, hs = function (e, f, S) { var i = e.ELEMENT_ARRAY_BUFFER; e.bindBuffer(i, f), S && e.bufferData(i, S, e.STATIC_DRAW) }, kp = function (H, Y, Q) { if (Q != l && Y != l) { Q = db(Q); var R = Q.length; 3 === R ? H.uniform3fv(Y, Q) : 4 === R ? H.uniform4fv(Y, Q) : 16 === R ? H.uniformMatrix4fv(Y, !1, Q) : sk(Q) ? H.uniform1i(Y, Q ? 1 : 0) : 2 === R ? H.uniform2fv(Y, Q) : H.uniform1f(Y, Q) } }, ni = function (e, y) { y != l && y >= 0 && e.enableVertexAttribArray(y) }, Lf = function (b, u) { u != l && u >= 0 && b.disableVertexAttribArray(u) }, Nd = function (c, $) { var a = c.getGL(), w = c._prg; c._7O = c._8O.pop(), $ && (kp(a, w.uMVMatrix, c._7O), c._6O = $, kp(a, w.uNMatrix, $)) }, ts = function (v, B) { return B || (B = Nq()), Uk(B, v), rf(B), lo(B), B }, Hq = function (G, H) { var k = G.getGL(), E = G._prg, r = G._7O; H && (G._8O.push(sr(r)), ri(r, r, H)), kp(k, E.uMVMatrix, r), kp(k, E.uNMatrix, ts(r, G._6O)) }, $r = function (X, b, E, t, H, U) { if (E) { if (t) { var a = E.value++, S = [(255 & a >> 24) / 255, (255 & a >> 16) / 255, (255 & a >> 8) / 255, (255 & a) / 255]; E[a] = { data: H, part: U } } else S = Zi; return kp(X, b.uFixPickReverseColor, S), S } }, zc = function () { var w = { center: function (o, s, e, F, A) { var D = s[1] / 2, g = { x: -s[0] / 2, y: D, width: s[0], height: s[1] }, r = $e(o, g, e); return [r.x + F, 2 * D - r.y - A, Zo()] }, front: function (B, v, V, j, a) { var x = v[1] / 2, $ = { x: -v[0] / 2, y: x, width: v[0], height: v[1] }, f = $e(B, $, V); return [f.x + j, 2 * x - f.y - a, v[2] / 2 + Zo()] }, back: function (h, e, p, f, E) { var N = e[0] / 2, z = e[1] / 2, d = { x: N, y: z, width: e[0], height: e[1] }, $ = $e(h, d, p); return [2 * N - $.x - f, 2 * z - $.y - E, -e[2] / 2 - Zo()] }, left: function (P, s, E, F, p) { var $ = s[1] / 2, R = { x: -s[2] / 2, y: $, width: s[2], height: s[1] }, G = $e(P, R, E); return [-s[0] / 2 - Zo(), 2 * $ - G.y - p, G.x + F] }, right: function (L, y, b, H, m) { var M = y[2] / 2, S = y[1] / 2, V = { x: M, y: S, width: y[2], height: y[1] }, C = $e(L, V, b); return [y[0] / 2 + Zo(), 2 * S - C.y - m, 2 * M - C.x - H] }, top: function (s, B, k, f, w) { var I = { x: -B[0] / 2, y: -B[2] / 2, width: B[0], height: B[2] }, y = $e(s, I, k); return [y.x + f, B[1] / 2 + Zo(), y.y + w] }, bottom: function (i, q, $, n, x) { var t = q[2] / 2, W = { x: -q[0] / 2, y: t, width: q[0], height: q[2] }, U = $e(i, W, $); return [U.x + n, -q[1] / 2 - Zo(), 2 * t - U.y - x] } }; return function (j, b, D, A, l, H) { return w[A](j, b, D, l || 0, H || 0) } }(), dq = function (Q, n, H, m, C, w, E, g, r, b) { if (C && (n[0] += C[0], n[1] += C[1], n[2] += C[2]), Gq(Q, H), g) { var z = Nq(); if (bi(z, r, b), Me(n, z), Gq(Q, n), Q.auto = g, Q.pos = Me([0, 0, 0], Q), w) { var f = Q.mat2 = Nq(); bi(f, w, E) } } else bi(Q, r, b), Gq(Q, n), m === Xr ? jn(Q, -c) : m === kf ? jn(Q, c) : m === ys ? gg(Q, -c) : m === yn ? gg(Q, c) : m === ak && jn(Q, s), bi(Q, w, E); return Q }, ur = function (n, A) { var Y = A.auto, a = A.mat2, H = n.gv; if (Y) { var T, B = Nq(), m = [0, 0, 0, 0]; T = "string" == typeof Y ? [Y.indexOf("x") < 0 ? H._eye[0] : H._center[0], Y.indexOf("y") < 0 ? H._eye[1] : H._center[1], Y.indexOf("z") < 0 ? H._eye[2] : H._center[2]] : H._eye, We(m, kn(Nq(), T, H._center, H._up)), $q(B, In(m, m), A.pos), a && ri(B, B, a), Hq(H, B) } else Hq(H, A) }, kh = function (i, t, c, f, G) { var e = i.s, Q = i.gv, p = Q.getGL(), W = Q._prg, l = Q._buffer, U = Q._1O; $b(p, Ro, U), ur(i, c), Ub(p, W, e(t + ".blend"), e(t + ".light"), e(t + ".opacity"), e(t + ".reverse.flip"), e(t + ".reverse.color"), e(t + ".reverse.cull")), Yo(p, W, U, G, l.uv, jp), Sj(p, l.vs, f, W.aPosition), Sj(p, l.ns, lm, W.aNormal), hs(p, l.is, Wp), ql(p, 0, Wp.length), ue(p, W, U), Pc(p, W), Nd(Q) }, _j = function (_, G, T) { var V = _.gv, t = _.data, D = _[G] = { blend: V.getBodyColor(t) || V.getFaceBlend(t, G), light: V.getFaceLight(t, G), color: V.getFaceColor(t, G), opacity: V.getFaceOpacity(t, G), transparent: V.getFaceTransparent(t, G), reverseFlip: V.getFaceReverseFlip(t, G), reverseColor: V.getFaceReverseColor(t, G), reverseCull: V.getFaceReverseCull(t, G), texture: V.getFaceImage(t, G), discardSelectable: V.getFaceDiscardSelectable(t, G) }; if ("csg" !== G) { D.uv = V.getFaceUv(t, G) || T && T[G + "Uv"], D.uvScale = V.getFaceUvScale(t, G) || T && T[G + "UvScale"], D.uvOffset = V.getFaceUvOffset(t, G) || T && T[G + "UvOffset"]; var k = V.getFaceMat(t, G); k && (D.mat = wo(t, k)) } return D }, vk = function (z, y, b, I, U) { if (I) { if (!U(I.transparent)) return; var E = z.data, p = z.gv, x = p._buffer, A = p.getTexture(I.texture, E); Yo(y, b, A, I.discardSelectable, x.uv, I.tuv, I.uvOffset, I.uvScale), Ub(y, b, I.blend, I.light, I.opacity, I.reverseFlip, I.reverseColor, I.reverseCull), kp(y, b.uDiffuse, I.color), Sj(y, x.vs, I.vs, b.aPosition), Sj(y, x.ns, I.ns, b.aNormal), on(y, 0, I.vs.length / 3), Pc(y, b), ue(y, b, A) } }, ps = function (Q, n, V, h, u, L) { var m, y, D, $, l, c, G, F, w, E, Z, S = [h - n, u - V], _ = Q ? Q.length : 0; for (D = 0; _ > D; D++) { for ($ = 2, m = Q[D], l = m[0], c = m[1]; $ + 1 < m.length;) { if (G = m[$], F = m[$ + 1], y = Kd(n, V, h, u, l, c, G, F, !0)) { w = [G - l, F - c], E = Bk(w), w[0] /= E, w[1] /= E, E = Wl(S, w), E = E > 0 ? L : -L, Z = [w[0] * E, w[1] * E]; break } l = G, c = F, $ += 2 } if (Z) break } if (Z) for (h = n + Z[0], u = V + Z[1], D = 0; _ > D; D++)for ($ = 2, m = Q[D], l = m[0], c = m[1]; $ + 1 < m.length;) { if (G = m[$], F = m[$ + 1], y = Kd(n, V, h, u, l, c, G, F, !0)) return [0, 0]; l = G, c = F, $ += 2 } return Z ? Z : [h - n, u - V] }, Dj = R.graph3d = {}, lb = function (G, r, c) { uo(K + ".graph3d." + G, r, c) }, Br = "~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~!gjeof$!~~<*^j]opjujtpQupqTw!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEupqTw<**1/2!-^j]sfuofDupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQupqTw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~<**1/2!-^j]opjujtpQuojpQv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQuojpQw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<*opjujtpQsje!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEsjEw<**1/2!-1/1!-1/1!-1/1)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQsjEv)5dfw!+!yjsubNxfjWv)4dfw!>!opjujtpQsje!4dfw|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]sfuofDupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]opjujtpQsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN", Tg = "~~<eJ!>!spmpDhbsG`mh!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTw)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEw)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~<1/2!>!b/spmpDwv|ftmf~<esbdtje|*5/1!=!b/spmpDwv)gj|ftmf~~<esbdtje|*1/1!>>!b/spmpDwv)gj|*uofsbqtobsUv)gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUv!mppc!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!"; _i(m, { setBatchInfo: function (k, A) { Oq[k] = A }, getBatchInfo: function (S) { return Oq[S] } }, !0); var nm = [1, 1, 1], Cp = [1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0], ef = [-.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5], Ag = [.5, .5, -.5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5], nf = [.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5], Xd = [.5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5], xk = [.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5], Qg = [-.5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5], is = function (L, $) { Tf(L, $), ld(L, $, "_wireframeModelMap", "_wireframeIndexMap"), ld(L, $, "_polylineModelMap", "_polylineIndexMap") }, Tf = function (W, E) { if (E) { var o, h, B = E._id, r = W._33O, d = W._34O, k = d[B]; if (k) { h = k.batch, o = r[h]; var g = k.begin, O = k.size, n = 3 * g, e = 3 * O, G = 4 * g, U = 4 * O, V = o.vs, $ = o.uv, x = o.cs, I = o.bs, m = o.rs, Z = o.ds, b = k.index; if (o.invalidate = !0, delete d[B], Z.splice(b, 1), xo(Z)) delete r[h]; else { for (; b < Z.length; b++)k = d[Z[b]._id], k.index-- , k.begin -= O; V.splice(n, e), o.ns.splice(n, e), o.ps.splice(G, U), $ && $.splice(2 * g, 2 * O), x && x.splice(G, U), I && I.splice(n, e), m && m.splice(g, O) } } } else W._34O = {}, W._33O = {} }, ld = function (I, S, b, L) { if (S) { var c, W, $ = S._id, l = I[b], v = I[L], m = v[$]; if (m) { W = m.batch, c = l[W]; var y = m.begin, w = m.size, t = 3 * y, k = 3 * w, Y = 4 * y, x = 4 * w, X = c.ds, K = m.index; if (c.invalidate = !0, delete v[$], X.splice(K, 1), xo(X)) delete l[W]; else { for (; K < X.length; K++)m = v[X[K]._id], m.index-- , m.begin -= w; c.vs.splice(t, k), c.cs.splice(Y, x), c.ps.splice(Y, x), c.ls && c.ls.splice(y, w) } } } else I[b] = {}, I[L] = {} }, og = function (w, h, z, N) { if (!N) return l; var Z = h[N]; if (!Z) { var R = Oq[N] || sn, T = R.image ? [] : l; Z = h[N] = { vs: [], ns: [], uv: T, cs: T ? l : R.color ? l : [], bs: R.blend ? [] : l, ps: [], rs: R.brightness ? [] : l, ds: [] } } return Z.invalidate = !0, w[z._id] = { index: Z.ds.length, begin: Z.vs.length / 3, batch: N }, Z.ds.push(z), Z }, hb = function (p, j) { return j != l && 1 !== j ? [p[0] * j, p[1] * j, p[2] * j, p[3]] : p }, Qm = function (v, X, a) { var S = v.getBrightness(X), W = db(a.color || "white"), L = W[3] < 1, d = Math.ceil(a.width) || 1, H = (L ? "T" : "O") + d, K = v._wireframeIndexMap, j = v._wireframeModelMap, $ = j[H]; $ || ($ = j[H] = { vs: [], cs: [], ps: [], ds: [], T: L, W: d }), $.invalidate = !0; var T = $.vs, e = $.cs, x = $.ds, P = K[X._id] = { index: x.length, begin: T.length / 3, batch: H }; x.push(X), Lm(T, wo(X, a.mat), a.short ? Hb : yb); var y = P.size = T.length / 3 - P.begin; fq(e, hb(W, S), y) }, qk = function ($, Q, O, G, J, W, S, e, B) { var u = $.getBrightness(Q); u == l && (u = 1); var t = hb(db(G), u), j = t[3] < 1; W = Math.ceil(W) || 1; var F = (j ? "T" : "O") + W; if (S) { var E = S[0], U = (S[1] || E) + E; F += "-" + E + "-" + U, B && (F += "-" + vg(B) + "-" + u, B = hb(db(B), u)) } var _ = $._polylineIndexMap, k = $._polylineModelMap, K = k[F]; K || (K = k[F] = { vs: [], cs: [], ps: [], ds: [], ls: S ? [] : l, T: j, W: W }, S && (K.D = E, K.G = U, K.A = B)), K.invalidate = !0; var o, M = K.vs, s = K.cs, P = K.ds, i = K.ls, f = _[Q._id] = { index: P.length, begin: M.length / 3, batch: F }; P.push(Q), an(M, O); var m, z = f.size = M.length / 3 - f.begin, T = O.length, v = 0, p = []; if (S || J) for (o = 0; T > o; o += 6)m = Bk([O[o], O[o + 1], O[o + 2]], [O[o + 3], O[o + 4], O[o + 5]]), p.push(m), v += m; if (v && J) { var Z, w = hb(db(J), u), n = [w[0] - t[0], w[1] - t[1], w[2] - t[2], w[3] - t[3]], L = 0; for (o = 0; T > o; o += 6)Z = L / v, fq(s, [t[0] + n[0] * Z, t[1] + n[1] * Z, t[2] + n[2] * Z, t[3] + n[3] * Z], 1), L += p[o / 6], Z = L / v, fq(s, [t[0] + n[0] * Z, t[1] + n[1] * Z, t[2] + n[2] * Z, t[3] + n[3] * Z], 1) } else fq(s, t, z); if (S) for (L = e || 0, o = 0; T > o; o += 6)i.push(L), L += p[o / 6], i.push(L) }, Oh = function (J, F, z) { if (F) for (var I = 4 * F.begin, R = z[F.batch].ps, P = 0; P < F.size; P++)R[I++] = J[0], R[I++] = J[1], R[I++] = J[2], R[I++] = J[3] }, zm = function (L, i) { var p = i + ["32"], H = L[i], D = L[p]; H ? D && D.length === H.length ? D.set(H) : L[p] = new ub(H) : delete L[p] }, zr = function (R, d, $, q, O, e, k, U, I) { if (sp($)) $.forEach(function (h) { zr(R, d, h, q, O, e, k, U, I) }); else if (Yc($)) zr(R, d, $l(q, $), q, O, e, k, U, I); else if (bk($)) { var s, z = oi($.mat, d, R), a = oi($.s3, d, R), K = oi($.t3, d, R), j = oi($.r3, d, R); if ((a || j || K || z) && (s = no(z, a, j, oi($.rotationMode, d, R), K), e.push(s)), $.shape3d) zr(R, d, $.shape3d, q, O, e, k, U, $); else { var F = q.s; I = I || sn; var A = e[0], M = e.length, B = F("shape3d.color", $.color, I.color); if (O || (O = F("shape3d.blend", $.blend, I.blend)), M > 1) { A = sr(A); for (var g = 1; M > g; g++)ri(A, A, e[g]) } $.vs && F(th, $.visible, I.visible) && us(A, k, U, $.vs, $.uv, $.is, O, B), $.top_vs && F(Hr, $.topVisible, I.topVisible) && us(A, k, U, $.top_vs, $.top_uv, $.top_is, O, F("shape3d.top.color", $.topColor, I.topColor) || B), $.bottom_vs && F(nn, $.bottomVisible, I.bottomVisible) && us(A, k, U, $.bottom_vs, $.bottom_uv, $.bottom_is, O, F("shape3d.bottom.color", $.bottomColor, I.bottomColor) || B), $.from_vs && F(Qc, $.fromVisible, I.fromVisible) && us(A, k, U, $.from_vs, $.from_uv, $.from_is, O, F("shape3d.from.color", $.fromColor, I.fromColor) || B), $.to_vs && F(zb, $.toVisible, I.toVisible) && us(A, k, U, $.to_vs, $.to_uv, $.to_is, O, F("shape3d.to.color", $.toColor, I.toColor) || B) } s && e.pop() } }, us = function (f, Q, V, c, p, P, M, T) { var y, n = Q.cs, Z = Q.uv, v = Q.bs; if (P) { y = P.length; for (var Y = 0; y > Y; Y++) { var m = P[Y]; Lm(V, f, [c[3 * m], c[3 * m + 1], c[3 * m + 2]]), Z && an(Z, [p[2 * m], p[2 * m + 1]]) } } else y = c.length / 3, Lm(V, f, c), Z && an(Z, p); n && fq(n, T, y), v && (M ? ck(v, M, y) : an(v, nm, y)) }, oe = function (a, V, _, j) { var x = []; j ? zr(a.gv, a.data, j, a, a.getBodyColor(), [V], _, x) : (Lh(a, Xr, V, _, x), Lh(a, kf, V, _, x), Lh(a, Mb, V, _, x), Lh(a, ak, V, _, x), Lh(a, ys, V, _, x), Lh(a, yn, V, _, x), Lh(a, "csg", V, _, x)), x.length && (an(_.vs, x), an(_.ns, tq(x))) }, Lh = function (e, p, x, V, R) { var X = e[p]; if (X) { var k = X.tuv; if (k) { var f, Y, o, N, B = X.uvScale, $ = X.uvOffset; if (B) for (f = k.length, Y = B[0], o = B[1], N = 0; f > N; N += 2)k[N] *= Y, k[N + 1] *= o; if ($) for (f = k.length, Y = $[0], o = $[1], N = 0; f > N; N += 2)k[N] += Y, k[N + 1] += o } us(x, V, R, X.vs, k, l, X.blend, X.color) } }, Er = function (f, o, F, x, i, Q, M, E) { var W, z = F.cs, k = F.uv, O = F.bs; if (f.getFaceVisible(o, Q)) { var b = f.getFaceMat(o, Q); if (b && (i = wo(o, b)), Lm(M, i, E), z && fq(z, f.getFaceColor(o, Q), 6), k) { var h = f.getFaceUv(o, Q) || x[Q + "Uv"], S = f.getFaceUvScale(o, Q) || x[Q + "UvScale"], U = f.getFaceUvOffset(o, Q) || x[Q + "UvOffset"]; h = h ? [h[6], h[7], h[0], h[1], h[2], h[3], h[2], h[3], h[4], h[5], h[6], h[7]] : Cp; var g = h[0], T = h[1], e = h[2], t = h[3], c = h[4], R = h[5], G = h[6], v = h[7], j = h[8], D = h[9], $ = h[10], P = h[11]; if (S) { var X = S[0], Z = S[1]; g *= X, T *= Z, e *= X, t *= Z, c *= X, R *= Z, G *= X, v *= Z, j *= X, D *= Z, $ *= X, P *= Z } if (U) { var C = U[0], l = U[1]; g += C, T += l, e += C, t += l, c += C, R += l, G += C, v += l, j += C, D += l, $ += C, P += l } k.push(g, T, e, t, c, R, G, v, j, D, $, P) } O && (W = f.getBodyColor(o) || f.getFaceBlend(o, Q), W ? ck(O, W, 6) : an(O, nm, 6)) } }, pi = function (r, j, Y, K) { var X = r.getGL(), I = r._prg, M = r._buffer; if (!Bm(j)) { Hq(r), td(X, I); for (var z in j) { var R = j[z]; if (!(K && !R.T || !K && R.T)) { R.invalidate ? (R.invalidate = !1, zm(R, "vs"), zm(R, "cs"), zm(R, "ls"), zm(R, "ps")) : Y && zm(R, "ps"); var C = R.vs32, g = Y ? R.ps32 : R.cs32; Yp(X, I, R.W, l, M.vs, C); var U = R.D, a = !r._dashDisabled && U; a && (kp(X, I.uDash, !0), kp(X, I.uDashDistance, U), kp(X, I.uDashGapDistance, R.G), ni(X, I.aLineDistance), Sj(X, M.lineDistance, R.ls32, I.aLineDistance, 1), kp(X, I.uDiffuse, R.A || Nn)); var e = !r._batchColorDisabled; e && (kp(X, I.uBatchColor, !0), ni(X, I.aBatchColor), Sj(X, M.batchColor, g, I.aBatchColor, 4)), Yo(X), on(X, 0, C.length / 3, X.LINES), ue(X), e && (kp(X, I.uBatchColor, !1), Lf(X, I.aBatchColor)), a && (kp(X, I.uDash, !1), Lf(X, I.aLineDistance)) } } ti(X, I) } }, Ed = function (E, X, d) { var W, t, m, G, C, T, H, M, A, Q, j, L = E.getGL(), N = E._prg, q = E._buffer, a = E._33O; if (!Bm(a)) { Hq(E); for (W in a) if (t = Oq[W] || sn, !(d && !t.transparent || !d && t.transparent) && (m = a[W], X || !t.transparentMask)) { var O = d && t.autoSort !== !1 && (E._33Q || m.invalidate); if (m.invalidate ? (m.invalidate = !1, zm(m, "vs"), zm(m, "ns"), zm(m, "cs"), zm(m, "rs"), zm(m, "ps"), zm(m, "bs"), zm(m, "uv")) : X && zm(m, "ps"), C = m.vs32, T = X ? m.ps32 : m.cs32, A = m.uv32, H = m.bs32, M = m.rs32, j = C.length / 3, O && (m.is = ib(C, E.getEye())), j) { G = t.light, Q = E.getTexture(t.image), Ub(L, N, l, t.light, t.opacity, t.reverseFlip, t.reverseColor, t.reverseCull), T ? E._batchColorDisabled || (kp(L, N.uBatchColor, !0), ni(L, N.aBatchColor), Sj(L, q.batchColor, T, N.aBatchColor, 4)) : kp(L, N.uDiffuse, t.color); var y = H && !E._batchBlendDisabled; y && (kp(L, N.uBatchBlend, !0), ni(L, N.aBatchBlend), Sj(L, q.batchBlend, H, N.aBatchBlend)); var K = M && !E._batchBrightnessDisabled; K && (kp(L, N.uBatchBrightness, !0), ni(L, N.aBatchBrightness), Sj(L, q.batchBrightness, M, N.aBatchBrightness, 1)), A ? Yo(L, N, Q, t.discardSelectable, q.uv, A, t.uvOffset, t.uvScale) : Yo(L), Sj(L, q.vs, C, N.aPosition), Sj(L, q.ns, m.ns32, N.aNormal), m.is ? (hs(L, q.is, m.is), ql(L, 0, j)) : on(L, 0, j), A ? ue(L, N, Q) : ue(L), T && !E._batchColorDisabled && (kp(L, N.uBatchColor, !1), Lf(L, N.aBatchColor)), y && (kp(L, N.uBatchBlend, !1), Lf(L, N.aBatchBlend)), K && (kp(L, N.uBatchBrightness, !1), Lf(L, N.aBatchBrightness)), Pc(L, N) } } } }, ib = function (T, r) { for (var m = T.length / 3, O = new Array(m), h = m / 3, b = new Array(h), s = 0; h > s; s++)b[s] = s; b.sort(function (R, e) { var u = 9 * R, x = [(T[u] + T[u + 3] + 2 * T[u + 6]) / 4, (T[u + 1] + T[u + 4] + 2 * T[u + 7]) / 4, (T[u + 2] + T[u + 5] + 2 * T[u + 8]) / 4]; u = 9 * e; var m = [(T[u] + T[u + 3] + 2 * T[u + 6]) / 4, (T[u + 1] + T[u + 4] + 2 * T[u + 7]) / 4, (T[u + 2] + T[u + 5] + 2 * T[u + 8]) / 4], l = Bk(r, x) - Bk(r, m); return l > 0 ? -1 : 0 > l ? 1 : 0 }); for (var s = 0; h > s; s++) { var i = 3 * s, I = 3 * b[s]; O[i] = I, O[i + 1] = I + 1, O[i + 2] = I + 2 } return new mh(O) }, jp = new ub([0, 0, 0, 1, 1, 1, 1, 0]), lm = new ub([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]), Wp = new mh([0, 1, 2, 2, 3, 0]), cr = new ub([-.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5]), aj = new mh([0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23]), Ci = new ub([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]), fc = new ub([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]), ud = tq(cr, aj), yb = (new ub([-.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, -.5, -.5, .5, .5, -.5, -.5, -.5, -.5, -.5, .5, -.5]), new mh([0, 1, 2, 3, 0, 7, 5, 4, 6, 7, 5, 3, 2, 4, 6, 1]), [-.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, .5, .5, .5, .5, .5, -.5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5]), Hb = [-.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4], Lg = function (d, Y, k, f, c, y) { y = y || 16, d = d || 16, Y = Y || 0, k = k || d; var E, G, F, J, T, o, w, l, N = .5, n = [], C = [], b = B / d, u = s / y; for (E = 0; y > E; E++)for (T = E + 1, J = E * u, l = T * u, G = Y; k > G; G++)o = G + 1, F = G * b, w = o * b, n.push(N * t(J) * S(F), N * S(J), -N * t(J) * t(F), N * t(l) * S(w), N * S(l), -N * t(l) * t(w), N * t(J) * S(w), N * S(J), -N * t(J) * t(w), N * t(J) * S(F), N * S(J), -N * t(J) * t(F), N * t(l) * S(F), N * S(l), -N * t(l) * t(F), N * t(l) * S(w), N * S(l), -N * t(l) * t(w)), C.push(G / d, E / y, o / d, T / y, o / d, E / y, G / d, E / y, G / d, T / y, o / d, T / y); if (f) { var p = [], H = []; for (F = Y * b, E = 0; y > E; E++)T = E + 1, J = E * u, l = T * u, p.push(0, 0, 0, N * t(l) * S(F), N * S(l), -N * t(l) * t(F), N * t(J) * S(F), N * S(J), -N * t(J) * t(F)), H.push(0, .5, Y / d, T / y, Y / d, E / y) } if (c) { var e = [], j = []; for (F = k * b, E = 0; y > E; E++)T = E + 1, J = E * u, l = T * u, e.push(0, 0, 0, N * t(J) * S(F), N * S(J), -N * t(J) * t(F), N * t(l) * S(F), N * S(l), -N * t(l) * t(F)), j.push(1, .5, k / d, E / y, k / d, T / y) } return { vs: n, uv: C, from_vs: p, from_uv: H, to_vs: e, to_uv: j } }, Cf = function (V, M, f) { V = V || .17, M = M || 12, f = f || 18, 0 > V ? V = 0 : V > .25 && (V = .25); var T, q, m, U, P, Y, C, p = .5, d = [], l = [], Q = [], h = B / f, r = B / M, g = p - V; for (q = 0; M >= q; q++)for (U = -s + q * r, Y = S(U), P = t(U), T = 0; f >= T; T++)m = T * h, C = g + V * Y, d.push(S(m) * C, P * V, -t(m) * C), l.push(T / f, 1 - q / M); for (q = 0; M > q; q++) { var e = q * (f + 1), J = (q + 1) * (f + 1); for (T = 0; f > T; T++)Q.push(e + T, J + T + 1, J + T, e + T, e + T + 1, J + T + 1) } return { vs: d, uv: l, is: Q } }, Hf = function (m, N, x, V, v, z, D) { D = D || 12, m = m || 18, N = N || 0, x = x || m, z = z || .17, 0 > z ? z = 0 : z > .25 && (z = .25); var p, o, Q, J, F, h, E, n, G, H, k = .5, P = [], X = [], f = B / m, q = B / D, g = k - z; for (Q = 0; D > Q; Q++)for (J = Q + 1, E = -s + Q * q, n = -s + J * q, p = N; x > p; p++)o = p + 1, F = p * f, h = o * f, G = g + z * S(E), H = g + z * S(n), P.push(S(F) * G, t(E) * z, -t(F) * G, S(h) * G, t(E) * z, -t(h) * G, S(h) * H, t(n) * z, -t(h) * H, S(F) * G, t(E) * z, -t(F) * G, S(h) * H, t(n) * z, -t(h) * H, S(F) * H, t(n) * z, -t(F) * H), X.push(p / m, 1 - Q / D, o / m, 1 - Q / D, o / m, 1 - J / D, p / m, 1 - Q / D, o / m, 1 - J / D, p / m, 1 - J / D); if (V) { var b = [], L = []; for (Q = 0; D > Q; Q++)J = Q + 1, E = -s + Q * q, n = -s + J * q, F = N * f, G = g + z * S(E), H = g + z * S(n), b.push(S(F) * G, t(E) * z, -t(F) * G, S(F) * H, t(n) * z, -t(F) * H, S(F) * g, 0, -t(F) * g), L.push(.5 + .5 * S(E), .5 - .5 * t(E), .5 + .5 * S(n), .5 - .5 * t(n), .5, .5) } if (v) { var l = [], d = []; for (Q = 0; D > Q; Q++)J = Q + 1, E = -s + Q * q, n = -s + J * q, F = x * f, G = g + z * S(E), H = g + z * S(n), l.push(S(F) * G, t(E) * z, -t(F) * G, S(F) * g, 0, -t(F) * g, S(F) * H, t(n) * z, -t(F) * H), d.push(.5 - .5 * S(E), .5 - .5 * t(E), .5, .5, .5 - .5 * S(n), .5 - .5 * t(n)) } return { vs: P, uv: X, from_vs: b, from_uv: L, to_vs: l, to_uv: d } }, sl = function (Q, c) { for (var Y, q, h, D = .5, M = 16, f = [], G = [], R = [], n = B / M, o = 0; M >= o; o++)Y = o * n, q = S(Y) * D, h = t(Y) * D, f.push(q, -D, h, q, D, h), G.push(1 - o / M, 1, 1 - o / M, 0); for (o = 0; M > o; o++)R.push(2 * o, 2 * o + 1, 2 * o + 3, 2 * o, 2 * o + 3, 2 * o + 2); if (c) { var x = [], r = [], j = []; for (x.push(0, -D, 0), r.push(.5, .5), o = 0; M >= o; o++)Y = o * n, q = S(Y), h = t(Y), x.push(q * D, -D, -h * D), r.push(.5 + .5 * q, .5 + .5 * h); for (o = 0; M > o; o++)j.push(0, o + 2, o + 1) } if (Q) { var k = [], O = [], T = []; for (k.push(0, D, 0), O.push(.5, .5), o = 0; M >= o; o++)Y = o * n, q = S(Y), h = t(Y), k.push(q * D, D, -h * D), O.push(.5 + .5 * q, .5 - .5 * h); for (o = 0; M > o; o++)T.push(0, o + 1, o + 2) } return { vs: f, uv: G, is: R, bottom_vs: x, bottom_uv: r, bottom_is: j, top_vs: k, top_uv: O, top_is: T } }, wn = function (A, W, J, m, u, D, j) { A = A || 12, W = W || 0, J = J || A; for (var k, p, N, Z, i, r, M, Y, F = .5, z = [], Q = [], K = B / A, X = W; J > X; X++)k = X + 1, p = X * K, N = k * K, Z = S(p) * F, i = t(p) * F, r = S(N) * F, M = t(N) * F, z.push(Z, -F, -i, r, -F, -M, Z, F, -i, r, -F, -M, r, F, -M, Z, F, -i), Q.push(X / A, 1, k / A, 1, X / A, 0, k / A, 1, k / A, 0, X / A, 0); if (j) { var h = [], $ = []; for (X = W; J > X; X++)p = K * X, N = K * (X + 1), Z = S(p), i = t(p), r = S(N), M = t(N), h.push(Z * F, -F, -i * F, 0, -F, 0, r * F, -F, -M * F), $.push(.5 + .5 * Z, .5 + .5 * i, .5, .5, .5 + .5 * r, .5 + .5 * M) } if (D) { var w = [], I = []; for (X = W; J > X; X++)p = K * X, N = K * (X + 1), Z = S(p), i = t(p), r = S(N), M = t(N), w.push(Z * F, F, -i * F, r * F, F, -M * F, 0, F, 0), I.push(.5 + .5 * Z, .5 - .5 * i, .5 + .5 * r, .5 - .5 * M, .5, .5) } if (m) { var y = [], b = []; p = K * W, Z = S(p) * F, i = t(p) * F, Y = W / A, y.push(0, F, 0, 0, -F, 0, Z, -F, -i, Z, -F, -i, Z, F, -i, 0, F, 0), b.push(0, 0, 0, 1, Y, 1, Y, 1, Y, 0, 0, 0) } if (u) { var E = [], R = []; p = K * J, Z = S(p) * F, i = t(p) * F, Y = J / A, E.push(0, -F, 0, 0, F, 0, Z, F, -i, Z, F, -i, Z, -F, -i, 0, -F, 0), R.push(1, 1, 1, 0, Y, 0, Y, 0, Y, 1, 1, 1) } return { vs: z, uv: Q, bottom_vs: h, bottom_uv: $, top_vs: w, top_uv: I, from_vs: y, from_uv: b, to_vs: E, to_uv: R } }, Dg = function (g, V, L, G, J) { V = V || 18, L = L || 0, G = G == l ? B : G, J = J == l ? .5 : J; for (var y, R, m, H, T, v, Q = [0, .5, .75, .875, .9375], r = [], U = [], w = [], u = G / V, a = 0; a < Q.length; a++) { var x = 0 === a % 2 ? 0 : .5; for (y = 0; V >= y; y++)R = (y + x) * u + L, m = 1 - Q[a], r.push(S(R) * J * m, -J + 2 * Q[a] * J, -t(R) * J * m), U.push((y + x) / V, m) } for (a = 0; a < Q.length - 1; a++) { var A = a * (V + 1), K = (a + 1) * (V + 1); for (y = 0; V > y; y++)w.push(A + y, K + y + 1, K + y, A + y, A + y + 1, K + y + 1) } for (v = r.length / 3 - (V + 1), y = 0; V > y; y++)r.push(0, J, 0), U.push((y + .5) / V, 0); for (y = 0; V > y; y++)w.push(v + y, v + y + 1, v + (V + 1) + y); if (g) { var P = [], $ = [], O = []; for (P.push(0, -J, 0), $.push(.5, .5), y = 0; V >= y; y++)R = y * u + L, H = S(R), T = t(R), P.push(H * J, -J, -T * J), $.push(.5 + .5 * H, .5 + .5 * T); for (y = 0; V > y; y++)O.push(0, y + 2, y + 1) } return { vs: r, uv: U, is: w, bottom_vs: P, bottom_uv: $, bottom_is: O } }, Ar = function (m, n, Q, c, D, $) { m = m || 16, n = n || 0, Q = Q || m; for (var _ = .5, K = [], E = [], v = B / m, o = n; Q > o; o++) { var N = o + 1, l = v * o, H = v * N; K.push(S(l) * _, -_, -t(l) * _, S(H) * _, -_, -t(H) * _, 0, _, 0), E.push(o / m, 1, N / m, 1, (o + N) / 2 / m, 0) } if ($) { var r = [], w = []; for (o = n; Q > o; o++) { l = v * o, H = v * (o + 1); var h = S(l), C = t(l), d = S(H), b = t(H); r.push(h * _, -_, -C * _, 0, -_, 0, d * _, -_, -b * _), w.push(.5 + .5 * h, .5 + .5 * C, .5, .5, .5 + .5 * d, .5 + .5 * b) } } if (c) { var x = [], V = []; l = v * n, x.push(0, _, 0, 0, -_, 0, S(l) * _, -_, -t(l) * _), V.push(0, 0, 0, 1, n / m, 1) } if (D) { var T = [], f = []; l = v * Q, T.push(0, -_, 0, 0, _, 0, S(l) * _, -_, -t(l) * _), f.push(1, 1, 1, 0, Q / m, 1) } return { vs: K, uv: E, bottom_vs: r, bottom_uv: w, from_vs: x, from_uv: V, to_vs: T, to_uv: f } }, hl = function (p, f, u, z, K, T, i, Z) { for (var t = [], V = 0; V < p.length - 1; V += 2)t.push({ x: p[V], y: p[V + 1] }); return Xb(t, f, u, z, K, T, i, Z, !1) }, Yl = { roundRect: function (r, c) { return hl([.5, .4, .5, .442, .471, .471, .442, .5, .4, .5, -.4, .5, -.442, .5, -.471, .471, -.5, .442, -.5, .4, -.5, -.4, -.5, -.442, -.471, -.471, -.442, -.5, -.4, -.5, .4, -.5, .442, -.5, .471, -.471, .5, -.442, .5, -.4, .5, .4], [1, 3, 3, 2, 3, 3, 2, 3, 3, 2, 3, 3, 2], r, c, 3) }, star: function (e, Q) { return hl([.193, .079, .333, .5, 0, .233, -.333, .5, -.194, .079, -.5, -.167, -.112, -.167, 0, -.5, .111, -.167, .5, -.167], [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5], e, Q) }, rect: function (G, w) { return hl([.5, -.5, .5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 2, 5], G, w) }, triangle: function (b, m) { return hl([0, -.5, .5, .5, -.5, .5], [1, 2, 2, 5], b, m) }, rightTriangle: function (I, t) { return hl([.5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 5], I, t) }, parallelogram: function (Q, o) { return hl([.5, -.5, .25, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], Q, o) }, trapezoid: function (x, g) { return hl([.25, -.5, .5, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], x, g) } }, Co = { sphere: 1, cylinder: 1, cone: 1, torus: 1 }, xs = { torus: 1, sphere: 1 }, ae = _i(Ln(Yl), { cylinder: 1 }), vs = _i(Ln(Yl), { cylinder: 1, cone: 1 }), Ic = function (i, O, U) { var W, c = oi(i.mat, U, O), x = oi(i.s3, U, O), p = oi(i.t3, U, O), k = oi(i.r3, U, O); return (x || k || p || c) && (W = sr(O._6O), Hq(O, no(c, x, k, oi(i.rotationMode, U, O), p))), W }, Pf = function (I, g, A, r, W, w, F) { if (sp(A)) A.forEach(function ($) { Pf(I, g, $, r, W, w, F) }); else if (Yc(A)) Pf(I, g, $l(r, A), r, W, w, F); else if (bk(A)) if (A.shape3d) { var B = Ic(A, I, g); Pf(I, g, A.shape3d, r, W, w, A), B && Nd(I, B) } else Vn(I, g, A, r.s, W, w, F) }, Vn = function (o, y, _, O, Y, m, q) { if (q = q || sn, !m || m(O("shape3d.transparent", _.transparent, q.transparent))) { var n = Ic(_, o, y); vl(_); var Q = o._26I, K = o._prg, S = o._buffer, z = O("shape3d.color", _.color, q.color); Y || (Y = O("shape3d.blend", _.blend, q.blend)), Ub(Q, K, Y, O("shape3d.light", _.light, q.light), O("shape3d.opacity", _.opacity, q.opacity), O("shape3d.reverse.flip", _.reverseFlip, q.reverseFlip), O("shape3d.reverse.color", _.reverseColor, q.reverseColor), O("shape3d.reverse.cull", _.reverseCull, q.reverseCull)), _.vs && O(th, _.visible, q.visible) && Kk(Q, K, S, z, o.getTexture(O("shape3d.image", _.image, q.image), y), O("shape3d.discard.selectable", _.discardSelectable, q.discardSelectable), _.vs, _.uv, _.ns, _.is, O("shape3d.uv.offset", _.uvOffset, q.uvOffset), O("shape3d.uv.scale", _.uvScale, q.uvScale)), _.top_vs && O(Hr, _.topVisible, q.topVisible) && Kk(Q, K, S, O("shape3d.top.color", _.topColor, q.topColor) || z, o.getTexture(O("shape3d.top.image", _.topImage, q.topImage), y), O("shape3d.top.discard.selectable", _.topDiscardSelectable, q.topDiscardSelectable), _.top_vs, _.top_uv, _.top_ns, _.top_is, O("shape3d.top.uv.offset", _.topUvOffset, q.topUvOffset), O("shape3d.top.uv.scale", _.topUvScale, q.topUvScale)), _.bottom_vs && O(nn, _.bottomVisible, q.bottomVisible) && Kk(Q, K, S, O("shape3d.bottom.color", _.bottomColor, q.bottomColor) || z, o.getTexture(O("shape3d.bottom.image", _.bottomImage, q.bottomImage), y), O("shape3d.bottom.discard.selectable", _.bottomDiscardSelectable, q.bottomDiscardSelectable), _.bottom_vs, _.bottom_uv, _.bottom_ns, _.bottom_is, O("shape3d.bottom.uv.offset", _.bottomUvOffset, q.bottomUvOffset), O("shape3d.bottom.uv.scale", _.bottomUvScale, q.bottomUvScale)), _.from_vs && O(Qc, _.fromVisible, q.fromVisible) && Kk(Q, K, S, O("shape3d.from.color", _.fromColor, q.fromColor) || z, o.getTexture(O("shape3d.from.image", _.fromImage, q.fromImage), y), O("shape3d.from.discard.selectable", _.fromDiscardSelectable, q.fromDiscardSelectable), _.from_vs, _.from_uv, _.from_ns, _.from_is, O("shape3d.from.uv.offset", _.fromUvOffset, q.fromUvOffset), O("shape3d.from.uv.scale", _.fromUvScale, q.fromUvScale)), _.to_vs && O(zb, _.toVisible, q.toVisible) && Kk(Q, K, S, O("shape3d.to.color", _.toColor, q.toColor) || z, o.getTexture(O("shape3d.to.image", _.toImage, q.toImage), y), O("shape3d.to.discard.selectable", _.toDiscardSelectable, q.toDiscardSelectable), _.to_vs, _.to_uv, _.to_ns, _.to_is, O("shape3d.to.uv.offset", _.toUvOffset, q.toUvOffset), O("shape3d.to.uv.scale", _.toUvScale, q.toUvScale)), Pc(Q, K), n && Nd(o, n) } }, Kk = function (w, L, E, Q, F, K, r, O, p, s, h, S) {
            r && (kp(w, L.uDiffuse, Q), O ? Yo(w, L, F, K, E.uv, O, h, S) : Yo(w), Sj(w, E.vs, r, L.aPosition), Sj(w, E.ns, p, L.aNormal), s ? (hs(w, E.is, s), ql(w, 0, s.length)) : on(w, 0, r.length / 3), O ? ue(w, L, F) : ue(w))
        }, $l = function (O, w) { var C = O.s; if (w || (w = C(Md)), !w) return l; if (bk(w)) return w; var W = Rm[w]; if (W) return W; if ("text" === w) { var k = { amount: C("shape3d.text.amount"), size: C("shape3d.text.size"), font: C("shape3d.text.font"), style: C("shape3d.text.style"), weight: C("shape3d.text.weight"), fill: C("shape3d.text.fill"), curveSegments: C("shape3d.text.curveSegments"), spacing: C("shape3d.text.spacing") }, r = O.gv.getShape3dText(O.data), D = r; for (var z in k) D += "_" + (k[z] === Z ? "U" : k[z]); return O._cachedTextKey === D ? O._cachedTextGeometry : (O._cachedTextKey = D, O._cachedTextGeometry = m.createTextGeometry(r, k)) } var z = w; if (Co[w]) { var c = C("shape3d.side"), P = C("shape3d.side.from"), h = C("shape3d.side.to"), N = C(Qc), _ = C(zb); 3 > c ? (c = 0, P = 0, h = 0, N = !1, _ = !1) : ((P == l || 0 > P) && (P = 0), (h == l || h > c) && (h = c), 0 === P && h === c && (N = !1, _ = !1)), z += "-" + c + "-" + P + "-" + h + "-" + N + "-" + _ } if (ae[w]) { var U = C(Hr); z += "-" + U } if (vs[w]) { var J = C(nn); z += "-" + J } if ("torus" === w) { var E = C("shape3d.torus.radius"); 0 > E ? E = 0 : E > .25 && (E = .25), z += "-" + E } if (xs[w]) { var M = C($h); z += "-" + M } return W = Hh[z], W || ("box" === w ? W = m.createBoxModel() : Yl[w] ? W = Yl[w](U, J) : "sphere" === w ? W = m.createSphereModel(c, P, h, N, _, M) : w === mr ? W = m.createCylinderModel(c, P, h, N, _, U, J) : "cone" === w ? W = m.createConeModel(c, P, h, N, _, J) : "torus" === w && (W = m.createTorusModel(c, P, h, N, _, E, M)), Hh[z] = W), W }, vl = function () { var U = ["vs", "ns", "uv", "top_vs", "top_ns", "top_uv", "bottom_vs", "bottom_ns", "bottom_uv", "from_vs", "from_ns", "from_uv", "to_vs", "to_ns", "to_uv", "er", "al"], t = ["is", "top_is", "bottom_is", "from_is", "to_is"]; return f = ss(Br.substr(Br.indexOf("^#") + 2)), De(m[gf(Bq + U[15] + "n" + U[16])]()) && Iq() ? function (Q) { Q && !Q._complete_ && (Q._complete_ = !0, Q.vs && xo(Q.ns) && (Q.ns = tq(Q.vs, Q.is)), Q.top_vs && xo(Q.top_ns) && (Q.top_ns = tq(Q.top_vs, Q.top_is)), Q.bottom_vs && xo(Q.bottom_ns) && (Q.bottom_ns = tq(Q.bottom_vs, Q.bottom_is)), Q.from_vs && xo(Q.from_ns) && (Q.from_ns = tq(Q.from_vs, Q.from_is)), Q.to_vs && xo(Q.to_ns) && (Q.to_ns = tq(Q.to_vs, Q.to_is)), U.forEach(function (x) { var k = Q[x]; sp(k) && (Q[x] = new ub(k)) }), t.forEach(function (g) { var h = Q[g]; sp(h) && (Q[g] = new mh(h)) })) } : void 0 }(), ng = function (l, G) { var s = l[G]; sp(s) && (l[G] = new ub(s)) }; _i(Xc, { _25Q: function (U) { U._16O = function (W, m, e, Y, q, y, F, t, K) { var l = this.info; if (l) { var d, b, a, V, o, T, v = Nq(); if (Nk[m] ? (d = l.p3, b = l.c1, a = l.c2) : Fe[m] ? (b = l.s1 || l.c1, a = l.s2 || l.c2) : (b = l.t1 || l.c1, a = l.t2 || l.c2), d) T = zc(m, Yd, e, Y, t, K); else { var O = gs(a, b), h = Bk(b, a); V = [0, -I(O[2], O[0]), H(O[1] / h)], o = "zyx", d = [(b[0] + a[0]) / 2, (b[1] + a[1]) / 2, (b[2] + a[2]) / 2], T = zc(m, [h, 0, 0], e, Y, t, K) } return dq(v, T, d, Y, q, y, F, W, V, o) } return hi }, U._80o = function (x, O, e) { var X = this, c = X.shapeModel; if (c) { var u = X.gv; Hq(u), Pf(u, X.data, c, X, X.getBodyColor(), e) } }, U.createLineModel = function (F, E, C, X, f) { for (var P = this, v = P.s, k = xl(F, E, v($h)), n = [], g = 0; g < k.length; g++) { var h = k[g], S = h.length; if (S > 1) { var O = h[0]; n.push(O.x, O.y, O.z); for (var y = 1; S - 1 > y; y++)O = h[y], n.push(O.x, O.y, O.z), n.push(O.x, O.y, O.z); O = h[S - 1], n.push(O.x, O.y, O.z) } } var T, Y, a, e = v(X + ".color"), p = v(f), R = 0; return p && (Y = v(f + ".color"), T = v(f + ".pattern"), R = v(f + ".offset"), a = e), qk(P.gv, P.data, n, Y || e, a ? l : v(X + ".gradient.color"), C, T || v(X + ".pattern"), R, a), k }, U.createTubeModel = function (v, d, W, F) { for (var b = this, f = b.s, B = f("shape3d.side") || gk, g = f("shape3d.start.angle"), P = f("shape3d.sweep.angle"), H = f(Hr) ? f("shape3d.top.cap") : l, Q = f(nn) ? f("shape3d.bottom.cap") : l, u = "flat" === H, G = "flat" === Q, n = u && (F ? F.uv : f("shape3d.top.image")), k = G && (F ? F.uv : f("shape3d.bottom.image")), L = F ? F.uv : f("shape3d.image"), V = { vs: [], uv: L ? [] : l, top_vs: u ? [] : l, top_uv: n ? [] : l, bottom_vs: G ? [] : l, bottom_uv: k ? [] : l }, c = xl(v, d, f($h), W), J = 0, q = c.length; q > J; J++)pn(V, c[J], f(uq), W, B, g, P, H, Q); if (F) { var O = []; zr(b.gv, b.data, V, b, b.getBodyColor(), [], F, O), O.length && (an(F.vs, O), an(F.ns, tq(O))) } else b.shapeModel = V; return c }, U.getCache = function () { var H = this.info; if (H) { var I = H.list; if (I) { var C = H.cache; return C || (C = H.cache = je(I)), C } } return l } } }); var Vk = function (k, p) { for (var C, v = 0, s = k.length, V = 0, L = s - 1; L >= V;)if (v = G(V + (L - V) / 2), C = k[v].length - p, 0 > C) V = v + 1; else { if (!(C > 0)) { L = v; break } L = v - 1 } v = L; var S = k[v], D = S.point; return v === s - 1 || S.length === p || (D = (new lc).subVectors(k[v + 1].point, D).normalize().multiplyScalar(p - S.length).add(D)), { point: D, tangent: S.tangent } }, je = function (Z) { for (var O, v, F = [], E = 0, D = 0; D < Z.length; D++) { for (var o = Z[D], g = 0; g < o.length; g++) { O = o[g], v && (E += v.distanceTo(O)); var r = new lc, Y = o[g + 1]; Y ? r.subVectors(Y, O) : v ? r.subVectors(O, v) : r.x = 1, r.normalize(), F.push({ point: O, length: E, tangent: r }), v = O } v = null } return F }, xl = function (j, D, W, M) { W = W || zk; for (var r = [], R = 0, Y = j.size(); Y > R; R++) { var g = j.get(R); r.push(new lc(g.x, g.e || 0, g.y)) } Zh(D) && (D = D._as); for (var V, e, f, A, c, v = [], P = 0, d = 0, H = D ? D.length : Y; H > d; d++)if (c = D ? D[d] : 0 === d ? 1 : 2, 1 === c) v.push(f = []), f.push(r[P++]); else if (2 === c || 5 === c) if (A = 2 === c ? r[P++] : f[0], M) { var _ = D ? D[d + 1] : H > d + 1 ? 2 : l; if (2 === _ || 5 === _) { var J = f[f.length - 1], o = 2 === _ ? r[P] : f[0], q = (new lc).subVectors(J, A), E = (new lc).subVectors(o, A), X = q.length(), h = E.length(); if (M > X / 2 && M > h / 2) f.push(A); else for (q.multiplyScalar(b(M, X / 2) / X).add(A), E.multiplyScalar(b(M, h / 2) / h).add(A), V = new Vb(q, A, E).getPoints(W), e = 0; W >= e; e++)f.push(V[e]) } else f.push(A) } else f.push(A); else if (3 === c) for (V = new Vb(f[f.length - 1], r[P++], r[P++]).getPoints(W), e = 1; W >= e; e++)f.push(V[e]); else if (4 === c) for (V = new jr(f[f.length - 1], r[P++], r[P++], r[P++]).getPoints(W), e = 1; W >= e; e++)f.push(V[e]); return v }, bb = function (X) { for (var h, b, t = new lc, i = [], c = [], a = [], F = 0, M = X.length; M > F; F++)h = X[F], b = X[F + 1], b ? t.subVectors(b, h) : t.subVectors(h, X[F - 1]), i.push(t.normalize().clone()); var P, l, n, e, o = new lc, S = new lc, x = new Eq, O = 1e-4, U = Number.MAX_VALUE, z = i[0], V = c[0] = new lc, G = a[0] = new lc; for (l = A(z.x), n = A(z.y), e = A(z.z), U >= l && (U = l, o.set(1, 0, 0)), U >= n && (U = n, o.set(0, 1, 0)), U >= e && o.set(0, 0, 1), S.crossVectors(z, o).normalize(), V.crossVectors(z, S), G.crossVectors(z, V), F = 1; M > F; F++)c[F] = c[F - 1].clone(), a[F] = a[F - 1].clone(), S.crossVectors(i[F - 1], i[F]), S.length() > O && (S.normalize(), P = E(Ze(i[F - 1].dot(i[F]), -1, 1)), c[F].applyMatrix4(x.makeRotationAxis(S, P))), a[F].crossVectors(i[F], c[F]); return { B: a, T: i, N: c } }, pn = function () { var N = function (p) { for (var G = 1; G < arguments.length; G++) { var I = arguments[G]; p.push(I.x, I.y, I.z) } }, P = function (z) { for (var s = 1; s < arguments.length; s++) { var Q = arguments[s].uv; z.push(Q[0], Q[1]) } }, _ = function (c, h, d, z, b) { var j = -z * S(b), Y = z * t(b); return new lc(c.x + j * d.x + Y * h.x, c.y + j * d.y + Y * h.y, c.z + j * d.z + Y * h.z) }, h = function (f, G, W, F, d, R, h, j) { h = h || B; for (var p = [], c = h / d, J = 0; d >= J; J++) { var D = _(f, G, W, F, J * c + R); p.push(D), j != l && (D.uv = [j, J / d]) } return p }, Y = function (s, V, h, u, d, I, $, f, M) { M = M || B; var o = V ? s.top_vs : s.bottom_vs; if (o) for (var J = V ? s.top_uv : s.bottom_uv, q = M / $, y = 0; $ > y; y++) { var i, P; V ? (i = y * q + f, P = (y + 1) * q + f) : (P = y * q + f, i = (y + 1) * q + f), N(o, _(h, u, d, I, i), _(h, u, d, I, P), h), J && J.push(.5 - .5 * S(i), .5 - .5 * t(i), .5 - .5 * S(P), .5 - .5 * t(P), .5, .5) } }; return function (e, L, d, $, s, i, q, G, X) { var w = L.length; if (w > 1) { var H, A, S, U, z, W, v, I = bb(L), c = I.T, k = I.N, _ = I.B; "flat" === G && Y(e, !0, L[0], _[0], k[0], $, s, i, q), "flat" === X && Y(e, !1, L[w - 1], _[w - 1], k[w - 1], $, s, i, q); var f, a, t = [], J = T(s / 2), Q = "round" === G, r = "round" === X, V = L[0], B = c[0], E = _[0], O = k[0], R = L[w - 1], j = c[w - 1], x = _[w - 1], y = k[w - 1]; if (Q) { for (S = 1; J >= S; S++)k.splice(0, 0, O), _.splice(0, 0, E), c.splice(0, 0, B), a = -S / J * $, L.splice(0, 0, B.clone().multiplyScalar(a).add(V)), t[J - S] = o($ * $ - a * a); w += J } if (r) { for (S = 1; J >= S; S++)k.push(y), _.push(x), c.push(j), a = S / J * $, L.push(j.clone().multiplyScalar(a).add(R)), t[L.length - 1] = o($ * $ - a * a); w += J } if (e.uv) { var F = 0, C = 0, n = []; for (d && (F = d), z = L[0], n[0] = 0, S = 1; w > S; S++)U = L[S], n[S] = z.distanceTo(U), z = U, d || (F += n[S]); for (f = [], S = 0; w > S; S++)C += n[S], f[S] = F ? C / F : 0 } for (S = 0; w > S; S++) { if (U = L[S], W = _[S], v = k[S], H = h(U, W, v, t[S] === Z ? $ : t[S], s, i, q, f ? f[S] : l), A) for (var g = 0; s > g; g++) { var p = A[g], m = A[g + 1] || A[0], u = H[g], M = H[g + 1] || H[0]; N(e.vs, m, p, u, u, M, m), e.uv && P(e.uv, m, p, u, u, M, m) } A = H } } } }(); _i(m, { getLineLength: function (a) { return a[a.length - 1].length }, getLineOffset: function (U, x) { return Vk(U, x) }, getLineCacheInfo: function (J, u, Z, v) { return je(xl(J, u, Z, v)) } }); var fs = R.Light = function () { xd(fs, this), this.s(uf, M[uf]), this.s(Md, "sphere"), this.s3(20, 20, 20) }; Df("Light", jf, { _image: "light_icon", _icon: "light_icon", onStyleChanged: function (G, j, h) { fs.superClass.onStyleChanged.apply(this, arguments), G === uf && this.s("shape3d.color", h) } }); var Gl = Dj.Graph3dView = function (h, p) { var M = this; M._attributes = p || m.graph3dViewAttributes, M._25I = {}, M._view = ii(1, M); var d = M._canvas = sc(M._view); d.addEventListener("webglcontextlost", function (D) { D.preventDefault(), xr(M), M._26I = l, M._1o.texture = l, M._35O = !0 }, !1), d.addEventListener("webglcontextrestored", function () { M._35O = !1, M.iv() }, !1), M._34O = {}, M._33O = {}, M._wireframeIndexMap = {}, M._wireframeModelMap = {}, M._polylineIndexMap = {}, M._polylineIndexMap = {}, M._8O = [], M._7O = Nq(), M._6O = Nq(), M._1o = new nh(M), M._30O = new Em(M), M._31O = new Kl(M), M._32O = new wj(M), M._33Q = !0, M._eye = Ln(m.graph3dViewEye), M._center = Ln(m.graph3dViewCenter), M._up = Ln(m.graph3dViewUp), M._lightChanged = !1, M._59O = [], M._spots = [], M._dirs = [], M.dm(h ? h : new Mn), M.setInteractors([new cb(M)]) }, fn = { fogDisabled: 1, dashDisabled: 1, batchColorDisabled: 1, batchBlendDisabled: 1, batchBrightnessDisabled: 1 }; lb("Graph3dView", F, { ms_v: 1, ms_tip: 1, ms_gv: 1, ms_dm: 1, ms_lp: 1, ms_fire: 1, ms_sm: 1, _51o: 1, ms_ac: ["devicePixelRatio", "boundaries", "moveStep", "rotateStep", "sizeEditableFunc", "rotationEditableFunc", "editableFunc", "rotatable", "zoomable", "pannable", "walkable", "resettable", "mouseRoamable", Kg, om, "firstPersonMode", qc, "movableFunc", "gridVisible", "gridSize", "gridGap", "gridColor", "originAxisVisible", "centerAxisVisible", "axisXColor", "axisYColor", "axisZColor", "editSizeColor", "rectSelectable", "rectSelectBackground", "headlightRange", "headlightColor", "headlightIntensity", "headlightDisabled", "ortho", "orthoWidth", "fovy", "near", "far", rs, vr, "up", "aspect", "fogDisabled", "fogColor", "fogNear", "fogFar", "dashDisabled", "batchColorDisabled", "batchBlendDisabled", "batchBrightnessDisabled"], _editable: !1, _devicePixelRatio: Z, _boundaries: Z, _moveStep: m.graph3dViewMoveStep, _rotateStep: m.graph3dViewRotateStep, _pannable: m.graph3dViewPannable, _rotatable: m.graph3dViewRotatable, _walkable: m.graph3dViewWalkable, _resettable: m.graph3dViewResettable, _zoomable: m.graph3dViewZoomable, _firstPersonMode: m.graph3dViewFirstPersonMode, _mouseRoamable: m.graph3dViewMouseRoamable, _gridVisible: m.graph3dViewGridVisible, _gridSize: m.graph3dViewGridSize, _gridGap: m.graph3dViewGridGap, _gridColor: m.graph3dViewGridColor, _originAxisVisible: m.graph3dViewOriginAxisVisible, _centerAxisVisible: m.graph3dViewCenterAxisVisible, _axisXColor: m.graph3dViewAxisXColor, _axisYColor: m.graph3dViewAxisYColor, _axisZColor: m.graph3dViewAxisZColor, _ortho: m.graph3dViewOrtho, _orthoWidth: m.graph3dViewOrthoWidth, _fovy: m.graph3dViewFovy, _near: m.graph3dViewNear, _far: m.graph3dViewFar, _headlightColor: m.graph3dViewHeadlightColor, _headlightIntensity: m.graph3dViewHeadlightIntensity, _headlightRange: m.graph3dViewHeadlightRange, _headlightDisabled: m.graph3dViewHeadlightDisabled, _rectSelectable: m.graph3dViewRectSelectable, _rectSelectBackground: m.graph3dViewRectSelectBackground, _editSizeColor: m.graph3dViewEditSizeColor, _autoMakeVisible: wf, _fogDisabled: m.graph3dViewFogDisabled, _fogColor: m.graph3dViewFogColor, _fogNear: m.graph3dViewFogNear, _fogFar: m.graph3dViewFogFar, _dashDisabled: m.graph3dViewDashDisabled, _batchColorDisabled: m.graph3dViewBatchColorDisabled, _batchBlendDisabled: m.graph3dViewBatchBlendDisabled, _batchBrightnessDisabled: m.graph3dViewBatchBrightnessDisabled, setEye: function (e, g, W) { 1 === arguments.length && (g = e[1], W = e[2], e = e[0]); var h = this._eye; h[0] = e, h[1] = g, h[2] = W, this.fp(rs, l, h) }, setCenter: function (R, E, q) { 1 === arguments.length && (E = R[1], q = R[2], R = R[0]); var t = this._center; t[0] = R, t[1] = E, t[2] = q, this.fp(vr, l, t) }, setUp: function (N, Y, J) { 1 === arguments.length && (Y = N[1], J = N[2], N = N[0]); var k = this._up; k[0] = N, k[1] = Y, k[2] = J, this.fp("up", l, k) }, isTransparentMask: function (o) { return o.s("transparent.mask") }, getAspect: function () { var R = this, q = R._aspect; return q ? q : R.getWidth() / R.getHeight() }, getCanvas: function () { return this._canvas }, setDataModel: function (a) { var L = this, k = L._dataModel, q = L._selectionModel; k !== a && (k && (k.umm(L.handleDataModelChange, L), k.umd(L.handleDataPropertyChange, L), q || k.sm().ums(L.handleSelectionChange, L)), L._dataModel = a, a.mm(L.handleDataModelChange, L), a.md(L.handleDataPropertyChange, L), q ? q._21I(a) : a.sm().ms(L.handleSelectionChange, L), L.invalidateAll(!0), L.invalidateLight(), L.fp(Mj, k, a)) }, handleDataPropertyChange: function (T) { var o = T.data; this.invalidateData(o), Yg(o) && "s:light.type" === T.property && this.invalidateLight() }, invalidateLight: function () { this._lightChanged || (this._lightChanged = !0, this.iv()) }, onPropertyChanged: function (y) { var e = this, w = y.property; e.iv(), e._18Q = l, "eye" === w ? e._33Q = !0 : "devicePixelRatio" === w ? e._42(l, e._devicePixelRatio || Sm) : fn[w] && xr(e) }, _5O: function (m) { var S = m._22Q(); return S ? new S(this, m) : l }, getData3dUI: function (T) { var k = this._25I[T._id]; return k === Z && (k = this._5O(T), this._25I[T._id] = k), k }, invalidateAll: function (h) { var i = this; if (h) { for (var s in i._25I) { var p = i._25I[s]; p && p.dispose() } i._25I = {}, i.iv(), is(i) } else i.dm().each(function (O) { i.invalidateData(O) }) }, invalidateSelection: function () { var H = this; H.sm().each(function (E) { H.invalidateData(E) }) }, invalidateData: function (h) { var T = this, w = T.getData3dUI(h); w && (w.iv(), T.iv()), is(T, h) }, getShape3dText: function (u) { return u.getStyle("shape3d.text") || this.getLabel(u) }, invalidateBatch: function (u) { var E = this, Y = E._33O, _ = Y[u], N = [], j = {}; if (_) { _.ds.forEach(function (n) { var u = E.getData3dUI(n); u && u.iv(), delete E._34O[n._id], N.push(n._id) }), delete Y[u]; for (var X, H, G, b, S, q, x, B, m, W = 0; 2 > W; W++) { var L = E[["_wireframeModelMap", "_polylineModelMap"][W]], A = E[["_wireframeIndexMap", "_polylineIndexMap"][W]]; for (j = {}, B = 0; B < N.length; B++) { var I = A[N[B]]; if (I) { delete A[N[B]], m = I.batch, X = L[m]; var y = I.begin, D = I.size, n = 3 * y, r = 3 * D, P = 4 * y, g = 4 * D; for (H = X.ds, G = X.vs, b = X.cs, S = X.ps, q = X.ls, x = I.index, X.invalidate = !0, H[x] = Z, x = n; n + r > x; x++)G[x] = Z; for (x = P; P + g > x; x++)b[x] = Z; for (x = P; P + g > x; x++)S[x] = Z; if (q) for (x = n; n + r > x; x++)q[x] = Z; j[m] = !0 } } for (m in j) { X = L[m], H = X.ds, G = X.vs, b = X.cs, S = X.ps, q = X.ls; var v = []; for (x = 0; x < H.length; x++)H[x] !== Z && v.push(H[x]); if (0 === v.length) delete L[m]; else { for (X.ds = v, v = [], x = 0; x < G.length; x++)G[x] !== Z && v.push(G[x]); for (X.vs = v, v = [], x = 0; x < b.length; x++)b[x] !== Z && v.push(b[x]); for (X.cs = v, v = [], x = 0; x < S.length; x++)S[x] !== Z && v.push(S[x]); if (X.ps = v, q) { for (v = [], x = 0; x < q.length; x++)q[x] !== Z && v.push(q[x]); X.ls = v } } } } E.iv() } }, handleDataModelChange: function (N) { var x = this, _ = N.kind, h = N.data; if ("add" === _) x.invalidateData(h), zl(h) && h.getEdgeGroup() && h.getEdgeGroup().eachSiblingEdge(x.invalidateData, x), Yg(h) && x.invalidateLight(); else if (_ === ee) { var D = h._id, g = x._25I[D]; g && (g.dispose(), delete x._25I[D], x.iv()), h === x._currentSubGraph && x.setCurrentSubGraph(l), is(x, h), Yg(h) && x.invalidateLight() } else _ === rr && (x.invalidateAll(!0), x.setCurrentSubGraph(l), is(x), x.invalidateLight()) }, toCanvas: function (f) { var r = this, Y = r.getGL(); if (r.validate(), f) { var U = Y.getParameter(Y.COLOR_CLEAR_VALUE); Td(Y, f) } r._42(l, 1); var e = r.getWidth(), F = r.getHeight(), D = new Uint8Array(4 * e * F), B = sc(), W = B.getContext("2d"); Y.readPixels(0, 0, e, F, Y.RGBA, Y.UNSIGNED_BYTE, D), co(B, e, F, 1); for (var z = W.getImageData(0, 0, e, F), $ = z.data, N = 0; N < $.length; N += 4) { var j = N / 4, V = G(j / e), H = j - V * e; j = 4 * ((F - 1 - V) * e + H), $[j] = D[N], $[j + 1] = D[N + 1], $[j + 2] = D[N + 2], $[j + 3] = D[N + 3] } return W.putImageData(z, 0, 0), f && Td(Y, U), r._42(l, r._devicePixelRatio || Sm), B }, toDataURL: function (Y, r) { var T = this, a = T.getGL(); if (T.validate(), Y) { var L = a.getParameter(a.COLOR_CLEAR_VALUE); Td(a, Y) } T._42(l, 1); var x = T._canvas.toDataURL(r || "image/png", 1); return Y && Td(a, L), T._42(l, T._devicePixelRatio || Sm), x }, getGL: function () { var A = this, y = A._26I, o = A._prg; if (!y) try { A._2O = {}, y = A._26I = A._canvas.getContext("webgl", A._attributes) || A._canvas.getContext("experimental-webgl", A._attributes), y._emptyTexture = tc(y), A._buffer = { vs: gd(y), ns: gd(y), is: gd(y), uv: gd(y), batchColor: gd(y), batchBlend: gd(y), batchBrightness: gd(y), lineDistance: gd(y) }, A._1O = $b(y); var p = A._cube = { vs: gd(y), ns: gd(y), is: gd(y), uv: gd(y) }; Sj(y, p.vs, cr), Sj(y, p.ns, ud), Sj(y, p.uv, Ci), hs(y, p.is, aj) } catch (g) { } if (y && !o) { if (o = A._prg = y.createProgram(), !o) return l; var N = A._dirs.length, I = A._spots.length, B = A._59O.length, j = ["uPMatrix", "uMVMatrix", "uNMatrix", "uViewMatrix", "aNormal", "aUv", "uOffsetScale", "uDiffuse", "uBlend", "uBlendColor", "uBrightness", "uPartOpacity", "uTransparent", "uTexture", "uSampler", "uDiscardSelectable", "uFix", "uPick", "uReverseFlip", "uFixPickReverseColor", "uBatchBrightness", "aBatchBrightness", "uBatchColor", "aBatchColor", "uBatchBlend", "aBatchBlend", "uDash", "aLineDistance", "uDashDistance", "uDashGapDistance", "uLight", "uHeadlightRange", "uHeadlightColor", "uFogColor", "uFogNear", "uFogFar"]; N && j.push("uDirColor", "uDirPosition"), I && j.push("uSpotColor", "uSpotRange", "uSpotAngle", "uSpotExponent", "uSpotPosition", "uSpotCenter"), B && j.push("uPointColor", "uPointRange", "uPointPosition"), Td(y, [0, 0, 0, 0]), y.clearDepth(1), y.enable(y.DEPTH_TEST), y.depthFunc(y.LEQUAL), y.enable(y.BLEND), y.blendFunc(y.SRC_ALPHA, y.ONE_MINUS_SRC_ALPHA), Hk || (Br = ss(Br.substring(0, Br.indexOf("^#"))), Tg = ss(Tg), Hk = !0); var t = ["#define MAX_DIR " + N, "#define MAX_SPOT " + I, "#define MAX_POINT " + B, A._fogDisabled ? "" : "#define FOG", A._dashDisabled ? "" : "#define DASH", A._batchColorDisabled ? "" : "#define BATCHCOLOR", A._batchBlendDisabled ? "" : "#define BATCHBLEND", A._batchBrightnessDisabled ? "" : "#define BATCHBRIGHTNESS", ""].join("\n"), S = Jn(y, o, y.VERTEX_SHADER, Br.replace("PREFIX", t)), w = Jn(y, o, y.FRAGMENT_SHADER, Tg.replace("PREFIX", t)); r ? j.push("aPosition") : (o.aPosition = 0, y.bindAttribLocation(o, 0, "aPosition")), y.linkProgram(o), j.forEach(function (Q) { o[Q] = /^u/.test(Q) ? y.getUniformLocation(o, Q) : y.getAttribLocation(o, Q) }), y.useProgram(o), y.deleteShader(S), y.deleteShader(w) } return y }, getBrightness: function ($) { var v = $.s("brightness"), u = this.isSelected($) ? $.s("select.brightness") : l; return v == l ? u : u == l ? v : v * u }, getWireframe: function (y) { var e = y.s("wf.visible"), f = y.s("wf.width"); return e === !0 || f > 0 && "selected" === e && this.isSelected(y) ? { color: y.s("wf.color"), width: f, "short": y.s("wf.short"), mat: y.s("wf.mat") } : void 0 }, getBodyColor: function (s) { return s.s("body.color") }, getMat: function (y) { return y.getMat ? y.getMat() : y.s("mat") }, getFaceMat: function (K, k) { return K.getFaceMat ? K.getFaceMat(k) : K.s(k + ".mat") }, getFaceBlend: function (h, C) { return h.s(C + ".blend") || h.s("all.blend") }, getFaceColor: function (G, m) { return G.s(m + ".color") || G.s("all.color") }, getFaceImage: function (u, i) { return u.s(i + ".image") || u.s("all.image") }, getFaceDiscardSelectable: function (v, U) { var K = v.s(U + ".discard.selectable"); return K == l ? v.s("all.discard.selectable") : K }, getFaceUv: function (S, E) { return S.s(E + ".uv") || S.s("all.uv") }, getFaceUvOffset: function (A, S) { return A.s(S + ".uv.offset") || A.s("all.uv.offset") }, getFaceUvScale: function (o, s) { return o.s(s + ".uv.scale") || o.s("all.uv.scale") }, getFaceLight: function (x, i) { var z = x.s(i + ".light"); return z == l ? x.s("all.light") : z }, getFaceVisible: function (E, p) { var D = E.s(p + ".visible"); return D == l ? E.s("all.visible") : D }, getFaceOpacity: function (W, Q) { var L = W.s(Q + ".opacity"); return L == l ? W.s("all.opacity") : L }, getFaceTransparent: function (b, D) { var k = b.s(D + ".transparent"); return k == l ? b.s("all.transparent") : k }, getFaceReverseColor: function (z, N) { return z.s(N + ".reverse.color") || z.s("all.reverse.color") }, getFaceReverseFlip: function (t, P) { var q = t.s(P + ".reverse.flip"); return q == l ? t.s("all.reverse.flip") : q }, getFaceReverseCull: function (Q, u) { var i = Q.s(u + ".reverse.cull"); return i == l ? Q.s("all.reverse.cull") : i }, getTextureMap: function () { return this._2O }, deleteTexture: function (T) { var k = this, t = k._2O[T]; t && (delete k._2O[T], k.getGL().deleteTexture(t)) }, getTexture: function (K, s) { if (!K) return l; var c = this, _ = c.getGL(), t = c._2O[K]; if (!t) { var V = yj(K); if (V) if (V.tagName) { if (V.dynamic) return $b(_, V, c._1O); t = c._2O[K] = $b(_, V) } else { var f = nq(V, s), u = Jf(V, s); if (f >= 1 && u >= 1) { var L = Sq(f, u); return mp(L, V, 0, 0, f, u, s, c), L.restore(), $b(_, Ro, c._1O) } } } return t }, redraw: function () { this.iv() }, validateImpl: function () { var L = this; if (L._lightChanged) { L._lightChanged = !1; var q = [], t = [], x = []; L.dm().each(function (n) { if (Yg(n)) { var a = n.s("light.type"); a === Pq ? q.push(n) : a === ug ? t.push(n) : a === mg && x.push(n) } }), (q.length !== L._59O.length || t.length !== L._spots.length || x.length !== L._dirs.length) && xr(L), L._59O = q, L._spots = t, L._dirs = x } L._42(), L._1o.iv() }, _42: function (E, t) { var N = this; if (!N._35O && (!xi || xm(xi))) { var v, T; E && (E instanceof jf ? T = E : v = E); var X = N._canvas, o = N.getWidth(), Q = N.getHeight(), g = N.getGL(), q = N._prg; if (g) { if (t ? E || co(X, o, Q, t) : (t = N._devicePixelRatio || Sm, E || o === X.clientWidth && Q === X.clientHeight || co(X, o, Q, t)), g.viewport(0, 0, o * t, Q * t), N._81O = l, g.clear(g.COLOR_BUFFER_BIT | g.DEPTH_BUFFER_BIT), kp(g, q.uBrightness, 1), kp(g, q.uOpacity, 1), kp(g, q.uPartOpacity, 1), g._picking = !!E, kp(g, q.uPick, !!E), kp(g, q.uTexture, !1), kp(g, q.uFix, !1), kp(g, q.uTransparent, !1), kp(g, q.uBatchColor, !1), kp(g, q.uBatchBlend, !1), kp(g, q.uBatchBrightness, !1), E || (Rn(N, g, q), N._fogDisabled || (kp(g, q.uFogColor, N._fogColor), kp(g, q.uFogNear, N._fogNear), kp(g, q.uFogFar, N._fogFar))), ni(g, q.aPosition), ni(g, q.aNormal), Lf(g, q.aUv), Lf(g, q.aBatchColor), Lf(g, q.aBatchBlend), Lf(g, q.aBatchBrightness), Lf(g, q.aLineDistance), kp(g, q.uPMatrix, Ge(N)), kp(g, q.uViewMatrix, Qb(N, N._7O)), T) { var r = g.getParameter(g.COLOR_CLEAR_VALUE); g.clearColor(0, 0, 0, 0), g.disable(g.BLEND), Lf(g, q.aNormal), Sj(g, N._cube.vs, l, q.aPosition), hs(g, N._cube.is), lr(T, N, Xr, 0), lr(T, N, Mb, 6), lr(T, N, kf, 12), lr(T, N, ak, 18), lr(T, N, ys, 24), lr(T, N, yn, 30), ni(g, q.aNormal), Td(g, r) } else if (v) { v.value = 2; var r = g.getParameter(g.COLOR_CLEAR_VALUE); g.clearColor(0, 0, 0, 0), g.disable(g.BLEND), N._95I(g, q, v), Ed(N, v), pi(N, N._polylineModelMap, v), pi(N, N._wireframeModelMap, v), kp(g, q.uTransparent, !0), N._95I(g, q, v, !0), Ed(N, v, !0), pi(N, N._polylineModelMap, v, !0), pi(N, N._wireframeModelMap, v, !0), kp(g, q.uTransparent, !1), g.disable(g.DEPTH_TEST), N._30O._42(g, q, v), g.enable(g.DEPTH_TEST), Td(g, r) } else g.disable(g.BLEND), N.drawSky(g, q), N._31O._42(g, q), N._95I(g, q), Ed(N), pi(N, N._polylineModelMap), pi(N, N._wireframeModelMap), g.enable(g.BLEND), g.depthMask(!1), kp(g, q.uTransparent, !0), N._95I(g, q, l, !0), Ed(N, l, !0), pi(N, N._polylineModelMap, l, !0), pi(N, N._wireframeModelMap, l, !0), kp(g, q.uTransparent, !1), g.depthMask(!0), g.disable(g.BLEND), g.disable(g.DEPTH_TEST), N._32O._42(g, q), N._30O._42(g, q), g.enable(g.DEPTH_TEST); Sj(g, l), hs(g, l), N._33Q = !1 } } }, _updateSkyBoxPosition: function (w) { if (this._skyBox && w && "eye" === w.property) { var A = w.newValue; this._skyBox.p3(A[0], A[1], A[2]), this.invalidateData(this._skyBox) } }, setSkyBox: function (o) { this._skyBox = o, this.ump(this._updateSkyBoxPosition, this), this.invalidateAll(), o && (this.mp(this._updateSkyBoxPosition, this), this._updateSkyBoxPosition()) }, drawSky: function (T, $, e) { var t = this, i = t._skyBox; if (i) { var M = t._headlightIntensity, g = db(t._headlightColor), $ = t._prg; 1 !== M && (g = [g[0] * M, g[1] * M, g[2] * M]), kp(T, $.uHeadlightColor, [g[0], g[1], g[2], 1]); var u = t.getData3dUI(i); u && u._42(T, $, e, function () { return !0 }), T.clear(T.DEPTH_BUFFER_BIT), kp(T, $.uHeadlightColor, [g[0], g[1], g[2], t._headlightDisabled ? 1 : 0]) } }, _95I: function (M, R, e, x) { function i(D) { if (z.isVisible(D) && (!O || j)) { if (!e && z.isTransparentMask(D)) return; var t = z.getData3dUI(D); t && t._42(M, R, e, L) } } var z = this, L = function (z) { return x ? z : !z }; z.sky && M.clear(M.DEPTH_BUFFER_BIT), z.dm().each(i) }, getLogicalPoint: function (V) { return mj(V, this._canvas) }, getHitFaceInfo: function (Y) { Y.target && (Y = this.lp(Y)); var M = this.getDataInfoAt(Y); if (M) { var G = this._1o.face(M.data, Dh(Y.x, Y.y)); if (G) return { data: M.data, face: G } } return l }, getDataAt: function (_) { var d = this.getDataInfoAt(_); return d ? d.data : l }, getDataInfoAt: function (k, L) { return k.target && (k = this.lp(k)), this._1o.get(Dh(k.x, k.y, L), !0) }, getDatasInRect: function ($) { return this._1o.get($) }, setEditable: function (l) { var C = this, Y = C._editable; C._editable = l, this.fp(Fp, Y, l) }, isEditable: function (v) { var V = this; return V._editable ? $j(v) ? v.s("3d.editable") ? V._editableFunc ? V._editableFunc(v) : !0 : !1 : !1 : !1 }, isSelectable: function (m) { return m.s("3d.selectable") && this.sm().isSelectable(m) }, isMovable: function (h) { var G = this; return zl(h) && h.getStyle(jj) !== fg ? !1 : h.s("3d.movable") ? G._movableFunc ? G._movableFunc(h) : !0 : !1 }, isSizeEditable: function (x) { return $j(x) ? this._sizeEditableFunc ? this._sizeEditableFunc(x) : !0 : !1 }, isRotationEditable: function (c) { return $j(c) && c.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(c) : !0 : !1 }, handleDelete: function () { this._editable && this.removeSelection() }, zoomIn: function (_) { this.setZoom(kb, _) }, zoomOut: function (L) { this.setZoom(1 / kb, L) }, setZoom: function (M, T) { if (1 !== M) { var f = this; if (f._ortho) return f.setOrthoZoom(M, T), void 0; f._14o && f._14o.stop(!0); var D = 1 / M, y = f._eye, B = f._center, O = B[0] + (y[0] - B[0]) * D - y[0], q = B[1] + (y[1] - B[1]) * D - y[1], Z = B[2] + (y[2] - B[2]) * D - y[2]; if (!(Bk(y, B) < f._moveStep && 1 > D)) { if (T = al(T)) { var V = Ln(y); return T.action = function (c) { f.fi({ kind: f._zooming ? "betweenZoom" : "beginZoom" }), f._zooming = 1, y[0] = V[0] + O * c, y[1] = V[1] + q * c, y[2] = V[2] + Z * c, f.fp(rs, l, y) }, T._37o = function () { delete f._14o, delete f._zooming, f.fi({ kind: "endZoom" }), f.onZoomEnded() }, f._14o = _g(T) } y[0] += O, y[1] += q, y[2] += Z, f.fp(rs, l, y) } } }, setOrthoZoom: function (h, N) { if (1 !== h) { var j = this; j._14o && j._14o.stop(!0); var u = j._orthoWidth, O = u / h - u; if (!(u < j._moveStep && h > 1)) return (N = al(N)) ? (N.action = function (f) { j.fi({ kind: j._zooming ? "betweenZoom" : "beginZoom" }), j._zooming = 1, j.setOrthoWidth(u + O * f) }, N._37o = function () { delete j._14o, delete j._zooming, j.fi({ kind: "endZoom" }), j.onZoomEnded() }, j._14o = _g(N)) : (j.setOrthoWidth(u / h), void 0) } }, getPositionInfo: function (Z) { var x = this, P = x._eye, u = x._center, V = x.getAspect(), U = Z ? Wl(gs(u, P, !0), gs(Z, P)) : Bk(P, u); if (x._ortho) { var Y = x._orthoWidth; return { length: U, height: Y / V, width: Y } } var g = 2 * z(x._fovy / 2) * U; return { length: U, height: g, width: g * V } }, getCenterInfo: function () { var o = this; return o._81O || (o._81O = o.getPositionInfo()), Ln(o._81O) }, rotate: function (j, K, u, C) { var M = this; if (j || K) { C == l && (C = M._firstPersonMode), M._88O && M._88O.stop(!0); var b = M._center, x = M._eye, n = M.getCenterInfo().length, d = C ? b : x, H = C ? x : b, Q = gs(d, H), Z = I(Q[0], Q[2]), w = I(o(Q[0] * Q[0] + Q[2] * Q[2]), Q[1]), g = C ? vr : rs; return C && (K = -K), (u = al(u)) ? (u.action = function (o) { M.fi({ kind: M._rotating ? "betweenRotate" : "beginRotate" }), M._rotating = 1; var R = Z + j * o, a = w + K * o; a = hn(a), Q[0] = n * t(a) * t(R), Q[1] = n * S(a), Q[2] = n * t(a) * S(R), d[0] = H[0] + Q[0], d[1] = H[1] + Q[1], d[2] = H[2] + Q[2], M.fp(g, l, d) }, u._37o = function () { delete M._88O, delete M._rotating, M.fi({ kind: "endRotate" }), M.onRotateEnded() }, M._88O = _g(u)) : (Z += j, w += K, w = hn(w), Q[0] = n * t(w) * t(Z), Q[1] = n * S(w), Q[2] = n * t(w) * S(Z), d[0] = H[0] + Q[0], d[1] = H[1] + Q[1], d[2] = H[2] + Q[2], M.fp(g, l, d), void 0) } }, pan: function (p, T, x, N) { if (p || T) { var H = this; N == l && (N = H._firstPersonMode), H._89O && H._89O.stop(!0); var E = Qb(H), V = [E[0] * p, E[4] * p, E[8] * p], c = [E[1] * T, E[5] * T, E[9] * T], n = V[0] + c[0], r = V[1] + c[1], $ = V[2] + c[2], m = H._center, f = H._eye; if (N) { var i = ps(H.getBoundaries(), f[0], f[2], f[0] + n, f[2] + $, o(n * n + $ * $)); n = i[0], $ = i[1] } if (x = al(x)) { var P = Ln(f), t = Ln(m); return x.action = function (K) { H.fi({ kind: H._panning ? "betweenPan" : "beginPan" }), H._panning = 1, m[0] = t[0] + n * K, m[1] = t[1] + r * K, m[2] = t[2] + $ * K, f[0] = P[0] + n * K, f[1] = P[1] + r * K, f[2] = P[2] + $ * K, H.fp(rs, l, f), H.fp(vr, l, m) }, x._37o = function () { delete H._89O, delete H._panning, H.fi({ kind: "endPan" }), H.onPanEnded() }, H._89O = _g(x) } m[0] += n, m[1] += r, m[2] += $, f[0] += n, f[1] += r, f[2] += $, H.fp(rs, l, f), H.fp(vr, l, m) } }, walk: function (E, z, i) { if (E) { var r = this; i == l && (i = r._firstPersonMode), r._90O && r._90O.stop(!0); var x = r._center, e = r._eye, s = gs(x, e, !0); if (i) { var F = ps(r.getBoundaries(), e[0], e[2], e[0] + s[0] * E, e[2] + s[2] * E, A(E)); if (E = Bk(F), !E) return; s = [F[0] / E, 0, F[1] / E] } if (z = al(z)) { var G = Ln(e), Q = Ln(x); return z.action = function (d) { r.fi({ kind: r._walking ? "betweenWalk" : "beginWalk" }), r._walking = 1; var K = E * d; e[0] = G[0] + s[0] * K, e[1] = G[1] + s[1] * K, e[2] = G[2] + s[2] * K, x[0] = Q[0] + s[0] * K, x[1] = Q[1] + s[1] * K, x[2] = Q[2] + s[2] * K, r.fp(rs, l, e), r.fp(vr, l, x) }, z._37o = function () { delete r._90O, delete r._walking, r.fi({ kind: "endWalk" }), r.onWalkEnded() }, r._90O = _g(z) } e[0] += s[0] * E, e[1] += s[1] * E, e[2] += s[2] * E, x[0] += s[0] * E, x[1] += s[1] * E, x[2] += s[2] * E, r.fp(rs, l, e), r.fp(vr, l, x) } }, handleScroll: function (r, s) { r.preventDefault(); var V = this, W = V._moveStep; V.isFirstPersonMode() ? V.isPannable() && V.pan(0, s > 0 ? W : -W) : V.isZoomable() && V.setZoom(0 > s ? 1 / ln : ln) }, handlePinch: function (p, Y) { this.isZoomable() && this.setZoom(Y > p ? 1 / Mp : Mp) }, reset: function () { this.setCenter(m.graph3dViewCenter), this.setEye(m.graph3dViewEye), this.setUp(m.graph3dViewUp) }, moveSelection: function (b, f, z) { var l, j = this, D = j.dm(); D && (l = D.getHistoryManager()), l && l.beginInteraction(), ok(this.sm().toSelection(this.isMovable, this), b, f, z), l && l.endInteraction() }, getMoveMode: function (G, i) { var I = i.s("3d.move.mode"); if (I) return I; var p = "88", y = "89", Q = "90"; return Qd(G) || Ne[p] && Ne[y] && Ne[Q] ? "xyz" : Ne[p] && Ne[y] ? "xy" : Ne[p] && Ne[Q] ? "xz" : Ne[y] && Ne[Q] ? "yz" : Ne[p] ? "x" : Ne[y] ? "y" : Ne[Q] ? "z" : "xz" }, handleTick: function () { var l = this, P = !1, u = l._moveStep, F = u, f = !1, M = !0, B = l._rotateStep * (M ? -1 : 1); if (l.isWalkable() || (F = 0), l.isPannable() || (u = 0), l.isRotatable() || (B = 0), l._32Q) { var J = (Fh() - l._32Q) / 50; F *= J, u *= J, B *= J } l._31Q && (Te(l._31Q), delete l._31Q, delete l._32Q), lh() && (P = !0, l.pan(-u, 0, f, M)), Wr() && (P = !0, l.pan(u, 0, f, M)), _b() && (P = !0, Qd() ? l.pan(0, u, f, M) : l.walk(F, f, M)), ar() && (P = !0, Qd() ? l.pan(0, -u, f, M) : l.walk(-F, f, M)), Qi() && (P = !0, l.rotate(-B, 0, f, M)), Kh() && (P = !0, l.rotate(B, 0, f, M)), Ef() && (P = !0, l.rotate(0, -B / 2, f, M)), hr() && (P = !0, l.rotate(0, B / 2, f, M)), P && (l._32Q = Fh(), l._31Q = iq(l.handleTick, l)) }, handleKeyDown: function (U) { var y = this; !ec(U) && Xi[U.keyCode] ? y.handleTick() : Tn(U) ? y.selectAll() : Th(U) ? y.handleDelete(U) : Pk(U) && this.isResettable() && y.reset() }, checkDoubleClickOnNote: function (Y, m, t) { var b = this; if (t === Yf) { if (m.s("note.toggleable")) return m.s(Yi, !m.s(Yi)), b.fi({ kind: "toggleNote", event: Y, data: m, part: t }), !0 } else if (t === Wd && m.s("note2.toggleable")) return m.s(Dd, !m.s(Dd)), b.fi({ kind: "toggleNote2", event: Y, data: m, part: t }), !0; return !1 }, checkDoubleClickOnRotation: function (T, I, j) { return j === bh ? (I.setRotationX(0), !0) : j === Kp ? (I.setRotationY(0), !0) : j === nk ? (I.setRotationZ(0), !0) : !1 }, onRotateEnded: function () { }, onWalkEnded: function () { }, toViewPosition: function (X) { var o = this, c = o.getWidth() / 2, l = o.getHeight() / 2, k = o._18Q; return k || (k = Ge(o), o._18Q = ri(k, k, Qb(o))), X = Bf([X[0], X[1], X[2], 1], k), { x: c + c * X[0] / X[3], y: l - l * X[1] / X[3] } }, getHitPosition: function (i, r, j) { var O = this, Z = O.getWidth(), S = O.getHeight(), o = i.target ? O.lp(i) : i, e = o.x - Z / 2, l = o.y - S / 2, V = O.getCenterInfo(), B = Qb(O); r = r ? r : [0, 0, 0], j = j ? j : [0, 1, 0], e = e / Z * V.width, l = -1 * l / S * V.height; var a = [B[0] * e, B[4] * e, B[8] * e], A = [B[1] * l, B[5] * l, B[9] * l], X = [a[0] + A[0], a[1] + A[1], a[2] + A[2]], Y = O.getCenter(), k = Ee(O, r, j, [X[0] + Y[0], X[1] + Y[1], X[2] + Y[2]]); return k ? k : [0, 0, 0] }, getLineLength: function (F) { this.validate(); var x = this.getData3dUI(F); if (x && x.getCache) { var u = x.getCache(); if (u) return u[u.length - 1].length } return 0 }, getLineOffset: function (g, j) { var Y = this.getData3dUI(g); if (Y && Y.getCache) { var Q = Y.getCache(); if (Q) return Vk(Q, j) } return l }, isLabelVisible: function () { return !0 }, isNoteVisible: function () { return !0 } }); var Kb = Dj.Interactor = function (f) { this.gv = f }; lb("Interactor", F, { ms_listener: 1, getView: function () { return this.gv.getView() }, setUp: function () { this.addListeners() }, tearDown: function () { this.removeListeners() } }); var cb = Dj.DefaultInteractor = function (l) { xd(cb, this, [l]) }; lb("DefaultInteractor", Kb, {
            handle_contextmenu: function (g) { np(g) }, handle_mousewheel: function (F) { this.gv.handleScroll(F, F.wheelDelta / 40) }, handle_DOMMouseScroll: function (N) { 2 === N.axis && this.gv.handleScroll(N, -N.detail) }, handle_keydown: function (i) { this.gv.handleKeyDown(i) }, handle_mousedown: function (t) { this.handle_touchstart(t) }, handle_touchstart: function (j) { np(j); var M = this, c = M.gv, y = Vg(j), G = c.getDataInfoAt(j), d = G ? G.data : l, $ = G ? G.part : l, U = c.sm(), Z = Fl(j), v = Ak(j); c.setFocus(j) && (M._62O = l, M._57I = l, d ? ec(j) ? U.co(d) ? U.rs(d) : U.as(d) : U.co(d) || U.ss(d) : y && (ec(j) ? c.isRectSelectable() && (M._62O = Tm) : M._57I = gi(j)), M._31Q && (Te(M._31Q), delete M._31Q, delete M._32Q), M._62O || (c.isFirstPersonMode() && (Qd(j) || v > 2 ? M._62O = "pan" : c.isMouseRoamable() || P ? (M._62O = "roaming", M.foward = Z && Vg(j), M._32Q = Fh(), M._31Q = iq(M.tick, M)) : y || (M._62O = "roaming")), M._62O || (y && Z && En[$] ? (M._62O = $, M.p3 = d.p3()) : y && Z && $j(d) && c.isSelected(d) && c.isMovable(d) ? (M._62O = "move", M.p3 = d.p3(), M.movedata = d) : P && (v > 2 ? M._62O = "pan" : 2 === v && (M.dist = Do(j), M._62O = "pinch")))), M.point = c.lp(j), Af(M, j), Si(j) ? c.handleDoubleClick(j, d, $) : c.handleClick(j, d, $)) }, tick: function () { var l = this, x = l.gv, j = x._moveStep; l.point && x.isWalkable() && (l._32Q && (j *= (Fh() - l._32Q) / 50), x.walk(l.foward ? j : -j), l._32Q = Fh(), l._31Q = iq(l.tick, l)) }, handle_mouseup: function (C) { this.handle_touchend(C) }, handle_touchend: function (o) { var U = this._57I; U && (Bk(U, gi(o)) <= 1 && this.gv.sm().cs(), this._57I = l) }, handleWindowMouseMove: function (w) { this.handleWindowTouchMove(w) }, handleWindowTouchMove: function (x) {
                var S, m, J = this, t = J.gv, j = J._62O, y = J.point, N = t.dm(), b = N.getHistoryManager(), U = t.lp(x), s = U.x - y.x, c = U.y - y.y, R = -B * s / t.getWidth(), p = -B * c / t.getHeight();
                if ("roaming" === j) J.rotate(x, R / 2, p / 2); else if (j === bh || j === Kp || j === nk) b && !t._86O && b.beginInteraction(), t.fi({ kind: t._86O ? "betweenEditRotation" : "beginEditRotation", event: x }), t._86O = 1, t.sm().each(function (U) { if ($j(U) && t.isRotationEditable(U)) { var O = A(R) > A(p) ? R : p; j === bh ? U.setRotationX(U.getRotationX() + O) : j === Kp ? U.setRotationY(U.getRotationY() + O) : j === nk && U.setRotationZ(U.getRotationZ() + O) } }); else if ("move" === j || En[j]) { j === Or || j === be || j === Jm ? (b && !t._87O && b.beginInteraction(), t.fi({ kind: t._87O ? "betweenEditSize" : "beginEditSize", event: x }), t._87O = 1) : (b && !t._moving && b.beginInteraction(), t.fi({ kind: t._moving ? "betweenMove" : "beginMove", event: x }), t._moving = 1); var L, e = J.p3, d = t.getPositionInfo(e), w = Qb(t); L = j === Sk ? "x" : j === Id ? "y" : j === Yb ? "z" : j === Or ? "sx" : j === be ? "sy" : j === Jm ? "sz" : t.getMoveMode(x, J.movedata), s = s / t.getWidth() * d.width, c = -1 * c / t.getHeight() * d.height; var h, W, z = [w[0] * s, w[4] * s, w[8] * s], a = [w[1] * c, w[5] * c, w[9] * c], H = z[0] + a[0], v = z[1] + a[1], X = z[2] + a[2], M = [e[0] + H, e[1] + v, e[2] + X], i = gs(t.getEye(), M, !0); if ("xyz" === L ? (h = M, t.moveSelection(H, v, X)) : "xz" === L ? (h = Ee(t, e, [0, 1, 0], M), h && t.moveSelection(h[0] - e[0], 0, h[2] - e[2])) : "xy" === L ? (h = Ee(t, e, [0, 0, 1], M), h && t.moveSelection(h[0] - e[0], h[1] - e[1], 0)) : "yz" === L ? (h = Ee(t, e, [1, 0, 0], M), h && t.moveSelection(0, h[1] - e[1], h[2] - e[2])) : "x" === L || "sx" === L ? (i[0] = 0, h = Ee(t, e, i, M), h && (W = h[0] - e[0], "x" === L ? t.moveSelection(W, 0, 0) : t.sm().each(function (b) { $j(b) && t.isSizeEditable(b) && (S = g(Rc, b.getWidth() + W), m = S / b.getWidth(), b.setWidth(S), Qd(x) && (b.setHeight(b.getHeight() * m), b.setTall(b.getTall() * m))) }))) : "y" === L || "sy" === L ? (i[1] = 0, h = Ee(t, e, i, M), h && (W = h[1] - e[1], "y" === L ? t.moveSelection(0, W, 0) : t.sm().each(function (u) { $j(u) && t.isSizeEditable(u) && (S = g(Rc, u.getTall() + W), m = S / u.getTall(), u.setTall(S), Qd(x) && (u.setHeight(u.getHeight() * m), u.setWidth(u.getWidth() * m))) }))) : ("z" === L || "sz" === L) && (i[2] = 0, h = Ee(t, e, i, M), h && (W = h[2] - e[2], "z" === L ? t.moveSelection(0, 0, W) : t.sm().each(function (k) { $j(k) && t.isSizeEditable(k) && (S = g(Rc, k.getHeight() + W), m = S / k.getHeight(), k.setHeight(S), Qd(x) && (k.setTall(k.getTall() * m), k.setWidth(k.getWidth() * m))) }))), !h) return; J.p3 = h } else if (j === Tm) { var P = J.div; P || (P = J.div = Rl(), hq(J.getView(), P), P.op = y, P.style.background = t.getRectSelectBackground()), t.fi({ kind: t._rectSelecting ? "betweenRectSelect" : "beginRectSelect", event: x }), t._rectSelecting = 1, P.rect = eb(P.op, U), Up(P, P.rect) } else if ("pinch" === j && 2 === Ak(x)) { t.fi({ kind: t._pinching ? "betweenPinch" : "beginPinch", event: x }), t._pinching = 1; var W = Do(x); t.handlePinch(W, J.dist), J.dist = W } else "pan" === j || Qd(x) ? J.pan(x, s, c) : t.isFirstPersonMode() || (Vg(x) ? J.rotate(x, R, p) : (J.pan(x, s, 0), t.isWalkable() && (t.fi({ kind: t._walking ? "betweenWalk" : "beginWalk", event: x }), t._walking = 1, t.walk(c / t.getHeight() * t.getCenterInfo().height)))); J.point = U
            }, pan: function (h, f, p) { var Q = this.gv; if (Q.isPannable()) { var n = Q.getCenterInfo(), v = f / Q.getWidth() * n.width, S = -1 * p / Q.getHeight() * n.height; Q.fi({ kind: Q._panning ? "betweenPan" : "beginPan", event: h }), Q._panning = 1, Q.pan(-v, -S) } }, rotate: function (R, B, u) { var a = this.gv; a.isRotatable() && (a.fi({ kind: a._rotating ? "betweenRotate" : "beginRotate", event: R }), a._rotating = 1, a.rotate(B, u)) }, handleWindowMouseUp: function (d) { this.handleWindowTouchEnd(d) }, handleWindowTouchEnd: function (M) { var i = this, B = i.gv, N = B.dm(), p = N.getHistoryManager(), Q = i.div; if (Q) { var H = B.getDatasInRect(Q.rect); if (!H.isEmpty()) { var _ = B.sm(), v = _.toSelection(); H.each(function (I) { _.co(I) ? v.remove(I) : v.add(I) }), _.ss(v) } Ng(Q) } B._moving && (delete B._moving, B.fi({ kind: "endMove", event: M }), B.onMoveEnded(), p && p.endInteraction()), B._panning && (delete B._panning, B.fi({ kind: "endPan", event: M }), B.onPanEnded()), B._rotating && (delete B._rotating, B.fi({ kind: "endRotate", event: M }), B.onRotateEnded()), B._86O && (delete B._86O, B.fi({ kind: "endEditRotation", event: M }), p && p.endInteraction()), B._87O && (delete B._87O, B.fi({ kind: "endEditSize", event: M }), p && p.endInteraction()), B._pinching && (delete B._pinching, B.fi({ kind: "endPinch", event: M }), B.onPinchEnded()), B._rectSelecting && (delete B._rectSelecting, B.fi({ kind: "endRectSelect", event: M }), B.onRectSelectEnded()), B._walking && (delete B._walking, B.fi({ kind: "endWalk", event: M }), B.onWalkEnded()), i.dist = i.point = i._62O = i.p3 = i.movedata = i.div = i._57I = i._32Q = i._31Q = i.foward = l }
        }); var nh = function (a) { this.gv = a }; uo(nh, F, { _iv: !0, iv: function () { this._iv = !0 }, face: function (v, k) { var r = this, T = r.gv.getGL(); if (!T || !$j(v)) return l; var S = k.x, x = k.width, V = k.height, p = r.height - k.y - V, m = G(x / 2), L = new Uint8Array(4 * x * V), f = 0; for (r.iv(), r.validate(v), pk(T, r.frame), T.readPixels(S, p, x, V, T.RGBA, T.UNSIGNED_BYTE, L), pk(T, l), r.iv(); m >= f; f++)for (var h = m - f, n = m + f, I = h; n >= I; I++)for (var i = h; n >= i; i++)if (I === h || I === n || i === h || i === n) { var t = es.m[L[4 * (I * x + i)]]; if (t) return t } }, get: function (R, T) { this.validate(); var D = this, Z = D.gv.getGL(); if (!Z) return l; var x, P, Q = R.x, b = R.width, n = R.height, p = D.height - R.y - n, g = G(b / 2), N = new Uint8Array(4 * b * n), V = 0, e = N.length, q = T ? l : new Ul, U = T ? l : {}; if (pk(Z, D.frame), Z.readPixels(Q, p, b, n, Z.RGBA, Z.UNSIGNED_BYTE, N), pk(Z, l), T) { for (; g >= V; V++)for (var O = g - V, H = g + V, J = O; H >= J; J++)for (var K = O; H >= K; K++)if ((J === O || J === H || K === O || K === H) && (x = D.info(N, 4 * (J * b + K)))) return x } else for (; e > V; V += 4)x = D.info(N, V), x && (P = x.data, U[P._id] || (q.add(P), U[P._id] = P)); return q }, info: function (K, q) { return this.colorMap[(K[q] << 24) + (K[q + 1] << 16) + (K[q + 2] << 8) + K[q + 3]] }, validate: function (C) { var Q = this, O = Q.gv, d = O.getGL(); if (d) { var E = O.getWidth(), p = O.getHeight(), x = d.RGBA, P = d.TEXTURE_2D, s = d.RENDERBUFFER, $ = d.FRAMEBUFFER; Q.texture || (Q.texture = $b(d), Q.render = d.createRenderbuffer(), Q.frame = d.createFramebuffer()), (Q.width !== E || Q.height !== p) && (de(d, Q.texture), d.texImage2D(P, 0, x, E, p, 0, x, d.UNSIGNED_BYTE, l), hc(d, d.TEXTURE_MIN_FILTER, d.LINEAR), d.bindRenderbuffer(s, Q.render), d.renderbufferStorage(s, d.DEPTH_COMPONENT16, E, p), pk(d, Q.frame), d.framebufferTexture2D($, d.COLOR_ATTACHMENT0, P, Q.texture, 0), d.framebufferRenderbuffer($, d.DEPTH_ATTACHMENT, s, Q.render), de(d, l), d.bindRenderbuffer(s, l), pk(d, l), Q.width = E, Q.height = p), Q._iv && (Q._iv = !1, pk(d, Q.frame), O._42(C || (Q.colorMap = {}), 1), pk(d, l)) } } }); var Kl = function (n) { this.gv = n }; uo(Kl, F, { gap: 0, size: 0, _42: function (G, Y) { var C = this, J = C.gv, I = J._gridGap, B = J._gridSize; if (J._gridVisible) { if (C.gap !== I || C.size !== B) { for (var o = [], t = J._gridSize / 2, $ = I * t, d = 0; 2 * t + 1 > d; d++) { var h = 6 * d, y = 6 * (2 * t + 1) + h; o[h] = -$, o[h + 1] = 0, o[h + 2] = -$ + d * I, o[h + 3] = $, o[h + 4] = 0, o[h + 5] = -$ + d * I, o[y] = -$ + d * I, o[y + 1] = 0, o[y + 2] = -$, o[y + 3] = -$ + d * I, o[y + 4] = 0, o[y + 5] = $ } C.vs = new ub(o), C.gap = I, C.size = B } Hq(J), td(G, Y), Yo(G), Yp(G, Y, 1, J._gridColor, J._buffer.vs, C.vs), on(G, 0, C.vs.length / 3, G.LINES), ue(G), ti(G, Y) } else C.vs = C.gap = C.size = l } }); var wj = function (y) { this.gv = y }; uo(wj, F, { _42: function (L, F) { var j = this.gv, k = j._buffer.vs, P = j._axisXColor, U = j._axisYColor, V = j._axisZColor, s = j._originAxisVisible, O = j._centerAxisVisible; if (s || O) { var X = r ? L.TRIANGLES : L.TRIANGLE_FAN, Q = L.LINES; if (Hq(j), td(L, F), Yo(L), s) { var d = j.getCenterInfo(), t = b(d.width, d.height) / 5, n = .8 * t, E = .05 * t; Yp(L, F, 1.5, P, k, new ub([0, 0, 0, t, 0, 0, n, E, 0, n, 0, E, n, -E, 0, n, 0, -E, n, E, 0, 0, 0, 0, 0, t, 0, E, n, 0, 0, n, E, -E, n, 0, 0, n, -E, E, n, 0, 0, 0, 0, 0, 0, t, E, 0, n, 0, E, n, -E, 0, n, 0, -E, n, E, 0, n])), on(L, 0, 2, Q), on(L, 1, 6, X), Yp(L, F, l, U), on(L, 7, 2, Q), on(L, 8, 6, X), Yp(L, F, l, V), on(L, 14, 2, Q), on(L, 15, 6, X) } if (O) { var Z = j._center, G = Z[0], m = Z[1], A = Z[2], d = j.getPositionInfo(Z); t = b(d.width, d.height) / 20, Yp(L, F, 1.5, P, k, new ub([G, m, A, G + t, m, A, G, m, A, G, m + t, A, G, m, A, G, m, A + t])), on(L, 0, 2, Q), Yp(L, F, l, U), on(L, 2, 2, Q), Yp(L, F, l, V), on(L, 4, 2, Q) } ue(L), ti(L, F) } } }); var Em = function (o) { this.gv = o }, Sk = "edit_tx", Id = "edit_ty", Yb = "edit_tz", bh = "edit_rx", Kp = "edit_ry", nk = "edit_rz", Or = "edit_sx", be = "edit_sy", Jm = "edit_sz", En = {}; En[Sk] = 1, En[Id] = 1, En[Yb] = 1, En[bh] = 1, En[Kp] = 1, En[nk] = 1, En[Or] = 1, En[be] = 1, En[Jm] = 1, uo(Em, F, { _42: function (O, e, r) { var K = this, w = K.gv, l = w.sm().ld(); if (w.isEditable(l) && $j(l) && (!w.isFirstPersonMode() || !w.isMouseRoamable() && !P)) { Hq(w); var V, v, F = w.isMovable(l), k = w.isRotationEditable(l), B = w.isSizeEditable(l), $ = w._axisXColor, H = w._axisYColor, z = w._axisZColor, j = w._editSizeColor, i = w.getCenterInfo(), p = b(i.width, i.height) / 10, d = p / (r ? 5 : 10), J = .7 * p, D = .4 * J, s = l.p3(), G = s[0], U = s[1], L = s[2]; V = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], F && K._17O(O, e, l, r, Sk, $, V, [G, U - d, L, G + J, U - d, L, G + J, U, L, G + J, U, L, G, U, L, G, U - d, L, G, U - d, L + d, G + J, U - d, L + d, G + J, U - d, L, G + J, U - d, L, G, U - d, L, G, U - d, L + d]), v = G + J, B && K._17O(O, e, l, r, Or, j, V, [v, U - d, L, v + D, U - d, L, v + D, U, L, v + D, U, L, v, U, L, v, U - d, L, v, U - d, L + d, v + D, U - d, L + d, v + D, U - d, L, v + D, U - d, L, v, U - d, L, v, U - d, L + d]), v += D, k && K._17O(O, e, l, r, bh, $, V, [v, U - d, L, v + D, U - d, L, v + D, U, L, v + D, U, L, v, U, L, v, U - d, L, v, U - d, L + d, v + D, U - d, L + d, v + D, U - d, L, v + D, U - d, L, v, U - d, L, v, U - d, L + d]), V = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0], F && K._17O(O, e, l, r, Id, H, V, [G, U, L, G, U + J, L, G - d, U + J, L, G - d, U + J, L, G - d, U, L, G, U, L, G, U, L, G, U, L - d, G, U + J, L - d, G, U + J, L - d, G, U + J, L, G, U, L]), v = U + J, B && K._17O(O, e, l, r, be, j, V, [G, v, L, G, v + D, L, G - d, v + D, L, G - d, v + D, L, G - d, v, L, G, v, L, G, v, L, G, v, L - d, G, v + D, L - d, G, v + D, L - d, G, v + D, L, G, v, L]), v += D, k && K._17O(O, e, l, r, Kp, H, V, [G, v, L, G, v + D, L, G - d, v + D, L, G - d, v + D, L, G - d, v, L, G, v, L, G, v, L, G, v, L - d, G, v + D, L - d, G, v + D, L - d, G, v + D, L, G, v, L]), V = [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], F && K._17O(O, e, l, r, Yb, z, V, [G, U, L, G, U, L + J, G, U - d, L + J, G, U - d, L + J, G, U - d, L, G, U, L, G, U - d, L, G - d, U - d, L, G - d, U - d, L + J, G - d, U - d, L + J, G, U - d, L + J, G, U - d, L]), v = L + J, B && K._17O(O, e, l, r, Jm, j, V, [G, U, v, G, U, v + D, G, U - d, v + D, G, U - d, v + D, G, U - d, v, G, U, v, G, U - d, v, G - d, U - d, v, G - d, U - d, v + D, G - d, U - d, v + D, G, U - d, v + D, G, U - d, v]), v += D, k && K._17O(O, e, l, r, nk, z, V, [G, U, v, G, U, v + D, G, U - d, v + D, G, U - d, v + D, G, U - d, v, G, U, v, G, U - d, v, G - d, U - d, v, G - d, U - d, v + D, G - d, U - d, v + D, G, U - d, v + D, G, U - d, v]) } }, _17O: function (u, w, N, x, i, m, X, R) { var c = this.gv._buffer; $r(u, w, x, !0, N, i), Ub(u, w, l, !0, l, !0, l, !1), kp(u, w.uDiffuse, m), Sj(u, c.vs, new ub(R), w.aPosition), Sj(u, c.ns, new ub(X), w.aNormal), Yo(u), on(u, 0, 12), ue(u), Pc(u, w) } }); var Yr = function (U, T) { this.gv = U, this.s = function (f, m, s) { return m == l && (m = s), m == l ? T.getStyle(f) : oi(m, T, U) }, this.data = T }; uo(Yr, F, { I3d: !0, ms_icons: 1, _iv: !0, iv: function () { this._iv = !0 }, _42: function (I, f, Q, t) { var c = this, m = c.data; if (!(m instanceof Wo)) { var X, S, D, n, H, d, R, v = c.gv, u = m._id, M = c.s("batch"), o = v._34O, G = v._33O, B = v.isSelectable(m), Y = v.getBrightness(m), C = Y != l && 1 !== Y; if (c._iv) { if (D = og(o, G, m, M), c.validate(D, M ? Oq[M] || sn : l), D && (n = o[u], H = n.size = D.vs.length / 3 - n.begin, R = D.rs)) for (Y = C ? Y : 1, d = 0; H > d; d++)R.push(Y); if ($j(m)) { var U = v.getWireframe(m); U && Qm(v, m, U) } c.labelInfo = c.label2Info = c.noteInfo = c.note2Info = c._38o = l, c._24O(Sc, "getLabel"), c._24O(zp, "getLabel2"), c._26O(Yf, "getNote"), c._26O(Wd, "getNote2"), c._15O(), c._iv = !1 } C && kp(I, f.uBrightness, Y), S = $r(I, f, Q, B, m, Ob), S && (Oh(S, o[u], G), Oh(S, v._polylineIndexMap[u], v._polylineModelMap), Oh(S, v._wireframeIndexMap[u], v._wireframeModelMap)), o[u] || c._80o(I, f, t), v.isLabelVisible(m) && ((X = c.labelInfo) && ($r(I, f, Q, B, m, Sc), c._28O(X, Sc, t)), (X = c.label2Info) && ($r(I, f, Q, B, m, zp), c._28O(X, zp, t))), v.isNoteVisible(m) && ((X = c.noteInfo) && ($r(I, f, Q, B, m, Yf), c._29O(X, Yf, t)), (X = c.note2Info) && ($r(I, f, Q, B, m, Wd), c._29O(X, Wd, t))), (X = c._38o) && c._99O(I, f, X, Q, B, t), C && kp(I, f.uBrightness, 1) } }, validate: function () { }, _16O: function () { return hi }, _80o: function () { }, dispose: function () { }, getBodyColor: function (F) { var R = this.data, m = this.gv.getBodyColor(R); return m ? m : F ? R.getStyle(F) : l }, _24O: function (m, d) { var I = this, x = I.data, b = I.gv, i = I.s, B = b[d](x); if (B != l) { var n = i(m + ".scale"), w = i(m + ".max"), v = I[m + "Info"] = { label: B, textureScale: i(m + ".texture.scale"), color: b[d + "Color"](x), font: i(m + ".font"), align: i(m + ".align"), background: b[d + "Background"](x) }, W = v.rect = zd(v, B); w > 0 && w < W.width && (v.labelWidth = W.width, W.width = w), W.x = W.y = 0, W.width *= n, W.height *= n, v.mat = I._16O(i(m + ".autorotate"), i(m + ".position"), W, i(m + ".face"), i(m + ".t3"), i(m + ".r3"), i(m + ".rotationMode")); var T = W.width / 2, R = W.height / 2; v.vs = new ub([-T, R, 0, -T, -R, 0, T, -R, 0, T, R, 0]), W.width /= n, W.height /= n } }, _26O: function (g, C) { var o = this, S = o.data, K = o.gv, k = o.s, d = K[C](S); if (d != l) { var U = k(g + ".scale"), b = this[g + "Info"] = { note: d, textureScale: k(g + ".texture.scale"), expanded: k(g + ".expanded"), font: k(g + ".font"), color: k(g + ".color"), align: k(g + ".align"), borderWidth: k(g + ".border.width"), borderColor: k(g + ".border.color"), background: K[C + "Background"](S) }; if (b.expanded) { var V = k(g + ".max"), M = zd(b, d); M.width += 6, M.height += 2, V > 0 && V < M.width && (b.labelWidth = M.width, M.width = V); var h = { x: -M.width / 2, y: -8 - M.height, width: M.width, height: M.height + 8 } } else h = { x: -6, y: -18, width: 12, height: 18 }; b.mat = o._16O(k(g + ".autorotate"), k(g + ".position"), l, k(g + ".face"), k(g + ".t3"), k(g + ".r3"), k(g + ".rotationMode")), b.rect = h, 1 !== U && (h = Ln(h), h.x *= U, h.height *= U, h.y = -h.height, h.width *= U); var _ = h.x, T = h.y, J = h.width, N = h.height; b.vs = new ub([_, -T, 0, _, -T - N, 0, _ + J, -T - N, 0, _ + J, -T, 0]) } }, _28O: function (F, G, i) { if (i(this.s(G + ".transparent"))) { var W = F.rect, e = F.textureScale, d = W.width * e, Y = W.height * e; if (d >= 1 && Y >= 1) { var N = Sq(d, Y); 1 !== e && (N.translate(N, W.x, W.y), N.scale(e, e), N.translate(N, -W.x, -W.y)), kg(N, F), N.restore(), kh(this, G, F.mat, F.vs, !0) } } }, _29O: function (R, n, $) { if ($(this.s(n + ".transparent"))) { var Y = R.rect, J = R.textureScale, P = Y.x, O = Y.y, u = Y.width * J, s = Y.height * J; if (u >= 1 && s >= 1) { Y.x = Y.y = 0; var e = Sq(u, s); 1 !== J && e.scale(J, J), jo(e, R), e.restore(), Y.x = P, Y.y = O, kh(this, n, R.mat, R.vs, !1) } } }, _99O: function (Y, B, V, X, y, w) { if (V) { var G = this, C = G.gv, H = G.data, k = C._buffer, D = C._1O, T = V.icons; for (var K in T) { var j = T[K], s = V.rects[K]; if (s && w(oi(j.transparent, H, C))) { $r(Y, B, X, y, H, K); var W = oi(j.shape3d, H, C), A = W ? [W] : oi(j.names, H, C), J = A ? A.length : 0, Q = oi(j.textureScale, H, C) || 1, e = oi(j.light, H, C); e == l && (e = W ? !0 : !1), Ub(Y, B, oi(j.blend, H, C), e, oi(j.opacity, H, C), oi(j.reverseFlip, H, C), oi(j.reverseColor, H, C), oi(j.reverseCull, H, C)); for (var v = 0; J > v; v++) { var p = A[v], u = s[v]; if (ur(G, u.mat), W) Pf(C, H, $l(G, W), G); else { var t = yj(p); if (t) { var R = u.width * Q, $ = u.height * Q; if (R >= 1 && $ >= 1) { var z = Sq(R, $); ff(z, t, oi(j.stretch, H, C), 0, 0, R, $, H, C), z.restore(), $b(Y, Ro, D), Yo(Y, B, D, oi(j.discardSelectable, H, C), k.uv, jp), Sj(Y, k.vs, u.vs, B.aPosition), Sj(Y, k.ns, lm, B.aNormal), hs(Y, k.is, Wp), ql(Y, 0, Wp.length), ue(Y, B, D) } } } Nd(C) } Pc(Y, B) } } } } }); var wm = function (_, H) { xd(wm, this, [_, H]) }; uo(wm, Yr, { _16O: function (A, z, E, F, M, s, v, b, d) { var l = this.data, X = zc(z, l.s3(), E, F, b, d); return dq(Nq(), X, l.p3(), F, M, s, v, A, l.r3(), l.getRotationMode()) }, clear: function () { var $ = this; $.faceMat = $.mat = $.shapeModel = $.left = $.right = $.front = $.back = $.top = $.bottom = $.csg = l }, validate: function ($, T) { var v = this, i = v.gv, H = v.data, F = $l(v), c = wo(H, i.getMat(H), F ? v.s("shape3d.scaleable") : !0); if (v.clear(), $) { var X = []; F ? zr(i, H, F, v, v.getBodyColor(), [c], $, X) : (Er(i, H, $, T, c, Xr, X, ef), Er(i, H, $, T, c, kf, X, Ag), Er(i, H, $, T, c, ys, X, nf), Er(i, H, $, T, c, yn, X, Xd), Er(i, H, $, T, c, Mb, X, xk), Er(i, H, $, T, c, ak, X, Qg)), X.length && (an($.vs, X), an($.ns, tq(X))) } else v.mat = c, (v.shapeModel = F) || (v.vf(Xr), v.vf(kf), v.vf(Mb), v.vf(ak), v.vf(ys), v.vf(yn)) }, vf: function (Z) { var E = this; if (E.gv.getFaceVisible(E.data, Z)) { var o = _j(E, Z); return o.mat && (E.faceMat = !0), o } }, _80o: function ($, Q, T) { var k = this, M = k.gv, Z = k.data, a = M._cube, X = k.shapeModel; Hq(M, k.mat), X ? Pf(M, Z, X, k, k.getBodyColor(), T) : (Sj($, a.vs, l, Q.aPosition), Sj($, a.ns, l, Q.aNormal), hs($, a.is), k._18O($, Q, k.left, 0, T), k._18O($, Q, k.front, 6, T), k._18O($, Q, k.right, 12, T), k._18O($, Q, k.back, 18, T), k._18O($, Q, k.top, 24, T), k._18O($, Q, k.bottom, 30, T)), Nd(M), k.faceMat && (k._18O($, Q, k.left, 0, T, !0), k._18O($, Q, k.front, 6, T, !0), k._18O($, Q, k.right, 12, T, !0), k._18O($, Q, k.back, 18, T, !0), k._18O($, Q, k.top, 24, T, !0), k._18O($, Q, k.bottom, 30, T, !0)) }, _18O: function (L, u, b, p, g, B) { if (b) { if (!g(b.transparent)) return; if (B && !b.mat || !B && b.mat) return; B && Hq(this.gv, b.mat); var K = this, f = K.data, o = K.gv, M = o.getTexture(b.texture, f), F = b.uv, E = b.uvScale, R = b.uvOffset, V = b.discardSelectable; if (M) if (F) { for (var P = 8 * (p / 6), k = 0; 8 > k; k++)fc[P + k] = F[k]; Yo(L, u, M, V, o._buffer.uv, fc, R, E) } else Yo(L, u, M, V, o._cube.uv, l, R, E); else Yo(L); Ub(L, u, b.blend, b.light, b.opacity, b.reverseFlip, b.reverseColor, b.reverseCull), kp(L, u.uDiffuse, b.color), ql(L, p, 6), Pc(L, u), ue(L, u, M), B && Nd(o) } } }); var Ko = function (V, L) { xd(Ko, this, [V, L]) }; uo(Ko, Yr, { _25Q: 1, validate: function (t) { var $ = this, D = $.gv, N = $.data, w = $.s, o = w("edge.width"), Y = N._40I, y = N._41I; if ($.shapeModel = $.info = l, Y && y) { var _, F, g, V, E, H, W, u, T, d, K = N.isLooped(), P = w(jj), v = m.getEdgeType(P); if (v) { var i = v(N, Ji($, D, N, K, P), D, $._19Q); if (!i.points || i.points.isEmpty()) return; H = $.info = {}, W = i.segments, E = i.points, u = E.size(); for (var R = Y.getElevation(), n = y.getElevation(), G = 0; u > G; G++) { var A = E.get(G); A.e == l && (A.e = R + (n - R) * G / (u - 1)) } T = Sr(E.get(0)), d = Sr(E.get(u - 1)); var B = u % 2; 0 === B ? (H.c1 = Sr(E.get(u / 2 - 1)), H.c2 = Sr(E.get(u / 2))) : H.p3 = Sr(E.get((u - B) / 2)), H.s1 = T, H.s2 = Sr(E.get(1)), H.t1 = Sr(E.get(u - 2)), H.t2 = d } else { E = new Ul, H = $.info = {}; var L = w("edge.offset"), z = w("edge.center"), k = w("edge.source.t3"), O = w("edge.target.t3"), J = Y.p3(), C = y.p3(); if (k && (J[0] += k[0], J[1] += k[1], J[2] += k[2]), O && (C[0] += O[0], C[1] += O[1], C[2] += O[2]), P === fg) { W = w("edge.segments"); var Q = H.points = w(Go) || hd; if (u = Q.size()) { T = Sr(Q.get(0)), d = Sr(Q.get(u - 1)), !z && L && (g = gs(T, J, !0), L = b(L, Bk(J, T)), J = [J[0] + g[0] * L, J[1] + g[1] * L, J[2] + g[2] * L], g = gs(C, d, !0), L = b(L, Bk(d, C)), C = [C[0] - g[0] * L, C[1] - g[1] * L, C[2] - g[2] * L]); var B = u % 2; 0 === B ? (_ = Sr(Q.get(u / 2 - 1)), F = Sr(Q.get(u / 2))) : H.p3 = Sr(Q.get((u - B) / 2)), H.s1 = J, H.s2 = T, H.t1 = d, H.t2 = C } else !z && L && (g = gs(C, J, !0), V = Bk(J, C), L = pj(L, V), J = [J[0] + g[0] * L, J[1] + g[1] * L, J[2] + g[2] * L], C = [C[0] - g[0] * L, C[1] - g[1] * L, C[2] - g[2] * L]), _ = J, F = C; E.add({ x: J[0], y: J[2], e: J[1] }), E.addAll(Q), E.add({ x: C[0], y: C[2], e: C[1] }) } else { var e = Ji($, D, N, K, P); if ($._19Q || (e = -e), K) { var X = J[0], f = J[1], S = J[2], I = Y.getTall() / 2 + e; _ = [X - e, f + I, S], F = [X + e, f + I, S], E.add({ x: X - e, y: S, e: f }), E.add({ x: X - e, y: S, e: f + I }), E.add({ x: X + e, y: S, e: f + I }), E.add({ x: X + e, y: S, e: f }) } else { g = gs(C, J, !0), V = Bk(J, C); var c = { x: J[0], y: J[2] }, q = { x: C[0], y: C[2] }, M = Rf(l, c, q, e), j = M.x - c.x, a = M.y - c.y; L = pj(L, V), g[0] *= L, g[1] *= L, g[2] *= L, _ = [J[0] + g[0] + j, J[1] + g[1], J[2] + g[2] + a], F = [C[0] - g[0] + j, C[1] - g[1], C[2] - g[2] + a], z ? (E.add({ x: J[0], y: J[2], e: J[1] }), E.add({ x: _[0], y: _[2], e: _[1] }), E.add({ x: F[0], y: F[2], e: F[1] }), E.add({ x: C[0], y: C[2], e: C[1] })) : (E.add({ x: _[0], y: _[2], e: _[1] }), E.add({ x: F[0], y: F[2], e: F[1] })) } } H.c1 = _, H.c2 = F } H.list = w(Md) === mr ? $.createTubeModel(E, W, o / 2, t) : $.createLineModel(E, W, o, "edge", "edge.dash") } } }); var Vp = function (E, S) { xd(Vp, this, [E, S]) }; uo(Vp, wm, { _80o: function (C, v, Q) { var A = this, L = A.gv, O = A.shapeModel; Hq(L, A.mat), O ? Pf(L, A.data, O, A, A.getBodyColor(), Q) : (vk(A, C, v, A.left, Q), vk(A, C, v, A.front, Q), vk(A, C, v, A.right, Q), vk(A, C, v, A.back, Q), vk(A, C, v, A.top, Q), vk(A, C, v, A.bottom, Q)), Nd(L) }, validate: function (u, f) { var n, y, O = this, c = O.s, g = O.data, H = g.p3(), i = g._thickness / 2, x = g.isClosePath(), K = g.getPoints(), I = g.getSegments(), F = c($h), h = u && u.uv; if (O.clear(), 0 > i) y = O.shapeModel = Xb(K, I, c(Hr), c(nn), F, c(uq), g.getTall(), g.getElevation(), x), c(th) ? c("shape3d.image") || delete y.uv : (delete y.vs, delete y.ns, delete y.uv), c("shape3d.top.image") || delete y.top_uv, c("shape3d.bottom.image") || delete y.bottom_uv; else if (c(Md) === mr) n = di(K, I, F, x), y = O.shapeModel = { vs: [] }, c("shape3d.image") && (y.uv = [], y.sum = c(uq) || ad(n) || 1, y.len = 0), c(Hr) && !x && (y.top_vs = [], c("shape3d.top.image") && (y.top_uv = [])), c(nn) && !x && (y.bottom_vs = [], c("shape3d.bottom.image") && (y.bottom_uv = [])), O._12O(n, i); else { var t, M, z, _, k, B, b, r, v, p; n = di(K, I, F, x), k = O.vf(Mb, h, !1, f), i && (B = O.vf(ak, h, !1, f), b = x ? l : O.vf(Xr, h, !1, f), r = x ? l : O.vf(kf, h, !1, f), v = O.vf(ys, h, !1, f), p = O.vf(yn, h, !1, f)), i ? O._12O(n, i) : k && n.forEach(function (R) { if (_ = R.length, _ > 0) for (t = R[0], z = 1; _ > z; z++)M = R[z], O.addV(k.vs, t, M), t = M }), O._20Q(n), u || (k && (k.ns = tq(k.vs), ng(k, "vs"), ng(k, If)), i && (B && (B.ns = tq(B.vs), ng(B, "vs"), ng(B, If)), b && (b.ns = tq(b.vs), ng(b, "vs"), ng(b, If)), r && (r.ns = tq(r.vs), ng(r, "vs"), ng(r, If)), v && (v.ns = tq(v.vs), ng(v, "vs"), ng(v, If)), p && (p.ns = tq(p.vs), ng(p, "vs"), ng(p, If)))) } var E = O.mat = Nq(); Gq(E, H), bi(E, g.r3(), g.getRotationMode()), Gq(E, vb(H)), u && (oe(O, E, u, y), O.clear()) }, _20Q: function (a) { var S, d, J, Y, P, s, Z, C = this, O = C.front, j = C.back, m = C.top, N = C.bottom, g = O ? O.tuv : l, q = j ? j.tuv : l, x = m ? m.tuv : l, i = N ? N.tuv : l, A = 0; (g || q || x || i) && (S = C.s(uq) || ad(a) || 1, a.forEach(function (c) { if (d = c.length, d > 0) for (s = c[0], J = 1; d > J; J++)Z = c[J], Y = A / S, A += Bk(s, Z), P = A / S, C._14O(O, Y, P), C._14O(j, 1 - P, 1 - Y), C._14O(m, Y, P), C._14O(N, Y, P), s = Z })) }, _14O: function (C, c, X) { if (C) { var H = C.uv, r = C.tuv; if (r) { if (H) var F = H[0] + (H[6] - H[0]) * c, M = H[1] + (H[7] - H[1]) * c, d = H[2] + (H[4] - H[2]) * c, h = H[3] + (H[5] - H[3]) * c, n = H[2] + (H[4] - H[2]) * X, b = H[3] + (H[5] - H[3]) * X, j = H[0] + (H[6] - H[0]) * X, m = H[1] + (H[7] - H[1]) * X; else F = c, M = 0, d = c, h = 1, n = X, b = 1, j = X, m = 0; r.push(d, h, n, b, j, m, j, m, F, M, d, h) } } }, _13O: function (b) { var d = b.uv, c = b.tuv; c && (d ? c.push(d[2], d[3], d[4], d[5], d[6], d[7], d[6], d[7], d[0], d[1], d[2], d[3]) : c.push(0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1)) }, _12O: function (y, K) { var e, Q, G, S, Z, $ = this; y.forEach(function (R) { if (Z = R.length, Z > 0) for (e = { p: R[0], n: !0 }, S = 1; Z > S; S++)Q = R[S], G = Z - 1 > S ? R[S + 1] : l, $.addPoint(e, Q, G, K, R) }) }, addPoint: function (p, s, U, W, z) { var n, j, X, K, C, h, v, N, m, J = this, I = p.p, P = p.f, S = p.b, M = J.s("shape3d.side") || gk, t = J.s("shape3d.start.angle"), L = J.s("shape3d.sweep.angle"), f = J.shapeModel, _ = J.data.isClosePath(); if (p.n && (p.n = !1, P = _ && z.length > 2 ? Rf(z[z.length - 2], I, s, W) : Rf(l, I, s, W), S = ek(I, P), f ? f.top_vs && J._10O(S, P, M, t, L, f.top_vs, f.top_uv) : (n = J.left) && (J.addV(n.vs, S, P), J._13O(n))), j = U ? Rf(I, s, U, W) : _ && z.length > 2 ? Rf(I, s, z[1], W) : Rf(I, s, l, W), X = ek(s, j), f) { var d, V, c = f.vs, i = f.uv, b = f.sum; for (i && (d = f.len / b, f.len += Bk(I, s), V = f.len / b), h = J._9O(S, P, M, t, L), v = J._9O(X, j, M, t, L), N = 0; M > N; N++)m = N + 1, an(c, h[m]), an(c, v[N]), an(c, h[N]), an(c, v[N]), an(c, h[m]), an(c, v[m]), i && (K = N / M, C = m / M, i.push(d, C, V, K, d, K, V, K, d, C, V, C)); !U && f.bottom_vs && J._10O(X, j, M, t, L, f.bottom_vs, f.bottom_uv, !0) } else !U && (n = J.right) && (J.addV(n.vs, j, X), J._13O(n)), (n = J.front) && J.addV(n.vs, P, j), (n = J.back) && J.addV(n.vs, X, S), (n = J.top) && J.addH(n.vs, P, j, X, S, !0), (n = J.bottom) && J.addH(n.vs, S, X, j, P); p.p = s, p.f = j, p.b = X }, _10O: function (Y, W, K, b, D, H, p, g) { var C, h, s = this, I = s.data, y = s._9O(Y, W, K, b, D), k = (Y.x + W.x) / 2, o = (Y.y + W.y) / 2, Q = I.getElevation(), V = 0; for (V = 0; K > V; V++)g ? (an(H, y[V]), an(H, y[V + 1])) : (an(H, y[V + 1]), an(H, y[V])), an(H, [k, Q, o]), p && (g ? (C = B * (V + 1) / K + b, h = B * V / K + b) : (C = B * V / K + b, h = B * (V + 1) / K + b), p.push(.5 - .5 * S(h), .5 - .5 * t(h), .5 - .5 * S(C), .5 - .5 * t(C), .5, .5)) }, _9O: function (s, Z, y, X, W) { var E, N, q = this, L = q.data, $ = [], k = (s.x + Z.x) / 2, a = (s.y + Z.y) / 2, D = L.getTall() / 2, h = L.getElevation(), o = 0; for (W = W || B; y >= o; o++)E = W * o / y + X, N = S(E), $.push([k + (s.x - k) * N, h + D * t(E), a + (s.y - a) * N]); return $ }, addV: function (a, Y, C) { var w = Y.x, i = Y.y, t = C.x, S = C.y, K = this.data, $ = K.getElevation(), j = K.getTall() / 2; a.push(w, $ - j, i, t, $ - j, S, t, $ + j, S, t, $ + j, S, w, $ + j, i, w, $ - j, i) }, addH: function (k, C, E, y, Y, r) { var p = this.data, u = p.getTall() / 2, Z = p.getElevation() + (r ? u : -u); k.push(C.x, Z, C.y, E.x, Z, E.y, y.x, Z, y.y, y.x, Z, y.y, Y.x, Z, Y.y, C.x, Z, C.y) }, vf: function (F, I, x, b) { var o, d = this, A = d.gv.getFaceVisible(d.data, F); return (x || A) && (o = _j(d, F, b), o.vs = [], o.tuv = A && (o.texture || I) ? [] : l, o.visible = A), o } }); var Bg = function (M, z) { xd(Bg, this, [M, z]) }; uo(Bg, Yr, { _25Q: 1, validate: function ($) { var w = this, J = w.data, W = w.s, R = J.getPoints(), m = R.size(); if (w.shapeModel = w.info = l, m > 1) { var P = w.info = {}, M = J.getSegments(), S = J.getThickness(), Z = Sr(R.get(0)), E = Sr(R.get(m - 1)), Q = m % 2; 0 === Q ? (P.c1 = Sr(R.get(m / 2 - 1)), P.c2 = Sr(R.get(m / 2))) : P.p3 = Sr(R.get((m - Q) / 2)), P.s1 = Z, P.s2 = Sr(R.get(1)), P.t1 = Sr(R.get(m - 2)), P.t2 = E, P.list = W(Md) === mr ? w.createTubeModel(R, M, S / 2, $) : w.createLineModel(R, M, S, "shape.border", "shape.dash") } } }), _i(m, { accordionViewExpandIcon: wq(sg), accordionViewCollapseIcon: wq(sg, !0), accordionViewLabelColor: _c, accordionViewLabelFont: Ek, accordionViewTitleBackground: Sh, accordionViewSelectBackground: cl, accordionViewSelectWidth: 3, accordionViewSeparatorColor: Z, splitViewDividerSize: 1, splitViewDividerBackground: Sh, splitViewDragOpacity: .5, splitViewToggleIcon: { width: 16, height: 16, comps: [{ type: bd, rect: [2, 2, 12, 12], background: sg }] }, propertyViewLabelColor: xn, propertyViewLabelSelectColor: _c, propertyViewLabelFont: Ek, propertyViewExpandIcon: wq(Qn), propertyViewCollapseIcon: wq(Qn, !0), propertyViewBackground: _f, propertyViewRowLineVisible: !0, propertyViewColumnLineVisible: !0, propertyViewRowLineColor: ze, propertyViewColumnLineColor: ze, propertyViewSelectBackground: cl, listViewLabelColor: xn, listViewLabelSelectColor: _c, listViewLabelFont: Ek, listViewRowLineVisible: !1, listViewRowLineColor: ze, listViewSelectBackground: cl, treeViewLabelColor: xn, treeViewLabelSelectColor: _c, treeViewLabelFont: Ek, treeViewExpandIcon: wq(Jo), treeViewCollapseIcon: wq(Jo, !0), treeViewRowLineVisible: !1, treeViewRowLineColor: ze, treeViewSelectBackground: cl, treeViewDoubleClickToToggle: !0, tableViewLabelColor: xn, tableViewLabelSelectColor: _c, tableViewLabelFont: Ek, tableViewRowLineVisible: !0, tableViewColumnLineVisible: !0, tableViewRowLineColor: ze, tableViewColumnLineColor: ze, tableViewSelectBackground: cl, treeTableViewLabelColor: xn, treeTableViewLabelSelectColor: _c, treeTableViewLabelFont: Ek, treeTableViewExpandIcon: wq(Jo), treeTableViewCollapseIcon: wq(Jo, !0), treeTableViewRowLineVisible: !0, treeTableViewColumnLineVisible: !0, treeTableViewRowLineColor: ze, treeTableViewColumnLineColor: ze, treeTableViewSelectBackground: cl, tableHeaderLabelColor: xn, tableHeaderLabelFont: Ek, tableHeaderColumnLineVisible: !0, tableHeaderColumnLineColor: Og, tableHeaderBackground: _f, tableHeaderMoveBackground: kc, tableHeaderInsertColor: cl, tableHeaderSortDescIcon: cs(Qn, !0), tableHeaderSortAscIcon: cs(Qn), tabViewTabGap: 1, tabViewLabelColor: _c, tabViewLabelFont: Ek, tabViewTabBackground: Sh, tabViewSelectWidth: 3, tabViewSelectBackground: cl, tabViewMoveBackground: kc, tabViewInsertColor: cl, toolbarLabelColor: xn, toolbarLabelSelectColor: _c, toolbarLabelFont: Ek, toolbarBackground: _f, toolbarSelectBackground: cl, toolbarItemGap: 8, toolbarSeparatorColor: yd }, !0); var Ml = { translateX: 1, sortColumn: 1 }, Cj = { sortable: 1, sortOrder: 1, sortFunc: 1 }, Om = { focusData: 1 }, ep = { dataModel: 1, sortColumn: 1, sortFunc: 1, visibleFunc: 1, rootData: 1, rootVisible: 1 }, Ch = { dataModel: 1, sortFunc: 1, visibleFunc: 1, categorizable: 1 }, $o = function (a, b) { b.add(a), a.hasChildren() && a.eachChild(function (r) { $o(r, b) }) }, Qe = function (q, I, N, w, Q, B, r, k, W, f, Y) { var V, R = N.getValueType(f), Z = N.getAlign(f); if (N.getEnumValues(f)) { var U = N.toEnumLabel(I, f), n = tg || 0, E = 0, p = B, J = m.getTextSize(w, U).width; return V = yj(N.toEnumIcon(I, f)), V && (E = B + tg / 2, "center" === Z ? E += (k - (n + J)) / 2 : "right" === Z && (E = E + k - (n + J)), Tp(q, V, E, r + W / 2), p = E + tg / 2), U != l && (V ? ho(q, U, w, Q, p, r, k - (p - B), W) : ho(q, U, w, Q, B, r, k, W, Z)), void 0 } return I = N.formatValue(I), I != l ? R === rh ? (qo(q, B, r, k, W, I), void 0) : R === Lr || !R && sk(I) ? (V = yj(I ? Sb : Oc), Tp(q, V, B + k / 2, r + W / 2, f, Y), void 0) : (ho(q, I, w, Q, B, r, k, W, Z), void 0) : void 0 }, Wb = function (e, V) { var n = V.view, w = n.getDataModel().getHistoryManager(), i = wd(e), h = V.column || V.property; w && w.beginInteraction(), V.editor = e, e.info = V, n.setCurrentEditor(e), n.getView().insertBefore(i, n._79O), Up(e, V.editorRect), e.setFocus ? e.setFocus() : Cq(e), e.commitValue = function () { e._17Q && (e = e._17Q), n.setValue(V.data, h, e.getValue ? e.getValue() : e.value), e.close && e.close(), Ng(i) }, h.onEditorCreated && h.onEditorCreated(V) }, hg = function (u, t, Q, V, g) { var D = oo(u, Q), W = t.value, q = t.view, v = g.getValueType(t.data); return D.onblur = D.onchange = function () { q.endEditing() }, "input" === u ? (W = g.formatValue(W), W != l && (D.value = W), D.onkeydown = function (u) { Zr(u) && q.endEditing() }, (v === Bq || v === bs) && D.addEventListener(Vo, m.numberListener, !1)) : u === Tm && V.forEach(function (h) { var O = i.createElement("option"); O.innerHTML = g.toEnumLabel(h), O.value = h, g.isEnumEqual(W, h) && (O.selected = !0), hq(D, O) }), Wb(D, t), D }, Wg = R.widget = {}, lk = function (H, x, c) { uo(K + ".widget." + H, x, c) }; _i(Xc, {
            ms_value: function (n) { n.getValue = function (t) { var X = this.getItemById(t), n = X.element; return Yc(n) ? n : n ? n.getValue ? n.getValue() : n.value : X.selected }, n.setValue = function (m, O) { var x = this.getItemById(m), V = x.element; V && !Yc(V) ? V.setValue ? V.setValue(O) : V.value = O : sk(O) ? (x.selected = O, this.iv()) : (x.element = O, this.iv()) }, n.v = function (z, A) { var $ = this; if (2 === arguments.length) $.setValue(z, A); else { if (!bk(z)) return $.getValue(z); for (var E in z) $.setValue(E, z[E]) } return $ } }, _46o: function (R) { R._icon = l, R._accessType = l, R._valueType = l, R._editable = !1, R._batchEditable = !0, R._align = Xr, R._nullable = !0, R._emptiable = !1, R.setParent = Lp, R.formatValue = function (d) { var N = this, Y = N._valueType; return N.getEnumValues() ? N.toEnumLabel(d) : Y === Lr ? !!d : d != l && Y === Bq ? L(d) : d }, R.setEnum = function (_, K, T, D, p, s, C) { var X = this; _ && !sp(_) && _.values && (D = _.editable, T = _.icons, K = _.labels, p = _.strict, s = _.maxHeight, C = _.dropDownWidth, _ = _.values), Zh(_) && (_ = _._as), Zh(K) && (K = K._as), Zh(T) && (T = T._as), X._enumValues = _, X._enumLabels = K, X._enumIcons = T, X._enumEditable = D, X._enumStrict = p == l ? !0 : p, X._enumMaxHeight = s, X._enumDropDownWidth = C, _ && _.length && Gr(_[0]) && (X._valueType = bs), X.fp("enum", !1, !0) }, R.getEnumDropDownWidth = function () { return this._enumDropDownWidth }, R.getEnumMaxHeight = function () { return this._enumMaxHeight }, R.isEnumEditable = function () { return this._enumEditable }, R.getEnumValues = function () { return this._enumValues }, R.getEnumLabels = function () { return this._enumLabels }, R.getEnumIcons = function () { return this._enumIcons }, R.isEnumStrict = function () { return this._enumStrict }, R.isEnumEqual = function (n, L) { return this._enumStrict ? n === L : n == L }, R.toEnumLabel = function (X, e) { var v = this, o = v.getEnumValues(e), g = v.getEnumLabels(e); if (o && g) for (var Q = 0; Q < o.length; Q++)if (v.isEnumEqual(X, o[Q])) return g[Q]; return X }, R.toEnumIcon = function (h, I) { var c = this, J = c.getEnumValues(I), q = c.getEnumIcons(I); if (J && q) for (var j = 0; j < J.length; j++)if (c.isEnumEqual(h, J[j])) return q[j]; return Z } }, _45o: function (Z) { Z._87o = function (n, j, N, g, R, H) { if (n) { var Z = this, V = Z._90I, A = Rl(1); Z._columnLineVisible && (R -= 1), Z._rowLineVisible && (H -= 1), 0 >= R || 0 >= H || (Z._90I || (V = Z._90I = {}), V[j] || (V[j] = new Ul), Up(A, Z.tx() + N, Z.ty() + g, R, H), hq(A, n), Z._view.insertBefore(A, Z._79O), n.onParentAdded && n.onParentAdded(A), V[j].add(A)) } }, Z._76o = function () { var i = this, P = i._90I; if (P) { for (var m in P) P[m].each(function (k) { Ng(k) }); delete i._90I } }, Z._77o = function (C) { var B = this; if (B._90I) { var J = B._90I[C]; J && (J.each(function (n) { Ng(n) }), delete B._90I[C]) } } }, _47o: function (Y) { Y.getValue = function (e, P) { return P.getValue ? P.getValue(e, P, this) : Wh(e, P.getAccessType(), P.getName()) }, Y.setValue = function (b, S, P) { if (S.isEmptiable(b) || "" !== P || (P = Z), S.isNullable(b) || P != l) { var k = this, R = S.getName(b), r = S.getAccessType(b), h = S.getValueType(b); h === Bq && Yc(P) ? P = n(P) : h === bs && Yc(P) ? P = parseFloat(P) : h === Lr && Yc(P) && (P = "true" === P), k._batchEditable && S._batchEditable && k.isSelected(b) ? k.sm().each(function (G) { S.setValue ? S.setValue(G, S, P, k) : Bj(G, r, R, P) }) : S.setValue ? S.setValue(b, S, P, k) : Bj(b, r, R, P) } }, Y.setCurrentEditor = function (Z) { this.endEditing(), this._currentEditor = Z, this.redraw() }, Y.isEditing = function (p, D) { var i = this, J = i._currentEditor; if (!J) return !1; if (D) { var q = J.info; return q ? (q.column || q.property) === D && q.data === p : !1 } return !0 }, Y.endEditing = function () { var L = this, q = L._currentEditor, k = L.getDataModel().getHistoryManager(); q && (delete L._currentEditor, q.commitValue && q.commitValue(q.info), L.redraw(), k && k.endInteraction()) }, Y.beginEditing = function (C) { this.endEditing(); var X = this, $ = C.column || C.property; if ($.beginEditing) $.beginEditing(C); else { var i = C.data, h = C.value, _ = X.getSelectBackground(i), G = $.getEnumValues(i), B = $.getSlider(i), g = $.getColorPicker(i); if (B) { var T = Jc(Wg.Slider, B); return T.setValue(h), T.getView().onblur = function () { X.endEditing() }, T.isInstant() && (T.onValueChanged = function () { X.setValue(i, $, T.getValue()) }), Wb(T, C), void 0 } if (g || $.getValueType(i) === rh) { var r = Jc(Wg.ColorPicker, g); return r.setValue(h), r.onClosed = function () { X.endEditing() }, r.isInstant() && (r.onValueChanged = function (p, g) { X.setValue(i, $, g) }), Wb(r, C), r.open(), void 0 } if (G) { if (Wg.ComboBox) { var U = new Wg.ComboBox; U.setValue(h), U.setValues(G), U.setLabels($.getEnumLabels(i)), U.setIcons($.getEnumIcons(i)), U.setEditable($.isEnumEditable(i)), U.setStrict($.isEnumStrict(i)), U.setMaxHeight($.getEnumMaxHeight(i)), U.setDropDownWidth($.getEnumDropDownWidth(i)), U.onClosed = function () { X.endEditing() }, Wb(U, C), U.open() } else hg(Tm, C, _, G, $); return } var w = $.getValueType(i); if (w === Lr || sk(h)) return X.setValue(i, $, !h), void 0; if ($.getItemEditor(i)) { var u = Vr($.getItemEditor(i)), x = new u(i, $, X, C), A = x.getView(); return A._17Q = x, x.setValue(h), Rd(A), Wb(A, C), x.editBeginning && x.editBeginning(), void 0 } hg("input", C, _, l, $) } } }, _44o: function (n) { n.init = function (s) { var o = this, X = o.th = new xp(s), H = o._view = ii(1, o); o.tv = o._tableView = s, hq(H, X.getView()), hq(H, s.getView()), X.mp(function (d) { d.property === Yj && o.iv() }), o.iv() }, n.getTableView = function () { return this.tv }, n.getTableHeader = function () { return this.th }, n.getDataModel = function () { return this.tv.dm() }, n.getColumnModel = function () { return this.tv.getColumnModel() }, n.setColumns = function (K) { this.tv.setColumns(K) }, n.addColumns = function (q) { this.tv.addColumns(q) }, n.endEditing = function () { this.tv.endEditing() }, n.validateImpl = function () { var x = this, P = x.th, v = zh(P), y = { x: 0, y: 0, width: x.getWidth(), height: v }; Up(P, y), y.y = v, y.height = g(0, x.getHeight() - v), Up(x.tv, y) } }, ms_vs: function (n) {
            n._41o = function () { return this._29I.height < this._59I }, n._43o = function () { var M = this; M._41o() && (M._58I || (U(function () { M._94O() }, qe), M.iv()), M._58I = new Date) }, n._94O = function () {
                var b = this; if (b._58I) {
                    var d = new Date;
                    d.getTime() - b._58I.getTime() >= qe ? (delete b._58I, b.iv()) : U(function () { b._94O() }, qe)
                }
            }, n._93I = function () { var w = this, p = w._27I; if (w._58I || !w._autoHideScrollBar) { p || hq(w._79O, p = w._27I = Rl()); var o = w._29I, x = o.height, W = w._59I, G = w.getScrollBarSize(), a = o.width - G - 2, M = x * (-w.ty() / W), b = x * (x / W), X = p.style; W > x ? (Ye > b && (M = M + b / 2 - Ye / 2, 0 > M && (M = 0), M + Ye > x && (M = x - Ye), b = Ye), X.visibility = ls, X.background = w.getScrollBarColor(), X.borderRadius = G / 2 + $k, Up(p, a, M, G, b)) : X.visibility = Yq } else p && (p.style.visibility = Yq) }
            }, ms_hs: function (g) { g._40o = function () { return this._29I.width < this._91I }, g._42o = function () { var h = this; h._40o() && (h._95O || (U(function () { h._94I() }, qe), h.iv()), h._95O = new Date) }, g._94I = function () { var k = this; if (k._95O) { var r = new Date; r.getTime() - k._95O.getTime() >= qe ? (delete k._95O, k.iv()) : U(function () { k._94I() }, qe) } }, g._92I = function () { var $ = this, A = $._28I; if ($._95O || !$._autoHideScrollBar) { A || hq($._79O, A = $._28I = Rl()); var _ = $._29I, k = _.width, E = $._91I, D = $.getScrollBarSize(), X = _.height - D - 2, o = k * (-$.tx() / E), Y = k * (k / E), l = A.style; E > k ? (Ye > Y && (o = o + Y / 2 - Ye / 2, 0 > o && (o = 0), o + Ye > k && (o = k - Ye), Y = Ye), l.visibility = ls, l.background = $.getScrollBarColor(), l.borderRadius = D / 2 + $k, Up(A, o, X, Y, D)) : l.visibility = Yq } else A && (A.style.visibility = Yq) } }
        }), uk(Sb, Xh(16, 16, [{ type: vd, rect: [1, 1, 14, 14], background: cl }, { type: Uo, rect: [1, 1, 14, 14], width: 1, color: Lj }, { type: mi, points: [13, 3, 7, 12, 4, 8], borderWidth: 2, borderColor: "#FFF" }])), uk(Oc, Xh(16, 16, { type: Uo, rect: [1, 1, 14, 14], width: 1, color: Lj })), uk(gq, Xh(16, 16, [{ type: Oj, rect: [2, 2, 12, 12], borderWidth: 1, borderColor: Lj, background: "#FFF" }, { type: Oj, rect: [4, 4, 8, 8], background: cl }])), uk(yg, Xh(16, 16, { type: Oj, rect: [2, 2, 12, 12], borderWidth: 1, borderColor: Lj })), Xc._15Q = function (d) { d._29I = er, d._59I = 0, d._91I = 0, d._5o = function (l) { var u = this; u._30I = new Ul, u._rows = new Ul, u._rowMap = {}, u._31I = 0, u._14I = 0, u._view = ii(1, u), u._canvas = sc(u._view), hq(u._view, u._79O = Rl()), u.dm(l ? l : new Mn) }, d.getCheckIcon = function (D) { var y = this.sm(), $ = y.co(D); return y.sg() ? yj($ ? gq : yg) : yj($ ? Sb : Oc) }, d.checkData = function (d) { var f = this.sm(), P = f.co(d); f.sg() && P || (this._32o = 1, P ? f.rs(d) : f.as(d), delete this._32o) }, d.getDataAt = function (p) { p.target && (p = this.lp(p)); var X = G(p.y / this._rowHeight), W = this._rows; return 0 > X || X >= W.size() ? l : W.get(X) }, d.onDataDoubleClicked = function () { }, d.onDataClicked = function () { }, d.adjustTranslateX = function () { return 0 }, d.adjustTranslateY = function (w) { var P = this.getHeight() - this._59I; return P > w && (w = P), w > 0 ? 0 : L(w) }, d.onPropertyChanged = function (m) { var I = this, B = m.property; ep[B] ? I.ivm() : Om[B] || I.redraw(), B === xe ? I._42o() : B === $g && I._43o() }, d.getLabel = function (j) { return j.toLabel() }, d.getLabelFont = function () { return this._labelFont }, d.getLabelColor = function (w) { var _ = this; if (_.isCheckMode()) { if (_._focusData === w) return _._labelSelectColor } else if (_.isSelected(w)) return _._labelSelectColor; return _._labelColor }, d.getStartRowIndex = function () { return this._31I }, d.getEndRowIndex = function () { return this._14I }, d.getRowDatas = function () { return this._rows }, d.getRowIndex = function (D) { return this._rowMap[D._id] }, d.getRowSize = function () { return this._rows.size() }, d.getViewRect = function () { return Ln(this._29I) }, d.isVisible = function (x) { return this._visibleFunc ? this._visibleFunc(x) : !0 }, d.getCurrentSortFunc = function () { return this._sortFunc }, d.setDataModel = function (V) { var b = this, g = b._dataModel, j = b._selectionModel; g !== V && (g && (g.umm(b.handleDataModelChange, b), g.umd(b.handleDataPropertyChange, b), g.umh(b.handleHierarchyChange, b), j || g.sm().ums(b.handleSelectionChange, b)), b._dataModel = V, V.mm(b.handleDataModelChange, b), V.md(b.handleDataPropertyChange, b), V.mh(b.handleHierarchyChange, b), j ? j._21I(V) : V.sm().ms(b.handleSelectionChange, b), b.fp("dataModel", g, V)) }, d.validateModel = function () { var $ = this; $._rows.clear(), $._rowMap = {}, $.buildChildren($._dataModel._roots); var D = $._rows = $._rows.toList($.isVisible, $), R = 0, s = $.getCurrentSortFunc(), r = D.size(); for (s && D.sort(s); r > R; R++)$._rowMap[D.get(R)._id] = R }, d.buildChildren = function (T) { var f = this; T.each(function (A) { f._rows.add(A), f.buildChildren(A._children) }) }, d.handleDataModelChange = function () { this.ivm() }, d.handleDataPropertyChange = function (X) { "parent" === X.property ? this.ivm() : this.invalidateData(X.data) }, d.handleHierarchyChange = function () { this.ivm() }, d.handleSelectionChange = function (C) { C.datas.each(this.invalidateData, this), this.onSelectionChanged(C) }, d.onSelectionChanged = function (n) { var c = this, T = c.sm(); !c.isAutoMakeVisible() || 1 !== T.size() || "set" !== n.kind && "append" !== n.kind || c._32o || c.makeVisible(T.ld()) }, d.handleBackgroundClick = function (S) { Vg(S) && !this.isCheckMode() && this.sm().cs() }, d.makeVisible = function (h) { h && (this._23I = h, this.iv()) }, d.scrollToIndex = function (C) { var S = this, k = S._29I, f = k.height, _ = S._rowHeight, L = _ * C; C >= 0 && C < S._rows.size() && f > 0 && (L + _ > k.y + f ? S.ty(-L + f - _) : L < k.y && S.ty(-L)) }, d.autoScroll = function (K, t) { var D = this, i = D._rowHeight, M = i, m = i / 4, L = D._29I, R = D.lp(K), H = { x: D.tx(), y: D.ty() }; return i > 0 && L && (R.x - L.x < M ? D.translate(m, 0) : L.x + L.width - R.x < M && D.translate(-m, 0), R.y - L.y < M ? D.translate(0, m) : L.y + L.height - R.y < M && D.translate(0, -m)), H.x = D.tx() - H.x, H.y = D.ty() - H.y, t && (t.x += H.x, t.y += H.y), H }, d.getTopRowOrderSelection = function () { var j = this.sm().getTopSelection(), T = {}, u = new Ul; return j.each(function (g) { T[g._id] = g }), this._rows.each(function (G) { T[G._id] && u.add(G) }), u }, d.getRowOrderSelection = function () { var x = new Ul; return this._rows.each(function (s) { this.isSelected(s) && x.add(s) }, this), x }, d.ivm = function () { this.invalidateModel() }, d.invalidateModel = function () { var Z = this; Z._96I || (Z._96I = 1, Z._32I = 1, delete Z._24I), Z.iv() }, d.redraw = function () { var h = this; h._32I || (h._32I = 1, delete h._24I, h.iv()) }, d.invalidateData = function (z) { var X = this; p ? X.redraw() : X._32I || (X._24I || (X._24I = {}), X._24I[z._id] = z, X.iv()) }, d.getFocusData = function () { return this._focusData }, d.setFocusDataById = function (Z) { this.setFocusData(this.dm().getDataById(Z)) }, d.setFocusData = function (w) { var M = this, T = M._focusData; T !== w && (M._focusData = w, M.fp("focusData", T, w), T && M.invalidateData(T), w && (M.invalidateData(w), M.isAutoMakeVisible() && M.makeVisible(w))) }, d.drawRowBackground = function (N, V, S, T, Z, l, f) { var g = this, z = g.isCheckMode(); (V === g._focusData && z || S && !z) && qo(N, T, Z, l, f, g.getSelectBackground(V)) }, d.drawData = function (Y, b, V) { var y = this, H = y._rowHeight, s = H * V, x = y._29I, Q = x.x, K = x.width; Y.save(), Y.beginPath(), Y.rect(Q, s, K, H), Y.clip(), y._87o(y.drawRow(Y, b, y.isSelected(b), Q, s, K, H), V, Q, s, K, H), Y.restore(), y._rowLineVisible && qo(Y, Q, s + H - 1, K, 1, y._rowLineColor) }, d._12I = function (w) { var M = this, Z = M._31I, D = M._29I, k = D.x, a = D.y, X = D.width, C = D.height; for (w.beginPath(), w.rect(k, a, X, C), w.clip(), w.clearRect(k, a, X, C), M._76o(), M._93db(w); Z < M._14I; Z++)M.drawData(w, M._rows.get(Z), Z); M._92db(w) }, d._13I = function (n) { for (var q, k = this, c = k._rowHeight, h = k._29I, s = h.x, t = h.width, Y = k._31I, B = k._30I; Y < k._14I; Y++)q = k._rows.get(Y), k._24I[q._id] && B.add({ data: q, index: Y }); B.isEmpty() || (n.beginPath(), B.each(function (J) { n.rect(s, J.index * c, t, c) }), n.clip(), B.each(function (O) { n.clearRect(s, O.index * c, t, c) }), B.each(function (G) { k._77o(G.index) }), k._93db(n), B.each(function (e) { k.drawData(n, e.data, e.index) }), k._92db(n), B.clear()) }, d.validateImpl = function () { var A = this, I = A._canvas, D = A.getWidth(), Z = A.getHeight(), Y = A._rowHeight, C = A._32I; (D !== I.clientWidth || Z !== I.clientHeight) && (co(I, D, Z), C = 1); var f = O && !j; A._96I && !f && A.validateModel(); var c = A._29I, F = { x: -A.tx(), y: -A.ty(), width: D, height: Z }, M = A._rows.size(), v = nr(I), b = A._23I; C || ns(F, c) || (C = 1), A._29I = F, A._59I = M * Y, A._31I = G(F.y / Y), A._14I = T((F.y + F.height) / Y), A._31I < 0 && (A._31I = 0), A._14I > M && (A._14I = M), A._99I && C && A._99I(), Rr(v, A.tx(), A.ty(), 1), C ? A._12I(v) : A._24I && A._13I(v), A._93I(), A._92I(), v.restore(), A._32I = A._24I = A._96I = l, b && (A.scrollToIndex(A.getRowIndex(b)), delete A._23I), A.tx(A.tx()), A.ty(A.ty()) } }, Xc._48o = function (r) { r._rootVisible = !0, r._rootData = l, r._35o = function () { this._expandMap = {}, this._levelMap = {} }, r.validateModel = function () { var F = this, b = F._rootData; F._rows.clear(), F._levelMap = {}, F._rowMap = {}, F._currentLevel = 0, b ? F._rootVisible ? F.isVisible(b) && F.buildData(b) : F.buildChildren(b) : F.buildChildren(), delete F._currentLevel }, r.buildData = function (a) { var s = this, p = a._id, e = s._rows; s._rowMap[p] = e.size(), e.add(a), s._levelMap[p] = s._currentLevel, s.isExpanded(a) && (s._currentLevel++ , s.buildChildren(a), s._currentLevel--) }, r.buildChildren = function (m) { var R = this, H = m ? m._children : R._dataModel._roots, t = R.getCurrentSortFunc(); t && R.isChildrenSortable(m) ? H.toList(R.isVisible, R).sort(t).each(R.buildData, R) : H.each(function (N) { R.isVisible(N) && R.buildData(N) }) }, r.getLevel = function (b) { return this._levelMap[b._id] }, r.getToggleIcon = function (W) { var Z = this, X = Z._loader, A = Z._collapseIcon; return X && !X.isLoaded(W) ? A : W.hasChildren() ? Z.isExpanded(W) ? Z._expandIcon : A : l }, r.isCheckMode = function () { return this._checkMode != l }, r.isChildrenSortable = function () { return !0 }, r.handleDataModelChange = function (E) { var Y = this; E.kind === ee ? delete Y._expandMap[E.data._id] : E.kind === rr && (Y._expandMap = {}), Y.ivm() }, r.toggle = function (H) { var S = this; S.isExpanded(H) ? S.collapse(H) : S.expand(H) }, r.isExpanded = function (K) { return 1 === this._expandMap[K._id] }, r.expand = function (J) { var j = this, W = j._loader; j.isExpanded(J) || (W && !W.isLoaded(J) && W.load(J), j._expandMap[J._id] = 1, j.ivm(), j.onExpanded(J)) }, r.onExpanded = function () { }, r.collapse = function (l) { var R = this; R.isExpanded(l) && (delete R._expandMap[l._id], R.ivm(), R.onCollapsed(l)) }, r.onCollapsed = function () { }, r.expandAll = function () { var L = this; L._dataModel.each(function (_) { _.hasChildren() && (L._expandMap[_._id] = 1) }), L.ivm() }, r.collapseAll = function () { this._expandMap = {}, this.ivm() }, r.makeVisible = function (e) { if (e) { var u = this; if (!u._rootData || e.isDescendantOf(u._rootData)) { for (var L = e._parent; L;)u.expand(L), L = L._parent; u._23I = e, u.iv() } } }, r.checkData = function (M) { var W, h = this, x = h._checkMode, T = h.sm(), z = T.co(M); if (!T.sg() || !z) { if (h._32o = 1, x === Y) z ? T.rs(M) : T.as(M); else if (x === Dm) W = new Ul(M), W.addAll(M._children); else if ("descendant" === x) W = new Ul, $o(M, W); else if ("all" === x && (W = new Ul, $o(M, W), !z)) for (var E = M._parent; E;)W.add(E), E = E._parent; W && (z ? T.rs(W) : T.as(W)), delete h._32o } }, r._97I = function (V, Q, m, s, e, f, O) { var $ = this, G = $._indent, i = $._levelMap[Q._id], R = $.getIconWidth(Q), A = yj($.getToggleIcon(Q)); A ? (s += G * i, Tp(V, A, s + G / 2, e + O / 2, Q, $), s += G) : s += G * (i + 1), $._checkMode && (Tp(V, $.getCheckIcon(Q), s + G / 2, e + O / 2, Q, $), s += G), $.drawIcon(V, Q, s, e, R, O), $.drawLabel(V, Q, s + R, e, O) } }, Xc._14Q = function (A) { A.getIcon = function (O) { return O.getIcon() }, A.getIconWidth = function (k) { return this.getIcon(k) ? this._indent : 0 }, A.drawIcon = function (s, W, O, t, Q, g) { if (Q) { var w = this, v = w.getBodyColor(W), h = yj(w.getIcon(W), v); h && (g -= w.isRowLineVisible() ? 1 : 0, ff(s, h, Jh, O, t, Q, g, W, w, v), Ei(s, w.getBorderColor(W), O, t, Q, g)) } }, A.drawLabel = function (u, K, E, r, q) { var I = this; ho(u, I.getLabel(K), I.getLabelFont(K), I.getLabelColor(K), E, r, 0, q) } }, Xc._50o = function ($) { $._98I = function () { var $ = this, N = $._39o = new Mn; $._60I = new Ul, N.mm($._17o, $), N.md($._18o, $), N.mh($._19o, $) }, $.setColumns = function (G) { this._39o.clear(), this.addColumns(G) }, $.addColumns = function (u) { var L = this._39o; u.forEach(function (a) { if (!(a instanceof On)) { var c = Vr(a.className); a = Jc(c ? c : On, a) } L.add(a) }) }, $.onColumnClicked = function () { }, $.onCheckColumnClicked = function () { }, $._3Q = function (B) { for (var i, H = 0, X = this._60I, E = X.size(); E > H; H++)if (i = X.get(H), i.column === B) return i; return l }, $.getColumnAt = function (p) { var r = this._4Q(p); return r ? r.column : l }, $._4Q = function (H) { for (var D = this, q = H.target ? D.lp(H).x : H.x, V = D._60I, g = 0; g < V.size(); g++) { var G = V.get(g), f = G.startX; if (q >= f && q < f + G.column.getWidth()) return G } return l }, $.getToolTip = function (H) { var A = this, b = A.getDataAt(H), V = A.getColumnAt(H); return b && V ? V.getToolTip(b, A) : l }, $.adjustTranslateX = function (G) { var Q = this.getWidth() - this._91I; return Q > G && (G = Q), G > 0 ? 0 : L(G) }, $._99I = function () { var r = this, x = r._29I, Y = r._60I; Y.clear(), r._91I = 0, r._39o._roots.each(function (A) { if (A.isVisible()) { var C = r._91I + A.getWidth(); r._91I <= x.x + x.width && C >= x.x && Y.add({ column: A, startX: r._91I }), r._91I = C } }) }, $.drawData = function (U, F, N) { var l = this, _ = l._rowHeight, S = _ * N, W = l.isSelected(F), p = l._29I, Q = p.x, h = p.width; l.drawRowBackground(U, F, W, Q, S, h, _), l._60I.each(function (m) { var Y = m.column, R = m.startX, H = Y.getWidth(); H > 0 && !l.isEditing(F, Y) && (U.save(), U.beginPath(), U.rect(R, S, H, _), U.clip(), l._87o(l.drawCell(U, F, W, Y, R, S, H, _), N, R, S, H, _), l._columnLineVisible && qo(U, R + H - 1, S, 1, _, l._columnLineColor), U.restore()) }), l._rowLineVisible && qo(U, Q, S + _ - 1, h, 1, l._rowLineColor) }, $.drawCell = function (Q, z, K, P, Y, y, j, G) { var u = this; if (P.drawCell) return P.drawCell(Q, z, K, P, Y, y, j, G, u); var q = u.getValue(z, P); Qe(Q, q, P, u.getLabelFont(z, P, q), u.getLabelColor(z, P, q), Y, y, j, G, z, u) }, $.getColumnModel = function () { return this._39o }, $._17o = function () { this.redraw() }, $._18o = function (c) { var B = this; c.data === B._sortColumn && Cj[c.property] ? B.ivm() : (B._42o(), B.redraw()) }, $._19o = function () { this.redraw() }, $.getCurrentSortFunc = function () { var H = this, b = H._sortColumn; if (b && b.isSortable()) { var t = b.getSortFunc(), I = ej === b.getSortOrder() ? 1 : -1; return t || (t = Bl), function (x, i) { return t.call(H, H.getValue(x, b), H.getValue(i, b), x, i) * I } } return H._sortFunc }, $.isCellEditable = function (_, c) { return c.isEditable() && this.isEditable() }, $._37O = function (d, g) { if (Vg(g)) for (var Z = this, x = Z.lp(g), L = Z._60I, m = Z._rowHeight, t = Z._29I, y = t.x, R = t.y, n = t.width, v = t.height, u = 0; u < L.size(); u++) { var w = L.get(u), a = w.startX, M = w.column, N = M.getWidth(); if (M !== Z._31o && M !== Z._4o && Z.isCellEditable(d, M, g) && x.x >= a && x.x < a + N) { var W = { x: a, y: Z.getRowIndex(d) * m, width: N, height: m }, G = { x: W.x + Z.tx(), y: W.y + Z.ty(), width: W.width, height: W.height }, C = 0, Y = 0; return W.x < y ? C = W.x - y : W.x + W.width > y + n && (C = W.x + W.width - y - n), C && (Z.tx(Z.tx() - C), G.x -= C), W.y < R ? Y = W.y - R : W.y + m > R + v && (Y = W.y + m - R - v), Y && (Z.ty(Z.ty() - Y), G.y -= Y), Z.beginEditing({ data: d, column: M, value: Z.getValue(d, M), event: g, rect: W, editorRect: G, view: Z }), void 0 } } } }, Wg.BaseItemEditor = function (q, b, t, p) { this._data = q, this._column = b, this._master = t, this._editInfo = p }, lk("BaseItemEditor", F, { ms_ac: ["data", "column", "master", "editInfo"], editBeginning: function () { }, getView: function () { }, getValue: function () { }, setValue: function () { } }); var Lo = R.Tab = function () { xd(Lo, this) }; Df("Tab", Zl, { ms_ac: ["view", "closable", "disabled"], _icon: l, _closable: !1, _disabled: !1, setParent: Lp }); var On = R.Column = function () { xd(On, this) }; Df("Column", Zl, { _46o: 1, ms_ac: ["accessType", "valueType", ls, Fp, Ho, fh, "align", rh, "sortOrder", Po, "sortable", "clickable", "nullable", "emptiable", "slider", "colorPicker", "itemEditor"], _visible: !0, _width: 80, _sortOrder: ej, _sortFunc: l, _sortable: !0, _clickable: !0, setWidth: function (n) { 16 > n && (n = 16); var t = this._width; this._width = n, this.fp(fh, t, n) }, getToolTip: function (b, R) { return this.formatValue(R.getValue(b, this)) } }); var so = R.Property = function () { xd(so, this) }; Df("Property", Zl, { _46o: 1, ms_ac: ["accessType", "valueType", Fp, Ho, "categoryName", rh, "align", "nullable", "emptiable", "slider", "itemEditor", "colorPicker"], _categoryName: l, getToolTip: function (G, f, C) { var p = this; return f ? p.formatValue(C.getValue(G, p)) : C.getPropertyName(p) } }), Wg.AccordionView = function () { var A = this; A._20o = {}, A._21o = new Ul, A._10o = l, A._9o = l, A._11o = l, A._view = ii(0, A), A.iv() }, lk("AccordionView", F, { ms_v: 1, ms_fire: 1, ms_ac: [Gk, uh, "titleHeight", od, Fd, "titleBackground", "selectWidth", Zq, "orientation", "separatorColor"], _expandIcon: m.accordionViewExpandIcon, _collapseIcon: m.accordionViewCollapseIcon, _titleHeight: gh, _labelColor: m.accordionViewLabelColor, _labelFont: m.accordionViewLabelFont, _titleBackground: m.accordionViewTitleBackground, _selectBackground: m.accordionViewSelectBackground, _selectWidth: m.accordionViewSelectWidth, _orientation: "v", _separatorColor: m.accordionViewSeparatorColor, onPropertyChanged: function () { this.iv() }, getView: function () { return this._view }, getTitles: function () { return this._21o }, getCurrentTitle: function () { return this._10o }, add: function (V, J, U, S) { var W = this, w = Rl(); if (W._20o[V]) throw V + " already exists"; w.onmousedown = np, w.style.cursor = tf, w.addEventListener(P ? he : Ir, function (J) { np(J) }, !1), w.addEventListener(P ? Dc : Pb, function ($) { np($), Vg($) && (W._10o === V ? W.collapse() : W.expand(V)) }, !1), hq(W._view, w), W._20o[V] = { content: J, div: w, canvas: sc(w), icon: S }, W._21o.add(V), U && W.expand(V), W.iv() }, remove: function (P) { var V = this, b = V._20o[P]; b && (Ng(b.div), delete V._20o[P], V._21o.remove(P), V.iv()) }, clear: function () { var l = this; l._20o = {}, l._21o.clear(), l.iv() }, isExpanded: function (L) { return this._10o === L }, expand: function (X) { var n = this; n._20o[X] && n._10o !== X && (n._10o = X, n.onExpanded(X), n.iv()) }, onExpanded: function () { }, collapse: function () { var n = this; n._10o && (n.onCollapsed(n._10o), delete n._10o, n.iv()) }, onCollapsed: function () { }, initCanvas: function (X, W, r) { co(X, W, r); var q = nr(X); return Rr(q, 0, 0, 1), q.clearRect(0, 0, W, r), q }, drawTitle: function (z, N, g, B, P) { var r = this, J = yj(P.icon), Y = r.isExpanded(N), O = r._titleHeight, U = r._titleBackground, m = r._selectWidth, b = r._separatorColor, h = yj(Y ? r._expandIcon : r._collapseIcon), s = m + 4; qo(z, 0, 0, g, B, U), Y && m && qo(z, 0, 0, m, B, r._selectBackground), (Y || r._21o.get(r._21o.size() - 1) !== N) && qo(z, 0, B - 1, g, 1, b ? b : ke(U)), J && (Tp(z, J, s + nq(J) / 2, O / 2), s += nq(J) + 2), ho(z, N, r.getLabelFont(N), r.getLabelColor(N), s, 0, 0, O), h && Tp(z, h, g - nq(h) / 2 - 4, O / 2) }, validateImpl: function () { var o = this, w = o._view, f = 0, u = 0, A = o.getWidth(), B = o.getHeight(), E = o._titleHeight, R = o._21o.size() * E, Y = o._11o, W = o._9o; delete o._11o, delete o._9o, o._21o.each(function ($) { var p, K, r = o._20o[$], F = r.content, s = o._10o === $; zs(o) ? (Up(r.div, f, 0, E, B), p = o.initCanvas(r.canvas, E, B), bo(p, 0, B), Nc(p, -c), o.drawTitle(p, $, B, E, r), p.restore(), s ? (K = g(0, A - R), F && (o._11o = F, o._9o = wd(F), Up(F, f + E, 0, K, B)), f += E + K) : f += E) : (Up(r.div, 0, u, A, E), p = o.initCanvas(r.canvas, A, E), o.drawTitle(p, $, A, E, r), p.restore(), s ? (K = g(0, B - R), F && (o._11o = F, o._9o = wd(F), Up(F, 0, u + E, A, K)), u += E + K) : u += E) }); var y = o._9o; Y && Y !== o._11o && Y.endEditing && Y.endEditing(), y && y !== W && hq(w, y), W && W !== y && Ng(W) } }), Wg.SplitView = function (s, _, O, u) { var E = this, t = E._dividerDiv = Rl(), r = E._60O = sc(), m = E._61O = sc(), I = r.style, D = m.style; E._view = ii(1, E), hq(E._view, t), I.msTouchAction = Mo, I.pointerEvents = Mo, I.cursor = tf, D.msTouchAction = Mo, D.pointerEvents = Mo, D.cursor = tf, s && E.setLeftView(s), _ && E.setRightView(_), O && E.setOrientation(O), u != l && E.setPosition(u), E.setStatus(jl), new em(E) }, lk("SplitView", F, { ms_v: 1, ms_fire: 1, ms_ac: ["continuousLayout", "dividerSize", "dividerBackground", "toggleIcon", "togglable", "dragOpacity", "orientation", "draggable", "status"], _continuousLayout: !1, _position: .5, _togglable: !0, _orientation: "h", _draggable: !0, _dividerSize: m.splitViewDividerSize, _dividerBackground: m.splitViewDividerBackground, _dragOpacity: m.splitViewDragOpacity, _toggleIcon: m.splitViewToggleIcon, onPropertyChanged: function () { this.iv() }, getDividerDiv: function () { return this._dividerDiv }, getPosition: function () { return this._position }, setPosition: function (b, U) { var i = this, H = i._position; isNaN(b) || (U || (i._82O = 0 > b ? -1 : b > 1 ? 1 : 0), i._position = b, i.fp(Ug, H, b)) }, getLeftView: function () { return this._leftView }, setLeftView: function (r) { var j = this, _ = j._leftView, U = j._view; if (j._leftView !== r) { if (_ && _ !== j._rightView) { var i = wd(_); i.parentNode === U && Ng(i) } if (j._leftView = r, r) { var H = wd(r); H.parentNode !== U && U.insertBefore(H, j._dividerDiv) } j.fp("leftView", _, r) } }, getRightView: function () { return this._rightView }, setRightView: function (S) { var X = this, d = X._rightView, T = X._view; if (X._rightView !== S) { if (d && d !== X._leftView) { var n = wd(d); n.parentNode === T && Ng(n) } if (X._rightView = S, S) { var j = wd(S); j.parentNode !== T && T.insertBefore(j, X._dividerDiv) } X.fp("rightView", d, S) } }, validateImpl: function () { var C = this, q = C._draggable, H = C._position, D = C.getWidth(), S = C.getHeight(), x = C._dividerSize, X = C._dividerBackground, O = P ? 18 : 8, I = C._dividerDiv, Z = C._82O, M = C._60O, d = C._61O, n = C._toggleIcon, v = C._status, E = I.style, w = null, j = P ? 20 : 4, o = n.comps[0]; x >= O || 0 === x ? C._coverDiv && (Ng(C._coverDiv), delete C._coverDiv) : C._coverDiv || (C._coverDiv = Rl(), r && (C._coverDiv.style.background = Zg), hq(I, C._coverDiv)), C._togglable ? M.parentNode || (hq(I, M), hq(I, d)) : (Ng(M), Ng(d)); var J = C._coverDiv, W = C._leftView, i = C._rightView; if (zs(C)) { if (x > D && (x = D), v === jl) if (1 === Z) var z = b(H, D), U = g(0, D - x - z); else -1 === Z ? (U = b(-H, D), z = g(0, D - x - U)) : (z = L((D - x) * H), U = g(0, D - x - z)); else "cl" === v ? (z = 0, U = g(0, D - x)) : "cr" === v && (U = 0, z = g(0, D - x)); W && Up(W, 0, 0, z, S), i && Up(i, z + x, 0, U, S), Up(I, z, 0, x, S), C._22o = z, J && (Up(J, x / 2 - O / 2, 0, O, S), J.style.cursor = q ? wg : ""), I.style.cursor = q ? wg : ""; var h = I.clientHeight / 2, Q = I.clientWidth; co(M, Q, Q), Up(M, 0, h - Q - j, Q, Q), w = nr(M), Rr(w, 0, 0, 1), o.rotation = -c, mp(w, n, 0, 0, Q, Q), w.restore(), co(d, Q, Q), Up(d, 0, h + j, Q, Q), w = nr(d), Rr(w, 0, 0, 1), o.rotation = c, mp(w, n, 0, 0, Q, Q), w.restore() } else { if (x > S && (x = S), v === jl) if (1 === Z) var B = b(H, S), Y = g(0, S - x - B); else -1 === Z ? (Y = b(-H, S), B = g(0, S - x - Y)) : (B = L((S - x) * H), Y = g(0, S - x - B)); else "cl" === v ? (B = 0, Y = g(0, S - x)) : "cr" === v && (Y = 0, B = g(0, S - x)); W && Up(W, 0, 0, D, B), i && Up(i, 0, B + x, D, Y), Up(I, 0, B, D, x), C._22o = B, J && (Up(J, 0, x / 2 - O / 2, D, O), J.style.cursor = q ? zg : ""), E.cursor = q ? zg : ""; var _ = I.clientWidth / 2, Q = I.clientHeight; co(M, Q, Q), Up(M, _ - Q - j, 0, Q, Q), w = nr(M), Rr(w, 0, 0, 1), o.rotation = 0, mp(w, n, 0, 0, Q, Q), w.restore(), co(d, Q, Q), Up(d, _ + j, 0, Q, Q), w = nr(d), Rr(w, 0, 0, 1), o.rotation = s, mp(w, n, 0, 0, Q, Q), w.restore() } E.background = X } }); var em = function (W) { this.sv = W, this.addListeners() }; uo(em, F, { ms_listener: 1, getView: function () { return this.sv.getView() }, handle_touchstart: function (W) { var i = this, m = i.sv, T = m._dividerDiv, $ = m._60O, t = m._61O, J = m._status, M = W.target; if (M === $) J === jl ? m.setStatus("cl") : "cr" === J && m.setStatus(jl); else if (M === t) J === jl ? m.setStatus("cr") : "cl" === J && m.setStatus(jl); else if (Fl(W) && (M === T || M === m._coverDiv) && (np(W), m.isDraggable())) { m.getLeftView(), m.getRightView(); var B = i.maskDiv = Rl(); if (B.style.left = 0, B.style.top = 0, B.style.width = m.getWidth() + "px", B.style.height = m.getHeight() + "px", m.getView().appendChild(B), !m.isContinuousLayout()) { var X = i.resizeDiv = Rl(); X.style.left = T.style.left, X.style.top = T.style.top, X.style.width = T.style.width, X.style.height = T.style.height, X.style.opacity = m.getDragOpacity(), X.style.background = m.getDividerBackground(), hq(i.getView(), X) } i._lastAbsPosition = m._22o, i._86o = zs(m) ? gi(W).x : gi(W).y, Af(i, W) } }, handleWindowTouchMove: function (b) { Fl(b) && this.update(b, this.sv.isContinuousLayout()) }, handleWindowTouchEnd: function (n) { var U = this; U.update(n, !0), U.sv.setStatus(jl), U.maskDiv && Ng(U.maskDiv), U.resizeDiv && Ng(U.resizeDiv), U.maskDiv = U.resizeDiv = l }, handle_mousedown: function (D) { Vg(D) && this.handle_touchstart(D) }, handleWindowMouseMove: function (i) { this.handleWindowTouchMove(i) }, handleWindowMouseUp: function (k) { this.handleWindowTouchEnd(k) }, update: function (I, $) { var v = this, e = v.sv, J = zs(e) ? e.getWidth() : e.getHeight(), b = e._dividerSize, R = v._lastAbsPosition - v._86o; zs(e) ? (R += gi(I).x, R > J - b && (R = J - b), 0 > R && (R = 0), v.resizeDiv && (v.resizeDiv.style.left = R + $k)) : (R += gi(I).y, R > J - b && (R = J - b), 0 > R && (R = 0), v.resizeDiv && (v.resizeDiv.style.top = R + $k)), $ && J !== b && (1 === e._82O ? e.setPosition(R, 1) : -1 === e._82O ? e.setPosition(R - J + b, 1) : e.setPosition(R / (J - b), 1)) } }), Wg.TabView = function () { var r = this, K = r._view = ii(1, r), U = r._91O = Rl(1), m = r._tabModel = new Mn, t = m.sm(), v = r.invalidate; r._7o = new Ul, r._canvas = sc(U), hq(K, U), hq(K, r._92O = Rl(1)), t.setSelectionMode(tl), t.ms(v, r), m.mm(v, r), m.md(v, r), m.mh(v, r), new Fm(r), r.iv() }, lk("TabView", F, { ms_v: 1, ms_fire: 1, ms_tx: 1, ms_ty: 1, ms_lp: 1, ms_ac: ["movable", "tabGap", "tabHeight", "tabPosition", od, Fd, "tabBackground", "selectWidth", Zq, "moveBackground", "insertColor"], _tabPosition: ys, _tabHeight: gh, _tabGap: m.tabViewTabGap, _labelColor: m.tabViewLabelColor, _labelFont: m.tabViewLabelFont, _tabBackground: m.tabViewTabBackground, _selectWidth: m.tabViewSelectWidth, _selectBackground: m.tabViewSelectBackground, _moveBackground: m.tabViewMoveBackground, _insertColor: m.tabViewInsertColor, _movable: !0, getContentDiv: function () { return this._92O }, getTitleDiv: function () { return this._91O }, getTabModel: function () { return this._tabModel }, add: function (M, g, x) { var d = new Lo, V = this._tabModel; return d.setName(M), d.setView(g), V.add(d), x && V.sm().ss(d), d }, getLabel: function (g) { return g.toLabel() }, onPropertyChanged: function () { this.iv() }, _7Q: function (t) { this._23o = t, this.iv() }, get: function (H) { var u = this, J = u._tabModel; if (Gr(H)) return J._roots.get(H); if (Yc(H)) { var _; return J.each(function (Y) { H === u.getLabel(Y) && (_ = Y) }), _ } return H instanceof Lo ? H : l }, select: function (O) { this._tabModel.sm().ss(this.get(O)) }, remove: function (l) { var z = this; if (l = z.get(l)) { var L = z._tabModel, V = L._roots.indexOf(l); z._tabModel.remove(l), z._12Q(--V) } }, getCurrentTab: function () { return this._8o }, hideTabView: function (t, f) { f.parentNode === this._92O && (gj(f) ? (f.style.display = js, f._tab_ = t) : Ng(f), ce()) }, showTabView: function (j, M) { gj(M) && (M.style.display = "block", M._tab_ = j), M.parentNode !== this._92O && (hq(this._92O, M), ce()) }, _24o: function () { var b, Q = this, S = Q._8o, d = Q._9o, Z = Q._tabModel.sm().ld(); Z && (b = wd(Z.getView())), b !== d && (d && (S.getView() && S.getView().endEditing && S.getView().endEditing(), Q.hideTabView(S, d)), b && Q.showTabView(Z, b)), Q._8o = Z, Q._9o = b, S !== Z && Q.onTabChanged(S, Z) }, onTabClosing: function () { return !0 }, onTabChanged: function () { }, onTabClosed: function (I, M) { this._12Q(--M) }, _12Q: function (a) { var A = this, s = A._tabModel, D = s.size(); if (D && !s.sm().ld()) { a == l && (a = 0), a >= D && (a = D - 1), 0 > a && (a = 0); for (var G = a; G >= 0; G--) { var p = A.get(G); if (!p.isDisabled()) return A.select(p), p } for (G = a + 1; D > G; G++)if (p = A.get(G), !p.isDisabled()) return A.select(p), p } }, _9Q: function (p) { var R = 4, K = yj(p.getIcon()); K && (R += nq(K, p) + 4); var f = this.getLabel(p); return f && (R += Nm(this.getLabelFont(p), f).width + 4), p.isClosable() && (R += 10), R }, drawTab: function (I, C, j, b, Q, G, E) { var g, e = this, X = e._tabPosition, r = j + 4, o = e._selectWidth, i = yj(C.getIcon()), F = C.isDisabled(), K = e.getLabelColor(C), f = e.getLabelFont(C), z = e.getLabel(C), t = e._selectBackground, x = X === Xr + "-vertical", Y = X === kf + "-vertical"; (x || Y) && (r = b + 4), F && (I.globalAlpha = cp), qo(I, j, b, Q, G, E), C === e._8o && o && (X === ys ? qo(I, j, b + G - o, Q, o, t) : X === Xr ? qo(I, j + Q - o, b, o, G, t) : X === kf ? qo(I, j, b, o, G, t) : x ? qo(I, j + Q - o, b, o, G, t) : Y ? qo(I, j, b, o, G, t) : qo(I, j, b, Q, o, t)); var p = Q / 2; if (x && (bo(I, p, b + G / 2), Nc(I, s), bo(I, -p, -b - G / 2)), i) { var U = Jf(i, C), L = nq(i, C); if (x || Y) { var A = j + Q / 2, P = r + U / 2; bo(I, A, P), Nc(I, c), bo(I, -A, -P), Tp(I, i, j + Q / 2, r + U / 2, C, e), bo(I, A, P), Nc(I, -c), bo(I, -A, -P), r += U + 4 } else Tp(I, i, r + L / 2, b + G / 2, C, e), r += L + 4 } return x || Y ? (bo(I, Q / 2, r + Q / 2), Nc(I, c), bo(I, -Q / 2, -r - Q / 2), ho(I, z, f, K, j, r, G, Q), bo(I, Q / 2, r + Q / 2), Nc(I, -c), bo(I, -Q / 2, -r - Q / 2)) : ho(I, z, f, K, r, b, Q, G), x && (bo(I, p, b + G / 2), Nc(I, -s), bo(I, -p, -b - G / 2)), C.isClosable() && (g = Y ? { x: j + Q - 12, y: b + G - 12, width: 12, height: 12 } : { x: j + Q - 12, y: b + 2, width: 12, height: 12 }, this.drawCloseIcon(C, I, K, g)), F && (I.globalAlpha = 1), g }, drawCloseIcon: function (l, q, v, c) { var d = c.x, u = c.y; q.strokeStyle = v, q.lineWidth = 1, q.beginPath(), q.moveTo(d + 2, u + 8), q.lineTo(d + 8, u + 2), q.moveTo(d + 8, u + 8), q.lineTo(d + 2, u + 2), q.stroke() }, validateImpl: function () { var m = this; m._24o(); var E, H = m._canvas, X = m._tabPosition, y = m._91O, h = m._92O, W = m._tabModel, n = m.getWidth(), l = m.getHeight(), O = m._tabHeight, V = m._7o, D = m._tabGap, r = X === ys, o = X === Xr, G = X === kf, _ = X === Xr + "-vertical", k = X === kf + "-vertical", N = m._23o, M = 0; if ((o || G) && W._roots.each(function (I) { M = g(m._9Q(I), M) }), r ? (Up(y, 0, 0, n, O), E = { x: 0, y: O, width: n, height: g(0, l - O) }) : o ? (Up(y, 0, 0, M, l), E = { x: M, y: 0, width: g(0, n - M), height: l }) : G ? (Up(y, n - M, 0, M, l), E = { x: 0, y: 0, width: g(0, n - M), height: l }) : _ ? (Up(y, 0, 0, O, l), E = { x: O, y: 0, width: g(0, n - O), height: l }) : k ? (Up(y, n - O, 0, O, l), E = { x: 0, y: 0, width: g(0, n - O), height: l }) : (Up(y, 0, l - O, n, O), E = { x: 0, y: 0, width: n, height: g(0, l - O) }), Up(h, E), _ || k) { m._9o && (E.x = 0, Up(m._8o.getView(), E)), co(H, O, l); var P = nr(H), x = 0; if (Rr(P, 0, m.ty(), 1), P.clearRect(0, 0, O, l), V.clear(), W._roots.each(function (z) { var C, S = m._9Q(z); N && N.tab === z || (C = m.drawTab(P, z, 0, x, O, S, m._tabBackground)), V.add({ _75o: C, tab: z, startY: x, endY: x + S, height: S }), x += S + D }), m._23Q = g(0, x - D), N) { var R = N.position; m.drawTab(P, N.tab, 0, N.startY, O, N.height, m._moveBackground), qo(P, 0, R, O, 1, m._insertColor) } P.restore(), m.ty(m.ty()) } else if (o || G) { m._9o && (E.x = 0, Up(m._8o.getView(), E)), co(H, M, l); var P = nr(H), x = 0; if (Rr(P, 0, m.ty(), 1), P.clearRect(0, 0, M, l), V.clear(), W._roots.each(function (A) { var l; N && N.tab === A || (l = m.drawTab(P, A, 0, x, M, O, m._tabBackground)), V.add({ _75o: l, tab: A, startY: x, endY: x + O, height: O }), x += O + D }), m._23Q = g(0, x - D), N) { var R = N.position; m.drawTab(P, N.tab, 0, N.startY, M, N.height, m._moveBackground), qo(P, 0, R, M, 1, m._insertColor) } P.restore(), m.ty(m.ty()) } else { m._9o && (E.y = 0, Up(m._8o.getView(), E)), co(H, n, O); var P = nr(H), L = 0; if (Rr(P, m.tx(), 0, 1), P.clearRect(0, 0, n, O), V.clear(), W._roots.each(function (k) { var s, v = m._9Q(k); N && N.tab === k || (s = m.drawTab(P, k, L, 0, v, O, m._tabBackground)), V.add({ _75o: s, tab: k, startX: L, endX: L + v, width: v }), L += v + D }), m._64I = g(0, L - D), N) { var R = N.position; m.drawTab(P, N.tab, N.startX, 0, N.width, O, m._moveBackground), jq(P, m._insertColor, R, 0, O) } P.restore(), m.tx(m.tx()) } for (var c = [], j = h.children, T = 0; T < j.length; T++) { var U = j[T], Z = U._tab_; Z && !W.contains(Z) && c.push(U) } c.forEach(function (j) { h.removeChild(j) }) } }); var Fm = function (G) { this.tv = G, this.addListeners() }; uo(Fm, F, { ms_listener: 1, getView: function () { return this.tv._91O }, handle_mousewheel: function (u) { this.handleScroll(u, 10 * (u.wheelDelta / 40)) }, handle_DOMMouseScroll: function (K) { this.handleScroll(K, 10 * -K.detail) }, handleScroll: function (s, T) { np(s); var Z = this.tv, u = Z._tabPosition; !Z._40o() || u !== ys && u !== yn || Z.tx(this.tv.tx() + T), !Z._41o() || u !== Xr && u !== kf && u !== Xr + "-vertical" && u !== kf + "-vertical" || Z.ty(this.tv.ty() + T) }, _8Q: function (H) { var u, v, X = this.tv, D = X._tabPosition, J = X._7o; if (D === ys || D === yn) { var m = X.lp(H).x; for (u = 0; u < J.size(); u++)if (v = J.get(u), v.startX <= m && m <= v.endX) return v } else if (D === Xr || D === kf || D === Xr + "-vertical" || D === kf + "-vertical") { var i = X.lp(H).y; for (u = 0; u < J.size(); u++)if (v = J.get(u), v.startY <= i && i <= v.endY) return v } return l }, isClickable: function (p) { var q = this.tv, m = q._tabPosition, z = this._73o = this._8Q(p); return !q._40o() || m !== ys && m !== yn ? !q._41o() || m !== Xr && m !== kf && m !== Xr + "-vertical" && m !== kf + "-vertical" ? z && (!z.tab.isDisabled() || q.isMovable()) : !0 : !0 }, handle_mousemove: function (F) { var z = this; Ib ? z._74o = z._8Q(F) : z.getView().style.cursor = z.isClickable(F) ? tf : "" }, handle_mousedown: function (B) { this.handle_mousemove(B), this.handle_touchstart(B) }, handle_touchstart: function (J) { var E = this, H = E.tv, v = H._tabPosition; np(J), E.isClickable(J) && (v === ys || v === yn ? (E.x = gi(J).x, E.lp = H.lp(J), E.tx = H.tx()) : (E.y = gi(J).y, E.lp = H.lp(J), E.ty = H.ty()), Af(E, J)) }, handleWindowMouseMove: function (g) { this.handleWindowTouchMove(g) }, handleWindowTouchMove: function (q) { var D, m = this, l = m.tv, n = l._tabPosition, c = m._73o; if (n === ys || n === yn) { if (D = gi(q).x - m.x, !m._25o && !m.moving && A(D) > 2 && (l._40o() && !ec(q) ? m._25o = 1 : c && l.isMovable() && (m.moving = 1)), m._25o) l.tx(m.tx + D); else if (m.moving) { var Y = m.lp.x + D, B = l._tabGap / 2; l._7o.each(function (j) { var P = j.endX, n = Y - j.startX < P - Y; Y >= j.startX && P >= Y && l._7Q({ tab: c.tab, startX: c.startX + D, width: c.width, front: n, insertTab: j.tab, position: n ? g(0, j.startX - B) : b(l._64I, P + B) }) }) } } else if (D = gi(q).y - m.y, !m._25o && !m.moving && A(D) > 2 && (l._41o() && !ec(q) ? m._25o = 1 : c && l.isMovable() && (m.moving = 1)), m._25o) l.ty(m.ty + D); else if (m.moving) { var y = m.lp.y + D, B = l._tabGap / 2; l._7o.each(function (j) { var m = j.endY, v = y - j.startY < m - y; y >= j.startY && m >= y && l._7Q({ tab: c.tab, startY: c.startY + D, height: c.height, front: v, insertTab: j.tab, position: v ? g(0, j.startY - B) : b(l._23Q, m + B) }) }) } }, handleWindowMouseUp: function (k) { this.handleWindowTouchEnd(k) }, handleWindowTouchEnd: function () { var n = this, L = n.tv, y = L._tabPosition, H = L.getTabModel(), d = H._roots, Z = n._73o; if (n.moving) { var i = L._23o; if (i && i.insertTab !== i.tab) { var G = i.tab, c = d.remove(G), w = d.indexOf(i.insertTab); w >= 0 && (i.front || w++ , w <= d.size() && (d.add(G, w), H._38I(G, c, w))) } L._7Q(l), delete n.moving } else if (!n._25o && Z) { G = Z.tab; var E = n._74o; if (!E || E.tab === G) if (!G.isDisabled() && lg(Z._75o, n.lp)) { var x = function () { var $ = d.indexOf(G); H.remove(G), L.onTabClosed(G, $) }; L.onTabClosing(G, x) && x() } else G.isDisabled() || L._8o === G || H.sm().ss(G) } n._25o = n._73o = n._74o = y === ys || y === yn ? n.x = n.lp = n.tx = l : n.y = n.lp = n.ty = l } }), Wg.PropertyView = function (y) { var R = this; R._view = ii(1, R), R._canvas = sc(R._view), hq(R._view, R._79O = Rl()), R._rows = new Ul, R._28o = new Ul, R._26o = {}, R._26Q = {}; var q = R._propertyModel = new Mn, d = R.ivm; q.mm(d, R), q.md(d, R), q.mh(d, R), R.dm(y ? y : new Mn), new Qq(R) }, lk("PropertyView", F, {
            ms_ac: [od, Ud, Fd, Fp, Ho, "categorizable", se, Po, qc, Gk, uh, ki, uj, He, "selectRowIndex", Zq, "background", Dn, dk, Wq, Wm, dh], ms_v: 1, ms_dm: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, _45o: 1, _47o: 1, ms_tip: 1, _29I: er, _59I: 0, _9I: 0, _selectRowIndex: -1, _editable: !0, _batchEditable: !0, _categorizable: !0, _indent: tg, _background: m.propertyViewBackground, _expandIcon: m.propertyViewExpandIcon, _collapseIcon: m.propertyViewCollapseIcon, _scrollBarColor: tb, _scrollBarSize: Nr, _autoHideScrollBar: Sg, _selectBackground: m.propertyViewSelectBackground, _rowHeight: dp, _rowLineVisible: m.propertyViewRowLineVisible, _rowLineColor: m.propertyViewRowLineColor, _10I: .5, _columnLineVisible: m.propertyViewColumnLineVisible, _columnLineColor: m.propertyViewColumnLineColor, _labelColor: m.propertyViewLabelColor, _labelSelectColor: m.propertyViewLabelSelectColor, _labelFont: m.propertyViewLabelFont, getRows: function () {
                return this._rows
            }, getColumnPosition: function () { return this._10I }, setColumnPosition: function (H) { 0 > H && (H = 0), H > 1 && (H = 1); var W = this, z = W._10I; W._10I = H, W.fp("columnPosition", z, H) }, getPropertyName: function (p) { return p.toLabel() }, getLabelFont: function () { return this._labelFont }, getLabelColor: function (p, g, $) { return $ === this._selectRowIndex ? this._labelSelectColor : this._labelColor }, getPropertyFont: function () { return this._labelFont }, getPropertyColor: function (H, z) { return z === this._selectRowIndex ? this._labelSelectColor : H.getColor() || this._labelColor }, getCategoryFont: function () { return this._labelFont }, getCategoryColor: function () { return this._labelColor }, adjustTranslateX: function () { return 0 }, adjustTranslateY: function (I) { var w = this.getHeight() - this._59I; return w > I && (I = w), I > 0 ? 0 : L(I) }, isExpanded: function (o) { if (!o) return !0; var V = this._26o[o]; return V ? V.isExpanded : !(this._26Q[o] === !1) }, toggle: function (Y) { var R = this; R.isExpanded(Y) ? R.collapse(Y) : R.expand(Y) }, expandAll: function () { this.validate(); for (var R in this._26o) this.expand(R) }, expand: function (n) { if (n && n !== js) { var O = this, c = O._26o[n]; c && !c.isExpanded && (c.isExpanded = !0, O.onExpanded(n), O.ivm()) } }, onExpanded: function () { }, collapseAll: function () { this.validate(); for (var b in this._26o) this.collapse(b) }, collapse: function (q) { if (q && q !== js) { var N = this, I = N._26o[q]; I && I.isExpanded && (I.isExpanded = !1, N.onCollapsed(q), N.ivm()) } }, onCollapsed: function () { }, getCategoryName: function (S) { if (!this.isCategorizable()) return js; var z = S.getCategoryName(); return z ? z : js }, getPropertyModel: function () { return this._propertyModel }, setDataModel: function (d) { var W = this, Y = W._dataModel; Y !== d && (Y && (Y.umd(W.handlePropertyChange, W), W._selectionModel || Y.sm().ums(W.ivm, W)), W._dataModel = d, d.md(W.handlePropertyChange, W), W._selectionModel ? W._selectionModel._21I(d) : d.sm().ms(W.ivm, W), W.fp(Mj, Y, d)) }, isVisible: function (z) { return this._visibleFunc ? this._visibleFunc(z) : !0 }, onPropertyChanged: function (I) { var F = this, K = I.property; Ch[K] ? F.ivm() : F.iv(), K === $g && F._43o() }, getCurrentData: function () { return this._27o }, updateCurrentData: function () { this._27o = this.sm().ld() }, getRawProperties: function () { return this._27o ? this._propertyModel._roots : hd }, handlePropertyChange: function (J) { this._27o === J.data && this.iv() }, ivm: function () { this.invalidateModel() }, invalidateModel: function () { var q = this; q._96I || (q.setSelectRowIndex(-1), q._96I = 1, q.iv()) }, redraw: function () { this.iv() }, validateModel: function () { var x = this, G = x._rows, O = x._28o, F = {}, S = new Ul, r = x._27o; x.updateCurrentData(), r !== x._27o && x.endEditing(), G.clear(), O.clear(), x.getRawProperties().each(function (L) { if (x.isVisible(L)) { S.add(L); var l = x.getCategoryName(L); F[l] || (O.add(l, l === js ? 0 : Z), F[l] = { isExpanded: x.isExpanded(l), properties: new Ul }) } }), x._sortFunc && S.sort(x._sortFunc); for (var N in x._26o) x._26Q[N] = x.isExpanded(N); x._26o = F, O.each(function (Q) { Q !== js && G.add(Q); var d = F[Q]; d.isExpanded && S.each(function (R) { x.getCategoryName(R) === Q && (d.properties.add(R), G.add({ property: R, data: x._27o })) }, x) }) }, validateImpl: function () { var E = this; E._76o(), E._96I && (E.validateModel(), delete E._96I); var q = E._canvas, S = E.getWidth(), g = E.getHeight(), $ = -E.ty(), n = E._rowHeight, O = E._indent, J = S - O, k = E._rows, a = k.size(), I = E._9I = O + J * E._10I, z = E._59I = a * n; co(q, S, g), E._29I = { x: 0, y: $, width: S, height: g }, E._31I = G($ / n), E._14I = T(($ + g) / n), E._31I < 0 && (E._31I = 0), E._14I > a && (E._14I = a); var y, h = nr(q), w = E._background; Rr(h, 0, -$, 1), h.beginPath(), h.rect(0, $, S, g), h.clip(), h.clearRect(0, $, S, g), E._93db(h), w && qo(h, 0, 0, O, z, w); for (var j = E._31I; j < E._14I; j++) { var o = k.get(j), $ = n * j; if (Yc(o)) w && qo(h, O, $, J, n, w), y = yj(E.isExpanded(o) ? E._expandIcon : E._collapseIcon), y && ff(h, y, Jh, 0, $, O, n), h.save(), h.beginPath(), h.rect(O, $, J, n), h.clip(), E.drawCategoryName(h, o, j, O, $, J, n), h.restore(); else { var e = o.property, u = o.data, y = yj(e.getIcon()), F = E._selectRowIndex === j ? E.getSelectBackground() : l; if (y && ff(h, y, Jh, 0, $, O, n), F && qo(h, O, $, J, n, F), h.save(), h.beginPath(), h.rect(O, $, I - O, n), h.clip(), E.drawPropertyName(h, e, j, O, $, I - O, n), h.restore(), !E.isEditing(u, e)) { var V = I + 1, c = S - I - 1; h.save(), h.beginPath(), h.rect(V, $, c, n), h.clip(), E._87o(E.drawPropertyValue(h, e, E.getValue(u, e), j, V, $, c, n, u), j, V, $, c, n), h.restore() } } E._rowLineVisible && qo(h, O, $ + n - 1, J, 1, E._rowLineColor) } E._columnLineVisible && (qo(h, I, 0, 1, z, E._columnLineColor), qo(h, S - 1, 0, 1, z)), E._92db(h), E._93I(), h.restore(), E.ty(E.ty()) }, drawCategoryName: function (W, d, Z, $, M, _, w) { ho(W, d, this.getCategoryFont(d), this.getCategoryColor(d), $, M, _, w) }, drawPropertyName: function (Z, y, K, b, T, v, l) { return y.drawPropertyName ? (y.drawPropertyName(Z, y, K, b, T, v, l, this), void 0) : (ho(Z, this.getPropertyName(y), this.getPropertyFont(y, K), this.getPropertyColor(y, K), b, T, v, l), void 0) }, drawPropertyValue: function (f, m, G, w, b, j, U, l, d) { return m.drawPropertyValue ? m.drawPropertyValue(f, m, G, w, b, j, U, l, d, this) : (Qe(f, G, m, this.getLabelFont(m, G, w), this.getLabelColor(m, G, w), b, j, U, l, d, this), void 0) }, isPropertyEditable: function (P) { return P.isEditable() && this.isEditable() }, setProperties: function (h) { this._propertyModel.clear(), this.addProperties(h) }, addProperties: function (f) { if (f) { var Q = this._propertyModel; f.forEach(function (m) { if (!(m instanceof so)) { var S = Vr(m.className); m = Jc(S ? S : so, m) } Q.add(m) }) } }, getRowIndexAt: function (h) { var P = this, Y = G(P.lp(h).y / P._rowHeight); return Y >= 0 && Y < P._rows.size() ? Y : -1 }, getPropertyAt: function (r) { var o = this, K = o.getRowIndexAt(r); return K >= 0 ? o._rows.get(K).property : l }, getToolTip: function (i) { var Q = this, j = Q.getPropertyAt(i), u = Q._27o; return j && u ? j.getToolTip(u, Q._9I < Q.lp(i).x, Q) : l }
        }); var Qq = function (B) { this.pv = B, this.addListeners() }; uo(Qq, F, { ms_listener: 1, getView: function () { return this.pv._view }, setCursor: function (i) { this.getView().style.cursor = i }, clear: function () { var M = this; M._62O = M.cp = M.ty = M.p = l, M.setCursor(Y) }, handle_mousedown: function (c) { this.handle_touchstart(c) }, handle_touchstart: function (I) { var a = this, K = a.pv; np(I), K.setFocus(I) && (Vg(I) ? (a.cp = gi(I), a.ty = K.ty(), a.p = K.getColumnPosition(), a.handle_touchmove(I)) : K.setSelectRowIndex(K.getRowIndexAt(I))) }, handleWindowMouseUp: function () { this.clear() }, handleWindowTouchEnd: function () { this.clear() }, handle_mouseup: function (U) { this.handle_touchend(U) }, handle_touchend: function (b) { var u = this; if (u.cp && !u._62O) { var o = u.pv, r = o.lp(b), Q = r.x, x = r.y, w = o._indent, z = o.getRowIndexAt(b), S = o._9I; if (z >= 0) { var U = o._rowHeight, n = U * z, C = o._rows.get(z), O = C.property; if (Yc(C)) yj(o.isExpanded(C) ? o._expandIcon : o._collapseIcon) && Q >= 0 && w >= Q && x >= n && n + U >= x ? o.toggle(C) : Si(b) && o.toggle(C); else if (Q > S && o.isPropertyEditable(O, b)) { var t = { x: S + 1, y: n, width: o.getWidth() - S - 1, height: U }, N = { x: t.x + o.tx(), y: t.y + o.ty(), width: t.width, height: t.height }, W = 0, y = o._29I; t.y < y.y ? W = t.y - y.y : t.y + U > y.y + y.height && (W = t.y + U - y.y - y.height), W && (o.ty(o.ty() - W), N.y -= W), o.beginEditing({ data: C.data, property: O, value: o.getValue(C.data, O), event: b, rect: t, editorRect: N, view: o }) } } o.setSelectRowIndex(z) } u.clear() }, handleWindowMouseMove: function (c) { this.handleWindowTouchMove(c) }, handleWindowTouchMove: function (v) { var O = this, x = O.pv, P = O.ty, c = O.cp, u = gi(v), o = O._62O; if ("p" === o) x.setTranslateY(P + u.y - c.y); else if ("c" === o) { var y = x.getWidth() - x._indent; if (y > 16) { var l = O.p - (c.x - u.x) / y, w = 16 / y; w > l && (l = w), l > 1 - w && (l = 1 - w), x.setColumnPosition(l) } } else "s" === o && x.setTranslateY(P + (c.y - u.y) * x._59I / x._29I.height) }, handle_mousemove: function (f) { this.handle_touchmove(f) }, handle_touchmove: function (e) { if (!Ib && Vg(e)) { var K = this, X = K.pv, z = A(X.lp(e).x - X._9I) <= (P ? 8 : 3); K.cp ? K._62O || (z ? (K._62O = "c", Af(K)) : A(gi(e).y - K.cp.y) >= 2 && (K._62O = K.isV(e) ? "s" : "p", Af(K))) : (z ? K.setCursor(wg) : K.setCursor(Y), K.isV(e) && X._43o()) } }, isV: function (y) { var a = this.pv, P = a._29I; return a._41o() && P.x + P.width - a.lp(y).x < Ac }, handle_mousewheel: function (n) { this.handleScroll(n, n.wheelDelta / 40) }, handle_DOMMouseScroll: function (x) { 2 === x.axis && this.handleScroll(x, -x.detail) }, handleScroll: function (D, _) { var u = this.pv; np(D), u.endEditing(), u.translate(0, _ * u.getRowHeight()) }, handle_keydown: function (X) { var $ = this.pv, H = $._rows.size(), J = $._selectRowIndex + (Ef(X) ? -1 : 1); (Ef(X) || hr(X)) && (0 > J && (J = 0), J >= H && (J = H - 1), $.setSelectRowIndex(J)) } }), Wg.ListView = function (U) { this._5o(U), new Xo(this) }, lk("ListView", F, { ms_ac: [od, Ud, Fd, Dn, se, dk, Wq, Po, qc, ki, uj, He, om, Zq], ms_v: 1, ms_bnb: 1, ms_tip: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, ms_hs: 1, _15Q: 1, _14Q: 1, ms_dm: 1, _45o: 1, _checkMode: !1, _indent: tg, _rowHeight: dp, _rowLineVisible: m.listViewRowLineVisible, _rowLineColor: m.listViewRowLineColor, _scrollBarColor: tb, _scrollBarSize: Nr, _autoMakeVisible: wf, _autoHideScrollBar: Sg, _selectBackground: m.listViewSelectBackground, _labelColor: m.listViewLabelColor, _labelSelectColor: m.listViewLabelSelectColor, _labelFont: m.listViewLabelFont, isCheckMode: function () { return this._checkMode }, setCheckMode: function (C) { var n = this, s = n._checkMode; n._checkMode = C, n.fp(fl, s, C) }, drawRow: function (R, w, Q, C, $, u, f) { var e = this, x = 0, m = e._indent, I = e.getIconWidth(w); e.drawRowBackground(R, w, Q, C, $, u, f), e._checkMode && (Tp(R, e.getCheckIcon(w), x + m / 2, $ + f / 2, w, e), x += m), e.drawIcon(R, w, x, $, I, f), e.drawLabel(R, w, x + I, $, f) } }); var Xo = function (P) { this.list = P, this._lastSelectDataTime = Fh(), this.addListeners() }; uo(Xo, F, { ms_listener: 1, getView: function () { return this.list._view }, clear: function (M) { var D = this, N = D.list; M && "d" === D._62O && !D.dragCancel && N.handleDragAndDrop(M, "end"), N.draggingData && (N.draggingData = null, N.redraw()), D.dragCancel = D._62O = D._isV = D._isH = D.cp = D.tx = D.ty = l }, handle_mousedown: function (K) { this.handle_touchstart(K) }, handle_touchstart: function ($) { var i = this, E = i.list; if (np($), E.setFocus($)) { var l = E.getDataAt($); i.cp = gi($), i.tx = E.tx(), i.ty = E.ty(), Vg($) ? l && E.handleDragAndDrop && !i.isV($) && !i.isH($) && (E.draggingData = l, E.redraw(), E.handleDragAndDrop($, "prepare")) : (l && i._33o($, l), i.clear($)) } }, handleWindowMouseUp: function (J) { this.clear(J) }, handleWindowTouchEnd: function (F) { this.clear(F) }, handle_mouseup: function ($) { this.handle_touchend($) }, handle_touchend: function (d) { var D = this, i = D.list; if (!D._isV && !D._isH && D.cp && !D._62O) { var l = i.getDataAt(d); l ? (i.isCheckMode() ? D._34o(d, l) : D._33o(d, l), Si(d) ? i.onDataDoubleClicked(l, d) : i.onDataClicked(l, d)) : i.handleBackgroundClick(d) } D.clear(d) }, handleWindowMouseMove: function (Y) { this.handleWindowTouchMove(Y) }, handleWindowTouchMove: function (Y) { var k = this, s = k.list, l = k._62O, U = k.tx, y = k.ty, O = k.cp, H = gi(Y), b = s._29I; "p" === l ? s.setTranslate(U + H.x - O.x, y + H.y - O.y) : "v" === l ? s.ty(y + (O.y - H.y) * s._59I / b.height) : "h" === l ? s.tx(U + (O.x - H.x) * s._91I / b.width) : "d" === l && (k.dragCancel || s.handleDragAndDrop(Y, "between")) }, handle_mousemove: function (m) { this.handle_touchmove(m) }, handle_touchmove: function (w) { if (!Ib && Vg(w)) { var o = this, t = o.list; if (o._isV = o.isV(w), o._isH = o.isH(w), o.cp) { if (!o._62O) { if (Bk(gi(w), o.cp) < 2) return; o._isV ? o._62O = "v" : o._isH ? o._62O = "h" : t.draggingData && !this.dragCancel ? (o._62O = "d", t.handleDragAndDrop(w, "begin")) : o._62O = "p", o._62O && "d" !== o._62O && t.draggingData && (t.draggingData = null, t.redraw()), Af(o) } } else o._isV && t._43o(), o._isH && t._42o() } }, isV: function (v) { var A = this.list, M = A._29I; return A._41o() && M.x + M.width - A.lp(v).x < Ac }, isH: function (F) { var E = this.list, H = E._29I; return E._40o() && H.y + H.height - E.lp(F).y < Ac }, handle_mousewheel: function (O) { this.handleScroll(O, O.wheelDelta / 40, O.wheelDelta !== O.wheelDeltaX) }, handle_DOMMouseScroll: function (D) { this.handleScroll(D, -D.detail, 1) }, handleScroll: function (f, g, i) { var X = this.list; np(f), X.endEditing && X.endEditing(), i && X._41o() ? X.translate(0, g * X.getRowHeight()) : X._40o() && X.translate(10 * g, 0) }, handle_keydown: function (J) { if (!m.isInput(J.target)) { var A, h = this.list, r = h.sm(), d = h._rows, U = d.size(); if (Tn(J)) h.selectAll(); else if (Th(J)) h.handleDelete && h.handleDelete(J); else if (ai(J)) "d" !== this._62O || this.dragCancel || (h.handleDragAndDrop(J, "cancel"), this.dragCancel = !0); else if (Pk(J)) h.isCheckMode() && (A = h.getFocusData(), A && h.checkData(A)); else if (Ef(J) || hr(J)) { var M = h.isCheckMode(); if (A = M ? h.getFocusData() : r.ld()) { var P = h.getRowIndex(A); P >= 0 && (Ef(J) ? 0 !== P && (A = d.get(P - 1), M ? h.setFocusData(A) : r.ss(A)) : P !== U - 1 && (A = d.get(P + 1), M ? h.setFocusData(A) : r.ss(A))) } else U > 0 && (A = d.get(0), M ? h.setFocusData(A) : r.ss(A)) } } }, _34o: function (j, U) { var I = this.list, T = I.lp(j).x; return T >= 0 && T <= I._indent ? (I.checkData(U), void 0) : (I.setFocusData(U), void 0) }, _33o: function (M, q) { var V = this.list, k = V.sm(), t = k.ld(); if (ec(M)) V.isSelected(q) ? k.rs(q) : k.as(q); else if (Qd(M)) if (t) for (var c = V.getRowIndex(t), s = V.getRowIndex(q); c !== s;)c += s > c ? 1 : -1, k.as(V._rows.get(c)); else k.ss(q); else if (Vg(M)) { var n = Fh(); if (k.contains(q)) { var J = n - this._lastSelectDataTime; V.handleDataDoubleSelect && J > 500 && 1500 > J && V.handleDataDoubleSelect(M, q) } k.ss(q), this._lastSelectDataTime = n } else k.contains(q) || k.ss(q) } }), Wg.TreeView = function ($) { var K = this; K._35o(), K._5o($), new ve(K) }, lk("TreeView", F, { ms_ac: [od, Ud, Fd, "rootVisible", fl, "rootData", Po, qc, ki, uj, He, se, Dn, dk, Wq, Gk, uh, om, Zq, "loader", "doubleClickToToggle"], ms_v: 1, ms_bnb: 1, ms_tip: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, ms_hs: 1, _15Q: 1, ms_dm: 1, _48o: 1, _14Q: 1, _45o: 1, _checkMode: l, _indent: tg, _rowHeight: dp, _rowLineVisible: m.treeViewRowLineVisible, _rowLineColor: m.treeViewRowLineColor, _scrollBarColor: tb, _scrollBarSize: Nr, _autoHideScrollBar: Sg, _expandIcon: m.treeViewExpandIcon, _collapseIcon: m.treeViewCollapseIcon, _autoMakeVisible: wf, _selectBackground: m.treeViewSelectBackground, _labelColor: m.treeViewLabelColor, _labelSelectColor: m.treeViewLabelSelectColor, _labelFont: m.treeViewLabelFont, _doubleClickToToggle: m.treeViewDoubleClickToToggle, drawRow: function (o, g, G, R, B, u, I) { var K = this; K.drawRowBackground(o, g, G, R, B, u, I), K._97I(o, g, G, 0, B, u, I) }, isOnToggleIcon: function (B) { var q = this.getDataAt(B); if (q) { var Q = this.getIndent(), C = this.lp(B).x; if (yj(this.getToggleIcon(q))) { var N = Q * this.getLevel(q); if (C >= N && N + Q >= C) return !0 } } return !1 } }); var ve = function (U) { xd(ve, this, [U]) }; uo(ve, Xo, { toggle: function (a, q, M, k) { var N = this.list, L = N.lp(a).x; if (yj(N.getToggleIcon(q))) { var R = M * k; if (L >= R && R + M >= L) return N.toggle(q), !0 } return N.isDoubleClickToToggle() && Si(a) ? (N.toggle(q), !0) : !1 }, _34o: function (H, u) { var p = this.list, Y = p.lp(H).x, Z = p._levelMap[u._id], Q = p._indent, P = Q * (Z + 1); return Y >= P && P + Q >= Y ? (p.checkData(u), void 0) : (this.toggle(H, u, Q, Z) || p.setFocusData(u), void 0) }, _33o: function (x, t) { var B = this, q = B.list; B.toggle(x, t, q._indent, q.getLevel(t)) || ve.superClass._33o.call(B, x, t) }, handle_keydown: function (B) { if (Qi(B) || Kh(B)) { var V = this.list, g = V._rows, p = V.isCheckMode(), b = V.sm(), v = p ? V.getFocusData() : b.ld(); v ? v.hasChildren() && (Qi(B) ? V.collapse(v) : V.expand(v)) : g.size() > 0 && (v = g.get(0), p ? V.setFocusData(v) : b.ss(v)) } else ve.superClass.handle_keydown.call(this, B) } }); var xc = Wg.TableView = function (N) { this._98I(), this._5o(N), new wc(this) }; lk("TableView", F, { ms_ac: [od, Ud, Fd, "sortMode", Fp, Ho, Dn, dk, Wq, Wm, dh, "sortColumn", Po, qc, ki, uj, He, om, Zq], ms_v: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, ms_hs: 1, _15Q: 1, ms_dm: 1, ms_tip: 1, _50o: 1, _45o: 1, _47o: 1, _sortMode: Rg, _editable: !0, _batchEditable: !1, _rowHeight: dp, _rowLineVisible: m.tableViewRowLineVisible, _rowLineColor: m.tableViewRowLineColor, _columnLineVisible: m.tableViewColumnLineVisible, _columnLineColor: m.tableViewColumnLineColor, _scrollBarColor: tb, _scrollBarSize: Nr, _autoHideScrollBar: Sg, _autoMakeVisible: wf, _selectBackground: m.tableViewSelectBackground, _labelColor: m.tableViewLabelColor, _labelSelectColor: m.tableViewLabelSelectColor, _labelFont: m.tableViewLabelFont, getCheckColumn: function () { var M = this; if (!M._31o) { var j = M._31o = new On; j.setEditable(!0), j.setWidth(40), j.getValue = M.getCheckColumValue, j.drawCell = M.drawCheckColumnCell } return M._31o }, isCheckMode: function () { return this._39o.contains(this._31o) }, setCheckMode: function (O) { var H = this, S = H._39o, P = H.getCheckColumn(); O !== H.isCheckMode() && (O ? S.add(P, 0) : S.remove(P), H.fp(fl, !O, O)) }, getCheckColumValue: function (U, g, L) { return L.isSelected(U) }, drawCheckColumnCell: function (d, I, N, a, w, y, p, q, m) { Tp(d, m.getCheckIcon(I), w + p / 2, y + q / 2, I, m) } }); var wc = function ($) { xd(wc, this, [$]) }; uo(wc, Xo, { _34o: function (j, U) { var n = this.list, P = n._31o; if (n.isCellEditable(U, P, j)) { var u = n._3Q(P), f = n.lp(j).x; if (u && f >= u.startX && f < u.startX + P.getWidth()) return n.checkData(U), void 0 } n.setFocusData(U), n._37O(U, j) }, _33o: function (u, f) { wc.superClass._33o.apply(this, arguments), this.list._37O(f, u) } }); var we = Wg.TreeTableView = function (u) { var r = this, U = r._4o = new On; r._35o(), r._98I(), r._5o(u), U.setDisplayName("Name"), U.setEditable(!0), U.setWidth(180), U.drawCell = ml, U.getValue = Ui, r._39o.add(U), new Ck(r) }, ml = function (j, Y, m, E, r, u, D, l, C) { C._97I(j, Y, m, r, u, D, l) }, Ui = function (f, S, d) { return d.getLabel(f) }; lk("TreeTableView", F, { ms_ac: [od, Ud, Fd, "sortMode", Fp, Ho, se, fl, "rootData", "rootVisible", Po, qc, "sortColumn", Gk, uh, ki, uj, He, om, Wq, Dn, dk, Wm, dh, Zq, "loader"], ms_v: 1, ms_bnb: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, ms_hs: 1, _15Q: 1, ms_dm: 1, ms_tip: 1, _50o: 1, _48o: 1, _14Q: 1, _45o: 1, _47o: 1, _sortMode: Rg, _checkMode: l, _editable: !0, _batchEditable: !1, _indent: tg, _rowHeight: dp, _rowLineVisible: m.treeTableViewRowLineVisible, _rowLineColor: m.treeTableViewRowLineColor, _columnLineVisible: m.treeTableViewColumnLineVisible, _columnLineColor: m.treeTableViewColumnLineColor, _expandIcon: m.treeTableViewExpandIcon, _collapseIcon: m.treeTableViewCollapseIcon, _scrollBarColor: tb, _scrollBarSize: Nr, _autoHideScrollBar: Sg, _autoMakeVisible: wf, _selectBackground: m.treeTableViewSelectBackground, _labelColor: m.treeTableViewLabelColor, _labelSelectColor: m.treeTableViewLabelSelectColor, _labelFont: m.treeTableViewLabelFont, getTreeColumn: function () { return this._4o } }); var Ck = function (t) { xd(Ck, this, [t]) }; uo(Ck, Xo, { _34o: function (Q, q) { var L = this.list, k = L._4o, g = L._3Q(k), y = L.lp(Q).x; if (g) { var e = L._indent, W = g.startX + e * L.getLevel(q); if (yj(L.getToggleIcon(q)) && y >= W && W + e >= y) return L.toggle(q), void 0; if (L.isCellEditable(q, k) && (W += e, y >= W && W + e >= y)) return L.checkData(q), void 0 } L.setFocusData(q), L._37O(q, Q) }, _33o: function (O, K) { var k = this.list, e = k.lp(O).x; if (yj(k.getToggleIcon(K))) { var M = k._3Q(k._4o); if (M) { var t = k._indent, f = M.startX + t * k.getLevel(K); if (e >= f && f + t >= e) return k.toggle(K), void 0 } } Ck.superClass._33o.apply(this, arguments), k._37O(K, O) } }); var xp = Wg.TableHeader = function (B) { var i = this, v = i._view = ii(1, i), U = i._39o = B.getColumnModel(), q = i.iv; i.tv = i._tableView = B, i._60I = new Ul, i._canvas = sc(v), v.style.background = m.tableHeaderBackground || "", v.style.height = Fg + $k, U.mm(q, i), U.md(q, i), U.mh(q, i), B.mp(function (W) { Ml[W.property] && i.iv() }, i), new Jg(i), i.iv() }; lk("TableHeader", F, { ms_v: 1, ms_lp: 1, ms_fire: 1, ms_ac: ["checkIcon", "sortDescIcon", "sortAscIcon", od, Fd, se, "moveBackground", "insertColor", Wm, dh, "resizable", "movable"], _checkIcon: Oc, _movable: !0, _resizable: !0, _labelColor: m.tableHeaderLabelColor, _labelFont: m.tableHeaderLabelFont, _columnLineColor: m.tableHeaderColumnLineColor, _columnLineVisible: m.tableHeaderColumnLineVisible, _sortDescIcon: m.tableHeaderSortDescIcon, _sortAscIcon: m.tableHeaderSortAscIcon, _moveBackground: m.tableHeaderMoveBackground, _insertColor: m.tableHeaderInsertColor, _indent: tg, getCheckIcon: function () { return this._checkIcon }, getTableView: function () { return this.tv }, getLabel: function (f) { return f.toLabel() }, getLabelFont: function () { return this._labelFont }, getLabelColor: function (S) { return S.getColor() || this._labelColor }, getLabelAlign: function (z) { return z._align }, onPropertyChanged: function () { this.iv() }, _5Q: function (p) { this._61I = p, this.iv() }, getLogicalPoint: function (t) { return mj(t, this._canvas, this.tv.tx()) }, validateImpl: function () { var b = this, I = b._canvas, F = b.getWidth(), V = b.getHeight(), m = b.tv, v = b._60I, Z = b._61I, Y = -m.tx(), c = 0; (F !== I.clientWidth || V !== I.clientHeight) && co(I, F, V), v.clear(), b._39o._roots.each(function (O) { if (O.isVisible()) { var d = c + O.getWidth(); Y + F >= c && d >= Y && v.add({ column: O, startX: c }), c = d } }); var _ = nr(I); if (Rr(_, -Y, 0, 1), _.beginPath(), _.rect(Y, 0, F, V), _.clip(), _.clearRect(Y, 0, F, V), v.each(function (s) { var i = s.column, J = s.startX, p = i.getWidth(); p > 0 && (_.save(), _.beginPath(), _.rect(J, 0, p, V), _.clip(), Z && Z.column === i || b.drawColumn(_, i, J, 0, p, V), b._columnLineVisible && qo(_, J + p - 1, 0, 1, V, b._columnLineColor), _.restore()) }), Z) { var M = Z.column, c = Z.startX, G = Z.position, Q = M.getWidth(); _.save(), _.beginPath(), _.rect(c, 0, Q, V), _.clip(), _.fillStyle = b._moveBackground, _.fill(), b.drawColumn(_, M, c, 0, Q, V), _.restore(), jq(_, b._insertColor, G, 0, V) } _.restore() }, _6Q: function (t) { var w = this.tv; return w._31o === t && w.sm().getSelectionMode() === rp }, drawColumn: function (M, Y, Q, z, $, G) { var U = this, e = U.tv, E = yj(Y.getIcon()), u = U.getLabelAlign(Y); if (U._6Q(Y)) { var Z = yj(U._checkIcon); Tp(M, Z, Q + $ / 2, z + G / 2, Y, U) } else { var d = U.getLabel(Y), i = U.getLabelFont(Y), R = U.getLabelColor(Y), f = Nm(i, d).width, P = E ? U._indent : 0; u === Xr ? (E && ff(M, E, Jh, Q, z, P, G), ho(M, d, i, R, Q + P, z, $, G, Xr)) : u === kf ? (E && ff(M, E, Jh, Q + $ - f - P, z, P, G), ho(M, d, i, R, Q, z, $, G, kf)) : (E && ff(M, E, Jh, Q + ($ - f - P) / 2, z, P, G), ho(M, d, i, R, Q + ($ - f + P) / 2, z, 0, G, Xr)) } if (Y.isSortable() && e.getSortColumn() === Y && (E = yj(Y.getSortOrder() === ej ? U._sortAscIcon : U._sortDescIcon))) { var m = nq(E, Y) / 2 + 2; Tp(M, E, u === kf ? Q + m : Q + $ - m, z + G / 2, Y, e) } } }); var Jg = function (F) { var o = this; o.th = F, o.tv = F._tableView, o.addListeners() }; uo(Jg, F, { ms_listener: 1, getView: function () { return this.th.getView() }, setCursor: function (m) { this.getView().style.cursor = m }, handle_mousemove: function (K) { if (!Ib) { var m = this; delete m._29o, m.setCursor(Y); for (var x = m.th, s = x._60I, $ = x.lp(K).x, f = s.size() - 1; f >= 0; f--) { var k = s.get(f), t = k.column, D = k.startX + t.getWidth(); if (x.isResizable() && A(D - $) <= (P ? 10 : 3)) return m._29o = k, m.setCursor(wg), void 0; $ > k.startX && D > $ && (m._29o = k), (t.isClickable() || t.isSortable() || x.isMovable() || m.tv.getCheckColumn && t === m.tv.getCheckColumn()) && $ > k.startX && D > $ && m.setCursor(tf) } } }, handle_mousedown: function (p) { this.handle_touchstart(p) }, handle_touchstart: function (A) { var q = this; np(A), q.tv.endEditing(), q.handle_mousemove(A), q._29o && (q.x = gi(A).x, q.lx = q.th.lp(A).x, q.w = q._29o.column.getWidth(), Af(q, A)) }, handleWindowMouseMove: function (i) { this.handleWindowTouchMove(i) }, handleWindowTouchMove: function (F) { var M = this, w = M.th, L = M.getView().style.cursor, Z = M._29o, z = gi(F).x - M.x; if (M.resizing || M.moving || (L === wg ? M.resizing = 1 : w.isMovable() && L === tf && A(z) > 2 && (M.moving = 1)), M.resizing) Z.column.setWidth(M.w + z); else if (M.moving) { var $ = M.lx + z; w._60I.each(function (K) { var u = K.startX, m = u + K.column.getWidth(); if ($ >= u && m >= $) { var d = { column: Z.column, startX: Z.startX + z, front: m - $ > $ - u, insertColumn: K.column }; d.position = d.front ? u : m, w._5Q(d) } }) } }, _16Q: function (u, K) { var v = this, b = v.tv, G = v.th, C = G._checkIcon; if (G._6Q(u)) { var M = yj(C), l = v.lx, g = u.getWidth(), j = nq(M, u); if (l >= K + g / 2 - j && K + g / 2 + j >= l) { G.setCheckIcon(C === Sb ? Oc : Sb); var F = b.sm(), Y = b._rows; return C === Sb ? F.rs(Y) : F.ss(Y), b.onCheckColumnClicked(u), !0 } } return !1 }, handleWindowMouseUp: function (v) { this.handleWindowTouchEnd(v) }, handleWindowTouchEnd: function (q) { var B = this, o = B.tv, c = B.th, P = B._29o; if (B.moving) { var Q = c._61I; if (Q && Q.insertColumn !== Q.column) { var k = Q.column, n = o.getColumnModel()._roots, N = n.remove(k), V = n.indexOf(Q.insertColumn); V >= 0 && (Q.front || V++ , V <= n.size() && (n.add(k, V), o.getColumnModel()._38I(k, N, V))) } c._5Q(l), delete B.moving } else if (!B.resizing && P) { k = P.column; var F = c.lp(q).x, b = P.startX, v = !0; if (c.onColumnClicked) { var D = c.onColumnClicked(k, q, b); D === !1 && (v = !1) } if (v && F >= b && F <= b + k.getWidth() && !B._16Q(k, b)) { if (k.isSortable()) { var f = o.getSortMode(), x = k.getSortOrder(); f === Rg ? o.getSortColumn() === k ? (x === Pp && o.setSortColumn(l), k.setSortOrder(x === ej ? Pp : ej)) : o.setSortColumn(k) : "bistate" === f && (o.getSortColumn() === k ? k.setSortOrder(x === ej ? Pp : ej) : o.setSortColumn(k)) } o.onColumnClicked(k, q, b) } } B._29o = B.resizing = B.x = B.lx = B.w = l } }), Wg.TablePane = function (K) { this.init(new xc(K)) }, lk("TablePane", F, { ms_v: 1, _44o: 1 }), Wg.TreeTablePane = function (N) { this.init(new we(N)) }, lk("TreeTablePane", F, { ms_v: 1, _44o: 1 }), Wg.Toolbar = function (o) { var S = this, $ = S._view = ii(1, S), l = $.style; l.background = m.toolbarBackground || "", l.height = gh + $k, S._canvas = sc($), S._30o = new Ul, S._90I = new Ul, S.setItems(o || []), $.handleGroupSelectedChanged = function (K) { if (K.isSelected()) { var Z = K.getGroupId(); null != Z && S._items.forEach(function (F) { var e = F.element; e && e !== K && e.setSelected && e.getGroupId && e.getGroupId() === Z && e.setSelected(!1) }) } }, new Gc(S) }, lk("Toolbar", F, { ms_v: 1, ms_fire: 1, ms_tx: 1, ms_lp: 1, ms_tip: 1, ms_value: 1, ms_ac: [Kr, od, Fd, Ud, Zq, "itemGap", "separatorColor", "currentItem", "stickToRight"], _labelColor: m.toolbarLabelColor, _labelSelectColor: m.toolbarLabelSelectColor, _labelFont: m.toolbarLabelFont, _selectBackground: m.toolbarSelectBackground, _itemGap: m.toolbarItemGap, _separatorColor: m.toolbarSeparatorColor, _stickToRight: !1, getSumWidth: function () { return this._64I }, getToolTip: function (X) { var q = this.getItemInfoAt(X); return q ? q.item.toolTip : l }, getLabelColor: function (B) { return B && B.selected && B.type !== Sb && B.type !== Xe ? this._labelSelectColor : this._labelColor }, onPropertyChanged: function (K) { this.iv(), K.property === Kr && this._items.forEach(function (x) { xq(x) }) }, redraw: function () { this.iv() }, addItem: function (L, M) { var U = this._items; M == l ? U.push(L) : U.splice(M, 0, L), this.fp(Kr, l, U) }, removeItem: function (v) { if (v) for (var j = this._items, w = 0; w < j.length; w++)v === j[w] && (j.splice(w, 1), this.fp(Kr, l, j)) }, removeItemById: function (S) { if (S != l) for (var v = this._items, P = 0; P < v.length; P++)if (S === v[P].id) { var E = v.splice(P, 1)[0]; return this.fp(Kr, l, v), E } }, getItemById: function (g) { if (g != l) for (var t = this._items, v = 0; v < t.length; v++) { var n = t[v]; if (g === n.id) return n } }, setItemVisible: function (h, W) { var A = this.getItemById(h); A && (A.visible = W) }, getItemInfos: function () { return this._30o }, getItemInfoAt: function (g) { var Q = this, O = 0, d = Q._30o, t = Q.lp(g), H = t.x, y = t.y; if (y >= 0 && y <= Q.getHeight()) for (; O < d.size(); O++) { var X = d.get(O); if (X.startX <= H && H <= X.endX) return X } return l }, drawItem: function (L, p, H, h, E) { if (p.visible === !1) return 0; if (Nf(p.visible) && !p.visible()) return 0; var z = this, J = p.disabled; J && (L.globalAlpha = cp); var N = z.drawItemImpl(L, p, H, h, E), W = z._itemGap; return J && (L.globalAlpha = 1), this._currentItem !== p || "separator" === p || p.separator === !0 || p.unfocusable || Ei(L, z._separatorColor, H - W / 2, 0, N + W, h), N }, drawItemImpl: function (u, r, R, E, x) { var L = this, v = L._view, q = L._itemGap, K = E / 2, w = r.type, P = r.element, B = r.label; Yc(P) && (B = P, P = l); var p, V = L.getLabelFont(r), A = L.getLabelColor(r), h = r.selected, Y = yj(r.icon), d = nq(Y, r), N = 0, s = d + (B ? Nm(V, B).width : 0); if ("separator" === r || r.separator === !0) return jq(u, L._separatorColor, R, E / 4, K), 1; if (P) { Y && Tp(u, Y, R + d / 2, K, r, L), ho(u, B, V, A, R + d, 0, 0, E); var I = wd(P); x || L._90I.add(I), I.parentNode !== v && hq(v, I), P.iv && P.iv(), P.validate && P.validate(); var t = I.getBoundingClientRect(), H = t.width, j = I.style; return Rd(I), j.left = L.tx() + R + s + $k, j.top = (E - t.height) / 2 + $k, s + H } return w === Xe ? p = yj(h ? gq : yg) : w === Sb && (p = yj(h ? Sb : Oc)), p ? (N = nq(p, r), Tp(u, p, R + N / 2, K, r, L), R += N, s += N) : h && qo(u, R - q / 2, 0, s + q, E, L.getSelectBackground(r)), Y && Tp(u, Y, R + d / 2, K, r, L), ho(u, B, V, A, R + d, 0, 0, E), s }, validateImpl: function () { var p = this, i = p._canvas, o = p.getWidth(), Y = p.getHeight(), J = p._30o, f = p._items; co(i, o, Y); var a = nr(i), b = p._itemGap, Z = b / 2; Rr(a, p.tx(), 0, 1), a.clearRect(0, 0, o, Y); var v = p._90I; p._90I = new Ul, J.clear(), f.forEach(function (A) { var K = p.drawItem(a, A, Z, Y); J.add({ item: A, startX: Z, endX: Z + K, width: K }), K && (Z += K + b) }), v.each(function (U) { p._90I.contains(U) || Ng(U) }); var C = p._64I; p._64I = g(0, Z), a.restore(), p._stickToRight ? (p._65O = 0, a = nr(i), Z = o - p._64I + b, Rr(a, 0, 0, 1), a.clearRect(0, 0, o, Y), J.clear(), f.forEach(function (P) { var n = p.drawItem(a, P, Z, Y, !0); J.add({ item: P, startX: Z, endX: Z + n, width: n }), n && (Z += n + b) }), a.restore()) : p.tx(p.tx()), C !== p._64I && p.onSumWidthChanged(C, p._64I) }, onSumWidthChanged: function () { }, handleClick: function (Y, c) { var k = this, j = Y.type, L = Y.action, o = Y.groupId, w = Y.selected; Y.disabled || (o != l ? w || (Y.selected = !0, this._items.forEach(function (G) { G.groupId === o && Y !== G && (G.selected = !1) }), L && Y.action(Y, k, c)) : j === Sb || "toggle" === j ? (Y.selected = !w, L && Y.action(Y, k, c)) : L && Y.action(Y, k, c)), ce(), k.iv() } }); var Gc = function (m) { this.tb = m, this.addListeners() }; uo(Gc, F, { ms_listener: 1, getView: function () { return this.tb._view }, handle_mousewheel: function (z) { this.handleScroll(z, 10 * (z.wheelDelta / 40)) }, handle_DOMMouseScroll: function (Y) { this.handleScroll(Y, 10 * -Y.detail) }, handleScroll: function (W, h) { np(W); var v = this.tb; v.isScrollable() && !v._stickToRight && (v.tx(v.tx() + h), qm()) }, handle_mousemove: function (z) { var V = this; Ib || V.setItem(z) }, handle_mouseout: function (h) { var U = this; h.target === U.getView() ? U.tb.setCurrentItem(l) : U.handle_mousemove(h) }, handle_mousedown: function (n) { this.handle_mousemove(n), this.handle_touchstart(n) }, handle_touchstart: function (E) { var T = this, _ = T.tb, s = E.target; Vg(E) && (s === T.getView() || s === _._canvas) && (np(E), _.setFocus(E) && (this.setItem(E, !0), (_.isScrollable() || T.info && !T.info.item.disabled) && (T.x = gi(E).x, T.tx = _.tx(), Af(T, E)))) }, handleWindowMouseMove: function (H) { this.handleWindowTouchMove(H) }, handleWindowTouchMove: function (i) { var L = this, Y = L.tb; if (!Y._stickToRight) { var C = gi(i).x - L.x; !L._25o && A(C) > 2 && Y.isScrollable() && (L._25o = 1), L._25o && Y.tx(L.tx + C) } }, handleWindowMouseUp: function (z) { this.handleWindowTouchEnd(z) }, handleWindowTouchEnd: function (F) { var c = this, $ = c.tb, _ = c.info, d = c.tb.getItemInfoAt(F); if (!c._25o && _) { var Z = _.item; d && d.item === Z && $.handleClick(Z, F) } c._25o = c.x = c.tx = l, c.setItem() }, setItem: function (o, N) { var u = this, X = u.tb, M = u.info = o ? X.getItemInfoAt(o) : l, Z = M ? M.item : l; X.setCurrentItem(Z), N && Z && Nf(Z.onDown) && Z.onDown(o) } }), Wg.BorderPane = function () { this._view = ii(1, this), this.iv() }, lk("BorderPane", F, { ms_v: 1, ms_ac: ["topHeight", "bottomHeight", "leftWidth", "rightWidth"], ms_fire: 1, getLeftView: function () { return this._leftView }, setLeftView: function (t, K) { this._12o("leftView", t), K != l && this.setLeftWidth(K) }, getRightView: function () { return this._rightView }, setRightView: function (m, K) { this._12o("rightView", m), K != l && this.setRightWidth(K) }, getTopView: function () { return this._topView }, setTopView: function (t, X) { this._12o("topView", t), X != l && this.setTopHeight(X) }, getBottomView: function () { return this._bottomView }, setBottomView: function (Q, f) { this._12o("bottomView", Q), f != l && this.setBottomHeight(f) }, getCenterView: function () { return this._centerView }, setCenterView: function (R) { this._12o("centerView", R) }, _12o: function (f, P) { var V = this, E = "_" + f, _ = V._view, z = V[E]; z !== P && (z && (z.getView ? Ng(z.getView()) : Ng(z)), V[E] = P, P && (P.getView ? hq(_, P.getView(), 1) : hq(_, P, 1)), V.fp(f, z, P)) }, onPropertyChanged: function () { this.iv() }, validateImpl: function () { var d = this, R = d._topView, e = d._bottomView, S = d._leftView, Z = d._rightView, x = d._centerView, h = d.getWidth(), F = d.getHeight(), I = 0, K = 0, L = h, k = F, W = 0, $ = 0, J = 0, Q = 0; R && (W = d._topHeight == l ? zh(R) : d._topHeight, K = W), e && ($ = d._bottomHeight == l ? zh(e) : d._bottomHeight, k = F - $), S && (J = d._leftWidth == l ? bc(S) : d._leftWidth, I = J), Z && (Q = d._rightWidth == l ? bc(Z) : d._rightWidth, L = h - Q); var D = g(0, L - I), Y = g(0, k - K); R && Up(R, 0, 0, h, W), e && Up(e, 0, k, h, $), S && Up(S, 0, K, J, Y), Z && Up(Z, L, K, Q, Y), x && Up(x, I, K, D, Y) } })
    }
}("undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : (0, eval)("this"), Object);