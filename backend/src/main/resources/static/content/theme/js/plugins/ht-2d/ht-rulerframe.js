!function(l,u){"use strict";var V="position",d="absolute",v="relative",I="px",O="left",J="right",t="top",P="bottom",y="display",k="none",F="block",L=ht.Default,w=L.getInternal(),X=Math.floor,h=Math.ceil,n=Math.PI,i=null,q=l.parseInt,G=function(U){return U.getContext("2d")},a=function(){return document},Z=function(T){return a().createElement(T)},j=function(){return Z("canvas")},f=function(G,j,e){G.style.setProperty(j,e,i)},o=function(S,c,I){L.def(ht.widget[S],c,I)},g=function(c,J){c.appendChild(J)},R=function(p,w){p.removeChild(w)},A=function(g,A,w,y){g.addEventListener(A,w,!!y)},D=function(J,l,t,u){J.removeEventListener(l,t,!!u)};ht.widget.RulerFrame=function(J){var H=this,T=H._view=w.createView(null,H),L=H.$1k=j(),K=H.$2k=j(),Y=H.$3k=j(),W=H.$4k=j();H._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},H._topRulerConfig={visible:!0},H._rightRulerConfig={visible:!1},H._bottomRulerConfig={visible:!1},H._leftRulerConfig={visible:!0},g(T,L),g(T,Y),g(T,K),g(T,W),f(T,V,v),f(T,"box-sizing","border-box"),f(T,"-moz-box-sizing","border-box"),f(L,V,d),f(K,V,d),f(Y,V,d),f(W,V,d),H.$14k=function(){H.$13k=1,H.iv()},H.$15k=function(A){if(H._topRulerConfig.guideVisible||H._rightRulerConfig.guideVisible||H._bottomRulerConfig.guideVisible||H._leftRulerConfig.guideVisible||H._defaultRulerConfig.guideVisible||(H._topRulerConfig.guideTipVisible||H._rightRulerConfig.guideTipVisible||H._bottomRulerConfig.guideTipVisible||H._leftRulerConfig.guideTipVisible||H._defaultRulerConfig.guideTipVisible)&&H._component){var G=T.getBoundingClientRect();H.$16k={x:A.clientX-G.left,y:A.clientY-G.top},H.$5k()}},H.setComponent(J)},o("RulerFrame",u,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(S){var N=this,Q=N._component,F=N.getView();if(F){if(N._component=S,N.fp("component",Q,S),Q){var i=N.getComponentView(Q);R(F,i),D(F,"mousemove",N.$15k),N.removeComponentPropertyChangeListener(Q,N.$14k)}if(S){var L=N.getComponentView(S);g(F,L),f(L,V,d),A(F,"mousemove",N.$15k),N.addComponentPropertyChangeListener(S,N.$14k)}}},addComponentPropertyChangeListener:function(I,G){I&&I.mp&&I.mp(G)},removeComponentPropertyChangeListener:function(n,l){n&&n.ump&&n.ump(l)},getComponentHZoom:function(N){return N&&N.getZoom?N.getZoom():1},getComponentVZoom:function(C){return C&&C.getZoom?C.getZoom():1},getComponentViewRect:function(n){return n&&n.getViewRect?n.getViewRect():void 0},getComponentView:function(k){return k&&k.getView?k.getView():k},invalidateComponent:function(k){k&&k.iv&&k.iv()},validateComponent:function(S){S&&S.validate&&S.validate()},$7k:function(M,J,Q,E,b,m,e,t,G,j,v,o){if(J.visible){var I=this._defaultRulerConfig,R="borderStyle",u="borderColor",z="borderWidth",U="background",N=J[R]||I[R],c=J[u]||I[u],d=J[z]||I[z],W=J.size!=i?J.size:I.size,H=J[U]||I[U],P=W+d,L=this.$6k(d,N,c,M,Q,b,P,e,t,G,j,v,o);f(M,b,"0px"),m?w.setCanvas(M,E-L,W):w.setCanvas(M,W,E-L),f(M,"background",H),f(M,y,F)}else f(M,y,k),f(this.getComponentView(this._component),b,"0px")},$6k:function(J,D,v,g,Q,G,P,w,C,q,c,r,h){var L=0;return f(g,Q,J+"px "+D+" "+v),f(this.getComponentView(this._component),G,P+I),w?(f(g,C,q+I),L+=q):f(g,C,"0px"),c?(f(g,r,h+I),L+=h):f(g,r,"0px"),L},validateImpl:function(){var w=this,a=w._component,q=w.$1k,Y=w.$2k,E=w.$3k,x=w.$4k,f=w._view,R=w._defaultRulerConfig,M=w._topRulerConfig,$=w._rightRulerConfig,c=w._bottomRulerConfig,L=w._leftRulerConfig,d=R.size;if(f&&a){var m=M.size!=i?M.size:d,e=$.size!=i?$.size:d,G=c.size!=i?c.size:d,Z=L.size!=i?L.size:d;w.$7k(q,M,"border-bottom",f.offsetWidth,t,!0,L.visible,O,Z,$.visible,J,e),w.$7k(Y,$,"border-left",f.offsetHeight,J,!1,M.visible,t,m,c.visible,P,G),w.$7k(E,c,"border-top",f.offsetWidth,P,!0,L.visible,O,Z,$.visible,J,e),w.$7k(x,L,"border-right",f.offsetHeight,O,!1,M.visible,t,m,c.visible,P,G),w.$13k?delete w.$13k:w.invalidateComponent(a),w.validateComponent(a),w.$5k()}},$5k:function(){function x(B,C,v,y,U,W){if(C.visible){var X=G(B),x=C[A]||R,g=C[N]!=i?C[N]:l,u=C[E]||c,_=C[z]||o,D=C.size!=i?C.size:J,Lg=C[T]||w,$d=C[h]||d,mp=C[m]||I,mh=C[K]!=i?C[K]:H,ro=C[q]!=i?C[q]:F,im=C[L]!=i?C[L]:$,pm=C[Q]!=i?C[Q]:e,gr=C[Z]!=i?C[Z]:b,Qg=C[p]!=i?C[p]:M,yg=C[f]||Ef,Jj=C[n]||jf;g&&(x=S[W]=S.$8k(S[W]||x,C[a]||V,C[j]||P,y?k:r,$d)),v.call(S,X,O,t,Y,s,D,y?k:r,x,u,_,U,Lg,mp);var Vf=S.$16k;(mh||ro)&&Vf&&(y?S.$9k(X,Vf.x,D,yg,Jj,mh,ro,im,pm,gr,Qg):S.$10k(X,Vf.y,D,yg,Jj,mh,ro,im,pm,gr,Qg,U))}}var S=this,y=S.$1k,C=S.$2k,_=S.$3k,D=S.$4k,v=S._topRulerConfig,U=S._rightRulerConfig,g=S._bottomRulerConfig,W=S._leftRulerConfig,u=S._defaultRulerConfig,B=S._component,X=S.getComponentViewRect(B),k=S.getComponentHZoom(B),r=S.getComponentVZoom(B),O=X.x*k,Y=O+X.width*k,t=X.y*r,s=t+X.height*r,J=S._defaultRulerConfig.size,A="defaultMajorTickSpacing",a="maxPhysicalMajorTickSpacing",j="minPhysicalMajorTickSpacing",N="tickSpacingAdaptable",E="majorTickTextFont",z="majorTickTextColor",T="majorTickColor",m="minorTickColor",K="guideVisible",q="guideTipVisible",L="guideTipBorderColor",Q="guideTipTextColor",Z="guideTipTextFont",p="guideTipBackground",f="guideColor",n="guideWidth",h="minMajorTickSpacing",R=u[A],V=u[a],P=u[j],l=u[N],c=u[E],o=u[z],w=u[T],d=u[h],I=u[m],H=u[K],F=u[q],$=u[L],e=u[Q],b=u[Z],M=u[p],Ef=u[f],jf=u[n];S._view&&B&&(x(y,v,S.$11k,!0,!1,"_currentTopMajorTickSpacing"),x(C,U,S.$12k,!1,!0,"_currentRightMajorTickSpacing"),x(_,g,S.$11k,!0,!0,"_currentBottomMajorTickSpacing"),x(D,W,S.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(C,q,J,Y,Q){return J>C*Y?C=X(q/Y/Q)*Q:C*Y>q&&(C=h(J/Y/Q)*Q),C},getHTipText:function(G){var M=this,X=M._component,i=0,a=M._view.getBoundingClientRect();return X.lp?i=q(X.lp({clientX:G.x+a.left,clientY:G.y}).x):i-=q(this.getComponentView(X).style.left)||0,i},$9k:function(v,P,Q,S,k,b,K,H,V,m,e){var B=this,_=B._component;v.save(),w.translateAndScale(v,0,0,1);var Z=P-(q(this.getComponentView(_).style.left)||0),F=0;if(P=B.getHTipText(B.$16k),b&&(v.beginPath(),v.fillStyle=S,v.rect(Z,F,k,Q),v.fill()),K){v.beginPath(),v.textAlign="center",v.textBaseline="middle",v.font=m;var n=v.measureText(P).width+6;v.fillStyle=e,v.rect(Z-n/2,F,n,Q),v.fill(),v.strokeStyle=H,v.stroke(),v.beginPath(),v.fillStyle=V,v.fillText(P,Z,F+Q/2)}v.restore()},getVTipText:function(m){var b=this,A=b._component,G=0,x=b._view.getBoundingClientRect();return A.lp?G=q(A.lp({clientX:m.x,clientY:m.y+x.top}).y):G-=q(this.getComponentView(A).style.top)||0,G},formatScaleText:function(m){return Math.round(m)},$10k:function(W,G,S,l,_,i,d,R,K,Z,r,o){var g=this,D=g._component;W.save(),w.translateAndScale(W,0,0,1);var x=S/2,c=G-(q(this.getComponentView(D).style.top)||0);if(G=g.getVTipText(g.$16k),i&&(W.beginPath(),W.fillStyle=l,W.rect(x-S/2,c,S,_),W.fill()),d){W.translate(x,c),W.rotate((o?90:-90)*n/180),W.translate(-x,-c),W.beginPath(),W.textAlign="center",W.textBaseline="middle",W.font=Z;var M=W.measureText(G).width+6;W.fillStyle=r,W.rect(x-M/2,c-S/2,M,S),W.fill(),W.strokeStyle=R,W.stroke(),W.fillStyle=K,W.fillText(G,x,c)}W.restore()},$11k:function(N,H,u,K,x,P,Z,Y,v,R,_,i,B){N.save(),u=0;var o=H,D=K,I=(o+D)/2;H=0,K=D-o,w.translateAndScale(N,0,0,1);var r=0,C=0,J=q(P/2),b=P-J,p=_?0:J,V=Y*Z,S=V/10;H-=V,K+=V,N.clearRect(H,0,K-H,P),N.beginPath(),N.fillStyle=B;var n=X(I/S)*S-o;for(r=n;K>r;r+=S)N.rect(r,u+p,1,b);for(r=n;r>H;r-=S)N.rect(r,u+p,1,b);for(N.fill(),p=_?0:1,N.beginPath(),N.fillStyle=i,n=X(I/V)*V-o,r=n;K>r;r+=V)N.rect(r,u+p,1,P-1);for(r=n;r>H;r-=V)N.rect(r,u+p,1,P-1);N.fill();var y=q(/\d+px/.exec(v)[0]),h=(y||10)/2;N.textBaseline="middle",p=_?P-h-2:h+2,N.beginPath(),N.fillStyle=R,N.font=v;var j=X(I/V)*V/Z;for(r=n,C=j;K>r;r+=V,C+=Y){var s=this.getHScaleText?this.getHScaleText(r):C;N.fillText(this.formatScaleText(s),r+2,u+p)}for(r=n,C=j;r>H;r-=V,C-=Y){var s=this.getHScaleText?this.getHScaleText(r):C;N.fillText(this.formatScaleText(s),r+2,u+p)}N.restore()},$12k:function(A,o,c,V,u,j,F,Q,r,t,Z,P,I){function L(y,P,x,l,R,v){R=E.getVScaleText?E.getVScaleText(x):R,R=E.formatScaleText(R),A.translate(y+P,x),A.rotate(-l),A.translate(-y-P,-x),A.fillText(R,y+P+(v?2:1),x),A.translate(y+P,x),A.rotate(l),A.translate(-y-P,-x)}A.save(),o=0;var O=c,R=u,H=(O+R)/2;c=0,u=R-O,w.translateAndScale(A,0,0,1);var J=0,E=this,k=0,T=q(j/2),m=j-T,y=Z?0:T,Y=Q*F,i=Y/10;c-=Y,u+=Y,A.clearRect(o,0,j,u-c),A.beginPath(),A.fillStyle=I;var M=X(H/i)*i-O;for(J=M;u>J;J+=i)A.rect(o+y,J,m,1);for(J=M;J>c;J-=i)A.rect(o+y,J,m,1);for(A.fill(),y=Z?0:1,A.beginPath(),A.fillStyle=P,M=X(H/Y)*Y-O,J=M;u>J;J+=Y)A.rect(o+y,J,j-1,1);for(J=M;J>c;J-=Y)A.rect(o+y,J,j-1,1);A.fill();var K=q(/\d+px/.exec(r)[0]),x=(K||10)/2,C=90*n/180;A.textBaseline="middle",y=Z?j-x:x+2,C=Z?-C:C,A.beginPath(),A.fillStyle=t,A.font=r;var b=X(H/Y)*Y/F;for(J=M,k=b;u>J;J+=Y,k+=Q)L(o,y,J,C,k,Z);for(J=M,k=b;J>c;J-=Y,k-=Q)L(o,y,J,C,k,Z);A.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var x=this,_=x._component,W=x._view;_&&x.removeComponentPropertyChangeListener(_,x.$14k),W&&(D(W,"mousemove",x.$15k),R(W.parentNode,W),x._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);